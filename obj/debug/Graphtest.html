<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>



<script>
    function log(st) {console.log(st);}
</script>
<body>
<h1>YGraph DEMO </h1>
<br>
<canvas width="800" height="1200" id="cnvs" style="border:1px solid black"></canvas><br>
<a style="cursor:pointer" id="addMarker">Place marker</a>
<br><br>

<script type="module">
    import * as YDataRendering from "./Renderer/YDataRendererFull.js";
    let canvas = document.getElementById("cnvs");
    var renderer = new YDataRendering.YGraph(canvas,log);
    //renderer.DisableRedraw();
    let now = YDataRendering.TimeConverter.ToUnixTime(new Date())



    var  yAxis1 = renderer.addYAxis();
    //yAxis1.min =0;
    //yAxis1.max =9;
    yAxis1.font.size=12;
    yAxis1.thickness = 2;
    yAxis1.legend.title="Y legend";
    //yAxis1.position = g.YDataRendering.YAxis.HrzPosition.RIGHT;

    var zone = yAxis1.AddZone();
    zone.min=2.5;
    zone.max=7.5;
    zone.color = YDataRendering.YColor.FromArgb(64,0,255,0);
    zone.visible =true;

    var  yAxis2 = renderer.addYAxis();
    // yAxis2.min =0;
    //  yAxis2.max =100;
    yAxis2.font.size=12;
    yAxis2.legend.title="Y legend 1";
    yAxis2.position = YDataRendering.YAxis.HrzPosition.RIGHT;

    renderer.xAxis.setMinMax(now,now+1);
    renderer.xAxis.overflowHandling =  YDataRendering.XAxis.OverflowHandling.SCROLL;
    renderer.xAxis.legend.title="X legend 2";
    renderer.xAxis.timeReference = YDataRendering.TimeConverter.TimeReference.RELATIVE;

    //renderer.xAxis.position = g.YDataRendering.XAxis.VrtPosition.TOP;


    let serie1 =   renderer.addSerie();
    serie1.legend = "serie #1";
    serie1.color = YDataRendering.YColor.Red;
    serie1.disabled = false;


    let serie2 =   renderer.addSerie();
    serie2.legend = "serie #2";

    serie2.color = YDataRendering.YColor.Green;
    serie2.yAxisIndex = yAxis2.index;
    serie2.disabled = false;

 //   renderer.navigator.enabled =true;
    renderer.legendPanel.overlap=true;
    renderer.legendPanel.enabled=true;
    renderer.legendPanel.padding=5;
    renderer.legendPanel.position = YDataRendering.LegendPanel.Position.TOPRIGHT;

    renderer.dataTracker.dataPrecision =  YDataRendering.DataTracker.DataPrecision.PRECISION_001;
    renderer.dataTracker.enabled=true;

    renderer.navigator.enabled=true;

    /*
for (let i=0;i<750;i++)
{
    serie1.AddPoint(new  YDataRendering.pointXY(now+i ,  5+5*Math.sin (i/1000.0)))
//    serie2.AddPoint( new  YDataRendering.pointXY(now+i , i & 16 ? 1:0));

}*/

    let  m = renderer.xAxis.AddMarker();
    m.xposition = now +5;
    m.text = "Hello\nThere!\nThis is line 3,\nThis is line 4.";
    m.enabled = true;
    renderer.AllowRedraw() ;


    let start =  performance.now();
    setInterval( ()=>{
        serie1.AddPoint(new  YDataRendering.pointXY(now+(performance.now() - start)/1000 ,  5+5*Math.sin ((performance.now() - start) /1000.0)))
        serie2.AddPoint( new  YDataRendering.pointXY(now+(performance.now() - start)/1000 ,5+4*Math.abs((((performance.now() - start)%6000) /6000)-0.5)   ));

    } ,40)


    export function DownloadAsPNG(){ renderer.captureAndDownloadImage(YDataRendering.YDataRenderer.CaptureType.PNG ); }
    window.DownloadAsPNG = DownloadAsPNG;

    export function DownloadAsSVG() { renderer.captureAndDownloadImage(YDataRendering.YDataRenderer.CaptureType.SVG );}
    window.DownloadAsSVG = DownloadAsSVG;

    document.getElementById("addMarker").addEventListener("click",(e)=>{renderer.startMarkerCapture(m);});

</script>

</body>
</html>