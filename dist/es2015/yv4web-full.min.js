/* Yocto-Visualization-4web (ES2015 full 2.1.10284) - www.yoctopuce.com */
var Al=Object.defineProperty;var m=(D,e)=>Al(D,"name",{value:e,configurable:!0});var Mi=class Mi{constructor(e,t,i){this.a=e,this.b=t,this.c=i}static FromXYCoord(e,t){return new Mi(e,t,1)}multiplyByM(e){return new Mi(e.a*this.a+e.b*this.b+e.c*this.c,e.d*this.a+e.e*this.b+e.f*this.c,e.g*this.a+e.h*this.b+e.i*this.c)}multiplyByN(e){return new Mi(this.a*e,this.b*e,this.c*e)}AddV(e){return new Mi(this.a+e.a,this.b+e.b,this.c+e.c)}SubstractV(e){return new Mi(this.a-e.a,this.b-e.b,this.c-e.c)}toPointF(){return new me(this.a,this.b)}toPoint(){return new ze(this.a,this.b)}};m(Mi,"Vector3");var Ut=Mi,Ee=class Ee{constructor(e,t,i,r,s,n,o,a,l,h){this.a=e,this.b=t,this.c=i,this.d=r,this.e=s,this.f=n,this.g=o,this.h=a,this.i=l,t==0&&r==0&&e==1&&s==1&&l==1&&o==0&&a==0&&(h|=Ee.Flag_TRANSLATION,i==0&&n==0&&(h|=Ee.Flag_IDENTITY)),this.isTranslation=(h&Ee.Flag_TRANSLATION)!=0,this.isIdentity=(h&Ee.Flag_IDENTITY)!=0}clone(){let e=0;return this.isTranslation&&(e|=Ee.Flag_TRANSLATION),this.isIdentity&&(e|=Ee.Flag_IDENTITY),new Ee(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,e)}get determinant(){let e=this.e*this.i-this.h*this.f,t=this.d*this.i-this.g*this.f,i=this.d*this.h-this.g*this.e;return this.a*e+-this.b*t+this.c*i}get transpose(){return this.isIdentity?Ee.newIdentityMatrix():new Ee(this.a,this.d,this.g,this.b,this.e,this.h,this.c,this.f,this.i,Ee.Flag_NONE)}multiplyByV(e){return this.isTranslation?new Ut(this.c+e.a,this.f+e.b,1):new Ut(this.a*e.a+this.b*e.b+this.c*e.c,this.d*e.a+this.e*e.b+this.f*e.c,this.g*e.a+this.h*e.b+this.i*e.c)}static newMatrix(e,t,i,r,s,n,o,a,l){return new Ee(e,t,i,r,s,n,o,a,l,Ee.Flag_NONE)}static newTranslateMatrix(e,t){let i=Ee.Flag_TRANSLATION;return e==0&&t==0&&(i|=Ee.Flag_IDENTITY),new Ee(1,0,e,0,1,t,0,0,1,i)}static newRotateMatrix(e){return e=Math.PI*e/180,new Ee(Math.cos(e),-Math.sin(e),0,Math.sin(e),-Math.cos(e),0,0,0,1,Ee.Flag_NONE)}static newScaleMatrix(e){return new Ee(e,0,0,0,e,0,0,0,1,Ee.Flag_NONE)}static newIdentityMatrix(){return new Ee(1,0,0,0,1,0,0,0,1,Ee.Flag_IDENTITY|Ee.Flag_TRANSLATION)}toCSS(){return"matrix("+this.a.toString()+","+this.d.toString()+","+this.b.toString()+","+this.e.toString()+","+this.c.toString()+","+this.f.toString()+")"}toString(){return"| "+this.a.toFixed(2)+" "+this.b.toFixed(2)+" "+this.c.toFixed(2)+" |"+(this.isIdentity?" I":"")+`
| `+this.d.toFixed(2)+" "+this.e.toFixed(2)+" "+this.f.toFixed(2)+" |"+(this.isTranslation?" T":"")+`
| `+this.g.toFixed(2)+" "+this.g.toFixed(2)+" "+this.i.toFixed(2)+` |
`}multiplyByM(e){return this.isIdentity?e.clone():e.isIdentity?this.clone():this.isTranslation&&e.isTranslation?Ee.newTranslateMatrix(this.c+e.c,this.f+e.f):new Ee(this.a*e.a+this.b*e.d+this.c*e.g,this.a*e.b+this.b*e.e+this.c*e.h,this.a*e.c+this.b*e.f+this.c*e.i,this.d*e.a+this.e*e.d+this.f*e.g,this.d*e.b+this.e*e.e+this.f*e.h,this.d*e.c+this.e*e.f+this.f*e.i,this.g*e.a+this.h*e.d+this.i*e.g,this.g*e.b+this.h*e.e+this.i*e.h,this.g*e.c+this.h*e.f+this.i*e.i,Ee.Flag_NONE)}get inverse(){if(this.isIdentity)return Ee.newIdentityMatrix();if(this.isTranslation)return Ee.newTranslateMatrix(-this.c,-this.f);let e=this.determinant;if(e==0)throw"matrix cannot be inverted";let t=this.e*this.i-this.f*this.h,i=this.b*this.i-this.c*this.h,r=this.b*this.f-this.c*this.e,s=this.d*this.i-this.f*this.g,n=this.a*this.i-this.c*this.g,o=this.a*this.f-this.c*this.d,a=this.d*this.h-this.e*this.g,l=this.a*this.h-this.b*this.g,h=this.a*this.e-this.b*this.d;return new Ee(t/e,-i/e,r/e,-s/e,n/e,-o/e,a/e,-l/e,h/e,Ee.Flag_NONE)}log(){console.log(this.toString())}};m(Ee,"Matrix3x3");var Yt=Ee;Yt.Flag_NONE=0;Yt.Flag_IDENTITY=1;Yt.Flag_TRANSLATION=2;var Qs=class Qs{static fromString(e,t){let i=Object.getOwnPropertyNames(e);for(let r=0;r<i.length;r++)if(i[r]==t)return e[t];throw"YEnum"+t+" is not a "+e+" value"}static siblings(e){let t=[],i=Object.getOwnPropertyNames(e);for(let r=0;r<i.length;r++)e[i[r]]instanceof De&&t.push(e[i[r]]);return t}};m(Qs,"YEnum");var Le=Qs,en=class en{constructor(e,t,i){this._value=e,this._container=i,this._humanreadable=t}fromString(e){return Le.fromString(this._container,e)}get toString(){return this._value.toString()}get description(){return this._humanreadable}get sibblings(){return Le.siblings(this._container)}};m(en,"YEnumItem");var De=en,tn=class tn{constructor(){this.IRLx=0,this.IRLy=0,this.zoomx=0,this.zoomy=0,this.Lmargin=0,this.Rmargin=0,this.Tmargin=0,this.Bmargin=0,this.Width=0,this.Height=0,this.Capture=!1,this.IRLCaptureStartX=0,this.CaptureStartY=0,this.OriginalXAxisMin=0,this.OriginalXAxisMax=0,this.OriginalIRLx=0,this.OriginalLmargin=0,this.OriginalZoomx=0}};m(tn,"ViewPortSettings");var jt=tn,rn=class rn{get userData(){return this._userData}set userData(e){this._userData=e}get directParent(){return this._directParent}constructor(e,t,i,r){this._userData=null,this._fontChangeCallback=null,this._name="Arial",this._italic=!1,this._bold=!1,this._color=c.Black,this._alternateColor=null,this._font=null,this._brush=new at(c.Black),this._parentRenderer=e,this._directParent=t,this._fontChangeCallback=r||null,this._size=new Be(i||10,Be.ResizeRule.FIXED,e,this,this.ResetFont)}ResetFont(e){this._font=null,e!=null&&this._parentRenderer.ProportionnalValueChanged(e)}get name(){return this._name}set name(e){this._name=e,this.ResetFont(null),this._parentRenderer.redraw()}get hasChanged(){return this._font==null}get size(){return this._size.value}set size(e){if(e<=0)throw new RangeError("Size must be a positive value");e=Math.round(100*e)/100,this._size.value=e,this.ResetFont(null),this._fontChangeCallback!=null&&this._fontChangeCallback(this),this._parentRenderer.redraw()}get italic(){return this._italic}set italic(e){this._italic!=e&&(this._italic=e,this.ResetFont(null),this._parentRenderer.redraw())}get bold(){return this._bold}set bold(e){this._bold!=e&&(this._bold=e,this.ResetFont(null),this._parentRenderer.redraw())}get color(){return this._color}set color(e){this._color!=e&&(this._color=e,this._brush=null,this._parentRenderer.redraw())}get alternateColor(){return this._alternateColor}set alternateColor(e){this._alternateColor!=e&&(this._alternateColor=e,this._brush=null,this._parentRenderer.redraw())}get fontObject(){return this._name?this._name:"Arial"}get brush(){return this._brush==null&&(this._brush=new at(this._alternateColor!=null?this._alternateColor:this._color)),this._brush}get sizeInPoints(){return this._size.value*.75}get sizeForCanvas(){return this._size.value*1.15}get htmlCode(){return(this._italic?"italic ":"")+(this._bold?"bold ":"")+this.sizeForCanvas.toString()+"px "+this._name}};m(rn,"YFont");var it=rn,sn=class sn{constructor(e,t){this._w=0,this._h=0,this._lines=[],this._linesCount=0,this._lineHeight=0,this._firstlineHeight=0,e!=null&&(this._lineHeight=e.size*1.25,this._firstlineHeight=this._lineHeight*.75,t.indexOf(`
`)<0?(this._lines=[t],this._linesCount=1):(this._lines=t.split(`
`),this._linesCount=this._lines.length))}get lines(){return this._lines}get linesCount(){return this._linesCount}get firstLineHeight(){return this._firstlineHeight}get lineHeight(){return this._lineHeight}get height(){return this._h}get width(){return this._w}set width(e){this._w=e}set height(e){this._h=e}};m(sn,"YSizeF");var Ki=sn,nn=class nn{constructor(e){this._value=0,this._value=e}};m(nn,"YTextRenderingHint");var Ye=nn;Ye.SystemDefault=new Ye(0);Ye.SingleBitPerPixelGridFit=new Ye(1);Ye.SingleBitPerPixel=new Ye(2);Ye.AntiAliasGridFit=new Ye(3);Ye.AntiAlias=new Ye(4);Ye.ClearTypeGridFit=new Ye(5);var an=class an{constructor(e){this._value=0,this._value=e}};m(an,"YSmoothingMode");var Ze=an;Ze.Invalid=new Ze(-1);Ze.Default=new Ze(0);Ze.HighSpeed=new Ze(1);Ze.HighQuality=new Ze(2);Ze.None=new Ze(3);Ze.AntiAlias=new Ze(4);var on=class on{constructor(){this._str=""}AppendLine(e){this._str+=e+`
`}Append(e){this._str+=e}get contents(){return this._str}};m(on,"YStringBuilder");var es=on,ln=class ln{get Alignment(){return this._Alignment}set Alignment(e){this._Alignment=e}get LineAlignment(){return this._LineAlignment}set LineAlignment(e){this._LineAlignment=e}get FormatFlags(){return this._formatFlags}set FormatFlags(e){this._formatFlags=e}get Trimming(){return this._Trimming}set Trimming(e){this._Trimming=e}constructor(e){this._Alignment=0,this._LineAlignment=0,this._formatFlags=0,this._Trimming=0,this._clip=16384,this._clip=e}};m(ln,"YStringFormat");var qe=ln,we=class we{get name(){return this._name}set predefname(e){this._name=e}static get predefinedColors(){if(we._predefinedColors==null){we._predefinedColors={};let e=Object.getOwnPropertyNames(we);for(let t=0;t<e.length;t++)we[e[t]]instanceof we&&(we._predefinedColors[e[t]]=we[e[t]],we._predefinedColors[e[t]].predefname=e[t])}return we._predefinedColors}static FromString(e){let t=e.toUpperCase(),i=Object.getOwnPropertyNames(we);for(let r=0;r<i.length;r++)if(i[r].toUpperCase()==t&&we[i[r]]instanceof we)return we[i[r]];if(e.length==7&&e.substr(0,1).toUpperCase()=="#"){let r=parseInt(e.substr(1,2),16),s=parseInt(e.substr(3,2),16),n=parseInt(e.substr(5,2),16);return new we(!1,255,r,s,n)}if(e.length==12){if(e.substr(0,4).toUpperCase()=="RGB:"){let r=parseInt(e.substr(4,2),16),s=parseInt(e.substr(6,2),16),n=parseInt(e.substr(8,2),16),o=parseInt(e.substr(10,2),16);return new we(!1,r,s,n,o)}else if(e.substr(0,4).toUpperCase()=="HSL:"){let r=parseInt(e.substr(4,2),16),s=parseInt(e.substr(6,2),16),n=parseInt(e.substr(8,2),16),o=parseInt(e.substr(10,2),16);return new we(!0,r,s,n,o)}}return null}static hex(e){let t=e.toString(16);return t.length<=1?"0"+t:t}toString(){if(this.isHSLColor)return"HSL:"+(we.hex(this.transparency)+we.hex(this.h)+we.hex(this.s)+we.hex(this.l)).toUpperCase();{let e=Object.getOwnPropertyNames(we);for(let t=0;t<e.length;t++){let r=Reflect.get(we,e[t]);if(r.alpha==this.alpha&&r.red==this.red&&r.green==this.green&&r.blue==this.blue)return e[t]}}return"RGB:"+(we.hex(this.transparency)+we.hex(this.r)+we.hex(this.g)+we.hex(this.b)).toUpperCase()}get svgCode(){return"rgb("+this.r.toString()+", "+this.g.toString()+", "+this.b.toString()+")"}get alphaCode(){return(this.transparency/255).toFixed(3)}static hsl2rgbInt(e,t,i){if(i>=170)return(e+127)/255>>0;if(i>42){if(i<=127)return(t+127)/255>>0;i=170-i}return(e*255+(t-e)*(6*i)+32512)/65025>>0}hsl2rgb(){let e,t,i;if(this.rgbConvertionDone=!0,this.s==0){this.r=this.l,this.g=this.l,this.b=this.l;return}this.l<=127?t=this.l*(255+this.s):t=(this.l+this.s)*255-this.l*this.s,e=510*this.l-t,i=this.h+85,i>255&&(i=i-255),this.r=we.hsl2rgbInt(e,t,i),i=this.h,i>255&&(i=i-255),this.g=we.hsl2rgbInt(e,t,i),this.h>=85?i=this.h-85:i=this.h+170,this.b=we.hsl2rgbInt(e,t,i),this.r>255&&(this.r=255),this.g>255&&(this.g=255),this.b>255&&(this.b=255)}computeHSL(){let e=this.r,t=this.g,i=this.b,r,s,n,o=e>t?e:t,a=e<t?e:t,l=0,h=0;if(this.hslConvertionDone=!0,i>o&&(o=i),i<a&&(a=i),n=(o+a+1)/2>>0,o==a){this.h=0,this.s=0,this.l=n;return}l=(o+a)/2>>0,n<=127?s=(255*(o-a)+l)/(o+a)>>0:s=(255*(o-a)+255-l)/(510-(o+a))>>0,l=3*(o-a),h=2*l,e==o?(r=0,e=t,t=i):t==o?(r=85,t=e,e=i):r=170,e>=t?r+=(255*(e-t)+l)/h>>0:r+=255-(255*(t-e)-l)/h>>0,r>255&&(r-=255),s>255&&(s=255),n>255&&(n=255),this.h=r,this.s=s,this.l=n}get hue(){return this.hslConvertionDone||this.computeHSL(),this.h}get saturation(){return this.hslConvertionDone||this.computeHSL(),this.s}get luminosity(){return this.hslConvertionDone||this.computeHSL(),this.l}get red(){return this.rgbConvertionDone||this.hsl2rgb(),this.r}get green(){return this.rgbConvertionDone||this.hsl2rgb(),this.g}get blue(){return this.rgbConvertionDone||this.hsl2rgb(),this.b}get alpha(){return this.transparency}static FromArgb(e,t,i,r){return new we(!1,e,t,i,r)}static FromAhsl(e,t,i,r){return new we(!0,e,t,i,r)}get isHSL(){return this.isHSLColor}get isRGB(){return!this.isHSLColor}equal(e){if(this.isHSLColor){if(!e.isHSLColor||e.hue!=this.hue||e.saturation!=this.saturation||e.luminosity!=this.luminosity||e.alpha!=this.alpha)return!1}else if(e.isHSLColor||e.red!=this.red||e.green!=this.green||e.blue!=this.blue||e.alpha!=this.alpha)return!1;return!0}clone(){return this.isHSLColor?new we(!0,this.transparency,this.h,this.s,this.l,this.isPredefined):new we(!1,this.transparency,this.r,this.g,this.b,this.isPredefined)}get isPredefined(){return this._isPredefined}constructor(e,t,i,r,s,n){this.hslConvertionDone=!1,this.rgbConvertionDone=!1,this.transparency=0,this.r=0,this.g=0,this.b=0,this.h=0,this.s=0,this.l=0,this._name="",this._htmlcode=this.computeHTMLCode(),this.hslConvertionDone=e,this.isHSLColor=e,this.transparency=t,this._isPredefined=n===!0,e?(this.h=i,this.s=r,this.l=s,this.hsl2rgb()):(this.r=i,this.g=r,this.b=s,this.rgbConvertionDone=!0),this._htmlcode=this.computeHTMLCode()}computeHTMLCode(){let e=this.transparency/255,t=this.r,i=this.g,r=this.b;return"rgba("+t+","+i+","+r+","+e.toFixed(3)+")"}get htmlCode(){return this._htmlcode}};m(we,"YColor");var c=we;c.AliceBlue=new c(!1,255,240,248,255,!0);c.AntiqueWhite=new c(!1,255,250,235,215,!0);c.Aqua=new c(!1,255,0,255,255,!0);c.Aquamarine=new c(!1,255,127,255,212,!0);c.Azure=new c(!1,255,240,255,255,!0);c.Beige=new c(!1,255,245,245,220,!0);c.Bisque=new c(!1,255,255,228,196,!0);c.Black=new c(!1,255,0,0,0,!0);c.BlanchedAlmond=new c(!1,255,255,235,205,!0);c.Blue=new c(!1,255,0,0,255,!0);c.BlueViolet=new c(!1,255,138,43,226,!0);c.Brown=new c(!1,255,165,42,42,!0);c.BurlyWood=new c(!1,255,222,184,135,!0);c.CadetBlue=new c(!1,255,95,158,160,!0);c.Chartreuse=new c(!1,255,127,255,0,!0);c.Chocolate=new c(!1,255,210,105,30,!0);c.Coral=new c(!1,255,255,127,80,!0);c.CornflowerBlue=new c(!1,255,100,149,237,!0);c.Cornsilk=new c(!1,255,255,248,220,!0);c.Crimson=new c(!1,255,220,20,60,!0);c.Cyan=new c(!1,255,0,255,255,!0);c.DarkBlue=new c(!1,255,0,0,139,!0);c.DarkCyan=new c(!1,255,0,139,139,!0);c.DarkGoldenrod=new c(!1,255,184,134,11,!0);c.DarkGray=new c(!1,255,169,169,169,!0);c.DarkGreen=new c(!1,255,0,100,0,!0);c.DarkKhaki=new c(!1,255,189,183,107,!0);c.DarkMagenta=new c(!1,255,139,0,139,!0);c.DarkOliveGreen=new c(!1,255,85,107,47,!0);c.DarkOrange=new c(!1,255,255,140,0,!0);c.DarkOrchid=new c(!1,255,153,50,204,!0);c.DarkRed=new c(!1,255,139,0,0,!0);c.DarkSalmon=new c(!1,255,233,150,122,!0);c.DarkSeaGreen=new c(!1,255,143,188,143,!0);c.DarkSlateBlue=new c(!1,255,72,61,139,!0);c.DarkSlateGray=new c(!1,255,47,79,79,!0);c.DarkTurquoise=new c(!1,255,0,206,209,!0);c.DarkViolet=new c(!1,255,148,0,211,!0);c.DeepPink=new c(!1,255,255,20,147,!0);c.DeepSkyBlue=new c(!1,255,0,191,255,!0);c.DimGray=new c(!1,255,105,105,105,!0);c.DodgerBlue=new c(!1,255,30,144,255,!0);c.Firebrick=new c(!1,255,178,34,34,!0);c.FloralWhite=new c(!1,255,255,250,240,!0);c.ForestGreen=new c(!1,255,34,139,34,!0);c.Fuchsia=new c(!1,255,255,0,255,!0);c.Gainsboro=new c(!1,255,220,220,220,!0);c.GhostWhite=new c(!1,255,248,248,255,!0);c.Gold=new c(!1,255,255,215,0,!0);c.Goldenrod=new c(!1,255,218,165,32,!0);c.Gray=new c(!1,255,128,128,128,!0);c.Green=new c(!1,255,0,128,0,!0);c.GreenYellow=new c(!1,255,173,255,47,!0);c.Honeydew=new c(!1,255,240,255,240,!0);c.HotPink=new c(!1,255,255,105,180,!0);c.IndianRed=new c(!1,255,205,92,92,!0);c.Indigo=new c(!1,255,75,0,130,!0);c.Ivory=new c(!1,255,255,255,240,!0);c.Khaki=new c(!1,255,240,230,140,!0);c.Lavender=new c(!1,255,230,230,250,!0);c.LavenderBlush=new c(!1,255,255,240,245,!0);c.LawnGreen=new c(!1,255,124,252,0,!0);c.LemonChiffon=new c(!1,255,255,250,205,!0);c.LightBlue=new c(!1,255,173,216,230,!0);c.LightCoral=new c(!1,255,240,128,128,!0);c.LightCyan=new c(!1,255,224,255,255,!0);c.LightGoldenrodYellow=new c(!1,255,250,250,210,!0);c.LightGray=new c(!1,255,211,211,211,!0);c.LightGreen=new c(!1,255,144,238,144,!0);c.LightPink=new c(!1,255,255,182,193,!0);c.LightSalmon=new c(!1,255,255,160,122,!0);c.LightSeaGreen=new c(!1,255,32,178,170,!0);c.LightSkyBlue=new c(!1,255,135,206,250,!0);c.LightSlateGray=new c(!1,255,119,136,153,!0);c.LightSteelBlue=new c(!1,255,176,196,222,!0);c.LightYellow=new c(!1,255,255,255,224,!0);c.Lime=new c(!1,255,0,255,0,!0);c.LimeGreen=new c(!1,255,50,205,50,!0);c.Linen=new c(!1,255,250,240,230,!0);c.Magenta=new c(!1,255,255,0,255,!0);c.Maroon=new c(!1,255,128,0,0,!0);c.MediumAquamarine=new c(!1,255,102,205,170,!0);c.MediumBlue=new c(!1,255,0,0,205,!0);c.MediumOrchid=new c(!1,255,186,85,211,!0);c.MediumPurple=new c(!1,255,147,112,219,!0);c.MediumSeaGreen=new c(!1,255,60,179,113,!0);c.MediumSlateBlue=new c(!1,255,123,104,238,!0);c.MediumSpringGreen=new c(!1,255,0,250,154,!0);c.MediumTurquoise=new c(!1,255,72,209,204,!0);c.MediumVioletRed=new c(!1,255,199,21,133,!0);c.MidnightBlue=new c(!1,255,25,25,112,!0);c.MintCream=new c(!1,255,245,255,250,!0);c.MistyRose=new c(!1,255,255,228,225,!0);c.Moccasin=new c(!1,255,255,228,181,!0);c.NavajoWhite=new c(!1,255,255,222,173,!0);c.Navy=new c(!1,255,0,0,128,!0);c.OldLace=new c(!1,255,253,245,230,!0);c.Olive=new c(!1,255,128,128,0,!0);c.OliveDrab=new c(!1,255,107,142,35,!0);c.Orange=new c(!1,255,255,165,0,!0);c.OrangeRed=new c(!1,255,255,69,0,!0);c.Orchid=new c(!1,255,218,112,214,!0);c.PaleGoldenrod=new c(!1,255,238,232,170,!0);c.PaleGreen=new c(!1,255,152,251,152,!0);c.PaleTurquoise=new c(!1,255,175,238,238,!0);c.PaleVioletRed=new c(!1,255,219,112,147,!0);c.PapayaWhip=new c(!1,255,255,239,213,!0);c.PeachPuff=new c(!1,255,255,218,185,!0);c.Peru=new c(!1,255,205,133,63,!0);c.Pink=new c(!1,255,255,192,203,!0);c.Plum=new c(!1,255,221,160,221,!0);c.PowderBlue=new c(!1,255,176,224,230,!0);c.Purple=new c(!1,255,128,0,128,!0);c.Red=new c(!1,255,255,0,0,!0);c.RosyBrown=new c(!1,255,188,143,143,!0);c.RoyalBlue=new c(!1,255,65,105,225,!0);c.SaddleBrown=new c(!1,255,139,69,19,!0);c.Salmon=new c(!1,255,250,128,114,!0);c.SandyBrown=new c(!1,255,244,164,96,!0);c.SeaGreen=new c(!1,255,46,139,87,!0);c.SeaShell=new c(!1,255,255,245,238,!0);c.Sienna=new c(!1,255,160,82,45,!0);c.Silver=new c(!1,255,192,192,192,!0);c.SkyBlue=new c(!1,255,135,206,235,!0);c.SlateBlue=new c(!1,255,106,90,205,!0);c.SlateGray=new c(!1,255,112,128,144,!0);c.Snow=new c(!1,255,255,250,250,!0);c.SpringGreen=new c(!1,255,0,255,127,!0);c.SteelBlue=new c(!1,255,70,130,180,!0);c.Tan=new c(!1,255,210,180,140,!0);c.Teal=new c(!1,255,0,128,128,!0);c.Thistle=new c(!1,255,216,191,216,!0);c.Tomato=new c(!1,255,255,99,71,!0);c.Transparent=new c(!1,0,255,255,255,!0);c.Turquoise=new c(!1,255,64,224,208,!0);c.Violet=new c(!1,255,238,130,238,!0);c.Wheat=new c(!1,255,245,222,179,!0);c.White=new c(!1,255,255,255,255,!0);c.WhiteSmoke=new c(!1,255,245,245,245,!0);c.Yellow=new c(!1,255,255,255,0,!0);c.YellowGreen=new c(!1,255,154,205,50,!0);c._predefinedColors=null;var hn=class hn{constructor(e,t){this._noAntiAlias=!1,this._color=e,typeof t!="undefined"&&(this._noAntiAlias=t)}get noAntiAlias(){return this._noAntiAlias}get color(){return this._color}};m(hn,"YBrush");var ts=hn,un=class un extends ts{};m(un,"YSolidBrush");var at=un,dn=class dn extends ts{constructor(e,t){super(e),this._color1=e,this._color2=t}get color1(){return this._color1}get color2(){return this._color2}};m(dn,"YLinearGradientBrush");var Bt=dn,is=class is{constructor(e,t,i){this._thickness=1,this._color=c.Black,this._noAntiAlias=!1,this._startCap=1,this._endCap=1,this._linejoin=is.LineJoin.Miter,this._thickness=t,this._color=t>0?e:c.Transparent,typeof i!="undefined"&&(this._noAntiAlias=i)}get noAntiAlias(){return this._noAntiAlias}get lineWidth(){return this._thickness}get strokeStyle(){return this._color.htmlCode}get color(){return this._color}set startCap(e){this._startCap=e}set endCap(e){this._endCap=e}set linejoin(e){this._linejoin=e}};m(is,"YPen");var Ce=is;(function(D){let e;(function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round",t[t.MiterClipped=3]="MiterClipped"})(e=D.LineJoin||(D.LineJoin={}))})(Ce||(Ce={}));var cn=class cn{constructor(e,t,i,r){this.x=e,this.y=t,this.w=i,this.h=r}};m(cn,"YRectangle");var le=cn,_n=class _n{constructor(e,t){this.X=e>>0,this.Y=t>>0}};m(_n,"Point");var ze=_n,gn=class gn{constructor(e,t,i,r){this.X1=e>>0,this.YMIN=t>>0,this.X2=i>>0,this.YMAX=r>>0}};m(gn,"minMaxPoint");var Ir=gn,fn=class fn{constructor(e,t){this.X=e,this.Y=t}};m(fn,"PointF");var me=fn,pn=class pn{constructor(){this.captureType=W.CaptureType.SVG,this.captureFolder="/",this.captureWidth=1024,this.captureHeight=1024,this.captureDPI=96}};m(pn,"captureParametersSet");var sl=pn,rs=class rs{get userData(){return this._userData}set userData(e){this._userData=e}get directParent(){return this._directParent}constructor(e,t){this._userData=null,this._enabled=!1,this._panelTextAlign=rs.TextAlign.LEFT,this._text="",this._bgColor=new c(!1,255,255,255,192),this._borderColor=c.Black,this._borderthickness=1,this._padding=10,this._verticalMargin=10,this._horizontalMargin=10,this._bgBrush=null,this._pen=null,this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,8,null)}get enabled(){return this._enabled}set enabled(e){this._enabled!=e&&(this._enabled=e,this._parentRenderer.clearCachedObjects(),this._parentRenderer.redraw())}get panelTextAlign(){return this._panelTextAlign}set panelTextAlign(e){this._panelTextAlign=e,this._enabled&&this._parentRenderer.redraw()}get text(){return this._text}set text(e){this._text=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e,this._bgBrush=null,this._enabled&&this._parentRenderer.redraw()}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._pen=null,this._enabled&&this._parentRenderer.redraw()}get borderthickness(){return this._borderthickness}set borderthickness(e){if(e<0)throw"Border thickness must be a positive value";this._borderthickness=e,this._parentRenderer.clearCachedObjects(),this._pen=null,this._enabled&&this._parentRenderer.redraw()}get padding(){return this._padding}set padding(e){if(e<0)throw new RangeError("Padding must be a positive value");this._padding=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get verticalMargin(){return this._verticalMargin}set verticalMargin(e){this._verticalMargin=e,this._enabled&&this._parentRenderer.redraw()}get horizontalMargin(){return this._horizontalMargin}set horizontalMargin(e){this._horizontalMargin=e,this._enabled&&this._parentRenderer.redraw()}get bgBrush(){return this._bgBrush==null&&(this._bgBrush=new at(this._bgColor)),this._bgBrush}get pen(){return this._pen==null&&(this._pen=new Ce(this._borderColor,this._borderthickness,!0)),this._pen}get font(){return this._font}};m(rs,"GenericPanel");var Se=rs;(function(D){let o=class o extends De{constructor(g,y,p){super(g,y,t)}};m(o,"HorizontalAlignPosEnumItem");let e=o;D.HorizontalAlignPosEnumItem=e;let a=class a extends Le{};m(a,"HorizontalAlignPos");let t=a;t.LEFT=new e("LEFT","Left"),t.CENTER=new e("CENTER","Center"),t.RIGHT=new e("RIGHT","Right"),D.HorizontalAlignPos=t;let l=class l extends De{constructor(g,y,p){super(g,y,r)}};m(l,"VerticalAlignPosEnumItem");let i=l;D.VerticalAlignPosEnumItem=i;let h=class h extends Le{};m(h,"VerticalAlignPos");let r=h;r.TOP=new i("TOP","Top"),r.CENTER=new i("CENTER","Center"),r.BOTTOM=new i("BOTTOM","Bottom"),D.VerticalAlignPos=r;let u=class u extends De{constructor(g,y,p){super(g,y,n)}};m(u,"TextAlignEnumItem");let s=u;D.TextAlignEnumItem=s;let _=class _ extends Le{};m(_,"TextAlign");let n=_;n.LEFT=new s("LEFT","Left"),n.CENTER=new s("CENTER","Center"),n.RIGHT=new s("RIGHT","Right"),D.TextAlign=n})(Se||(Se={}));var mn=class mn extends Se{constructor(e,t){super(e,t),this._panelHrzAlign=Se.HorizontalAlignPos.CENTER,this._panelVrtAlign=Se.VerticalAlignPos.CENTER}get panelHrzAlign(){return this._panelHrzAlign}set panelHrzAlign(e){this._panelHrzAlign=e,this._enabled&&this._parentRenderer.redraw()}get panelVrtAlign(){return this._panelVrtAlign}set panelVrtAlign(e){this._panelVrtAlign=e,this._enabled&&this._parentRenderer.redraw()}};m(mn,"MessagePanel");var Ve=mn,bn=class bn extends Se{constructor(e,t){super(e,t),this._overlap=!1,this._positionOffsetX=50,this._positionOffsetY=50,this._panelHrzAlign=Se.HorizontalAlignPos.CENTER,this._panelVrtAlign=Se.VerticalAlignPos.TOP}get overlap(){return this._overlap}set overlap(e){!e&&this._panelHrzAlign==Se.HorizontalAlignPos.CENTER&&this._panelVrtAlign==Se.VerticalAlignPos.CENTER&&(this._panelVrtAlign=Se.VerticalAlignPos.TOP),this._overlap=e,this._parentRenderer.clearCachedObjects(),this._parentRenderer.redraw()}get positionOffsetX(){return this._positionOffsetX}set positionOffsetX(e){this._positionOffsetX=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get positionOffsetY(){return this._positionOffsetY}set positionOffsetY(e){this._positionOffsetY=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get panelHrzAlign(){return this._panelHrzAlign}set panelHrzAlign(e){!this._overlap&&e==Se.HorizontalAlignPos.CENTER&&this._panelVrtAlign==Se.VerticalAlignPos.CENTER&&(this._panelVrtAlign=Se.VerticalAlignPos.TOP),this._panelHrzAlign=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get panelVrtAlign(){return this._panelVrtAlign}set panelVrtAlign(e){!this._overlap&&e==Se.VerticalAlignPos.CENTER&&this._panelHrzAlign==Se.HorizontalAlignPos.CENTER&&(this._panelHrzAlign=Se.HorizontalAlignPos.RIGHT),this._panelVrtAlign=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}};m(bn,"AnnotationPanel");var Js=bn,yn=class yn{get directParent(){return this._directParent}get userData(){return this._userData}set userData(e){this._userData=e}resetCache(){}constructor(e,t){this._userData=null,this._zoneBrush=null,this._color=c.Red,this._visible=!1,this._min=0,this._max=100,this._directParent=t,this._parentRenderer=e}get zoneBrush(){return this._zoneBrush==null&&(this._zoneBrush=new at(this._color)),this._zoneBrush}get color(){return this._color}set color(e){this._color=e,this._zoneBrush=null,this.visible&&this._parentRenderer.redraw()}get visible(){return this._visible}set visible(e){this._visible=e,this._parentRenderer.redraw()}set_minMax(e,t){if(e>t)throw new RangeError("Min cannot be greater than max ");this._min=e,this._max=t,this.resetCache(),this.visible&&this._parentRenderer.redraw()}get min(){return this._min}set min(e){if(e>=this._max&&!W.minMaxCheckDisabled)throw new RangeError("Min cannot be greater than max ("+this._max.toString()+")");this._min=e,this.resetCache(),this.visible&&this._parentRenderer.redraw()}get max(){return this._max}set max(e){if(e<=this._min&&!W.minMaxCheckDisabled)throw new RangeError("Max cannot be greater than min ("+this._min.toString()+")");this._max=e,this.resetCache(),this.visible&&this._parentRenderer.redraw()}};m(yn,"Zone");var nr=yn,Fi=class Fi{get userData(){return this._userData}set userData(e){this._userData=e}get directParent(){return this._directParent}get value(){return this._value}set value(e){this._value=e,this.set_refPoint(),this._reset!=null&&this._reset(this)}get resizeRule(){return this._resizeRule}set resizeRule(e){this.set_refPoint(),this._resizeRule=e}set_refPoint(){this._refWidth=Math.max(1,this._parentRenderer.usableUiWidth()),this._refHeight=Math.max(1,this._parentRenderer.usableUiHeight()),this._refValue=this._value}constructor(e,t,i,r,s){this._reset=null,this._refWidth=1,this._refHeight=1,this._refValue=1,this.valueStack=[],this._resizeRule=Fi.ResizeRule.FIXED,this._userData=null,this._reset=s,this._parentRenderer=i,this._value=e,this._resizeRule=t,this._directParent=r,this.set_refPoint(),this._parentRenderer.AddNewProportionalToSizeValue(this)}containerResizedPushNewCoef(e){this.valueStack.push(this._value),this._value=Math.round(100*this._refValue*e)/100,this._reset!=null&&this._reset(this)}containerResizedPop(){if(this.valueStack.length<=0)throw new RangeError("Can't pop, empty stack.");this._value=this.valueStack.pop(),this._reset!=null&&this._reset(this)}static resizeCoef(e,t,i,r,s){switch(e){case Fi.ResizeRule.RELATIVETOWIDTH:return r/t;case Fi.ResizeRule.RELATIVETOHEIGHT:return s/i;case Fi.ResizeRule.RELATIVETOBOTH:return Math.min(s/i,r/t)}return 1}containerResized(e,t){this._value=Math.round(100*this._refValue*Fi.resizeCoef(this._resizeRule,this._refWidth,this._refHeight,e,t))/100,this._reset!=null&&this._reset(this)}forceChangeCallback(){this._reset!=null&&this._reset(this)}};m(Fi,"Proportional");var Be=Fi;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"ResizeRuleEnumItem");let e=i;D.ResizeRuleEnumItem=e;let r=class r extends Le{};m(r,"ResizeRule");let t=r;t.FIXED=new e("FIXED","Fixed"),t.RELATIVETOWIDTH=new e("RELATIVETOWIDTH","Relative to Width"),t.RELATIVETOHEIGHT=new e("RELATIVETOHEIGHT","Relative to height"),t.RELATIVETOBOTH=new e("RELATIVETOBOTH","Relative to Width and Height"),D.ResizeRule=t})(Be||(Be={}));var At=class At{get annotationPanels(){return this._annotationPanels}get userData(){return this._userData}static get minMaxCheckDisabled(){return At._disableMinMaxCheck}static set minMaxCheckDisabled(e){At._disableMinMaxCheck=e}resetlegendPens(){}get getCaptureParameters(){return this._getCaptureParameters}set getCaptureParameters(e){this._getCaptureParameters=e}get messagePanels(){return this._messagePanels}static globalMouseMove(e){At.globalMouseX=e.pageX,At.globalMouseY=e.pageY}clearTransformationMatrix(){this._Scr2ElmMatrix=null,this._Elm2ScrMatrix=null}findElementAbsolutePosition(e){let t=!1,i=!1,r=0,s=0;for(;e!=null;){let n=window.getComputedStyle(e);!i&&n.position=="static"&&!t&&(r=e.offsetLeft+parseFloat(n.borderLeftWidth),s=e.offsetTop+parseFloat(n.borderTopWidth),t=!0),(n.position=="relative"||n.position=="absolute")&&(r+=e.offsetLeft+parseFloat(n.borderLeftWidth),s+=e.offsetTop+parseFloat(n.borderTopWidth),i=!0),e=e.parentElement}return new me(r,s)}get Elm2ScrMatrix(){if(this._Elm2ScrMatrix==null){let e=this.UIContainer,t=[];for(;e!=null;)t.push(this.findElementAbsolutePosition(e)),e=e.parentElement;e=this.UIContainer;let i=[],r=!1,s=!1,n=0;for(;e!=null;){let o=e.parentElement,a=window.getComputedStyle(e),l=t[n].X,h=t[n].Y;n<t.length-1&&(l-=t[n+1].X,h-=t[n+1].Y);let u=a.transform;if(u!="none"){let _=u.match(/matrix.*\((.+)\)/)[1].split(", "),d=[];for(let x=0;x<6;x++)d.push(parseFloat(_[x]));let g=null,y=Yt.newMatrix(d[0],d[2],d[4],d[1],d[3],d[5],0,0,1),p=null;if(a.transformOrigin){let x=a.transformOrigin.split(" "),w=Number.parseFloat(x[0]),f=Number.parseFloat(x[1]);g=Yt.newTranslateMatrix(-w,-f),p=Yt.newTranslateMatrix(w,f)}g!=null&&i.push(g),y!=null&&i.push(y),p!=null&&i.push(p)}(l!=0||h!=0)&&i.push(Yt.newTranslateMatrix(l,h)),e=o,n++}this._Elm2ScrMatrix=Yt.newIdentityMatrix();for(let o=i.length-1;o>=0;o--)this._Elm2ScrMatrix=this._Elm2ScrMatrix.multiplyByM(i[o])}return this._Elm2ScrMatrix}get Scr2ElmMatrix(){return this._Scr2ElmMatrix==null&&(this._Scr2ElmMatrix=this.Elm2ScrMatrix.inverse),this._Scr2ElmMatrix}addAnnotationPanel(){let e=new Js(this,this);return this._annotationPanels.push(e),this.redraw(),e}AllowRedraw(){if(this._redrawAllowed--,this._redrawAllowed<0)throw new RangeError("Too many AllowRedraw calls");this._redrawAllowed==0&&this.redraw()}AllowRedrawNoRefresh(){if(this._redrawAllowed--,this._redrawAllowed<0)throw new RangeError("Too many AllowRedraw calls")}DisableRedraw(){this._redrawAllowed++}AddNewProportionalToSizeValue(e){this.ProportionalToSizeValues.indexOf(e)<0&&this.ProportionalToSizeValues.push(e)}canRedraw(){return this._redrawAllowed==0}setPatchAnnotationCallback(e){this._PatchAnnotationCallback=e}patchAnnotation(e){if(e=e.replace("\\n",`
`),e.indexOf("$")<0)return e;let t=new Date;return e=e.replace("$DAY$",t.getDay().toString()),e=e.replace("$MONTH$",t.getMonth().toString()),e=e.replace("$YEAR$",t.getFullYear().toString()),e=e.replace("$HOUR$",t.getHours().toString()),e=e.replace("$MINUTE$",t.getMinutes().toString()),e=e.replace("$SECOND$",t.getSeconds().toString()),this._PatchAnnotationCallback!=null&&(e=this._PatchAnnotationCallback(e)),e}mouseLocalPosition(){let e=Ut.FromXYCoord(At.globalMouseX,At.globalMouseY),i=this.Scr2ElmMatrix.multiplyByV(e).toPoint();return i.X<0||i.Y<0||i.X>this.UIContainer.offsetWidth||i.Y>this.UIContainer.offsetHeight?null:i}set proportionnalValueChangeCallback(e){this._proportionnalValueChangeCallback=e}ProportionnalValueChanged(e){this._proportionnalValueChangeCallback!=null&&this._proportionnalValueChangeCallback(e)}getContainerInnerWidth(){return this.UIContainer.offsetWidth}getContainerInnerHeight(){return this.UIContainer.offsetHeight}Draw(e){if(!this.canRedraw())return 0;let t=this.getContainerInnerWidth(),i=this.getContainerInnerHeight();if(t<=5||i<=5)return 0;this.DisableRedraw();let r=document.createElement("canvas");r.width=t,r.height=i;let s=new Kt(r,t,i,90),n=performance.now();try{this.Render(s,t,i)}catch(h){debugger;this.log("Rendering error: "+h.message)}let o=performance.now()-n,a=this.UIContainer.getContext("2d");a.clearRect(0,0,t,i),a.drawImage(r,0,0),this.rendererTimingTotal+=o,this.rendererTimingCount++;let l=this.rendererTimingTotal/this.rendererTimingCount;return s.Dispose(),this.AllowRedrawNoRefresh(),this.renderingPostProcessing(),0}renderingPostProcessing(){}get resizeRule(){return this._resizeRule}set resizeRule(e){if(e!=this._resizeRule){this.DisableRedraw(),this._resizeRule=e;for(let t=0;t<this.ProportionalToSizeValues.length;t++)this.ProportionalToSizeValues[t].resizeRule=this._resizeRule;this.AllowRedraw(),this.redraw()}}redraw(){document.visibilityState==="visible"&&(this._redrawAllowed>0||this.getContainerInnerWidth()<2||this.getContainerInnerHeight()<2||(this.requestAnimationFrameID!=null&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.requestAnimationFrameID=window.requestAnimationFrame(e=>{try{this.Draw(e)}catch(t){throw console.log("caught"),this.requestAnimationFrameID=null,t}this.requestAnimationFrameID=null})))}usableUiWidth(){return this.getContainerInnerWidth()}usableUiHeight(){return this.getContainerInnerHeight()}resetProportionalSizeObjectsCachePush(e){if(this.clearCachedObjects(),this._resizeRule!=Be.ResizeRule.FIXED)for(let t=0;t<this.ProportionalToSizeValues.length;t++)this.ProportionalToSizeValues[t].containerResizedPushNewCoef(e)}resetProportionalSizeObjectsCachePop(){if(this.clearCachedObjects(),this._resizeRule!=Be.ResizeRule.FIXED)for(let e=0;e<this.ProportionalToSizeValues.length;e++)this.ProportionalToSizeValues[e].containerResizedPop()}resetProportionalSizeObjectsCache(e,t){if(this.clearCachedObjects(),this._resizeRule!=Be.ResizeRule.FIXED)for(let i=0;i<this.ProportionalToSizeValues.length;i++)this.ProportionalToSizeValues[i].containerResized(e,t)}containerResized(){this.containerResize(null,null)}containerResize(e,t){this.clearTransformationMatrix(),this.DisableRedraw(),this.UIContainer.width=this.UIContainer.offsetWidth,this.UIContainer.height=this.UIContainer.offsetHeight,this.resetProportionalSizeObjectsCache(this.usableUiWidth(),this.usableUiHeight()),this.AllowRedraw(),this.redraw()}proportionnalsizeReset(){this.resetProportionalSizeObjectsCache(this.usableUiWidth(),this.usableUiHeight())}captureAndDownloadImage(e,t,i,r,s){let n="",o,a,l=this.getContainerInnerWidth()/this.getContainerInnerHeight();if(s==null&&(s=90),(t==null||typeof t=="undefined")&&(t="capture.",e==At.CaptureType.PNG&&(t=t+"png"),e==At.CaptureType.SVG&&(t=t+"svg")),i==null||typeof i=="undefined"?(o=this.getContainerInnerWidth(),r==null||typeof r=="undefined"?a=this.getContainerInnerHeight():(a=r>>0,o=a*l>>0)):(o=i>>0,r==null||typeof r=="undefined"?a=o*l>>0:a=r>>0),o<=5||a<=5)return;this.DisableRedraw(),e==At.CaptureType.SVG&&(o=Math.round(o/1.371),a=Math.round(a/1.371));let h=document.createElement("canvas");h.width=o,h.height=a;let u;switch(e){case At.CaptureType.PNG:u=new Kt(h,o,a,s);break;case At.CaptureType.SVG:u=new ei(h,o,a,s);break;default:throw new RangeError("capture :unknown type")}let _=Be.resizeCoef(Be.ResizeRule.RELATIVETOBOTH,this.refWidth,this.refHeight,o,a);this.log("start capture"),this.resetProportionalSizeObjectsCachePush(_);let d=!1;this._snapshotPanel.enabled=!1;try{let g=this.Render(u,o,a);d=!0}catch(g){n=g.message,this.log("Render error: "+n)}if(this.log("capture completed"),this.resetProportionalSizeObjectsCachePop(),d){let g=document.createElement("a"),y=u.get_downloadableData();g.setAttribute("href",y),g.setAttribute("download",t),g.style.display="none",document.body.appendChild(g),g.click(),document.body.removeChild(g)}u.Dispose(),this.AllowRedraw()}getFocus(e,t){this.log("got focus")}gainFocus(){}lostFocus(e,t){}get AllowPrintScreenCapture(){return this._AllowPrintScreenCapture}set AllowPrintScreenCapture(e){this._AllowPrintScreenCapture=e}constructor(e,t){this._redrawAllowed=1,this._refWidth=1,this._refHeight=1,this.rendererTimingTotal=0,this.rendererTimingCount=0,this._PatchAnnotationCallback=null,this._logFunction=null,this._annotationPanels=[],this._userData=null,this.documentVisibiltyChangeFct=null,this.containerResizedFct=null,this._getCaptureParameters=null,this.OnDblClick=null,this.OnRightClick=null,this._messagePanels=[],this._Scr2ElmMatrix=null,this._Elm2ScrMatrix=null,this.ProportionalToSizeValues=[],this._proportionnalValueChangeCallback=null,this._resizeRule=Be.ResizeRule.FIXED,this.requestAnimationFrameID=null,this._snapshotPanel=null,this._snapshotTimer=null,this._AllowPrintScreenCapture=!1,At.globalMouseMoveSet||(document.addEventListener("mousemove",i=>{At.globalMouseMove(i)}),At.globalMouseMoveSet=!0),this.UIContainer=e,this.UIContainer.width=this.getContainerInnerWidth(),this.UIContainer.height=this.getContainerInnerHeight(),this._logFunction=t,this.parentForm=e.ownerDocument,this._annotationPanels=[],this._messagePanels=[],this.DisableRedraw(),this._snapshotPanel=this.addMessagePanel(),this._snapshotPanel.panelTextAlign=Ve.TextAlign.CENTER,this._snapshotPanel.text="Captured to clipboard",this._snapshotPanel.panelHrzAlign=Ve.HorizontalAlignPos.CENTER,this._snapshotPanel.panelVrtAlign=Ve.VerticalAlignPos.CENTER,this._snapshotPanel.bgColor=new c(!1,200,204,247,161),this._snapshotPanel.font.size=16,this.AllowRedrawNoRefresh(),this.containerResizedFct=()=>{this.containerResize(null,null)},document.addEventListener("resize",this.containerResizedFct),this.resetRefrenceSize(),this.documentVisibiltyChangeFct=()=>{document.visibilityState==="visible"&&this.redraw()},document.addEventListener("visibilitychange",this.documentVisibiltyChangeFct)}destroy(){document.removeEventListener("visibilitychange",this.documentVisibiltyChangeFct),document.removeEventListener("resize",this.containerResized),this.UIContainer.parentNode.removeChild(this.UIContainer),this.UIContainer=null,this.parentForm=null,this._annotationPanels=null,this._messagePanels=null,this._Scr2ElmMatrix=null,this._Elm2ScrMatrix=null}resetRefrenceSize(){this._refWidth=this.getContainerInnerWidth(),this._refHeight=this.getContainerInnerHeight()}get refWidth(){return this._refWidth}get refHeight(){return this._refHeight}RendererCanvas_Click(e,t){}RendererCanvas_DoubleClick(e,t){}addMessagePanel(){let e=new Ve(this,this);return this._messagePanels.push(e),e}DrawMessagePanels(e,t,i){for(let r=0;r<this._messagePanels.length;r++)if(this._messagePanels[r].enabled){let s=this._messagePanels[r],n=t-2*s.padding-s.borderthickness;n<100&&(n=100);let o=null,a=!1;for(;!a;)o=e.MeasureString(s.text,s.font,n),(o.width>=this.UIContainer.width||o.height>=this.UIContainer.height)&&s.font.size>5?s.font.size=Math.round(s.font.size*9)/10:a=!0;if(o==null)return;let l=o.width+2*s.padding+s.borderthickness,h=o.height+2*s.padding+s.borderthickness,u=0;switch(s.panelHrzAlign){case Ve.HorizontalAlignPos.LEFT:u=s.horizontalMargin;break;case Ve.HorizontalAlignPos.RIGHT:u=t-l-s.horizontalMargin;break;default:u=(t-l)/2;break}let _=0;switch(s.panelVrtAlign){case Ve.VerticalAlignPos.TOP:_=s.verticalMargin;break;case Ve.VerticalAlignPos.BOTTOM:_=i-h-s.verticalMargin;break;default:_=(i-h)/2;break}e.FillRectangleXYHW(s.bgBrush,u,_,l,h),s.borderthickness>0&&e.DrawRectangleXYHW(s.pen,u,_,l,h);let d=new qe(16384);switch(s.panelTextAlign){case Ve.TextAlign.LEFT:d.LineAlignment=0,d.Alignment=0;break;case Ve.TextAlign.RIGHT:d.LineAlignment=2,d.Alignment=2;break;default:d.LineAlignment=1,d.Alignment=1;break}let g=new le(u+s.padding+s.borderthickness/2>>0,_+s.padding+s.borderthickness/2>>0,o.width+1,o.height+1);e.DrawStringRect(s.text,s.font,s.font.brush,g,d)}}drawAnnotationPanels(e,t,i,r,s,n){let o=!1;for(let a=0;a<this.annotationPanels.length;a++)this.annotationPanels[a].enabled&&(o=!0);if(o){for(let a=0;a<this.annotationPanels.length;a++)if(t[a].enabled&&t[a].overlap==s){let l=t[a],h=i-2*l.padding-l.borderthickness;h<100&&(h=100);let u=l.text.replace("\\n",`
`);u.indexOf("$")>=0&&(u=u.replace("\\n",`
`),u=this.patchAnnotation(u));let _=e.MeasureString(u,l.font,h),d=_.width+2*l.padding+l.borderthickness,g=_.height+2*l.padding+l.borderthickness,y=0;switch(l.panelHrzAlign){case Ve.HorizontalAlignPos.LEFT:y=l.horizontalMargin,!t[a].overlap&&n.Lmargin<d+10&&(n.Lmargin=d+10);break;case Ve.HorizontalAlignPos.RIGHT:y=i-d-l.horizontalMargin,!t[a].overlap&&n.Rmargin<d+20&&(n.Rmargin=d+20);break;default:y=(i-d)/2;break}let p=0;switch(l.panelVrtAlign){case Ve.VerticalAlignPos.TOP:p=l.verticalMargin,!t[a].overlap&&n.Tmargin<g+20&&(n.Tmargin=g+20);break;case Ve.VerticalAlignPos.BOTTOM:p=r-g-l.verticalMargin,!t[a].overlap&&n.Bmargin<g+20&&(n.Bmargin=g+20);break;default:p=(r-g)/2;break}t[a].overlap&&(y+=t[a].positionOffsetX/100*(i-d),p+=t[a].positionOffsetY/100*(r-g),y<0&&(y=0),p<0&&(p=0),y>i-d&&(y=i-d),p>r-g&&(p=r-g)),e.FillRectangleXYHW(l.bgBrush,y,p,d,g),l.borderthickness>0&&e.DrawRectangleXYHW(l.pen,y,p,d,g);let x=new qe(16384);switch(l.panelTextAlign){case Ve.TextAlign.LEFT:x.LineAlignment=0,x.Alignment=0;break;case Ve.TextAlign.RIGHT:x.LineAlignment=2,x.Alignment=2;break;default:x.LineAlignment=1,x.Alignment=1;break}let w=new le(y+l.padding+l.borderthickness/2,p+l.padding+l.borderthickness/2,_.width+1,_.height+1);e.DrawStringRect(u,l.font,l.font.brush,w,x)}}}log(e){this._logFunction!=null&&this._logFunction(e)}};m(At,"YDataRenderer");var W=At;W.RendererDebug=!1;W.FloatToStrformats=["0","0","0","0.0","0.00","0.000","0.0000"];W._disableMinMaxCheck=!1;W.globalMouseMoveSet=!1;W.globalMouseX=-1;W.globalMouseY=-1;(function(D){let o=class o extends De{constructor(g,y,p){super(g,y,t)}};m(o,"CaptureTypeEnumItem");let e=o;D.CaptureTypeEnumItem=e;let a=class a extends Le{};m(a,"CaptureType");let t=a;t.PNG=new e("PNG","Bitmap (PNG)"),t.SVG=new e("SVG","Vector (SVG)"),D.CaptureType=t;let l=class l extends De{constructor(g,y,p){super(g,y,r)}};m(l,"CaptureTargetEnumItem");let i=l;D.CaptureTargetEnumItem=i;let h=class h extends Le{};m(h,"CaptureTarget");let r=h;r.ToClipBoard=new i("ToClipBoard","ClipBoard"),r.ToFile=new i("ToFile","File"),D.CaptureTarget=r;let u=class u extends De{constructor(g,y,p){super(g,y,n)}};m(u,"CaptureFormatsEnumItem");let s=u;D.CaptureFormatsEnumItem=s;let _=class _ extends Le{};m(_,"CaptureFormats");let n=_;n.Keep=new s("Keep","Keep original size"),n.Fixed=new s("Fixed","Fixed size"),n.FixedWidth=new s("FixedWidth","Fixed width, keep ration aspect"),n.FixedHeight=new s("FixedHeight","Fixed height, keep ration aspect"),D.CaptureFormats=n})(W||(W={}));var sr=class sr{constructor(e,t,i,r){this._c=null,this._g=null,this._width=0,this._height=0,this._dpi=0,this._image=null,this._lastPen=null,this._lastBrush=null,this._lastFont=null,this._clipCounter=0,this._textRenderingHint=null,this._smoothingMode=Ze.Default,this._c=e,this._g=this._c.getContext("2d"),this._g.textBaseline="top",this._width=t,this._height=i,this._dpi=r}get_downloadableData(){return this._c.toDataURL("image/png")}get graphics(){return this._g}setPen(e){if(e!=this._lastPen){if(e!=null){this._g.lineWidth=e.lineWidth;let t=e.strokeStyle;this._g.strokeStyle=e.strokeStyle}else this._g.lineWidth=0;this._lastPen=e}}setBrush(e){if(e!=this._lastBrush){if(e instanceof at)this._g.fillStyle=e.color.htmlCode;else if(e instanceof Bt){let t=this._g.createLinearGradient(0,0,0,this._height);t.addColorStop(0,e.color1.htmlCode),t.addColorStop(1,e.color2.htmlCode),this._g.fillStyle=t}else throw new Error("invalid / insupported brush type");this._lastBrush=e}}setFont(e){e==this._lastFont&&!e.hasChanged||(this._g.font=e.htmlCode,this._lastFont=e)}DrawLineXY(e,t,i,r,s){if(e.noAntiAlias){let n=e.lineWidth==e.lineWidth>>0&&(e.lineWidth&1)==1?.5:0;t=Math.round(t)+n,i=Math.round(i)+n,r=Math.round(r)+n,s=Math.round(s)+n}this.setPen(e),this._g.beginPath(),this._g.moveTo(t,i),this._g.lineTo(r,s),this._g.stroke()}DrawLine(e,t,i){this.setPen(e),this._g.beginPath(),this._g.moveTo(t.X,t.Y),this._g.lineTo(i.X,i.Y),this._g.stroke()}SetClip(e){this._g.save(),this._g.beginPath(),this._g.rect(e.x,e.y,e.w,e.h),this._g.clip(),this._clipCounter++}ResetClip(){if(this._clipCounter<=0)throw new Error("clipping stack error");this._g.restore(),this._clipCounter--}MeasureString(e,t,i){this.setFont(t);let r=new Ki(t,e),s=r.linesCount;if(s==0)return r;r.height=r.firstLineHeight*1.2+(s-1)*r.lineHeight;let n=0,o;for(let a=0;a<s;a++)o=this._g.measureText(r.lines[a]),n=Math.max(n,o.width);return r.width=n,r}MeasureStringSF(e,t,i,r){return this.MeasureString(e,t,i)}FillRectangle(e,t){this.setBrush(e),this._g.beginPath(),this._g.fillRect(t.x,t.y,t.w,t.h),this._g.fill()}FillRectangleXYHW(e,t,i,r,s){this.setBrush(e),this._g.beginPath(),this._g.fillRect(t,i,r,s),this._g.fill()}DrawRectangle(e,t){if(this.setPen(e),this._g.beginPath(),e.noAntiAlias){let i=e.lineWidth==e.lineWidth>>0&&(e.lineWidth&1)==1?.5:0;this._g.rect(Math.round(t.x)+i,Math.round(t.y)+i,Math.round(t.w),Math.round(t.h))}else this._g.rect(t.x,t.y,t.w,t.h);this._g.stroke()}DrawRectangleXYHW(e,t,i,r,s){if(e.noAntiAlias){let n=e.lineWidth==e.lineWidth>>0&&(e.lineWidth&1)==1?.5:0;t=Math.round(t)+n,i=Math.round(i)+n,r=Math.round(r),s=Math.round(s)}this.setPen(e),this._g.beginPath(),this._g.rect(t,i,r,s),this._g.stroke()}DrawStringXY(e,t,i,r,s){this.setPen(null),this.setBrush(i),this.setFont(t);let n=this.MeasureString(e,t,0),o=n.lineHeight;for(let a=0;a<n.linesCount;a++)this._g.fillText(n.lines[a],r,s),s+=o}DrawStringXYF(e,t,i,r,s,n){if(sr._debugDrawString){let a=new Ce(c.Red,1);this.DrawLineXY(a,r-5,s,r+5,s),this.DrawLineXY(a,r,s-5,r,s+5)}let o=this.MeasureString(e,t,1e4);n.Alignment==1?r-=o.width>>1:n.Alignment==2&&(r-=o.width),n.LineAlignment==1?s-=o.height/2>>0:n.LineAlignment==2&&(s-=o.height),this.DrawStringXY(e,t,i,r,s)}DrawStringPF(e,t,i,r,s){this.DrawStringXYF(e,t,i,r.X,r.Y,s)}DrawString(e,t,i,r){if(sr._debugDrawString){let s=new Ce(c.Red,1);this.DrawLineXY(s,r.X-5,r.Y,r.X+5,r.Y),this.DrawLineXY(s,r.X,r.Y-5,r.X,r.Y+5)}this.setPen(null),this.setBrush(i),this.setFont(t),this._g.fillText(e,r.X,r.Y)}DrawStringRect(e,t,i,r,s){if(sr._debugDrawString){let h=new Ce(c.Red,1);this.DrawRectangle(h,r)}this.setPen(null),this.setBrush(i),this.setFont(t);let n=this.MeasureString(e,t,0),o=n.lineHeight,a=r.y;switch(s.LineAlignment){case 0:break;case 1:a+=(r.h-n.height)/2;break;case 2:a+=r.h-n.height;break}let l=r.x;s.FormatFlags&2&&(this.Transform(r.x,r.y,Math.PI/2),a-=r.y+r.w,l-=r.x);for(let h=0;h<n.linesCount;h++){let u=n.lines[h],_=this.MeasureString(u,t,0),d=l;switch(s.Alignment){case 0:break;case 1:d+=(r.w-_.width)/2;break;case 2:d+=r.w-_.width;break}this._g.fillText(u,d,a),a+=o}s.FormatFlags&2&&this.ResetTransform()}Transform(e,t,i){let r=Math.sin(i),s=Math.cos(i);this._g.save(),this._g.transform(s,r,-r,s,e,t)}ResetTransform(){this._g.restore()}FillEllipse(e,t,i,r,s){this.setBrush(e),this._g.beginPath(),this._g.ellipse(t+r/2,i+s/2,r/2,s/2,0,0,2*Math.PI),this._g.fill()}DrawEllipse(e,t,i,r,s){this.setPen(e),this._g.beginPath(),this._g.ellipse(t+r/2,i+s/2,r/2,s/2,0,0,2*Math.PI),this._g.stroke()}FillPolygon(e,t){if(this.setBrush(e),!(t.length<=2)){if(this._g.beginPath(),e.noAntiAlias){this._g.moveTo(Math.round(t[0].X)+.5,Math.round(t[0].Y)+.5);for(let i=1;i<t.length;i++)this._g.lineTo(Math.round(t[i].X)+.5,Math.round(t[i].Y)+.5)}else{this._g.moveTo(t[0].X,t[0].Y);for(let i=1;i<t.length;i++)this._g.lineTo(t[i].X,t[i].Y)}this._g.closePath(),this._g.fill()}}DrawPolygon(e,t){if(this.setPen(e),!(t.length<=1)){if(this._g.beginPath(),e.noAntiAlias){let i=e.lineWidth==e.lineWidth>>0&&(e.lineWidth&1)==1?.5:0;this._g.moveTo(Math.round(t[0].X)+i,Math.round(t[0].Y)+i);for(let r=1;r<t.length;r++)this._g.lineTo(Math.round(t[r].X)+i,Math.round(t[r].Y)+i)}else{this._g.moveTo(t[0].X,t[0].Y);for(let i=1;i<t.length;i++)this._g.lineTo(t[i].X,t[i].Y)}this._g.closePath(),this._g.stroke()}}DrawLines(e,t){if(this.setPen(e),!(t.length<=1)){this._g.beginPath(),this._g.lineCap="round",this._g.lineJoin="round",this._g.moveTo(t[0].X,t[0].Y);for(let i=1;i<t.length;i++)this._g.lineTo(t[i].X,t[i].Y);this._g.stroke()}}Dispose(){this._c=null,this._g=null,this._width=0,this._height=0,this._dpi=0}get TextRenderingHint(){return this._textRenderingHint}set TextRenderingHint(e){this._textRenderingHint=e}get SmoothingMode(){return this._smoothingMode}set SmoothingMode(e){this._smoothingMode=e}DrawImage(e,t,i,r){this._g.drawImage(e,i.x,i.y,i.w,i.h,t.x,t.y,t.w,t.h)}comment(e){}};m(sr,"YGraphics");var Kt=sr;Kt._debugDrawString=!1;var Ot=class Ot extends Kt{constructor(e,t,i,r){super(e,t,i,r),this._clipcount=0,this._clipSectionsToClose=0,this._transformSectionsToClose=0,this._gradientCount=0,Ot.SVGID++,this._SVGdefs=new es,this._SVGcontents=new es,this._SVGdefs.AppendLine('<clipPath id="pageClip_'+Ot.SVGID.toString()+'"><rect x="0" y="0"  width="'+t.toString()+'" height="'+i.toString()+'"/></clipPath>')}static escapeXml(e){return e.replace(/[^ !#$%(-;=?-z]/g,t=>"&#"+t.charCodeAt(0)+";")}get_downloadableData(){return"data:image/svg+xml;base64,"+btoa(this.get_svgContents())}DrawLineXY(e,t,i,r,s){this._SVGcontents.AppendLine('<line x1="'+t.toString()+'"  y1 ="'+i.toString()+'"  x2 ="'+r.toString()+'"  y2 ="'+s.toString()+'" style = "stroke:'+e.color.svgCode+";stroke-opacity:"+e.color.alphaCode+"; stroke-width:"+e.lineWidth.toString()+'"/>')}DrawLine(e,t,i){this.DrawLineXY(e,t.X,t.Y,i.X,i.Y)}SetClip(e){this.ResetClip(),this._SVGdefs.AppendLine('<clipPath id="clip_'+Ot.SVGID.toString()+"_"+this._clipcount.toString()+'"><rect x="'+e.x.toString()+'" y="'+e.y.toString()+'"  width="'+e.w.toString()+'" height="'+e.h.toString()+'"/></clipPath>'),this._SVGcontents.AppendLine('<g clip-path="url(#clip_'+Ot.SVGID.toString()+"_"+this._clipcount.toString()+')">'),this._clipcount++,this._clipSectionsToClose++}ResetClip(){this._clipSectionsToClose>0&&(this._SVGcontents.AppendLine("</g>"),this._clipSectionsToClose--)}BrushToSVG(e,t){let i="";if(e instanceof at)i='fill = "'+e.color.svgCode+'" fill-opacity="'+e.color.alphaCode+'" ';else if(e instanceof Bt)this._SVGdefs.AppendLine('<linearGradient id="grad_'+Ot.SVGID.toString()+"_"+this._gradientCount+'" x1="0%" '+(t?'y1="100%" ':'y1="0%" ')+'x2="0%" '+(t?'y2="0%" ':'y2="100%" ')+`>\r
<stop offset="0%" style ="stop-color:`+e.color1.svgCode+";stop-opacity:"+e.color1.alphaCode+`"/>\r
<stop offset="100%" style ="stop-color:`+e.color2.svgCode+";stop-opacity:"+e.color2.alphaCode+`"/>\r
</linearGradient>`),i='fill="url(#grad_'+Ot.SVGID.toString()+"_"+this._gradientCount+')" ',this._gradientCount++;else throw new ReferenceError("unsupported brush type.");return i}FillRectangle(e,t){this._SVGcontents.AppendLine('<rect x="'+t.x.toString()+'"  y ="'+t.y.toString()+'"  width ="'+t.w.toString()+'"  height ="'+t.h.toString()+'" '+this.BrushToSVG(e,!0)+'style="stroke-width:0"/>')}FillRectangleXYHW(e,t,i,r,s){this.FillRectangle(e,new le(t,i,r,s))}DrawRectangle(e,t){this._SVGcontents.AppendLine('<rect x="'+t.x.toString()+'"  y ="'+t.y.toString()+'"  width ="'+t.w.toString()+'"  height ="'+t.h.toString()+'"  fill="none" style = "stroke:'+e.color.svgCode+";stroke-opacity:"+e.color.alphaCode+"; stroke-width:"+e.lineWidth.toString()+'"/>')}DrawRectangleXYHW(e,t,i,r,s){this.DrawRectangle(e,new le(t,i,r,s))}DrawEllipse(e,t,i,r,s){this._SVGcontents.AppendLine('<ellipse  cx="'+(t+r/2).toString()+'"  cy ="'+(i+s/2).toString()+'"  rx ="'+(r/2).toString()+'"  ry ="'+(s/2).toString()+'"  fill="none" style = "stroke:'+e.color.svgCode+";stroke-opacity:"+e.color.alphaCode+"; stroke-width:"+e.lineWidth.toString()+'"/>')}FillEllipse(e,t,i,r,s){this._SVGcontents.AppendLine('<ellipse  cx="'+(t+r/2).toString()+'"  cy ="'+(i+s/2).toString()+'"  rx ="'+(r/2).toString()+'"  ry ="'+(s/2).toString()+'" '+this.BrushToSVG(e,!1)+'style="stroke-width:0"/>')}DrawStringXY(e,t,i,r,s){let n=e.split(`
`);for(let o=0;o<n.length;o++)e=n[o],this._SVGcontents.AppendLine('<text x="'+r.toString()+'" y="'+(s+t.sizeInPoints).toString()+'" text-anchor="start" font-family="'+t.name.toString()+'" font-size="'+t.sizeInPoints.toString()+'pt" font-weight="'+(t.bold?"bold":"normal")+'" font-style="'+(t.italic?"italic":"normal")+'" '+this.BrushToSVG(i,!1)+`style="stroke-width:0">\r
`+Ot.escapeXml(e)+`\r
</text>`),s+=t.sizeInPoints*1.75}DrawString(e,t,i,r){if(Kt._debugDrawString){let s=new Ce(c.Red,1);this.DrawLineXY(s,r.X-5,r.Y,r.X+5,r.Y),this.DrawLineXY(s,r.X,r.Y-5,r.X,r.Y+5)}this.DrawStringXY(e,t,i,r.X,r.Y)}DrawStringF(e,t,i,r,s){let n=this.MeasureString(e,t,0),o=r.Y+t.size*1.25;switch(s.LineAlignment){case 0:break;case 1:o+=-n.height/2;break;case 2:o+=-n.height;break}let a=e.split(`
`);for(let l=0;l<a.length;l++){let h=a[l],u=this.MeasureString(h,t,0),_=r.X;switch(s.Alignment){case 0:break;case 1:_+=-u.width/2;break;case 2:_+=-u.width;break}this._SVGcontents.AppendLine('<text x="'+_.toString()+'" y="'+o.toString()+'" text-anchor="start" font-family="'+t.name.toString()+'" font-size="'+t.sizeInPoints.toString()+'pt" font-weight="'+(t.bold?"bold":"normal")+'" font-style="'+(t.italic?"italic":"normal")+'" '+this.BrushToSVG(i,!1)+`style="stroke-width:0">\r
`+Ot.escapeXml(h)+`\r
</text>`),o+=t.sizeInPoints*1.75}}DrawStringRect(e,t,i,r,s){if(Kt._debugDrawString){let l=new Ce(c.Red,1);this.DrawRectangle(l,r)}let n=this.MeasureString(e,t,0),o=r.y+t.sizeInPoints*1.1;switch(s.LineAlignment){case 0:break;case 1:o+=(r.h-n.height)/2;break;case 2:o+=r.h-n.height;break}let a=e.split(`
`);for(let l=0;l<a.length;l++){let h=a[l],u=this.MeasureString(h,t,0),_=r.x;switch(s.Alignment){case 0:break;case 1:_+=(r.w-u.width)/2;break;case 2:_+=r.w-u.width;break}this._SVGcontents.AppendLine('<text x="'+_.toString()+'" y="'+o.toString()+'" text-anchor="start" font-family="'+t.name.toString()+'" font-size="'+(t.sizeInPoints*1.1).toString()+'pt" font-weight="'+(t.bold?"bold":"normal")+'" font-style="'+(t.italic?"italic":"normal")+'" '+this.BrushToSVG(i,!1)+`style="stroke-width:0">\r
`+Ot.escapeXml(h)+`\r
</text>`),o+=t.sizeInPoints*1.75}}Transform(e,t,i){this._SVGcontents.AppendLine('<g transform="translate('+e.toString()+" "+t.toString()+") rotate("+(180*i/Math.PI).toString()+')">'),this._transformSectionsToClose++}ResetTransform(){this._transformSectionsToClose>0&&(this._SVGcontents.AppendLine("</g>"),this._transformSectionsToClose--)}DrawPolygon(e,t){if(!(t.length<2)){this._SVGcontents.Append('<path  d="M '+t[0].X.toString()+" "+t[0].Y.toString());for(let i=1;i<t.length;i+=1)this._SVGcontents.Append(" L "+t[i].X.toString()+" "+t[i].Y.toString());this._SVGcontents.AppendLine(' z" fill="none" style="stroke:'+e.color.svgCode+";stroke-opacity:"+e.color.alphaCode+"; stroke-width:"+e.lineWidth.toString()+'"/>')}}DrawLines(e,t){if(!(t.length<2)){this._SVGcontents.Append('<path  d="M '+t[0].X.toString()+" "+t[0].Y.toString());for(let i=1;i<t.length;i++)this._SVGcontents.Append(" L "+t[i].X.toString()+" "+t[i].Y.toString());this._SVGcontents.AppendLine('" fill="none" style="stroke:'+e.color.svgCode+";stroke-opacity:"+e.color.alphaCode+"; stroke-linecap:round; stroke-linejoin:round;stroke-width:"+e.lineWidth.toString()+'"/>')}}FillPolygon(e,t){if(!(t.length<2)){this._SVGcontents.Append('<path  d="M '+t[0].X.toString()+" "+t[0].Y.toString());for(let i=1;i<t.length;i++)this._SVGcontents.Append(" L "+t[i].X.toString()+" "+t[i].Y.toString());this._SVGcontents.AppendLine(' z" '+this.BrushToSVG(e,!1)+`style="stroke-width:0"/>\r
`)}}DrawImage(e,t,i,r){throw new Error("DrawImage not supported, find an other way.")}save(e){throw new Error("Direct save to file not supported.")}comment(e){this._SVGcontents.AppendLine("<!--"+e+"-->")}get_svgContents(){let e=(2.54*(this._width/this._dpi)).toFixed(3),t=(2.54*(this._height/this._dpi)).toFixed(3);for(;this._clipSectionsToClose>0;)this._SVGcontents.AppendLine("</g>"),this._clipSectionsToClose--;for(;this._transformSectionsToClose>0;)this._SVGcontents.AppendLine("</g>"),this._transformSectionsToClose--;return`<?xml version = "1.0" standalone = "no" ?>\r
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\r
<svg width = "`+e+'cm" height = "'+t+'cm" viewBox = "0 0 '+this._width.toString()+" "+this._height.toString()+`" xmlns = "http://www.w3.org/2000/svg" version = "1.1" >\r
<defs>\r
`+this._SVGdefs.contents+`</defs>\r
<g clip-path="url(#pageClip_`+Ot.SVGID.toString()+`)">\r
`+this._SVGcontents.contents+`</g>\r
</svg>
`}};m(Ot,"YGraphicsSVG");var ei=Ot;ei.SVGID=0;var Sn=class Sn extends nr{get path(){return this._path}setPathSize(e){this._path=new Array(e).fill(null)}setPathPoint(e,t){this._path[e]=t}resetPath(){this._path=null}resetCache(){this.resetPath()}get width(){return this._width}set width(e){if(e<=0)throw new RangeError("Width must be a positive value");this._width=e,this._path=null,this._parentRenderer.redraw()}get outerRadius(){return this._outerRadius}set outerRadius(e){this._outerRadius=Math.max(0,Math.min(100,e)),this._path=null,this._parentRenderer.redraw()}constructor(e,t){super(e,t),this._path=null,this._width=10,this._outerRadius=98}};m(Sn,"YAngularZone");var An=Sn,Cn=class Cn extends W{get min(){return this._min}set min(e){if(e>=this._max&&!W.minMaxCheckDisabled)throw new RangeError("Min cannot be greater than max ("+this._max.toString()+")");this._min=e;for(let t=0;t<this._zones.length;t++)this._zones[t].resetPath();this._needleValue<this._min&&(this._needleValue=this._min),this.redraw()}get max(){return this._max}set max(e){if(e<=this._min&&!W.minMaxCheckDisabled)throw new RangeError("Max cannot be less than min ("+this._min.toString()+")");this._max=e;for(let t=0;t<this._zones.length;t++)this._zones[t].resetPath();this._needleValue>this._max&&(this._needleValue=this._max),this.redraw()}get borderpen(){return this._borderpen==null&&(this._borderpen=new Ce(this._borderColor,this._borderThickness),this._borderpen.startCap=1,this._borderpen.endCap=1),this._borderpen}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._borderpen=null,this.redraw()}get backgroundColor1(){return this._backgroundColor1}set backgroundColor1(e){this._backgroundColor1=e,this._bgBrush=null,this.redraw()}get backgroundColor2(){return this._backgroundColor2}set backgroundColor2(e){this._backgroundColor2=e,this._bgBrush=null,this.redraw()}get borderThickness(){return this._borderThickness}set borderThickness(e){if(e<0)throw new RangeError("thickness must be a positive value");this._borderThickness=e,this._borderpen=null,this.redraw()}get valueFormater(){return this._valueFormater}set valueFormater(e){this._valueFormater=e,this.redraw()}get minmaxFormater(){return this._minmaxFormater}set minmaxFormater(e){this._minmaxFormater=e,this.redraw()}get thickness(){return this._thickness}set thickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._thickness=Math.max(Math.min(e,80),1),this.redraw()}get value(){return this._value}set value(e){this._value=e,this.redraw()}get color1(){return this._color1}set color1(e){this._color1=e,this.redraw()}get color2(){return this._color2}set color2(e){this._color2=e,this.redraw()}get graduationColor(){return this._graduationColor}set graduationColor(e){this._graduationColor=e,this._graduationPen=null,this.redraw()}get graduationThickness(){return this._graduationThickness}set graduationThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._graduationThickness=e,this._graduationPen=null,this.redraw()}get graduationSize(){return this._graduationSize}set graduationSize(e){if(e<=0)throw new RangeError("Graduation size must be a positive value");this._graduationSize=e,this.redraw()}get graduation(){return this._graduation}set graduation(e){this._graduation=e,this.redraw()}get unitFactor(){return this._unitFactor}set unitFactor(e){if(e==0)throw new RangeError("Factor cannot be zero.");this._unitFactor=e,this.redraw()}get unit(){return this._unit}set unit(e){this._unit=e,this.redraw()}get unitFont(){return this._unitFont}get subgraduationColor(){return this._subgraduationColor}set subgraduationColor(e){this._subgraduationColor=e,this._subgraduationPen=null,this.redraw()}get subgraduationThickness(){return this._subgraduationThickness}set subgraduationThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._subgraduationThickness=e,this._subgraduationPen=null,this.redraw()}get subgraduationSize(){return this._subgraduationSize}set subgraduationSize(e){if(e<=0)throw new RangeError("Size must be a positive value");this._subgraduationSize=e,this.redraw()}get graduationOuterRadiusSize(){return this._graduationOuterRadiusSize}set graduationOuterRadiusSize(e){this._graduationOuterRadiusSize=Math.max(0,Math.min(100,e)),this.redraw()}get subgraduationCount(){return this._subgraduationCount}set subgraduationCount(e){if(e<0)throw new RangeError("Count must be a positive value");this._subgraduationCount=e,this.redraw()}get statusColor(){return this._statusColor}set statusColor(e){this._statusColor=e,this.redraw()}get statusFont(){return this._unitFont}get statusLine(){return this._statusLine}set statusLine(e){this._statusLine=e,this.redraw()}get showNeedle(){return this._showNeedle}set showNeedle(e){this._showNeedle=e,this.redraw()}get needleColor(){return this._needleColor}set needleColor(e){this._needleColor=e,this._needleBrush=null,this.redraw()}get needleMaxSpeed(){return this._needleMaxSpeed}set needleMaxSpeed(e){if(e<=0)throw new RangeError("Speed must be a positive value");this._needleMaxSpeed=e,this.redraw()}get needleLength1(){return this._needleLength1}set needleLength1(e){this._needleLength1=e,this.redraw()}get needleLength2(){return this._needleLength2}set needleLength2(e){this._needleLength2=e,this.redraw()}get needleWidth(){return this._needleWidth}set needleWidth(e){if(e<=0)throw new RangeError("Width must be a positive value");this._needleWidth=e,this.redraw()}get needleContourColor(){return this._needleContourColor}set needleContourColor(e){this._needleContourColor=e,this._needleContourPen=null,this.redraw()}get needleContourThickness(){return this._needleContourThickness}set needleContourThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._needleContourThickness=e,this._needleContourPen=null,this.redraw()}get graduationFont(){return this._graduationFont}get showMinMax(){return this._showMinMax}set showMinMax(e){this._showMinMax=e,this.redraw()}constructor(e,t){super(e,t),this._min=0,this._max=100,this.SegmentMaxLength=8,this._borderpen=null,this._borderColor=c.Black,this._bgBrush=null,this._backgroundColor1=c.FromArgb(255,240,240,240),this._backgroundColor2=c.FromArgb(255,200,200,200),this._borderThickness=5,this._valueFormater=null,this._minmaxFormater=null,this._thickness=20,this._value=0,this._needleValue=0,this._color1=c.Green,this._color2=c.Red,this._graduationPen=null,this._graduationColor=c.Black,this._graduationThickness=2,this._graduationSize=10,this._graduation=10,this._unitFactor=1,this._unit="",this._subgraduationPen=null,this._subgraduationColor=c.Black,this._subgraduationThickness=1,this._subgraduationSize=5,this._graduationOuterRadiusSize=98,this._subgraduationCount=5,this._statusColor=c.Gray,this._statusLine="",this._showNeedle=!0,this._needleBrush=null,this._needleColor=c.Red,this._needleMaxSpeed=5,this._needleLength1=90,this._needleLength2=5,this._needleWidth=5,this._needleContourPen=null,this._needleContourColor=c.DarkRed,this._needleContourThickness=1,this._showMinMax=!0,this._path=null,this._graduationFont=new it(this,this,Math.min(this.getContainerInnerWidth(),this.getContainerInnerHeight())/15,null),this._unitFont=new it(this,this,Math.min(this.getContainerInnerWidth(),this.getContainerInnerHeight())/20,null),this._statusFont=new it(this,this,Math.min(this.getContainerInnerWidth(),this.getContainerInnerHeight())/15,null),this.unitFont.color=c.DarkGray,this._statusFont.color=c.DarkGray,this.resizeRule=Be.ResizeRule.RELATIVETOBOTH,this._zones=[]}clearCachedObjects(){if(this._zones!=null)for(let e=0;e<this._zones.length;e++)this._zones[e].resetPath();this._path=null,this._bgBrush=null}get zones(){return this._zones}AddZone(){let e=new An(this,this);return this._zones.push(e),e}Render(e,t,i){let r=new jt;r.Lmargin=0,r.Rmargin=0,r.Tmargin=0,r.Bmargin=0,e.SmoothingMode=Ze.HighQuality,e.TextRenderingHint=Ye.AntiAlias;let s=new qe(16384),n=new qe(16384);n.Alignment=1,n.LineAlignment=1,this.drawAnnotationPanels(e,this._annotationPanels,t,i,!1,r),e.TextRenderingHint=Ye.AntiAlias;let o=r.Lmargin+(t-r.Lmargin-r.Rmargin)/2,a=r.Tmargin+(i-r.Tmargin-r.Bmargin)/2,l=Math.min((t-r.Lmargin-r.Rmargin)/2,(i-r.Tmargin-r.Bmargin)/2)-this.borderThickness,h=2*l*3.14>>0,u=8*Math.PI/5;if(this._path==null){let F=2*l*Math.PI/this.SegmentMaxLength>>0,z=2*Math.PI/F;this._path=new Array(F).fill(null);let U=0;for(let j=0;j<F;j++){let se=2*j*Math.PI/F;this._path[U++]=new me(o+l*Math.cos(se),a-l*Math.sin(se))}}this._bgBrush==null&&(this._bgBrush=new Bt(this._backgroundColor1,this._backgroundColor2)),this._borderpen==null&&(this._borderpen=new Ce(this._borderColor,this._borderThickness),this._borderpen.linejoin=Ce.LineJoin.Round),this._path.length>3&&e.FillPolygon(this._bgBrush,this._path),this._graduationPen==null&&(this._graduationPen=new Ce(this._graduationColor,this._graduationThickness)),this._subgraduationPen==null&&(this._subgraduationPen=new Ce(this._subgraduationColor,this._subgraduationThickness));let _=(this._unitFactor!=1?"x"+this._unitFactor.toString()+" ":"")+this._unit,d=e.MeasureStringSF(_.toString(),this._unitFont,1e4,s),g=new le(o-d.width/2>>0,a+l/2-d.height/2>>0,d.width+1>>0,d.height+1>>0);if(e.DrawStringRect(_,this._unitFont,this._unitFont.brush,g,n),this._statusLine!=""){d=e.MeasureStringSF(this._statusLine,this._statusFont,1e4,s);let I=new le(o-d.width/2>>0,a-l/3-d.height/2>>0,d.width+1,d.height+1);e.DrawStringRect(this._statusLine,this._statusFont,this._statusFont.brush,I,n)}let y,p,x,w,f,T,R,P=this._graduationOuterRadiusSize/100;for(let I=0;I<this._zones.length;I++)if(this._zones[I].visible){if(this._zones[I].path==null){let F=Math.max(this._min,Math.min(this._max,this._zones[I].min)),z=Math.max(this._min,Math.min(this._max,this._zones[I].max));if(z>F){let U=this._zones[I].outerRadius/100,j=(Math.PI-u)/2+u*(F-this._min)/(this._max-this._min),se=(Math.PI-u)/2+u*(z-this._min)/(this._max-this._min),ee=(se-j)*l/this.SegmentMaxLength>>0;ee<2&&(ee=2),this._zones[I].setPathSize(2*ee+2);for(let te=0;te<=ee;te++){let pe=j+(se-j)*te/ee;this._zones[I].setPathPoint(te,new me(o-l*U*Math.cos(pe),a-l*U*Math.sin(pe)))}let _e=U-this._zones[I].width/100;for(let te=ee;te>=0;te--){let pe=j+(se-j)*te/ee;this._zones[I].setPathPoint(2*ee+1-te,new me(o-l*_e*Math.cos(pe),a-l*_e*Math.sin(pe)))}}}this._zones[I].path!=null&&e.FillPolygon(this._zones[I].zoneBrush,this._zones[I].path)}for(y=this._graduation*(this._min/this._graduation)>>0,this._min<0&&(y-=this._graduation);y<this._min;)y+=this._graduation;if(p=1+(this._max-this._min)/this._graduation>>0,this._subgraduationCount>0&&this._subgraduationCount*p<h){let I=this._graduation/this._subgraduationCount;for(y=I*(this._min/I>>0),this._min<0&&(y-=I);y<this._min;)y+=I;p=1+(this._max-this._min)/I>>0;for(let F=0;F<p;F++){let z=y+F*I;z<=this._max&&(x=(Math.PI-u)/2+u*(z-this._min)/(this._max-this._min),w=Math.cos(x),f=Math.sin(x),T=P*(l-this._borderThickness/2),R=(100-this._subgraduationSize)*(P*(l-this._borderThickness/2))/100,e.DrawLineXY(this._subgraduationPen,o-T*w,a-T*f,o-R*w,a-R*f))}}if(p<h)for(let I=0;I<p;I++){let F=y+I*this._graduation;if(F<=this._max){x=(Math.PI-u)/2+u*(F-this._min)/(this._max-this._min),w=Math.cos(x),f=Math.sin(x),T=P*(l-this._borderThickness/2),R=(100-this._graduationSize)*(P*(l-this._borderThickness/2))/100,e.DrawLineXY(this._graduationPen,o-T*w,a-T*f,o-R*w,a-R*f),d=e.MeasureStringSF(F.toString().trim(),this._graduationFont,1e3,s);let z=.4*Math.sqrt(d.width*d.width+d.height*d.height),U=new le(o-(R-z)*w-d.width/2>>0,a-(R-z)*f-d.height/2>>0,(d.width>>0)+1,d.height>>0);e.DrawStringRect(F.toString(),this._graduationFont,this._graduationFont.brush,U,n)}}if(this._borderThickness>0&&this._path.length>3&&e.DrawPolygon(this._borderpen,this._path),this.drawAnnotationPanels(e,this._annotationPanels,t,i,!0,r),this._showNeedle){if(this._needleValue!=this._value){let j=this._unitFactor*this._needleMaxSpeed*(this._max-this._min)/100;Math.abs(this._value-this._needleValue)<j?this._needleValue=this._value:this._needleValue<this.value?this._needleValue+=j:this._needleValue-=j}let I=this._needleValue/this._unitFactor,F=(this._max-this.min)*.05;I<this._min-F&&(I=this._min-F),I>this._max+F&&(I=this._max+F),x=(Math.PI-u)/2+u*(I-this._min)/(this._max-this._min),w=Math.cos(x),f=Math.sin(x),T=l*this._needleLength1/100,R=l*this._needleLength2/100;let z=l*this._needleWidth/200,U=new Array(4).fill(null);if(U[0]=new me(o-T*w,a-T*f),U[1]=new me(o+z*f,a-z*w),U[2]=new me(o+R*w,a+R*f),U[3]=new me(o-z*f,a+z*w),this._needleBrush==null&&(this._needleBrush=new at(this._needleColor)),e.FillPolygon(this._needleBrush,U),this._needleContourThickness>0){this._needleContourPen==null&&(this._needleContourPen=new Ce(this._needleContourColor,this._needleContourThickness),this._needleContourPen.startCap=2,this._needleContourPen.endCap=2,this._needleContourPen.linejoin=Ce.LineJoin.Round);let j=new Array(5).fill(null);j[0]=U[0],j[1]=U[1],j[2]=U[2],j[3]=U[3],j[4]=U[0],e.DrawLines(this._needleContourPen,j)}}return this.DrawMessagePanels(e,t,i),0}renderingPostProcessing(){this._needleValue!=this._value&&this.redraw()}};m(Cn,"YAngularGauge");var ar=Cn;var qt=class qt extends W{get backgroundColor1(){return this._backgroundColor1}set backgroundColor1(e){this._backgroundColor1=e,this._bgBrush=null,this.redraw()}get backgroundColor2(){return this._backgroundColor2}set backgroundColor2(e){this._backgroundColor2=e,this._bgBrush=null,this.redraw()}get alternateValue(){return this._alternateValue}set alternateValue(e){this._alternateValue=e,this.redraw()}get valueFormater(){return this._valueFormater}set valueFormater(e){this._valueFormater=e,this.redraw()}get hrzAlignmentOfset(){return this._hrzAlignmentOfset}set hrzAlignmentOfset(e){this._hrzAlignmentOfset=e,this.redraw()}get hrzAlignment(){return this._hrzAlignment}set hrzAlignment(e){this._hrzAlignment=e,this.redraw()}get outOfRangeMin(){return this._outOfRangeMin}set outOfRangeMin(e){if(!Number.isNaN(e)&&!Number.isNaN(this._outOfRangeMax)&&!W.minMaxCheckDisabled&&e>=this._outOfRangeMax)throw new RangeError("Min cannot be greater than max ("+this._outOfRangeMax.toString()+")");this._outOfRangeMin=e,this.redraw()}get outOfRangeMax(){return this._outOfRangeMax}set outOfRangeMax(e){if(!Number.isNaN(e)&&!Number.isNaN(this._outOfRangeMin)&&!W.minMaxCheckDisabled&&e<=this._outOfRangeMin)throw new RangeError("Min cannot be less than max ("+this._outOfRangeMin.toString()+")");this._outOfRangeMax=e,this.redraw()}get outOfRangeColor(){return this._outOfRangeColor}set outOfRangeColor(e){this._outOfRangeColor=e,this.redraw()}get value(){return this._value}set value(e){this._value=e,this.redraw()}get font(){return this._font}constructor(e,t){super(e,t),this._bgBrush=null,this._backgroundColor1=c.Black,this._backgroundColor2=c.FromArgb(255,48,48,48),this._alternateValue=null,this._valueFormater=null,this._hrzAlignmentOfset=5,this._hrzAlignment=qt.HrzAlignment.DECIMAL,this._outOfRangeMin=Number.NaN,this._outOfRangeMax=Number.NaN,this._outOfRangeColor=c.Red,this._value=0,this._font=new it(this,this,Math.min(e.width/5,e.height/2),null),this._font.color=c.LightGreen,this.resizeRule=Be.ResizeRule.RELATIVETOBOTH}clearCachedObjects(){this.font!=null&&this.font.ResetFont(null),this._bgBrush=null}Render(e,t,i){let r=new jt;r.Lmargin=0,r.Rmargin=0,r.Tmargin=0,r.Bmargin=0,e.SmoothingMode=Ze.HighQuality,e.TextRenderingHint=Ye.AntiAlias;let s=new qe(16384);s.Alignment=1,s.LineAlignment=1,this._bgBrush==null&&(this._bgBrush=new Bt(this._backgroundColor1,this._backgroundColor2)),e.FillRectangleXYHW(this._bgBrush,0,0,t,i),this.drawAnnotationPanels(e,this._annotationPanels,t,i,!1,r),r.Tmargin>=20&&(r.Tmargin-=10),r.Bmargin>=20&&(r.Bmargin-=10),e.TextRenderingHint=Ye.AntiAlias;let n=t-(r.Lmargin+r.Rmargin),o=i-(r.Tmargin+r.Bmargin);if(n>10&&o>10){let a;this._alternateValue==null?(a=this._valueFormater==null?this.value.toFixed(3):this._valueFormater(this,this.value),!Number.isNaN(this._outOfRangeMin)&&this.value<this._outOfRangeMin?this.font.alternateColor=this._outOfRangeColor:!Number.isNaN(this._outOfRangeMax)&&this.value>this._outOfRangeMax?this.font.alternateColor=this._outOfRangeColor:this.font.alternateColor=null):(this._font.alternateColor=null,a=this._alternateValue);let l=e.MeasureStringSF(a,this.font,1e4,s),h,u=this._hrzAlignment;switch(this._alternateValue!=null&&u==qt.HrzAlignment.DECIMAL&&(u=qt.HrzAlignment.RIGHT),u==qt.HrzAlignment.DECIMAL&&a.indexOf(".")<0&&(u=qt.HrzAlignment.RIGHT),u){case qt.HrzAlignment.LEFT:h=new le(r.Lmargin+(n*this.hrzAlignmentOfset/100>>0),r.Tmargin+(o-l.height)/2>>0,l.width+1>>0,l.height+1>>0),e.DrawStringRect(a,this.font,this.font.brush,h,s);break;case qt.HrzAlignment.CENTER:h=new le(r.Lmargin+(n-l.width)/2>>0,r.Tmargin+(o-l.height)/2>>0,l.width+1>>0,l.height+1>>0),e.DrawStringRect(a,this.font,this.font.brush,h,s);break;case qt.HrzAlignment.DECIMAL:let _="",d=a.lastIndexOf(",");if(d<0&&(d=a.lastIndexOf(".")),d>=0)_=a.substring(0,d+1);else{for(d=0;d<a.length&&(a[d]>="0"&&a[d]<="9"||a[d]=="-"||a[d]=="'"||a[d]==" ");)d++;_=a.substring(0,d)}let g=e.MeasureStringSF(_,this.font,1e4,s);h=new le(r.Lmargin+(n-g.width-n*this.hrzAlignmentOfset/100)>>0,r.Tmargin+(o-l.height)/2>>0,l.width+1>>0,l.height+1>>0),e.DrawStringRect(a,this.font,this.font.brush,h,s);break;case qt.HrzAlignment.RIGHT:h=new le(r.Lmargin+(n-l.width-n*this.hrzAlignmentOfset/100)>>0,r.Tmargin+(o-l.height)/2>>0,l.width+1>>0,l.height+1>>0),e.DrawStringRect(a,this.font,this.font.brush,h,s);break}}return this.drawAnnotationPanels(e,this._annotationPanels,t,i,!0,r),this.DrawMessagePanels(e,t,i),0}};m(qt,"YDigitalDisplay");var di=qt;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"HrzAlignmentEnumItem");let e=i;D.HrzAlignmentEnumItem=e;let r=class r extends Le{};m(r,"HrzAlignment");let t=r;t.LEFT=new e("LEFT","Left"),t.CENTER=new e("CENTER","Center"),t.DECIMAL=new e("DECIMAL","Decimal"),t.RIGHT=new e("RIGHT","Right"),D.HrzAlignment=t})(di||(di={}));var $e=100,ls=class ls{constructor(e,t){this.x=e===void 0?0:e,this.y=t===void 0?0:t}clone(){return new ls(this.x,this.y)}};m(ls,"pointXY");var ot=ls,hs=class hs{constructor(e,t,i,r){this.x1=e,this.x2=t,this.ymin=i,this.ymax=r}clone(){return new hs(this.x1,this.x2,this.ymin,this.ymin)}};m(hs,"pointsSummary");var hr=hs,Dn=class Dn{constructor(){this.success=!1,this.result=0}};m(Dn,"TimeConverterParseResult");var ns=Dn,In=class In{constructor(){this.step=0,this.format=0}};m(In,"TimeResolution");var Tn=In,ht=class ht extends Date{ToString(e){let t="",i="";if(e&ht.D&&(t=t+this.getDate()+" "),e&ht.M&&(t=t+ht.months[this.getMonth()]+" "),e&ht.YY){let r=this.getFullYear().toString();t=t+r.substr(r.length-2)+" "}else if(e&ht.YYYY){let r=this.getFullYear().toString();t=t+r+" "}if(e&ht.CR&&(t=t+`
`),e&ht.h)if(ht.use24Hformat){let r="0"+this.getHours().toString();t=t+r.substring(r.length-2),e&ht.m||(t=t+"H")}else{let r=this.getHours();i="AM",r>11&&(i="PM"),r>12&&(r=r-12),r==0&&(r=12),t=t+r.toString()}if(e&ht.m){let r="0"+this.getMinutes().toString();t=t+":"+r.substring(r.length-2)}if(e&ht.s){let r="0"+this.getSeconds().toString();t=t+":"+r.substring(r.length-2)}if(e&ht.ms1){let r="00"+this.getMilliseconds().toString();t=t+"."+r.substring(r.length-3).substring(1)}else if(e&ht.ms01){let r="00"+this.getMilliseconds().toString();t=t+"."+r.substring(r.length-3).substring(2)}else if(e&ht.ms001){let r="00"+this.getMilliseconds().toString();t=t+"."+r.substring(r.length-3).substring(3)}return e&ht.h&&!ht.use24Hformat&&(t=t+i),t}};m(ht,"YDate");var ae=ht;ae.D=1;ae.DD=2;ae.M=4;ae.YY=8;ae.h=16;ae.m=32;ae.s=64;ae.ms1=128;ae.ms01=256;ae.ms001=512;ae.CR=1024;ae.isRelative=2048;ae.YYYY=4096;ae.d=new Date().toLocaleTimeString().toUpperCase();ae.use24Hformat=ae.d.indexOf("AM")<0&&ae.d.indexOf("PM")<0;ae.months=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];var vr=class vr{static UTCNow(){return new ae}static ToUnixTime(e){return e.getTime()/1e3}static FromUnixTime(e){let t=new ae;return t.setTime(e*1e3),t}static tryParseStringToAbsDateTime(e){let t=new ns;t.success=!1;let i=new Date,r=i.getFullYear(),s=i.getMonth(),n=i.getDate(),o=0,a=0,l=0;for(e=e.trim();e.indexOf("  ")>0;)e=e.replace("  "," ");let h=!1,u=!1,_=e.split(" ");if(_.length<=0)return t;for(let d=0;d<_.length&&d<2;d++)if(_[d].indexOf("-")>0){let g=_[d].split("-");g.length==1?n=parseInt(g[0]):g.length==2?(n=parseInt(g[1]),s=parseInt(g[0])-1):(n=parseInt(g[2]),s=parseInt(g[1])-1,r=parseInt(g[0])),h=!0}else if(_[d].indexOf(":")>0){let g=_[d].split(":");g.length==1?o=parseInt(g[0]):g.length==2?(o=parseInt(g[0]),a=parseInt(g[1])):(o=parseInt(g[0]),a=parseInt(g[1]),l=parseFloat(g[2])),u=!0}return!u&&!h||isNaN(r)||isNaN(s)||isNaN(n)||isNaN(o)||isNaN(a)||isNaN(l)||(i.setFullYear(r,s,n),i.setHours(o,a,l>>0,1e3*(l%1)>>0),t.result=i.getTime()/1e3,t.success=!0),t}static tryParseStringToSecTimeSpan(e){let t=new ns,i=0;e=e.toUpperCase();let r=e.indexOf("D");if(r>0){if(i=parseFloat(e.substring(0,r)),isNaN(i))return t;if(t.result+=+i*86400,r==e.length-1)return t.success=!0,t;e=e.substring(r+1)}if(r=e.indexOf("H"),r>0){if(i=parseFloat(e.substring(0,r)),isNaN(i))return t;if(t.result+=i*3600,r==e.length-1)return t.success=!0,t;e=e.substring(r+1)}if(r=e.indexOf("M"),r>0){if(i=parseFloat(e.substring(0,r)),isNaN(i))return t;if(t.result+=i*60,r==e.length-1)return t.success=!0,t;e=e.substring(r+1)}return r=e.indexOf("S"),r<0&&(r=e.length),i=parseFloat(e.substring(0,r)),isNaN(i)||(t.result+=i,t.success=!0),t}static secTimeSpanToString(e,t){let i=!1,r="";if(e<0&&(r="-",e=-e),e>=86400){let n=e/86400>>0;r=r+n.toString()+"d",e-=86400*n,i=!0}if(t>=86400)return r!=""?r:"0d";if(e>=3600){let n=e/3600>>0,o=n.toString();i&&o.length==1&&(o="0"+o),r=r+o+"h",e-=3600*n,i=!0}if(t>=3600||e<t)return r!=""?r:"0h";if(e>=60){let n=e/60>>0,o=n.toString();i&&o.length==1&&(o="0"+o),r=r+o+"m",e-=60*n,i=!0}if(t>=60||e<t)return r!=""?r:"0m";e=Math.round(e*100)/100;let s;return t>.1?s=e.toFixed(0):t>.01?s=e.toFixed(1):t>.001?s=e.toFixed(2):s=e.toString(),i&&e<10&&(s="0"+s),r=r+s+"s",r}static RelativeFormat(e,t,i){let r=!0,s=!0,n=!0,o=!1,a=!1,l=!1;e<=.1&&(s=!0),e<=1&&(r=!0),(e>=60||t>=60)&&(o=!0),(e>=3600||t>=3600)&&(a=!0),(e>=86400||t>=86400)&&(l=!0),i>=.1&&(s=!1),i>=1&&(r=!1),i>=60&&(n=!1),i>=3600&&(o=!1),i>=86400&&(a=!1);let h=0;return h|=ae.isRelative,r&&(h|=ae.ms1),s&&(h|=ae.ms01),n&&(h|=ae.s),o&&(h|=ae.m),a&&(h|=ae.h),l&&(h|=ae.D),h}static BestTimeformat(e,t,i){let r=new Tn,s=!0,n=!0,o=!0,a=!1,l=!1,h=!1,u=!1,_=!1;return t<=.1?r.step=.01:t<=1?r.step=.1:t<=2?r.step=.2:t<=5?r.step=.5:t<=10?r.step=1:t<=20?r.step=2:t<=30?r.step=3:t<=40?r.step=4:t<=60?r.step=5:t<=120?r.step=10:t<=300?r.step=30:t<=900?r.step=60:t<=1800?r.step=180:t<=3600?r.step=300:t<=7200?r.step=600:t<=14e3?r.step=900:t<=21600?r.step=1800:t<=43200?r.step=3600:t<=86400?r.step=7200:t<=2*86400?r.step=2*7200:t<=4*86400?r.step=4*7200:t<=7*86400?r.step=86400:t<=14*86400?r.step=2*86400:t<=28*86400?r.step=4*86400:t<=56*86400?r.step=7*86400:t<=112*86400?r.step=14*86400:t<=224*86400?r.step=31*86400:t<=448*86400?r.step=62*86400:t<=896*86400?r.step=93*86400:r.step=365*86400,i==vr.TimeReference.ABSOLUTE?(n=!0,s=!0,a=!0,l=!0,h=e>86400,u=e>86400,_=e>168*86400,r.step>=.1&&(n=!1),r.step>=1&&(s=!1),r.step>=60&&(o=!1),r.step>=3600&&(a=!1),r.step>=86400&&(l=!1),r.step>=31*86400&&(h=!1),r.step>=365*86400&&(u=!1),r.format=0,n&&(r.format|=ae.ms01),s&&(r.format|=ae.ms1),o&&(r.format|=ae.s),a&&(r.format=r.format|=ae.m),l&&(r.format=r.format|=ae.h),r.format!=0&&(h||u)&&(r.format|=ae.CR),h&&(r.format|=ae.D),u&&(r.format|=ae.M),_&&(r.format|=ae.YY),r.format==ae.YY&&(r.format=ae.YYYY)):r.format=vr.RelativeFormat(e,t,r.step),r}};m(vr,"TimeConverter");var he=vr;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"TimeReferenceEnumItem");let e=i;D.TimeReferenceEnumItem=e;let r=class r extends Le{};m(r,"TimeReference");let t=r;t.ABSOLUTE=new e("ABSOLUTE","Absolute"),t.RELATIVE=new e("RELATIVE","Relative to first data"),D.TimeReference=t})(he||(he={}));var vn=class vn{constructor(e,t){this.Min=0,this.Max=0,this.Min=e,this.Max=t}};m(vn,"MinMax");var Mt=vn,En=class En{static extend(e,t){if(isNaN(e.Min))return e;let i=e.Max-e.Min;return new Mt(e.Min-i*(t-1)/2,e.Max+i*(t-1)/2)}static DefaultValue(e,t){if(typeof t=="undefined")return typeof e=="undefined"?new Mt(Number.NaN,Number.NaN):new Mt(e,e);if(typeof e=="undefined")return new Mt(t,t);if(t<e)throw new RangeError("MinMax invalid parameters ("+e.toString()+">"+t.toString());return new Mt(e,t)}static isDefined(e){return!isNaN(e.Min)}static Combine(e,t){if(isNaN(e.Min))return new Mt(t.Min,t.Max);if(isNaN(t.Min))return new Mt(e.Min,e.Max);let i=new Mt(t.Min,t.Max);return e.Min<i.Min&&(i.Min=e.Min),e.Max<i.Min&&(i.Min=e.Max),e.Min>i.Max&&(i.Max=e.Min),e.Max>i.Max&&(i.Max=e.Max),i}static CombineWithNumber(e,t){return isNaN(e.Min)?new Mt(t,t):t<e.Min?new Mt(t,e.Max):t>e.Max?new Mt(e.Min,t):new Mt(e.Min,e.Max)}};m(En,"MinMaxHandler");var Me=En,or=class or{static ArrayCopy(e,t,i,r,s){for(let n=0;n<s;n++)i[r+n]=e[t+n].clone()}constructor(e){if(this.data=[],this.count=0,e instanceof Array)this.data=new Array(e.length),or.ArrayCopy(e,0,this.data,0,e.length),this.count=e.length;else if(e instanceof ot)this.data=new Array(or.SegmentGranularity),this.data[0]=e,this.count=1;else throw new Error("invalid constructor paramter type")}grow(){let e=this.data.length+or.SegmentGranularity;for(;this.data.length<e;)this.data.push(null)}};m(or,"DataSegment");var ci=or;ci.SegmentGranularity=1e3;var Ft=class Ft{getBufferpoint(){return this.vtlPtCount<=0?null:new hr(this.Xmin,this.Xmax,this.Ymin,this.Ymax)}Dump(){var e,t,i,r;console.log("Summary level"+this.selfIndex+", "+this.segments.length+" segments, "+this.totalpoints+" points");let s=0;for(let n=0;n<this.segments.length;n++){console.log("  segment "+n);for(let o=0;o<this.segments[n].ptCount;o++)console.log(((e=this.segments[n].data[o])===null||e===void 0?void 0:e.x1)+","+((t=this.segments[n].data[o])===null||t===void 0?void 0:t.ymin)+" delataX="+Math.round(this.segments[n].data[o].x1-s)),console.log(((i=this.segments[n].data[o])===null||i===void 0?void 0:i.x2)+","+((r=this.segments[n].data[o])===null||r===void 0?void 0:r.ymax)+" delataX="+Math.round(this.segments[n].data[o].x2-this.segments[n].data[o].x1)),s=this.segments[n].data[o].x2}}constructor(e,t,i){this.segments=[],this.totalpoints=0,this.Xmin=0,this.Xmax=0,this.Ymin=0,this.Ymax=0,this.vtlPtCount=0,this.pointSize=0,this.isLast=!1,this.newSummaryLevelTrigger=0,this.selfIndex=e,this.selfArray=t,this.pointSize=i,this.isLast=!0}processSegments(e){if(e.length<=0)return;let t=e.length-1;this.Xmin=e[t].data[0].x,this.Xmax=e[t].data[0].x,this.Ymin=e[t].data[0].y,this.Ymax=e[t].data[0].y,this.totalpoints=0,this.vtlPtCount=0;for(let i=t;i>=0;i--){for(let r=0;r<e[i].data.length;r++){let s=e[i].data[r];s.x<this.Ymin&&(this.Ymin=s.y),s.x>this.Ymax&&(this.Ymax=s.y),this.Xmax=s.x,this.vtlPtCount++,this.vtlPtCount>=this.pointSize&&(this.flush(!1),this.Xmin=s.x,this.Ymin=s.y,this.Ymax=s.y)}if(i>0){let r=e[i].data.length,s=e[i-1].data[0],n=e[i].data[r-1],o=1;if(r>1){let a=e[i].data[r-2];o=n.x-a.x}s.x-n.x>this.pointSize*o&&(this.flush(!1),this.Xmin=s.x,this.Ymin=s.y,this.Ymax=s.y,this.addNewEmptySegment())}}if(this.totalpoints>1){let i=new Ft(this.selfIndex+1,this.selfArray,this.pointSize*$e);this.selfArray.push(i),this.isLast=!1,i.processSegments(e)}}addNewLevel(){let e=this.selfArray.length;Ft.DBG&&console.log("--- ADDING NEW LEVEL "+e);let t=new Ft(e,this.selfArray,this.pointSize*$e);this.selfArray.push(t),this.isLast=!1;let i=this.segments[0].data[0].x1,r=this.segments[0].data[0].x2,s=this.segments[0].data[0].ymin,n=this.segments[0].data[0].ymax,o=0;for(let a=0;a<this.segments.length;a++){for(let l=0;l<this.segments[a].ptCount;l++)r=this.segments[a].data[l].x2,this.segments[a].data[l].ymin<s&&(s=this.segments[a].data[l].ymin),this.segments[a].data[l].ymin>n&&(n=this.segments[a].data[l].ymin);if(o+=this.segments[a].ptCount,a<this.segments.length-1&&this.segments[a].ptCount>2){let l=this.segments[a].ptCount-1,h=this.segments[a].data[l].x1-this.segments[a].data[l-1].x2;this.segments[a+1].data[0].x1-this.segments[a].data[this.segments[a].ptCount-1].x2>h*$e&&(t.addNewEmptySegment(),i=this.segments[a+1].data[0].x1,r=this.segments[a+1].data[0].x2,s=this.segments[a+1].data[0].ymin,n=this.segments[a+1].data[0].ymax,o=0)}}o!=0&&t.addNewSinglePointSegment(i,r,s,n,o)}addNewSinglePointSegment(e,t,i,r,s){Ft.DBG&&console.log(" ===> level "+this.selfIndex+" new single point segment"),this.segments.push(new ur(new hr(e,t,i,r),s))}addNewEmptySegment(){Ft.DBG&&console.log(" ===> level "+this.selfIndex+" new empty segment"),this.segments.push(new ur(null,null))}addSequentialPoint(e,t){if(Ft.DBG&&console.log(" ADD Point, LEVEL "+this.selfIndex+" Vtl point = "+this.vtlPtCount+"/"+this.pointSize+" TOTAL Points= "+this.totalpoints),this.isLast&&this.totalpoints>=$e&&this.addNewLevel(),this.vtlPtCount==0){this.Xmin=e.x,this.Xmax=e.x,this.Ymin=e.y,this.Ymax=e.y,this.vtlPtCount=1,Ft.DBG&&this.selfIndex==1&&console.log(" --> added 1srt virtual pt vtlPtCount="+this.vtlPtCount+"/"+this.pointSize),this.isLast||this.selfArray[this.selfIndex+1].addSequentialPoint(e,t*$e);return}else{if(Ft.DBG&&console.log(" --> level "+this.selfIndex+" delta = "+(e.x-this.Xmax)+"/"+t),t>0&&e.x-this.Xmax>t){Ft.DBG&&console.log(" --> level "+this.selfIndex+" hole detected"),this.flush(!1),this.addNewEmptySegment(),this.Xmin=e.x,this.Xmax=e.x,this.Ymin=e.y,this.Ymax=e.y,this.vtlPtCount=1,this.isLast||this.selfArray[this.selfIndex+1].addSequentialPoint(e,t*$e);return}e.y<this.Ymin&&(this.Ymin=e.y),e.y>this.Ymax&&(this.Ymax=e.y),this.Xmax=e.x,this.vtlPtCount++,Ft.DBG&&this.selfIndex==1&&console.log(" --> level "+this.selfIndex+" added subsequent virtual pt vtlPtCount="+this.vtlPtCount+"/"+this.pointSize),this.vtlPtCount>=this.pointSize&&(Ft.DBG&&this.selfIndex==1&&console.log(" --> level "+this.selfIndex+" flushing"),this.flush(!1))}this.isLast||this.selfArray[this.selfIndex+1].addSequentialPoint(e,t*$e)}flush(e){(this.segments.length==0||e)&&this.segments.push(new ur(null,null));let t=this.segments[this.segments.length-1];t.data[t.ptCount]=new hr(this.Xmin,this.Xmax,this.Ymin,this.Ymax),this.totalpoints++,t.ptCount++,this.vtlPtCount=0}};m(Ft,"Summary");var kr=Ft;kr.DBG=!1;var ji=class ji{static ArrayCopy(e,t,i,r,s){for(let n=0;n<s;n++)i[r+n]=e[t+n].clone()}constructor(e,t){this.data=[],this.ptCount=0,e instanceof Array?(this.data=new Array(e.length),ji.ArrayCopy(e,0,this.data,0,e.length),this.ptCount=e.length):e instanceof hr?(this.data=new Array(ji.SegmentGranularity),this.data[0]=e,this.ptCount=1):e==null&&(this.data=new Array(ji.SegmentGranularity),this.ptCount=0)}grow(){let e=this.data.length+ji.SegmentGranularity;for(;this.data.length<e;)this.data.push(null)}};m(ji,"DataSummarySegment");var ur=ji;ur.SegmentGranularity=1e3;var ti=class ti{get userData(){return this._userData}set userData(e){this._userData=e}static get MaxPointsPerSeries(){return ti._MaxPointsPerSeries}static set MaxPointsPerSeries(e){ti._MaxPointsPerSeries=e}get timeRange(){return this._timeRange}get valueRange(){return this._valueRange}constructor(e){if(this.totalPointCount=0,this._userData=null,this._yAxisIndex=0,this._pen=null,this._legendPen=null,this._brush=null,this._navigatorpen=null,this._visible=!0,this._disabled=!1,this._color=c.Black,this._thickness=1,this._legend="",this._unit="",this.segments=[],this.summaries=null,e.yAxes.length<=0)throw new Error("Define at least one yAxis");this._timeRange=Me.DefaultValue(),this._valueRange=Me.DefaultValue(),this.parent=e}get yAxisIndex(){return this._yAxisIndex}set yAxisIndex(e){if(e>=this.parent.yAxes.length)throw new RangeError("No such yAxis ("+e.toString()+")");this._yAxisIndex=e,this.parent.yAxes[this._yAxisIndex].AutoShow()}get pen(){return this._pen==null&&(this._pen=new Ce(this._color,this._thickness),this._pen.endCap=2,this._pen.linejoin=Ce.LineJoin.Round),this._pen}get legendPen(){return this._legendPen==null&&(this._legendPen=new Ce(this._color,this._thickness*this.parent.legendPanel.traceWidthFactor)),this._legendPen}resetlegendPen(){this._legendPen=null}get brush(){return this._brush==null&&(this._brush=new at(this._color)),this._brush}get navigatorpen(){return this._navigatorpen==null&&(this._navigatorpen=new Ce(c.FromArgb(100,this._color.red,this._color.green,this._color.blue),1)),this._navigatorpen}get visible(){return this._visible}set visible(e){this._visible=e,this.parent.redraw()}get disabled(){return this._disabled}set disabled(e){this._disabled=e,this.parent.redraw()}get color(){return this._color}set color(e){this._color=e,this._pen=null,this._legendPen=null,this._brush=null,this._navigatorpen=null,this.parent.redraw()}get thickness(){return this._thickness}set thickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._thickness=e,this._pen=null,this._legendPen=null,this.parent.redraw()}get legend(){return this._legend}set legend(e){this._legend=e,this.parent.redraw()}get unit(){return this._unit}set unit(e){this._unit=e,this.parent.redraw()}AddNewSegment(e){this.segments.splice(0,0,new ci(e))}getlastPoint(){return this.segments.length<=0?new ot(NaN,NaN):this.segments[this.segments.length-1].data[this.segments[this.segments.length-1].count-1]}handleSummary(e,t){this.summaries==null&&(this.summaries=[],this.summaries.push(new kr(0,this.summaries,$e))),this.summaries!=null&&this.summaries[0].addSequentialPoint(e,t)}AddPoint(e){this._timeRange=Me.CombineWithNumber(this._timeRange,e.x),this._valueRange=Me.CombineWithNumber(this._valueRange,e.y);let t=-1,i=-1;if(this.segments.length<=0){this.AddNewSegment(e),this.totalPointCount++,$e>0&&this.handleSummary(e,t);return}else if(this.segments[0].count>1&&(t=this.segments[0].data[this.segments[0].count-1].x-this.segments[0].data[this.segments[0].count-2].x,i=e.x-this.segments[0].data[this.segments[0].count-1].x,i>.1&&(i<0||i>2*t))){this.AddNewSegment(e),$e>0&&this.handleSummary(e,t);return}$e>0&&this.handleSummary(e,t),this.segments[0].data[this.segments[0].count]=e,this.segments[0].count++,this.totalPointCount++,ti._MaxPointsPerSeries>0&&this.totalPointCount>ti._MaxPointsPerSeries&&(this.dataCleanUp(),this.rebuildSummaries()),this.parent.adjustGlobalTimeRange(e.x),this.parent.redraw()}rebuildSummaries(){$e<=0||(this.summaries=[],this.summaries.push(new kr(0,this.summaries,$e)),this.summaries[0].processSegments(this.segments))}dumpSummaries(){if(this.summaries!=null)for(let e=0;e<this.summaries.length;e++)this.summaries[e].Dump();else console.log("****No summaries ****")}dataCleanUp(){if(this.segments.length<=0)return;let e=ti._MaxPointsPerSeries*90/100;for(;this.segments[this.segments.length-1].count<=this.totalPointCount-e;)this.totalPointCount-=this.segments[this.segments.length-1].count,this.segments.splice(this.segments.length-1,1);if(this.totalPointCount>e){let n=this.totalPointCount-e,o=this.segments[this.segments.length-1].count-n,a=new Array(o);ci.ArrayCopy(this.segments[this.segments.length-1].data,n,a,0,this.segments[this.segments.length-1].count-n),this.segments[this.segments.length-1].data=a,this.segments[this.segments.length-1].count-=n,this.totalPointCount-=n}let t=this.segments[0].data[0].x,i=this.segments[0].data[0].x,r=this.segments[0].data[0].y,s=this.segments[0].data[0].y;for(let n=0;n<this.segments.length;n++){let o=this.segments[n].count;t>this.segments[n].data[0].x&&(t=this.segments[n].data[0].x),i<this.segments[n].data[o-1].x&&(i=this.segments[n].data[o-1].x);for(let a=0;a<o;a++)r>this.segments[n].data[a].y&&(r=this.segments[n].data[a].y),s<this.segments[n].data[a].y&&(s=this.segments[n].data[a].y)}this._timeRange.Min=t,this._timeRange.Max=i,this._valueRange.Min=r,this._valueRange.Max=s}InsertPoints(e){if(e.length==0)return;if(e.length==1){this._timeRange=Me.CombineWithNumber(this._timeRange,e[0].x),this._valueRange=Me.CombineWithNumber(this._valueRange,e[0].y);return}let t=e[1].x-e[0].x,i=e[e.length-1].x-e[e.length-2].x,r=-1,s=-1;for(let n=0;n<this.segments.length;n++)if(this.segments[n].count>1){let o=this.segments[n].data[0].x-e[e.length-1].x,a=e[0].x-this.segments[n].data[this.segments[n].count-1].x;o>0&&o<2*t&&(r=n),a>0&&a<2*i&&(s=n)}if(r>=0)ci.ArrayCopy(this.segments[r].data,0,this.segments[r].data,e.length,this.segments[r].count),ci.ArrayCopy(e,0,this.segments[r].data,0,e.length),this.segments[r].count+=e.length,this.totalPointCount+=e.length;else if(s>=0)ci.ArrayCopy(e,0,this.segments[s].data,this.segments[s].count,e.length),this.segments[s].count+=e.length,this.totalPointCount+=e.length;else{let n=!1;for(let o=0;o<this.segments.length;o++)this.segments[o].data[this.segments[o].data.length-1].x<e[0].x&&!n&&(this.segments.splice(o,0,new ci(e)),n=!0);n||this.segments.push(new ci(e)),this.totalPointCount+=e.length}this._timeRange=Me.CombineWithNumber(this._timeRange,e[0].x),this._timeRange=Me.CombineWithNumber(this._timeRange,e[e.length-1].x);for(let n=0;n<e.length;n++)this._valueRange=Me.CombineWithNumber(this._valueRange,e[n].y);ti._MaxPointsPerSeries>0&&this.totalPointCount>ti._MaxPointsPerSeries&&this.dataCleanUp(),this.parent.redraw()}static CompareSegments(e,t){return e.data[0].x>t.data[0].x?-1:e.data[0].x<t.data[0].x?1:0}getData(){let e=[];this.segments.sort(ti.CompareSegments);for(let t=this.segments.length-1;t>=0;t--)for(let i=0;i<this.segments[t].count;i++)e.push(this.segments[t].data[i]);return e}findClosestValue(e,t){let i=0,r=0,s=0;if(this.segments.length<=0)return null;for(let a=0;a<this.segments.length;a++)if(e>=this.segments[a].data[0].x&&e<=this.segments[a].data[this.segments[a].count-1].x){let l=this.segments[a].data;for(i=0,r=this.segments[a].count-1;r-i>1;){let h=i+r>>1;l[h].x>e?r=h:i=h}if(s=i-1,s<0&&(s=0),t){if(s++,e==l[s].x)return l[s];if(e==l[s+1].x)return l[s+1];let h=new ot;return h.x=e,h.y=l[s].y+(l[s+1].y-l[s].y)*(e-l[s].x)/(l[s+1].x-l[s].x),h}else return e-l[s].x<l[s+1].x-e?l[s]:l[s+1]}if(t)return null;try{this.segments[0].data[0].clone()}catch(a){debugger}let n=this.segments[0].data[0],o=Math.abs(this.segments[0].data[0].x-e);for(let a=0;a<this.segments.length;a++){let l=Math.abs(this.segments[a].data[0].x-e),h=Math.abs(this.segments[a].data[this.segments[a].count-1].x-e);l<o&&(n=this.segments[a].data[0],o=l),h<o&&(n=this.segments[a].data[this.segments[a].count-1],o=h)}return n.clone()}clear(){this.segments=[],this._timeRange=Me.DefaultValue(),this._valueRange=Me.DefaultValue(),this.parent.clearCachedObjects(),this.totalPointCount=0}};m(ti,"DataSerie");var Ri=ti;Ri._MaxPointsPerSeries=0;var Er=class Er{get directParent(){return this._directParent}get userData(){return this._userData}set userData(e){this._userData=e}constructor(e,t){this._userData=null,this._enabled=!1,this._showSerieName=!1,this._showTimeStamp=!1,this._dataPrecisionString="",this._dataPrecision=Er.DataPrecision.PRECISION_NOLIMIT,this._diameter=5,this._handleLength=25,this._detectionDistance=50,this._bgColor=c.FromArgb(200,255,255,255),this._borderColor=c.Black,this._borderthickness=1,this._padding=10,this._verticalMargin=10,this._horizontalMargin=10,this._bgBrush=null,this._pen=null,this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,8,null)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._parentRenderer.redraw()}get showSerieName(){return this._showSerieName}set showSerieName(e){this._showSerieName=e,this._parentRenderer.redraw()}get showTimeStamp(){return this._showTimeStamp}set showTimeStamp(e){this._showTimeStamp=e,this._parentRenderer.redraw()}get dataPrecisionString(){return this._dataPrecisionString}get dataPrecision(){return this._dataPrecision}set dataPrecision(e){this._dataPrecision=e,this.compute_dataPrecisionString(),this._parentRenderer.redraw()}compute_dataPrecisionString(){if(this._dataPrecision==Er.DataPrecision.PRECISION_NOLIMIT){this._dataPrecisionString="";return}this._dataPrecisionString="0."}get diameter(){return this._diameter}set diameter(e){if(e<0)throw new RangeError("Diameter must be a positive value");this._diameter=e,this._parentRenderer.redraw()}get handleLength(){return this._handleLength}set handleLength(e){if(e<0)throw new RangeError("Hanle length must be a positive value");this._handleLength=e,this._parentRenderer.redraw()}get detectionDistance(){return this._detectionDistance}set detectionDistance(e){if(e<=0)throw new RangeError("Distance must be a positive value");this._detectionDistance=e}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e,this._bgBrush=null,this._parentRenderer.redraw()}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._pen=null,this._parentRenderer.redraw()}get borderthickness(){return this._borderthickness}set borderthickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._borderthickness=e,this._pen=null,this._parentRenderer.redraw()}get padding(){return this._padding}set padding(e){if(e<0)throw new RangeError("Padding must be a positive value");this._padding=e,this._parentRenderer.redraw()}get verticalMargin(){return this._verticalMargin}set verticalMargin(e){if(e<0)throw new RangeError("Margin must be a positive value");this._verticalMargin=e,this._parentRenderer.redraw()}get horizontalMargin(){return this._horizontalMargin}set horizontalMargin(e){if(e<0)throw new RangeError("Margin must be a positive value");this._horizontalMargin=e,this._parentRenderer.redraw()}get bgBrush(){return this._bgBrush==null&&(this._bgBrush=new at(this._bgColor)),this._bgBrush}get pen(){return this._pen==null&&(this._pen=new Ce(this._borderColor,this._borderthickness,!0)),this._pen}get font(){return this._font}};m(Er,"DataTracker");var dr=Er;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"DataPrecisionEnumItem");let e=i;D.DataPrecisionEnumItem=e;let r=class r extends Le{};m(r,"DataPrecision");let t=r;t.PRECISION_NOLIMIT=new e("PRECISION_NOLIMIT","As is"),t.PRECISION_1=new e("PRECISION_1","1"),t.PRECISION_01=new e("PRECISION_01","0.1"),t.PRECISION_001=new e("PRECISION_001","0.01"),t.PRECISION_0001=new e("PRECISION_0001","0.001"),t.PRECISION_00001=new e("PRECISION_00001","0.0001"),t.PRECISION_000001=new e("PRECISION_000001","0.00001"),t.PRECISION_0000001=new e("PRECISION_0000001","0.000001"),t.PRECISION_00000001=new e("PRECISION_00000001","0.0000001"),t.PRECISION_000000001=new e("PRECISION_000000001","0.00000001"),t.PRECISION_0000000001=new e("PRECISION_0000000001","0.000000001"),D.DataPrecision=t})(dr||(dr={}));var us=class us{get directParent(){return this._directParent}get userData(){return this._userData}set userData(e){this._userData=e}get traceWidthFactor(){return this._traceWidth}set traceWidthFactor(e){if(e<=0)throw new RangeError("This has to be a strictly positive value");this._traceWidth=e,this._parentRenderer.resetlegendPens(),this._parentRenderer.redraw()}constructor(e,t){this._userData=null,this._traceWidth=1,this._enabled=!1,this._position=us.Position.BOTTOM,this._overlap=!1,this._bgColor=c.FromArgb(200,255,255,255),this._borderColor=c.Black,this._borderthickness=1,this._padding=10,this._verticalMargin=10,this._horizontalMargin=10,this._bgBrush=null,this._pen=null,this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,8,null)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._parentRenderer.redraw()}get position(){return this._position}set position(e){this._position=e,this._parentRenderer.redraw()}get overlap(){return this._overlap}set overlap(e){this._overlap=e,this._parentRenderer.redraw()}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e,this._bgBrush=null,this._parentRenderer.redraw()}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._pen=null,this._parentRenderer.redraw()}get borderthickness(){return this._borderthickness}set borderthickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._borderthickness=e,this._pen=null,this._parentRenderer.redraw()}get padding(){return this._padding}set padding(e){if(e<0)throw new RangeError("Padding must be a positive value");this._padding=e,this._parentRenderer.redraw()}get verticalMargin(){return this._verticalMargin}set verticalMargin(e){if(e<0)throw new RangeError("Margin must be a positive value");this._verticalMargin=e,this._parentRenderer.redraw()}get horizontalMargin(){return this._horizontalMargin}set horizontalMargin(e){if(e<0)throw new RangeError("Margin must be a positive value");this._horizontalMargin=e,this._parentRenderer.redraw()}get bgBrush(){return this._bgBrush==null&&(this._bgBrush=new at(this._bgColor)),this._bgBrush}get pen(){return this._pen==null&&(this._pen=new Ce(this._borderColor,this._borderthickness,!0)),this._pen}get font(){return this._font}};m(us,"LegendPanel");var St=us;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"PositionEnumItem");let e=i;D.PositionEnumItem=e;let r=class r extends Le{};m(r,"Position");let t=r;t.LEFT=new e("LEFT","Left"),t.TOPLEFT=new e("TOPLEFT","Top-Left"),t.TOP=new e("TOP","Top"),t.TOPRIGHT=new e("TOPRIGHT","Top-Right"),t.RIGHT=new e("RIGHT","Right"),t.BOTTOMRIGHT=new e("BOTTOMRIGHT","Bottom-Right"),t.BOTTOM=new e("BOTTOM","Bottom"),t.BOTTOMLEFT=new e("BOTTOMLEFT","Bottom-Left"),D.Position=t})(St||(St={}));var ds=class ds{get directParent(){return this._directParent}get userData(){return this._userData}set userData(e){this._userData=e}get showXAxisZones(){return this._showXAxisZones}set showXAxisZones(e){this._showXAxisZones=e}get relativeheight(){return this._relativeheight}set relativeheight(e){e<10&&(e=10),e>50&&(e=50),this._relativeheight=e,this._parentRenderer.redraw()}constructor(e,t){this._userData=null,this._viewport=new jt,this.Xrange=null,this._showXAxisZones=!0,this._relativeheight=10,this._enabled=!1,this._bgColor1=c.FromArgb(255,225,225,225),this._cursorBorderColor=c.FromArgb(255,40,40,40),this._yAxisHandling=ds.YAxisHandling.AUTO,this._bgColor2=c.FromArgb(255,225,225,225),this._cursorColor=c.FromArgb(100,0,255,0),this._cursorBrush=null,this._pen=null,this._cursorBorderPen=null,this._xAxisColor=c.Black,this._xAxisThickness=1,this._borderPen=null,this._borderColor=c.DimGray,this._borderThickness=1,this._bgBrush=null,this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,8,null)}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._parentRenderer.redraw()}get bgColor1(){return this._bgColor1}set bgColor1(e){this._bgColor1=e,this._bgBrush=null,this._parentRenderer.redraw()}get cursorBorderColor(){return this._cursorBorderColor}set cursorBorderColor(e){this._cursorBorderColor=e,this._cursorBorderPen=null,this._parentRenderer.redraw()}get yAxisHandling(){return this._yAxisHandling}set yAxisHandling(e){this._yAxisHandling=e,this._parentRenderer.redraw()}get bgColor2(){return this._bgColor2}set bgColor2(e){this._bgColor2=e,this._bgBrush=null,this._parentRenderer.redraw()}get cursorColor(){return this._cursorColor}set cursorColor(e){this._cursorColor=e,this._cursorBrush=null,this._parentRenderer.redraw()}get cursorBrush(){return this._cursorBrush==null&&(this._cursorBrush=new at(this._cursorColor)),this._cursorBrush}get pen(){return this._pen==null&&(this._pen=new Ce(this._xAxisColor,this._xAxisThickness,!0)),this._pen}get cursorBorderPen(){return this._cursorBorderPen==null&&(this._cursorBorderPen=new Ce(this._cursorBorderColor,1,!0)),this._cursorBorderPen}get xAxisColor(){return this._xAxisColor}set xAxisColor(e){this._xAxisColor=e,this._pen=null,this._parentRenderer.redraw()}get xAxisThickness(){return this._xAxisThickness}set xAxisThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._xAxisThickness=e,this._pen=null,this._parentRenderer.redraw()}get borderPen(){return this._borderPen==null&&(this._borderPen=new Ce(this._borderColor,this._borderThickness,!0)),this._borderPen}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._borderPen=null,this._parentRenderer.redraw()}get borderThickness(){return this._borderThickness}set borderThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._borderThickness=e,this._borderPen=null,this._parentRenderer.redraw()}setPosition(e,t,i,r,s,n){(this._viewport.Lmargin!=i||this._viewport.Rmargin!=r||this._viewport.Tmargin!=s||this._viewport.Bmargin!=n)&&(this._bgBrush=null),this._viewport.Lmargin=i,this._viewport.Rmargin=r,this._viewport.Bmargin=n,this._viewport.Tmargin=s,this._viewport.Width=e,this._viewport.Height=t}setIRLPosition(e,t,i,r){this._viewport.IRLx=e,this._viewport.IRLy=t,this._viewport.zoomx=i,this._viewport.zoomy=r}startCapture(e,t,i){this._viewport.OriginalXAxisMin=t,this._viewport.OriginalXAxisMax=i,this._viewport.OriginalIRLx=this._viewport.IRLx,this._viewport.OriginalLmargin=this._viewport.Lmargin,this._viewport.OriginalZoomx=this._viewport.zoomx,this._viewport.IRLCaptureStartX=e.x,this._viewport.Capture=!0}get Capture(){return this._viewport.Capture}stopCapture(){this._viewport.Capture=!1}get viewport(){return this._viewport}get bgBrush(){return this._bgBrush==null&&(this._bgBrush=new Bt(this._bgColor1,this._bgColor2)),this._bgBrush}get font(){return this._font}};m(ds,"Navigator");var Vi=ds;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"YAxisHandlingEnumItem");let e=i;D.YAxisHandlingEnumItem=e;let r=class r extends Le{};m(r,"YAxisHandling");let t=r;t.AUTO=new e("AUTO","Automatic"),t.INHERIT=new e("INHERIT","Inherit from main view"),D.YAxisHandling=t})(Vi||(Vi={}));var ii=class ii{get userData(){return this._userData}set userData(e){this._userData=e}static _round100(e){return Math.round(100*e)/100}get stringFormat(){if(this._stringFormat!=null)return this._stringFormat;switch(this._stringFormat=new qe(16384),this._stringFormat.LineAlignment=1,this._textAlign){case ii.TextAlign.LEFT:this._stringFormat.Alignment=0;break;case ii.TextAlign.CENTER:this._stringFormat.Alignment=1;break;case ii.TextAlign.RIGHT:this._stringFormat.Alignment=2;break}return this._stringFormat}get PatchTextCallback(){return this._MarkerTextCallback}set PatchTextCallback(e){this._MarkerTextCallback=e}get directParent(){return this._directParent}constructor(e,t){this._userData=null,this._stringFormat=null,this._MarkerTextCallback=null,this._enabled=!1,this._xposition=0,this._xpositionIsRelative=!1,this._yposition=92,this._text="Marker",this._textAlign=ii.TextAlign.CENTER,this._bgColor=c.FromArgb(255,255,255,192),this._borderColor=c.DarkRed,this._borderthickness=1,this._arrowSize=5,this._padding=5,this._verticalMargin=5,this._horizontalMargin=5,this._bgBrush=null,this._arrowBrush=null,this._pen=null,this._navigatorpen=null,this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,8,null)}startCapture(){this._parentRenderer.startMarkerCapture(this)}setCapturedPosition(e,t){this.enabled=!0,this._xpositionIsRelative=t.timeReference==he.TimeReference.RELATIVE&&t.zeroTime>0,this._xposition=ii._round100(this._xpositionIsRelative?e-t.zeroTime:e),this._parentRenderer.clearCachedObjects(),this._parentRenderer.redraw()}get enabled(){return this._enabled}set enabled(e){this._enabled!=e&&(this._enabled=e,this._parentRenderer.clearCachedObjects(),this._parentRenderer.redraw())}get xposition(){return this._xposition}set xposition(e){this._xposition=ii._round100(e),this._enabled&&this._parentRenderer.redraw()}get timereference(){return this._xpositionIsRelative?he.TimeReference.RELATIVE:he.TimeReference.ABSOLUTE}set timereference(e){let t=e==he.TimeReference.RELATIVE;if(this._xpositionIsRelative!=t){let i=this._directParent.zeroTime;isNaN(i)&&(i=0),t?(this._xpositionIsRelative=!0,this._xposition-=i):(this._xpositionIsRelative=!1,this._xposition+=i),this._xposition=ii._round100(this._xposition),this._parentRenderer.redraw()}}get positionOnXAxis(){return new _t(this._xposition,this._xpositionIsRelative)}set positionOnXAxis(e){if(e.capture)this.startCapture();else{let t=ii._round100(e.value);(this._xpositionIsRelative!=e.relative||this._xposition!=t)&&(this._xposition=t,this._xpositionIsRelative=e.relative,this._enabled&&this._parentRenderer.redraw())}}get yposition(){return this._yposition}set yposition(e){this._yposition=Math.min(100,Math.max(0,e)),this._enabled&&this._parentRenderer.redraw()}get text(){return this._text}set text(e){this._text=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e,this._stringFormat=null,this._enabled&&this._parentRenderer.redraw()}get shortText(){return this._text.length<=20?this._text:this._text.substring(0,18)+".."}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e,this._bgBrush=null,this._enabled&&this._parentRenderer.redraw()}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._arrowBrush=null,this._pen=null,this._navigatorpen=null,this._enabled&&this._parentRenderer.redraw()}get borderthickness(){return this._borderthickness}set borderthickness(e){if(e<0)throw new RangeError("thickness must be a positive value");this._borderthickness=e,this._parentRenderer.clearCachedObjects(),this._pen=null,this._enabled&&this._parentRenderer.redraw()}get arrowSize(){return this._arrowSize}set arrowSize(e){this._arrowSize=e,this._enabled&&this._parentRenderer.redraw()}get padding(){return this._padding}set padding(e){if(e<0)throw new RangeError("Padding must be a positive value");this._padding=e,this._parentRenderer.clearCachedObjects(),this._enabled&&this._parentRenderer.redraw()}get verticalMargin(){return this._verticalMargin}set verticalMargin(e){this._verticalMargin=e,this._enabled&&this._parentRenderer.redraw()}get horizontalMargin(){return this._horizontalMargin}set horizontalMargin(e){this._horizontalMargin=e,this._enabled&&this._parentRenderer.redraw()}get bgBrush(){return this._bgBrush==null&&(this._bgBrush=new at(this._bgColor)),this._bgBrush}get arrowBrush(){return this._arrowBrush==null&&(this._arrowBrush=new at(this._borderColor,!0)),this._arrowBrush}get pen(){return this._pen==null&&(this._pen=new Ce(this._borderColor,this._borderthickness,!0)),this._pen}get navigatorpen(){return this._navigatorpen==null&&(this._navigatorpen=new Ce(this._borderColor,1)),this._navigatorpen}get font(){return this._font}};m(ii,"Marker");var Di=ii;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"TextAlignEnumItem");let e=i;D.TextAlignEnumItem=e;let r=class r extends Le{};m(r,"TextAlign");let t=r;t.LEFT=new e("LEFT","Left"),t.CENTER=new e("CENTER","Center"),t.RIGHT=new e("RIGHT","Right"),D.TextAlign=t})(Di||(Di={}));var kn=class kn{get directParent(){return this._directParent}get userData(){return this._userData}set userData(e){this._userData=e}constructor(e,t){this._userData=null,this._title="",this._font=null,this._directParent=t,this._parentRenderer=e,this._font=new it(e,this,12,null)}get title(){return this._title}set title(e){this._title=e,this._parentRenderer.redraw()}get font(){return this._font}};m(kn,"Legend");var xn=kn,Pn=class Pn{get directParent(){return this._directParent}get zones(){return this._zones}AddZone(){let e=new nr(this._parentRenderer,this);return this._zones.push(e),e}get userData(){return this._userData}set userData(e){this._userData=e}get AxisChanged(){return this._AxisChanged}set AxisChanged(e){this._AxisChanged=e}constructor(e,t){this._userData=null,this._AxisChanged=null,this._pen=null,this._gridPen=null,this._visible=!0,this._AllowAutoShow=!1,this._min=Number.NaN,this._max=Number.NaN,this._step=Number.NaN,this._thickness=1,this._color=c.Black,this._showGrid=!1,this._gridColor=c.FromArgb(50,0,0,0),this._gridThickness=1,this._font=null,this._zones=[],this._directParent=t,this._parentRenderer=e,this._legend=new xn(e,this),this._font=new it(e,this)}get pen(){return this._pen==null&&(this._pen=new Ce(this._color,this._thickness,!0)),this._pen}get gridPen(){return this._gridPen==null&&(this._gridPen=new Ce(this._gridColor,this._gridThickness,!0)),this._gridPen}get visible(){return this._visible}set visible(e){this._visible=e,e||(this._AllowAutoShow=!1),this._parentRenderer.redraw()}get AllowAutoShow(){return this._AllowAutoShow}set AllowAutoShow(e){this._AllowAutoShow=e}AutoShow(){this._AllowAutoShow&&(this.visible=!0,this._AxisChanged!=null&&this._AxisChanged(this))}set_minMax(e,t){if(!isNaN(e)&&!isNaN(t)&&e>=t)throw new RangeError("Min ("+e.toString()+") cannot be greater than max ("+t.toString()+")");this._min=e,this._max=t,this._parentRenderer.redraw()}get min(){return this._min}set min(e){if(!isNaN(e)&&!isNaN(this._max)&&!W.minMaxCheckDisabled&&e>=this._max)throw new RangeError("Min cannot be greater than max ("+this._max.toString()+")");this._min=e,this._parentRenderer.redraw()}setMinMax(e,t){e<t&&(this._min=e,this._max=t,this._parentRenderer.redraw())}get max(){return this._max}set max(e){if(!isNaN(e)&&!isNaN(this._min)&&!W.minMaxCheckDisabled&&e<=this._min)throw new RangeError("Max cannot be less than min ("+this._min.toString()+")");this._max=e,this._parentRenderer.redraw()}get step(){return this._step}set step(e){if(!isNaN(e)&&e<0)throw new RangeError("Steps must be a strictely positive value");this._step=e,this._parentRenderer.redraw()}get thickness(){return this._thickness}set thickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._thickness=e,this._pen=null,this._parentRenderer.redraw()}get color(){return this._color}set color(e){this._color=e,this._pen=null,this._parentRenderer.redraw()}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,this._parentRenderer.redraw()}get gridColor(){return this._gridColor}set gridColor(e){this._gridColor=e,this._gridPen=null,this._parentRenderer.redraw()}get gridThickness(){return this._gridThickness}set gridThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._gridThickness=e,this._gridPen=null,this._parentRenderer.redraw()}get font(){return this._font}get legend(){return this._legend}};m(Pn,"GenericAxis");var as=Pn,Nn=class Nn{constructor(){this.dataMin=0,this.dataMax=0,this.absMin=0,this.absMax=0,this.step=0,this.start=0,this.stop=0,this.precision=0}};m(Nn,"StartStopStep");var os=Nn,cs=class cs{get relative(){return this._isRelative}set relative(e){this._isRelative=e}get value(){return this._value}set value(e){this._value=e}constructor(e,t,i){this._isRelative=!1,this._value=0,this._capture=!1,this._isRelative=t,this._value=e,this._capture=typeof i=="undefined"?!1:i}clone(){return new cs(this._value,this._isRelative,this._capture)}toString(){if(this._isRelative)return he.secTimeSpanToString(this._value,0);{let e=he.FromUnixTime(this._value),t=e.getFullYear().toString()+"-"+(e.getMonth()+1).toString()+"-"+e.getDate().toString()+" "+e.getHours().toString()+":",i=e.getMinutes().toString();i.length<=1&&(i="0"+i),t=t+i+":";let r=e.getSeconds(),s=e.getMilliseconds();return r=r+s/1e3,r<10&&(t=t+"0"),s==0?t=t+r.toString():t=t+r.toFixed(3),t}}TryParse(e){return this._isRelative?he.tryParseStringToSecTimeSpan(e):he.tryParseStringToAbsDateTime(e)}get capture(){return this._capture}set capture(e){this._capture=e}};m(cs,"xAxisPosition");var _t=cs;_t.DTdisplayformat="DD/MM/YY hh:mm:ss.ff";_t.TSdisplayformat="dd.hh:mm:ss.ff";var Ln=class Ln{constructor(){this.NumberDecimalSeparator="."}};m(Ln,"YNumberFormatInfo");var wn=Ln,_s=class _s extends as{constructor(e,t,i){super(e,t),this._index=0,this._highlightZero=!1,this._position=_s.HrzPosition.LEFT,this.innerWidth=0,this.zoom=0,this.IRLy=0,this._index=i,this.nfi=new wn,this.nfi.NumberDecimalSeparator=".",this.startStopStep=new os,this.startStopStep.start=0,this.startStopStep.stop=1,this.startStopStep.step=.1}get index(){return this._index}lockMinMax(){this._min=this.startStopStep.absMin,this._max=this.startStopStep.absMax,this._parentRenderer.redraw()}unlockMinMax(){this._min=Number.NaN,this._max=Number.NaN,this._parentRenderer.redraw()}get highlightZero(){return this._highlightZero}set highlightZero(e){this._highlightZero=e,this._parentRenderer.redraw()}get position(){return this._position}set position(e){this._position=e,this._parentRenderer.redraw()}computeStartAndStep(e){let t=new os,i=this.min,r=this.max;t.step=this.step,t.precision=0,Me.isDefined(e)||(e=Me.DefaultValue(),e.Min=0,e.Max=100),isNaN(i)&&(i=e.Min),isNaN(r)&&(r=e.Max),t.absMax=r,t.absMin=i,i==r&&(i-=.5,r+=.5),i!=0&&(i-=(r-i)*.025),r!=0&&(r+=(r-i)*.025),t.start=i,t.stop=r,t.dataMin=i,t.dataMax=r;let s=r-i;if(isNaN(t.step)){let n=Math.log10(s);n-Math.floor(n)!=0&&(n=Math.floor(n)+1),t.precision=n-1>>0;let o=Math.pow(10,t.precision),a=s/o;if(a<=2?(t.step=o/5,t.precision--):a<=5?(t.step=o/2,t.precision--):t.step=o,isNaN(this.min)){let l=i/t.step;l-Math.floor(l)!=0&&(l=l>0?Math.floor(l)+1:Math.floor(l)-1),t.start=t.step*l}}else{let n=t.step.toString(),o=n.indexOf(".");o>=0?t.precision=-(n.length-o-1):t.precision=0}return this.startStopStep=t,t}};m(_s,"YAxis");var Nt=_s;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"HrzPositionEnumItem");let e=i;D.HrzPositionEnumItem=e;let r=class r extends Le{};m(r,"HrzPosition");let t=r;t.LEFT=new e("LEFT","Left"),t.RIGHT=new e("RIGHT","Right"),D.HrzPosition=t})(Nt||(Nt={}));var lr=class lr extends as{get position(){return this._position}set position(e){this._position=e,this._parentRenderer.redraw()}get markers(){return this._markers}AddMarker(){let e=new Di(this._parentGraph,this);return this._markers.push(e),this._parentGraph.clearCachedObjects(),this._parentGraph.redraw(),e}get initialZoom(){return this._initialZoom}set initialZoom(e){if(e<=0)throw new RangeError("Zoom must be a positive value");this._initialZoom=e,this.min=this.min-this._initialZoom*this._initialOffset/100,this.max=this.min+this.initialZoom,this._parentRenderer.redraw()}get initialOffset(){return this._initialOffset}set initialOffset(e){this._initialOffset=e;let t=this._parentGraph.getMostRecentPoint();if(isNaN(t.x))this._min=this._min-this._initialZoom*this._initialOffset/100,this._max=this._min+this._initialZoom,this._parentRenderer.redraw();else{let i=this._max-this._min;this._min=t.x-i*this._initialOffset/100,this._max=this._min+i}this._parentRenderer.redraw()}get labelFormat(){return this._format}set labelFormat(e){this._format=e,this._parentRenderer.redraw()}constructor(e,t){super(e,t),this._position=lr.VrtPosition.BOTTOM,this._markers=[],this._initialZoom=300,this._initialOffset=0,this._format=lr.FORMATAUTO,this._timeReference=he.TimeReference.ABSOLUTE,this._zeroTime=0,this._fullSize=0,this.innerHeight=0,this._overflowHandling=lr.OverflowHandling.DONOTHING,this._parentGraph=e,this._markers=[],this.min=he.ToUnixTime(he.UTCNow()),this.max=this.min+this.initialZoom,this.step=30}get timeReference(){return this._timeReference}set timeReference(e){this._timeReference=e,this._parentRenderer.redraw()}get zeroTime(){return this._zeroTime}set zeroTime(e){this._zeroTime=e}get fullSize(){return this._fullSize}set fullSize(e){this._fullSize=e}bestFormat(e,t){return he.BestTimeformat(e,t,this._timeReference)}get overflowHandling(){return this._overflowHandling}set overflowHandling(e){this._overflowHandling=e}};m(lr,"XAxis");var ct=lr;ct.FORMATAUTO=0;(function(D){let s=class s extends De{constructor(h,u,_){super(h,u,t)}};m(s,"VrtPositionEnumItem");let e=s;D.VrtPositionEnumItem=e;let n=class n extends Le{};m(n,"VrtPosition");let t=n;t.TOP=new e("TOP","Top"),t.BOTTOM=new e("BOTTOM","Bottom"),D.VrtPosition=t;let o=class o extends De{constructor(h,u,_){super(h,u,r)}};m(o,"OverflowHandlingEnumItem");let i=o;D.OverflowHandlingEnumItem=i;let a=class a extends Le{};m(a,"OverflowHandling");let r=a;r.DONOTHING=new i("DONOTHING","Do nothing"),r.SCROLL=new i("SCROLL","Scroll contents"),r.CONTRACT=new i("CONTRACT","Squeeze contents"),D.OverflowHandling=r})(ct||(ct={}));var qi=class qi extends Se{constructor(e,t){super(e,t),this._panelHrzAlign=qi.HorizontalAlign.CENTERED,this._panelVrtAlign=qi.VerticalAlign.CENTERED,this._horizontalPosition=qi.HorizontalPosition.ABSOLUTEX,this._verticalPosition=qi.VerticalPosition.ABSOLUTEY,this._AbsoluteXposition=0,this._AbsoluteYposition=0,this._YScaleIndex=0}get panelHrzAlign(){return this._panelHrzAlign}set panelHrzAlign(e){this._panelHrzAlign=e,this._enabled&&this._parentRenderer.redraw()}get panelVrtAlign(){return this._panelVrtAlign}set panelVrtAlign(e){this._panelVrtAlign=e,this._enabled&&this._parentRenderer.redraw()}get horizontalPosition(){return this._horizontalPosition}set horizontalPosition(e){this._horizontalPosition=e,this._enabled&&this._parentRenderer.redraw()}get verticalPosition(){return this._verticalPosition}set verticalPosition(e){this._verticalPosition=e,this._enabled&&this._parentRenderer.redraw()}get AbsoluteXposition(){return this._AbsoluteXposition}set AbsoluteXposition(e){this._AbsoluteXposition=e,this._enabled&&this._parentRenderer.redraw()}get AbsoluteYposition(){return this._AbsoluteYposition}set AbsoluteYposition(e){this._AbsoluteYposition=e,this._enabled&&this._parentRenderer.redraw()}get yScaleIndex(){return this._YScaleIndex}set yScaleIndex(e){this._YScaleIndex=e,this._enabled&&this._parentRenderer.redraw()}};m(qi,"DataPanel");var Pt=qi;(function(D){let l=class l extends De{constructor(w,f,T){super(w,f,t)}};m(l,"HorizontalAlignEnumItem");let e=l;D.HorizontalAlignEnumItem=e;let h=class h extends Le{};m(h,"HorizontalAlign");let t=h;t.LEFTOF=new e("LEFTOF","Left"),t.CENTERED=new e("CENTERED","Center"),t.RIGHTOF=new e("RIGHTOF","Right"),D.HorizontalAlign=t;let u=class u extends De{constructor(w,f,T){super(w,f,r)}};m(u,"VerticalAlignEnumItem");let i=u;D.VerticalAlignEnumItem=i;let _=class _ extends Le{};m(_,"VerticalAlign");let r=_;r.ABOVE=new i("ABOVE","Top"),r.CENTERED=new i("CENTERED","Center"),r.BELOW=new i("BELOW","Bottom"),D.VerticalAlign=r;let d=class d extends De{constructor(w,f,T){super(w,f,n)}};m(d,"HorizontalPositionEnumItem");let s=d;D.HorizontalPositionEnumItem=s;let g=class g extends Le{};m(g,"HorizontalPosition");let n=g;n.LEFTBORDER=new s("LEFTBORDER","Left border"),n.ABSOLUTEX=new s("ABSOLUTEX","Absolute X position"),n.RIGHTBORDER=new s("RIGHTBORDER","Right borde"),D.HorizontalPosition=n;let y=class y extends De{constructor(w,f,T){super(w,f,a)}};m(y,"VerticalPositionEnumItem");let o=y;D.VerticalPositionEnumItem=o;let p=class p extends Le{};m(p,"VerticalPosition");let a=p;a.TOPBORDER=new o("TOPBORDER","Top border"),a.ABSOLUTEY=new o("ABSOLUTEY","Absolute Y position"),a.BOTTOMBORDER=new o("BOTTOMBORDER","Bottom border"),D.VerticalPosition=a})(Pt||(Pt={}));var Yn=class Yn{constructor(e){}get handle(){return"crosshair"}};m(Yn,"YCursor");var Rn=Yn,Mn=class Mn{constructor(e){this._value=0,this._value=e}toString(e){let t="",i=Math.abs(this._value/1e3),r=Math.floor(i),s=Math.round(1e3*(i-Math.floor(i)));if(e&ae.ms1){let n="00"+s.toString();t="."+n.substring(n.length-3).substring(0,1)}else if(e&ae.ms01){let n="00"+s.toString();t="."+n.substring(n.length-3).substring(0,2)}else if(e&ae.ms001){let n="00"+s.toString();t="."+n.substring(n.length-3).substring(0,3)}if(e&ae.s){let o="0"+(r%60).toString();t=o.substring(o.length-2)+t+"s"}if(r=Math.floor(r/60),e&ae.m){let o="0"+(r%60).toString();t=o.substring(o.length-2)+"m"+t}if(r=Math.floor(r/60),e&ae.h){let o="0"+(r%24).toString();t=o.substring(o.length-2)+"h"+t}if(r=Math.floor(r/24),e&ae.D){let n=r.toString();t=n.substring(n.length-2)+"d"+t}return t}};m(Mn,"YTimeSpan");var wi=Mn;wi.TicksPerSecond=1e3;var re=class re extends W{get legendPanel(){return this._legendPanel}get dataTracker(){return this._dataTracker}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._borderPen=null,this.redraw()}get borderThickness(){return this._borderThickness}set borderThickness(e){if(e<0)throw new RangeError("thickness must be a positive value");this._borderThickness=e,this._borderPen=null,this.redraw()}static get verticalDragZoomEnabled(){return re._defaultVerticalDragZoomEnabled}static set verticalDragZoomEnabled(e){re._defaultVerticalDragZoomEnabled=e}static createCaptureCursor(){if(re.captureCursor!=null)return;let e="iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALHRFWHRDcmVhdGlvbiBUaW1lAFRodSAyMCBBdWcgMjAyMCAxMjoxNTo1MCArMDEwMP38NhoAAAAHdElNRQfkCBQOJAvCrm0ZAAAACXBIWXMAAFxGAABcRgEUlENBAAAABGdBTUEAALGPC / xhBQAAAmVJREFUeNrtVrFuFDEQHd9eBImAIBFoAgVC0NJQUFDwL / QgRXzAfUz + Iy0pQwsIJAhCQMQBUS5c2DXv7T5fzN5qs / Fxdw0jPY3ttT3jt54ZmyXIYDDoQXnodWBV / SRJXZhJbwCXov65pZ + 4zklfBsZRf2EMxOuTjc / igIu0s0UygAvnonWZ0NP4fB2QkQz6yHvP / i76V4E1jZ / bic4LIuMnND7ZwDl + u4 / me + AnkKPvu + 7rFMNZBzZ64eRTm5w6sQ8cAcUZexVytOCpOnv7j + QdDD + CHgKjMg80nWpeQrYgd4A3wHjWPJAqN4BVoLcsB1ZMd25ZDkzkvwNLd6AMQ4XGIuXElKz6SAo3rYpLhsZKyyJmwu2WTLiF5g / g2NozIY1 / BkacRwaYkZgUPlr7L2EdeAhjLxpqwTOr0vAHOZG37FPIOO3mfXXG1qEWAGvM + TC6Rydk / KmMv7bmWlD / v95qtaCThGpo1TPsFvp7wBO0v4nBqWoYvR0yOeLFThHmdH4TcgGQy8i + hkn5V / WbSjGr7e9oD96372LJB1o7izbPtYHpPw7V / 8u4yvzFkvPTO3MXuMbx8JRPij8svgAcAw / EwCe0f8XGxZYFB6JQZzl + rHWj1Gf5WZLVTj5py5HbVoXjeF4OuMhYnQHKulW / x6U64CPtbfpVxQu7CX0PeicMov3cKup5EZmw / KwMFNb8pMtl5G3MhIyHkOX3PPUSMmXzOX7Fqsw35Gu5NidEwXWr / jnnD + XUFzLARJRaDXnCQ53o0BpSLzcXzQfAK + Cl9EEwXrKTyr1OWGa3sFnLvPDsn6Tg8P0PrBcSMR2NtfsAAAAASUVORK5CYII =";try{re.captureCursor=new Rn(atob(e))}catch(t){console.log("Cannot create custom cursor")}}get dataPanels(){return this._dataPanels}addDataPanel(){let e=new Pt(this,this);return this._dataPanels.push(e),e}setMarkerCaptureCallbacks(e,t){this._markerCaptureStartedCallback=e,this._markerCaptureStoppedCallback=t}startMarkerCapture(e){this._markerCaptureStartedCallback!=null&&this._markerCaptureStartedCallback(e),this.markerCapture=e,this.UIContainer.focus()}constructor(e,t){super(e,t),this._markerCaptureStartedCallback=null,this._markerCaptureStoppedCallback=null,this.lastPointCount=-1,this.lastTopMargin=-1,this.lastBottomMargin=-1,this.navigatorCache=null,this.markerCapture=null,this._borderPen=null,this._borderColor=c.LightGray,this._borderThickness=1,this._touchStartfct=null,this._touchMovefct=null,this._touchEndfct=null,this._mouseDownfct=null,this._mouseMovefct=null,this._mouseWheelfct=null,this._mouseKeyDownfct=null,this.mainViewPort=new jt,this._timeRange=null,this._bgBrush=null,this._bgColor1=c.FromArgb(255,200,200,200),this._bgColor2=c.FromArgb(255,255,255,255),this._touchStartPinchDistance=-1,this._touchStartPinchCenter=new ze(0,0),this._touchStartPinchZoom=1,this._touchStartPinchIRLx=0,this._touchStartPinchRange=0,this.dataTrackerRefreshtimeout=null,re.createCaptureCursor(),this._xAxis=new ct(this,this),this._yAxes=[],this._series=[],this._dataPanels=[],this._navigator=new Vi(this,this),this._legendPanel=new St(this,this),this._dataTracker=new dr(this,this),this._touchStartfct=o=>{this.TouchStart(this.UIContainer,o)},this._touchMovefct=o=>{this.TouchMove(this.UIContainer,o)},this._touchEndfct=o=>{this.TouchEnd(this.UIContainer,o)},this._mouseDownfct=o=>{this.MouseDown(this.UIContainer,o)},this._mouseMovefct=o=>{this.MouseMove(this.UIContainer,o)},this._mouseWheelfct=o=>{this.mouseWheelEvent(this.UIContainer,o)},this._mouseKeyDownfct=o=>{this.KeyDown(this.UIContainer,o)},this.UIContainer.addEventListener("touchstart",this._touchStartfct),this.UIContainer.addEventListener("touchmove",this._touchMovefct),this.UIContainer.addEventListener("touchend",this._touchEndfct),this.UIContainer.addEventListener("mousedown",this._mouseDownfct),this.UIContainer.addEventListener("mousemove",this._mouseMovefct),this.UIContainer.addEventListener("wheel",this._mouseWheelfct),this.UIContainer.addEventListener("keydown",this._mouseKeyDownfct),this._timeRange=Me.DefaultValue();let i=e.width,r=e.height,s=e.width,n=e.height}destroy(){this._touchStartfct!=null&&this.UIContainer.removeEventListener("touchstart",this._touchStartfct),this._touchMovefct!=null&&this.UIContainer.removeEventListener("touchstart",this._touchMovefct),this._touchEndfct!=null&&this.UIContainer.removeEventListener("touchstart",this._touchEndfct),this._mouseDownfct!=null&&this.UIContainer.removeEventListener("mousedown",this._mouseDownfct),this._mouseMovefct!=null&&this.UIContainer.removeEventListener("mousemove",this._mouseMovefct),this._mouseWheelfct!=null&&this.UIContainer.removeEventListener("wheel",this._mouseWheelfct),this._mouseKeyDownfct!=null&&this.UIContainer.removeEventListener("keydown",this._mouseKeyDownfct),super.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}getMostRecentPoint(){let e=new ot(NaN,NaN);for(let t=0;t<this._series.length;t++)if(!this.series[t].disabled){let i=this.series[t].getlastPoint();isNaN(i.x)||(isNaN(e.x)||i.x>e.x)&&(e=i)}return e}adjustGlobalTimeRange(e){let t=this._timeRange.Max;if(this._timeRange=Me.CombineWithNumber(this._timeRange,e),isNaN(t))return;let i=e-t;if(i>0)switch(this._xAxis.overflowHandling){case ct.OverflowHandling.SCROLL:t>this._xAxis.min+(this._xAxis.max-this._xAxis.min)*.85&&t<=this._xAxis.max&&(this.DisableRedraw(),this._xAxis.set_minMax(this._xAxis.min+i,this._xAxis.max+i),this.AllowRedraw());break;case ct.OverflowHandling.CONTRACT:t>this._xAxis.min+(this._xAxis.max-this._xAxis.min)*.95&&t<=this._xAxis.max&&(this.DisableRedraw(),this._xAxis.max+=i,this.AllowRedraw());break}}get bgColor1(){return this._bgColor1}set bgColor1(e){this._bgColor1=e,this._bgBrush=null,this.redraw()}get bgColor2(){return this._bgColor2}set bgColor2(e){this._bgColor2=e,this._bgBrush=null,this.redraw()}get xAxis(){return this._xAxis}get navigator(){return this._navigator}get yAxes(){return this._yAxes}get series(){return this._series}addYAxis(){let e=new Nt(this,this,this._yAxes.length);return this._yAxes.push(e),this.redraw(),e}addSerie(){let e=new Ri(this);return this._series.push(e),this.redraw(),e}clearCachedObjects(){this._bgBrush=null,this.navigatorCache=null}TouchStart(e,t){t.touches.length==1?this.HandleMouseDown(e,t.touches[0].pageX,t.touches[0].pageY):t.touches.length==2&&(t.preventDefault(),this.HandleEndOfMouseCapture(),this._touchStartPinchDistance=Math.sqrt(Math.pow(t.touches[1].pageX-t.touches[0].pageX,2)+Math.pow(t.touches[1].pageY-t.touches[0].pageY,2)),this._touchStartPinchCenter=new ze(t.touches[1].pageX+t.touches[0].pageX>>2,t.touches[1].pageY+t.touches[0].pageY>>2),this._touchStartPinchZoom=this.mainViewPort.zoomx,this._touchStartPinchIRLx=this.mainViewPort.IRLx,this._touchStartPinchRange=this._xAxis.max-this._xAxis.min)}MouseDown(e,t){t.buttons==2&&this.markerCapture!=null&&(this.markerCapture=null,this._markerCaptureStoppedCallback!=null&&this._markerCaptureStoppedCallback(null)),t.buttons==1&&this.HandleMouseDown(e,t.pageX,t.pageY)}HandleMouseDown(e,t,i){let r=this.Scr2ElmMatrix.multiplyByV(Ut.FromXYCoord(t,i)).toPoint(),s=r.X,n=r.Y;if(s>=this.mainViewPort.Lmargin&&s<=this.mainViewPort.Width-this.mainViewPort.Rmargin&&n>=this.mainViewPort.Tmargin&&n<=this.mainViewPort.Height-this.mainViewPort.Bmargin){if(this.markerCapture!=null){let a=re.ViewPortPointToIRL(this.mainViewPort,new ze(s,n));this.markerCapture.setCapturedPosition(a.x,this.xAxis),this._markerCaptureStoppedCallback!=null&&this._markerCaptureStoppedCallback(this.markerCapture),this.markerCapture=null;return}let o=re.ViewPortPointToIRL(this.mainViewPort,new ze(s,n));this.mainViewPort.OriginalXAxisMin=this.xAxis.min,this.mainViewPort.OriginalXAxisMax=this.xAxis.max,this.mainViewPort.OriginalIRLx=this.mainViewPort.IRLx,this.mainViewPort.OriginalLmargin=this.mainViewPort.Lmargin,this.mainViewPort.OriginalZoomx=this.mainViewPort.zoomx,this.mainViewPort.CaptureStartY=n,this.mainViewPort.IRLCaptureStartX=o.x,this.mainViewPort.Capture=!0}else if(s>=this._navigator.viewport.Lmargin&&s<=this._navigator.viewport.Width-this._navigator.viewport.Rmargin&&n>=this._navigator.viewport.Lmargin&&n<=this._navigator.viewport.Height-this._navigator.viewport.Bmargin){let o=re.ViewPortPointToIRL(this._navigator.viewport,new ze(s,n)),a=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Lmargin,0)),l=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Width-this.mainViewPort.Rmargin,0));if(o.x>=a.x&&o.x<=l.x)this._navigator.startCapture(o,this._xAxis.min,this._xAxis.max);else{this.DisableRedraw();let h=o.x-(l.x-a.x)/2,u=h+(l.x-a.x);this._xAxis.set_minMax(h,u),this.AllowRedraw(),this.Draw(0)}}}TouchMove(e,t){if(t.touches.length==1)t.preventDefault(),this.HandleMouseMove(e,t.touches[0].pageX,t.touches[0].pageY);else if(t.touches.length==2){t.preventDefault();let r=Math.sqrt(Math.pow(t.touches[1].pageX-t.touches[0].pageX,2)+Math.pow(t.touches[1].pageY-t.touches[0].pageY,2))/this._touchStartPinchDistance,s=this._touchStartPinchZoom*r;if(s>this.mainViewPort.zoomx&&s>1e3)return;let n=this._xAxis.max-this._xAxis.min;this.mainViewPort.IRLx=this._touchStartPinchIRLx+(this._touchStartPinchCenter.X-this.mainViewPort.Lmargin)/this._touchStartPinchZoom-(this._touchStartPinchCenter.X-this.mainViewPort.Lmargin)/s,this._xAxis.set_minMax(this.mainViewPort.IRLx,this.mainViewPort.IRLx+this._touchStartPinchRange/r),this.mainViewPort.zoomx=s,this.redraw()}}TouchEnd(e,t){this.HandleEndOfMouseCapture()}MouseMove(e,t){t.buttons!=1&&(this.mainViewPort.Capture||this._navigator.Capture)&&this.HandleEndOfMouseCapture(),this.HandleMouseMove(e,t.pageX,t.pageY),this.dataTracker.enabled&&(this.dataTrackerRefreshtimeout!=null&&clearTimeout(this.dataTrackerRefreshtimeout),this.dataTrackerRefreshtimeout=setTimeout(()=>{this.redraw()},100))}HandleEndOfMouseCapture(){this.mainViewPort.Capture=!1,this._navigator.stopCapture(),this._dataTracker.enabled&&this.redraw()}HandleMouseMove(e,t,i){let r=this.Scr2ElmMatrix.multiplyByV(Ut.FromXYCoord(t,i)).toPoint(),s=r.X,n=r.Y;if(this.markerCapture!=null?s>this.mainViewPort.Lmargin&&s<this.mainViewPort.Width-this.mainViewPort.Rmargin&&n>this.mainViewPort.Tmargin&&n<this.mainViewPort.Height-this.mainViewPort.Bmargin?this.UIContainer.style.cursor!=re.captureCursor.handle&&this.UIContainer.style.cursor!="crosshair"&&(this.UIContainer.style.cursor=re.captureCursor!=null?re.captureCursor.handle:"crosshair"):this.UIContainer.style.cursor!="default"&&(this.UIContainer.style.cursor="default"):this.UIContainer.style.cursor!="default"&&(this.UIContainer.style.cursor="default"),this.mainViewPort.Capture){let a=this.mainViewPort.OriginalIRLx+(s-this.mainViewPort.OriginalLmargin)/this.mainViewPort.OriginalZoomx-this.mainViewPort.IRLCaptureStartX,l=n-this.mainViewPort.CaptureStartY;this.DisableRedraw();let h=(this.mainViewPort.OriginalXAxisMax-this.mainViewPort.OriginalXAxisMin)/2,u=(this.mainViewPort.OriginalXAxisMax+this.mainViewPort.OriginalXAxisMin)/2,_=re._defaultVerticalDragZoomEnabled&&Math.abs(l)>10?Math.pow(1.01,l):1;this._xAxis.set_minMax(u-h*_-a,u+h*_-a),this.AllowRedraw(),this.redraw();return}if(this._navigator.viewport.Capture){let a=this._navigator.viewport.OriginalIRLx+(s-this._navigator.viewport.OriginalLmargin)/this._navigator.viewport.OriginalZoomx-this._navigator.viewport.IRLCaptureStartX;this.DisableRedraw(),this._xAxis.set_minMax(this._navigator.viewport.OriginalXAxisMin+a,this._navigator.viewport.OriginalXAxisMax+a),this.AllowRedraw(),this.redraw();return}}cross(e){}static IRLPointToViewPort(e,t,i,r){if(i===void 0){let o=e.Lmargin+Math.round((t.x-e.IRLx)*e.zoomx),a=e.Height-e.Bmargin-Math.round((t.y-e.IRLy)*e.zoomy);return new ze(o>>0,a>>0)}let s=e.Lmargin+Math.round((t.x-e.IRLx)*e.zoomx),n=e.Height-e.Bmargin-Math.round((t.y-i)*r);return new ze(s>>0,n>>0)}static IRLPointSummaryToViewPort(e,t,i,r){if(i===void 0){let l=e.Lmargin+Math.round((t.x1-e.IRLx)*e.zoomx),h=e.Height-e.Bmargin-Math.round((t.ymin-e.IRLy)*e.zoomy),u=e.Lmargin+Math.round((t.x2-e.IRLx)*e.zoomx),_=e.Height-e.Bmargin-Math.round((t.ymax-e.IRLy)*e.zoomy);return new Ir(l,h,u,_)}let s=e.Lmargin+Math.round((t.x1-e.IRLx)*e.zoomx),n=e.Height-e.Bmargin-Math.round((t.ymin-i)*r),o=e.Lmargin+Math.round((t.x2-e.IRLx)*e.zoomx),a=e.Height-e.Bmargin-Math.round((t.ymax-i)*r);return new Ir(s,n,o,a)}static ViewPortPointToIRL(e,t,i,r){return i===void 0?new ot(e.IRLx+(t.X-e.Lmargin)/e.zoomx,e.IRLy+(+e.Height-t.Y-e.Bmargin)/e.zoomy):new ot(e.IRLx+(t.X-e.Lmargin)/e.zoomx,i+(+e.Height-t.Y-e.Bmargin)/r)}static FindMinMax(e,t,i,r){let s=Me.DefaultValue();if(i[0].x>t||i[r-1].x<e)return s;let n=0,o=0,a=0;if(i[0].x<e){for(n=0,o=r-1;o-n>1;){let h=n+o>>1;i[h].x>e?o=h:n=h}a=n-1,a<0&&(a=0)}let l=r-1;if(i[l]===void 0)debugger;if(i[l].x>t){for(n=0,o=r-1;o-n>1;){let h=n+o>>1;i[h].x<t?n=h:o=h}l=o+1,l>r-1&&(l=r-1)}s.Min=i[a].y,s.Max=i[a].y;for(let h=a+1;h<=l;h++)i[h].y<s.Min&&(s.Min=i[h].y),i[h].y>s.Max&&(s.Max=i[h].y);return s}resetlegendPens(){for(let e=0;e<this._series.length;e++)this._series[e].resetlegendPen()}drawLegendPanel(e,t,i,r){let s=1.25;if(!this._legendPanel.enabled)return;let n=new Array(this._series.length),o=new Array(this._series.length),a=new Array(this._series.length),l=new Array(this._series.length),h=new Array(this._series.length),u=0,_=0,d=0,g=0;e.TextRenderingHint=Ye.SingleBitPerPixelGridFit,e.SetClip(new le(0,0,t,i));for(let T=0;T<this._series.length;T++)this._series[T].legend!=""?h[T]=this._series[T].legend:h[T]="Series "+(T+1).toString();if(this._legendPanel.position==St.Position.TOP||this._legendPanel.position==St.Position.BOTTOM){let T=t-2*this._legendPanel.padding+this._legendPanel.borderthickness;this._legendPanel.overlap&&(T=T-r.Lmargin-r.Rmargin),u=0;let R=0,P=0;for(let I=0;I<this._series.length;I++)if(this._series[I].segments.length>0&&this._series[I].visible&&!this._series[I].disabled){let F=e.MeasureString(h[I],this._legendPanel.font,1e5);o[I]=F.height+1;let z=F.width+20;R==0&&(u+=F.height),T-R<z?R==0?(a[I]=R,l[I]=P,P+=F.height,d<z&&(d=z)):(P+=F.height,a[I]=0,l[I]=P,R=z,u+=F.height,d<R&&(d=R)):(a[I]=R,l[I]=P,R+=z,d<R&&(d=R))}_>T&&(_=T)}else{let T=0;for(let R=0;R<this._series.length;R++)if(this._series[R].segments.length>0&&this._series[R].visible&&!this._series[R].disabled){let P=e.MeasureString(h[R],this._legendPanel.font,1e5);n[R]=P.width+1,d<n[R]+20&&(d=n[R]+20),o[R]=P.height+1,g<o[R]&&(g=o[R]),a[R]=0,l[R]=T,T+=P.height*s,u+=R==0?P.height:P.height*s}}let y=d+2*this._legendPanel.padding+this._legendPanel.borderthickness,p=u+2*this._legendPanel.padding+this._legendPanel.borderthickness,x=0,w=0;switch(this._legendPanel.position){case St.Position.LEFT:x=this._legendPanel.horizontalMargin,this._legendPanel.overlap?(x+=r.Lmargin,w=r.Tmargin+(i-r.Tmargin-r.Bmargin-p)/2):(r.Lmargin+=y+2*this.legendPanel.horizontalMargin+this.legendPanel.borderthickness>>0,w=(i-p)/2);break;case St.Position.TOPLEFT:x=this._legendPanel.horizontalMargin,w=this._legendPanel.verticalMargin,this._legendPanel.overlap?(x+=r.Lmargin,w+=r.Tmargin):r.Lmargin+=y+2*this.legendPanel.horizontalMargin+this.legendPanel.borderthickness>>0;break;case St.Position.TOP:this._legendPanel.overlap?(x=r.Lmargin+(t-r.Lmargin-r.Rmargin-y)/2-this._legendPanel.horizontalMargin-this._legendPanel.borderthickness,w=r.Tmargin+this._legendPanel.verticalMargin-this._legendPanel.borderthickness):(x=(t-y)/2-this._legendPanel.horizontalMargin-this._legendPanel.borderthickness,w=this._legendPanel.verticalMargin+this._legendPanel.borderthickness,r.Tmargin+=u+this._legendPanel.verticalMargin+2*this._legendPanel.verticalMargin+this._legendPanel.borderthickness>>0);break;case St.Position.TOPRIGHT:x=t-this._legendPanel.horizontalMargin-y,w=this._legendPanel.verticalMargin,this._legendPanel.overlap?(x-=r.Rmargin,w+=r.Tmargin):r.Rmargin+=y+2*this._legendPanel.horizontalMargin+this._legendPanel.borderthickness>>0;break;case St.Position.RIGHT:x=t-this._legendPanel.horizontalMargin-y,this._legendPanel.overlap?(x-=r.Rmargin,w=r.Tmargin+(i-r.Tmargin-r.Bmargin-p)/2):(r.Rmargin+=y+2*this._legendPanel.horizontalMargin+this._legendPanel.borderthickness>>0,w=(i-p)/2);break;case St.Position.BOTTOMRIGHT:x=t-this._legendPanel.horizontalMargin-y,this._legendPanel.overlap?(x-=r.Rmargin,w=i-r.Bmargin-p-this._legendPanel.verticalMargin):(r.Rmargin+=y+2*this._legendPanel.horizontalMargin+this._legendPanel.borderthickness>>0,w=i-this._legendPanel.verticalMargin-p);break;case St.Position.BOTTOM:this._legendPanel.overlap?(x=r.Lmargin+(t-r.Lmargin-r.Rmargin-y)/2-this._legendPanel.horizontalMargin-this._legendPanel.borderthickness,w=i-r.Bmargin-u-2*this._legendPanel.padding-2*this._legendPanel.verticalMargin-this._legendPanel.borderthickness):(x=(t-y)/2-this._legendPanel.horizontalMargin-this._legendPanel.borderthickness,w=i-this._legendPanel.verticalMargin-2*this._legendPanel.padding-this._legendPanel.borderthickness-u,r.Bmargin+=u+2*this._legendPanel.padding+2*this._legendPanel.verticalMargin+this._legendPanel.borderthickness);break;case St.Position.BOTTOMLEFT:x=this._legendPanel.horizontalMargin,w=this._legendPanel.verticalMargin,this._legendPanel.overlap?(x+=r.Lmargin,w=i-r.Bmargin-p-this._legendPanel.verticalMargin):(r.Lmargin+=y+2*this._legendPanel.horizontalMargin+this._legendPanel.borderthickness,w=i-this._legendPanel.verticalMargin-p);break}let f=new le(x>>0,w>>0,y>>0,p>>0);e.FillRectangle(this._legendPanel.bgBrush,f),e.DrawRectangle(this._legendPanel.pen,f),e.TextRenderingHint=Ye.AntiAlias;for(let T=0;T<this._series.length;T++)if(this._series[T].segments.length>0&&this._series[T].visible&&!this._series[T].disabled){e.DrawStringXY(h[T],this._legendPanel.font,this._legendPanel.font.brush,x+a[T]+20+this._legendPanel.padding>>0,w+l[T]+this._legendPanel.padding>>0);let R=x+a[T]+this._legendPanel.borderthickness/2+this._legendPanel.padding+6>>0,P=w+l[T]+this._legendPanel.padding+o[T]/2>>0;e.DrawLine(this._series[T].legendPen,new me(R,P),new me(R+12,P))}}static DoSegmentRendering(e,t,i,r,s,n,o){if(r[0].x>o||r[s-1].x<n)return 0;let a=t instanceof ei,l=0,h=0,u=0;if(r[0].x<n){for(l=0,h=s-1;h-l>1;){let d=l+h>>1;r[d].x>n?h=d:l=d}u=l-1,u<0&&(u=0)}let _=s-1;if(r[_].x>o){for(l=0,h=s-1;h-l>1;){let d=l+h>>1;r[d].x<o?l=d:h=d}_=h+1,_>s-1&&(_=s-1)}if(_-u>2*e.Width-e.Lmargin-e.Rmargin){let d=new Array(3*(_-u+1)),g=re.IRLPointToViewPort(e,r[u]),y,p=u+1,x=0,w,f,T;for(;p<_;){d[x++]=new me(g.X,g.Y),f=r[p].y,w=f,T=re.ViewPortPointToIRL(e,new ze(g.X+1,g.Y+1)).x;do r[p].y>w&&(w=r[p].y),r[p].y<f&&(f=r[p].y),p++;while(p<_&&r[p].x<T);let R=re.IRLPointToViewPort(e,new ot(r[p].x,f)),P=re.IRLPointToViewPort(e,new ot(r[p].x,w));Math.abs(R.Y-P.Y)>2&&(d[x++]=new me(R.X,R.Y),d[x++]=new me(P.X,P.Y)),g=re.IRLPointToViewPort(e,r[p])}return d[x++]=g,d=d.slice(0,x),x>1&&t.DrawLines(i,d),x}else if(a){let d=new Array(_-u+1);for(let g=u;g<=_;g++)d[g-u]=re.IRLPointToViewPort(e,r[g]);t.DrawLines(i,d)}else for(let d=u;d<_;d++)t.DrawLine(i,re.IRLPointToViewPort(e,r[d]),re.IRLPointToViewPort(e,r[d+1]));return _-u}static DoSummarySegmentRendering(e,t,i,r,s,n,o,a){let l=new Array(2*s+1),h=0;if(s>0){if(r[0].x1>a||r[s-1].x2<o)return 0;let u=t instanceof ei,_=0,d=0,g=0;if(r[0].x1<o){for(_=0,d=s-1;d-_>1;){let U=_+d>>1;r[U].x1>o?d=U:_=U}g=_-1,g<0&&(g=0)}let y=s-1;if(r[y].x2>a){for(_=0,d=s-1;d-_>1;){let U=_+d>>1;r[U].x2<a?_=U:d=U}y=d+1,y>s-1&&(y=s-1)}let p,x,w=g,f,T,R;p=re.IRLPointSummaryToViewPort(e,r[w]),l[h++]=new me(p.X1,p.YMIN);let P=p.YMAX,I=p.YMIN,F=p.X1,z=0;for(;w<=y;)p=re.IRLPointSummaryToViewPort(e,r[w]),P>p.YMAX&&(P=p.YMAX),I<p.YMIN&&(I=p.YMIN),z++,p.X2>F&&(l[h++]=new me(F,P),I-P>2&&(l[h++]=new me(F+p.X2>>1,I)),F=p.X2,P=p.YMAX,I=p.YMIN,z=0),w++;z>0&&(l[h++]=new me(F,p.YMIN),l[h++]=new me(F+p.X2>>1,p.YMAX))}if(n){let u=re.IRLPointSummaryToViewPort(e,n);l[h++]=new me(u.X1,u.YMIN),l[h++]=new me(u.X2,u.YMAX)}return h>1&&(l=l.slice(0,h),t.DrawLines(i,l)),h}DrawYAxisZones(e,t,i){if(!i.visible)return;let s=(i.startStopStep.dataMax-i.startStopStep.dataMin)/(e.Height-e.Bmargin-e.Tmargin);for(let n=0;n<i.zones.length;n++)if(i.zones[n].visible){let o=i.zones[n].max,a=i.zones[n].min;if(Number.isNaN(o)&&(o=i.startStopStep.dataMax),Number.isNaN(a)&&(a=i.startStopStep.dataMin),o<a){let u=o;o=a,a=u}let l=e.Height-e.Bmargin-Math.round((o-i.startStopStep.dataMin)/s)>>0,h=Math.round((o-a)/s)>>0;t.FillRectangleXYHW(i.zones[n].zoneBrush,this.mainViewPort.Lmargin,l,this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin+1,h)}}DrawXAxisZones(e,t,i){if(!i.visible)return;let s=(i.max-i.min)/(e.Width-e.Lmargin-e.Rmargin);for(let n=0;n<i.zones.length;n++)if(i.zones[n].visible){let o=i.zones[n].max,a=i.zones[n].min;if(Number.isNaN(o)&&(o=i.min),Number.isNaN(a)&&(a=i.max),o<a){let h=o;o=a,a=h}let l=e.Lmargin+Math.round((a-i.min)/s)>>0;t.FillRectangleXYHW(i.zones[n].zoneBrush,l,this.mainViewPort.Tmargin,(o-a)/s>>0,this.mainViewPort.Height-this.mainViewPort.Tmargin-this.mainViewPort.Bmargin)}}static DrawYAxis(e,t,i,r,s){if(!i.visible)return i.innerWidth=0,i.innerWidth;let n=i.startStopStep.dataMax-i.startStopStep.dataMin,o=n/(e.Height-e.Bmargin-e.Tmargin),a=i.position==Nt.HrzPosition.LEFT,l=a?e.Lmargin-r:e.Width-e.Rmargin+r;s||t.DrawLineXY(i.pen,l,e.Tmargin,l,e.Height-e.Bmargin);let h=new qe(16384);h.LineAlignment=1,h.Alignment=a?2:0;let u=i.startStopStep.step*Math.floor(i.startStopStep.start/i.startStopStep.step);u<0&&(u-=i.startStopStep.step);let _=((n-(u-i.startStopStep.dataMin))/i.startStopStep.step>>0)+1;s||(t.TextRenderingHint=Ye.AntiAlias);let d=0,g=0;if(i.startStopStep.precision<0&&(g=-i.startStopStep.precision),_<e.Height)for(let y=0;y<_;y++){let p=Math.round((u+y*i.startStopStep.step-i.startStopStep.dataMin)/o)>>0;if(p>=0){p=e.Height-e.Bmargin-p;let x=u+y*i.startStopStep.step;s||(i.showGrid&&(y>0||i.startStopStep.dataMin!=0)&&t.DrawLineXY(i.gridPen,e.Lmargin,p,e.Width-e.Rmargin,p),Math.abs(x)<1e-6&&i.highlightZero&&t.DrawLineXY(i.pen,e.Lmargin,p,e.Width-e.Rmargin,p),t.DrawLineXY(i.pen,l+(a?-2:2),p,l+(a?5:-5),p));let w=x.toFixed(g),f=t.MeasureString(w,i.font,1e5);if(f.width>d&&(d=f.width),!s){let T=new ze(l+(a?-3:3),p);t.DrawStringPF(w,i.font,i.font.brush,T,h)}}}if(i.legend.title!=""){let y=t.MeasureString(i.legend.title,i.legend.font,1e5);if(!s){let p=new qe(16384);p.Alignment=1,p.LineAlignment=1,p.Trimming=0;let x=l+(a?-d-y.height:d+y.height+2)>>0,w=e.Tmargin+(e.Height-e.Tmargin-e.Bmargin)/2>>0;t.Transform(x,w,a?-Math.PI/2:Math.PI/2),t.DrawStringPF(i.legend.title,i.legend.font,i.legend.font.brush,new ze(0,0),p),t.ResetTransform()}d+=y.height}return i.innerWidth=(d>>0)+10,i.innerWidth}DrawMonitorXAxis(e,t,i,r){let s=i.Max-i.Min,n=he.BestTimeformat(s,s,this.xAxis.timeReference),o=s/(e.Width-e.Lmargin-e.Rmargin),a=(s/n.step>>0)+2,l=n.step*Math.floor(i.Min/n.step);l<i.Min&&(l+=n.step),t.TextRenderingHint=Ye.AntiAlias;let h=e.Height-e.Bmargin;t.DrawLineXY(this._navigator.pen,e.Lmargin,e.Height-e.Bmargin-1,e.Width-e.Rmargin,e.Height-e.Bmargin-1);let u,_=l;do{let d=he.FromUnixTime(_);if(n.step>31.1*86400&&(_=he.ToUnixTime(new Date(d.getFullYear(),d.getMonth(),1))),_>=i.Min){let g=e.Lmargin+Math.round((_-i.Min)/o);t.DrawLineXY(this._navigator.pen,g,h,g,h-4),r==ct.FORMATAUTO?u=he.FromUnixTime(_).ToString(n.format):u=he.FromUnixTime(_).ToString(r);let y=t.MeasureString(u,this._navigator.font,1e5);t.DrawString(u,this._navigator.font,this._navigator.font.brush,new ze(g-y.width/2,h-y.height-1))}_+=n.step}while(_<i.Max)}static XLabel(e,t,i,r){let s;if(t.timeReference==he.TimeReference.ABSOLUTE)t.labelFormat==ct.FORMATAUTO?s=he.FromUnixTime(e).ToString(i.format):s=e.toString();else{let n=wi.TicksPerSecond*(Math.round(1e3*(e-t.zeroTime))/1e3);s=n<0?"-"+new wi(-n).toString(i.format):new wi(n).toString(i.format)}return s}DrawXAxis(e,t,i,r){if(e.Width-e.Rmargin-e.Lmargin<10)return 1;let s=new qe(16384);s.Alignment=1;let n=i.position==ct.VrtPosition.BOTTOM,o=n?e.Height-e.Bmargin:e.Tmargin;r||t.DrawLineXY(i.pen,e.Lmargin,o,e.Width-e.Rmargin,o);let a=i.max-i.min,l=a/(e.Width-e.Lmargin-e.Rmargin),h=(a/i.step>>0)+1,u=0,_=Me.DefaultValue();for(let P=0;P<this._series.length;P++)this._series[P].disabled||(_=Me.Combine(_,this._series[P].timeRange));if(i.zeroTime=_.Min,i.timeReference==he.TimeReference.ABSOLUTE)u=i.step*Math.floor(i.min/i.step),_.Min=i.min,_.Max=i.max;else{if(Number.isNaN(_.Min))return 0;u=_.Min+i.step*Math.floor((i.min-i.zeroTime)/i.step)}u<i.min&&(u+=i.step);let d=0;i.timeReference!=he.TimeReference.ABSOLUTE&&(d=u),i.fullSize=_.Max-_.Min;let g=i.bestFormat(_.Max-_.Min,i.max-i.min);r||(t.TextRenderingHint=Ye.AntiAlias);let y=0,p;i.step=g.step;let x=parseFloat(u.toString());p=re.XLabel(x,i,g,_);let w=t.MeasureString(p,i.font,1e5),f=1;for(;f*(e.Width-e.Rmargin-e.Lmargin)/h<w.width;)f++;let T=Math.round((x-d)/i.step)>>0,R=0;do{let P=he.FromUnixTime(x);if(i.step>32*86400&&i.timeReference==he.TimeReference.ABSOLUTE){if(i.step>=365*86400){let I=P.getMonth();x=he.ToUnixTime(new Date(P.getFullYear()+(I>5?1:0),0,1))}else x=he.ToUnixTime(new Date(P.getFullYear(),P.getMonth(),1));if(x<R)debugger}if(x>=i.min){let I=e.Lmargin+Math.round((x-i.min)/l)>>0;I<=e.Width-e.Rmargin&&(r||(i.showGrid&&t.DrawLineXY(i.gridPen,I,e.Tmargin,I,e.Height-e.Bmargin),t.DrawLineXY(i.pen,I,o+(n?2:-2),I,o+(n?-5:5))),p=re.XLabel(x,i,g,_),w=t.MeasureString(p,i.font,1e5),w.height>y&&(y=w.height),r||T%f==0&&t.DrawStringPF(p,i.font,i.font.brush,new me(I,o+(n?5:-w.height>>0)-2),s))}if(R=x,x+=i.step,x<R)debugger;T++}while(x<=i.max);if(i.legend.title!=""){let P=t.MeasureString(i.legend.title,i.legend.font,1e5);if(!r){let I=e.Lmargin+(e.Width-e.Lmargin-e.Rmargin-P.width)/2>>0,F=n?e.Height-e.Bmargin+y+5:e.Tmargin-y-P.height*1.5;t.DrawString(i.legend.title,i.legend.font,i.legend.font.brush,new me(I,F))}y+=P.height>>0}return i.innerHeight=(y>>0)+10,i.innerHeight}pixelxSize(e,t){let i=t.max-t.min,r=e.Width-e.Lmargin-e.Rmargin;return r>0?i/r:0}TimeToAutoSting(e,t,i){let r="",s=i.max-i.min,n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(s>0){let o=this.pixelxSize(t,i);if(o>0)if(i.timeReference==he.TimeReference.ABSOLUTE){let a=he.FromUnixTime(e),l=n[a.getMonth()],h=a.getDate().toString(),u=a.getHours().toString();u.length<2&&(u="0"+u);let _=a.getMinutes().toString();_.length<2&&(_="0"+_);let d=a.getSeconds().toString();d.length<2&&(d="0"+d);let g=Math.round(a.getMilliseconds()/10).toString();g.length<2&&(g="0"+d);let y=Math.round(a.getMilliseconds()/100).toString();s>=86400&&(r+=l+" "+h),o<.1?r+=(r!=""?" ":"")+u+":"+_+":"+d+"."+g:o<1?r+=(r!=""?" ":"")+u+":"+_+":"+d+"."+y:o<60?r+=(r!=""?" ":"")+u+":"+_+":"+d:o<3600?r+=(r!=""?" ":"")+u+":"+_:o<86400&&(r+=(r!=""?" ":"")+u+"H")}else{let a=he.RelativeFormat(i.fullSize,s,o),l=wi.TicksPerSecond*(Math.round(100*(e-i.zeroTime))/100);r+=l<0?"-"+new wi(-l).toString(a):new wi(l).toString(a)}}return r}DrawDataTracker(e,t,i,r){if(!this._dataTracker.enabled)return;let s=this.mouseLocalPosition();if(s==null||s.X<=this.mainViewPort.Lmargin||s.Y<=this.mainViewPort.Tmargin||s.X>=this.UIContainer.width-this.mainViewPort.Rmargin||s.Y>=this.UIContainer.height-this.mainViewPort.Bmargin)return;e.SetClip(new le(0,0,t,i));let n=re.ViewPortPointToIRL(this.mainViewPort,s),o=-1,a=-1,l=new Array(this._series.length),h=new Array(this._series.length);for(let u=0;u<this._series.length;u++)if(this._series[u].visible&&!this._series[u].disabled){let _=this._series[u].findClosestValue(n.x,!1);_!=null&&(h[u]=_,l[u]=re.IRLPointToViewPort(this.mainViewPort,h[u],this.yAxes[this._series[u].yAxisIndex].IRLy,this.yAxes[this._series[u].yAxisIndex].zoom),(a<0||o>Math.abs(l[u].Y-s.Y))&&(o=Math.abs(l[u].Y-s.Y),(this._dataTracker.detectionDistance==0||o<=this._dataTracker.detectionDistance&&Math.abs(l[u].X-s.X)<this._dataTracker.detectionDistance)&&(a=u)))}if(a>=0){let u=l[a].X-this._dataTracker.diameter/2>>0,_=l[a].Y-this._dataTracker.diameter/2>>0,d=this._dataTracker.diameter;e.FillEllipse(this._series[a].brush,u,_,d,d),e.DrawEllipse(this._dataTracker.pen,u,_,d,d);let g,y;s.X>this.mainViewPort.Lmargin+(t-this.mainViewPort.Lmargin-this.mainViewPort.Rmargin)/2?g=-1:g=1,s.Y>this.mainViewPort.Tmargin+(i-this.mainViewPort.Tmargin-this.mainViewPort.Bmargin)/2?y=-1:y=1;let p=l[a].X+g*(this._dataTracker.handleLength*1.5)>>0,x=l[a].Y+y*this._dataTracker.handleLength>>0;e.DrawLineXY(this._dataTracker.pen,l[a].X+g*.707*this._dataTracker.diameter/2>>0,l[a].Y+y*.707*this._dataTracker.diameter/2>>0,l[a].X+g*this._dataTracker.handleLength>>0,l[a].Y+y*this._dataTracker.handleLength>>0),e.DrawLineXY(this._dataTracker.pen,l[a].X+g*this._dataTracker.handleLength>>0,l[a].Y+y*this._dataTracker.handleLength>>0,p,x);let w="";if(this._dataTracker.showSerieName&&(w+=this._series[a].legend+`\r
`),this._dataTracker.showTimeStamp){let P=h[a].x;w+=this.TimeToAutoSting(P,this.mainViewPort,r)+`\r
`}if(this._dataTracker.dataPrecision.toString==dr.DataPrecision.PRECISION_NOLIMIT.toString)w+=h[a].y.toString()+this._series[a].unit;else{let P=this._dataTracker.dataPrecision.description,I=-Math.log10(Number(P));w+=h[a].y.toFixed(I)+this._series[a].unit}let f=e.MeasureString(w,this._dataTracker.font,1e4),T=f.width+2*this._dataTracker.padding+this._dataTracker.borderthickness,R=f.height+2*this._dataTracker.padding+this._dataTracker.borderthickness;g>0?(e.FillRectangleXYHW(this._dataTracker.bgBrush,p,x-(R>>1),T,R),e.DrawRectangleXYHW(this._dataTracker.pen,p,x-(R>>1),T,R),e.DrawStringXY(w,this._dataTracker.font,this._dataTracker.font.brush,p+this._dataTracker.padding>>0,x-(R>>1)+this._dataTracker.padding>>0)):(e.FillRectangleXYHW(this._dataTracker.bgBrush,p-T,x-(R>>1),T,R),e.DrawRectangleXYHW(this._dataTracker.pen,p-T,x-(R>>1),T,R),e.DrawStringXY(w,this._dataTracker.font,this.dataTracker.font.brush,p+this._dataTracker.padding-T>>0,x-(R>>1)+this._dataTracker.padding>>0))}}DrawMarkers(e,t,i,r,s){if(this._xAxis.markers.length==0)return;t.SetClip(new le(e.Lmargin,e.Tmargin,e.Width-e.Rmargin-e.Lmargin,e.Height-e.Bmargin-e.Tmargin));let n=re.ViewPortPointToIRL(e,new ze(e.Lmargin,e.Height-e.Bmargin)),o=re.ViewPortPointToIRL(e,new ze(e.Width-e.Rmargin,e.Tmargin)),a=(e.Height-e.Bmargin-e.Tmargin)/100,l=-1;t.TextRenderingHint=Ye.AntiAlias;for(let h=0;h<this._xAxis.markers.length;h++)if(this._xAxis.markers[h].enabled){l<0&&(l=this.pixelxSize(this.mainViewPort,i));let u=!0,_=0;if(this._xAxis.markers[h].timereference==he.TimeReference.RELATIVE?this._xAxis.zeroTime>0?_=this._xAxis.markers[h].xposition+this._xAxis.zeroTime:u=!1:_=this._xAxis.markers[h].xposition,_>n.x-100*l&&_<o.x+100*l&&u){let g=re.IRLPointToViewPort(e,new ot(_,0)).X>>0,y=e.Height-e.Bmargin-this._xAxis.markers[h].yposition*a>>0,p=this._xAxis.markers[h].text.replace("\\n",`
`),x=new Date;if(p.indexOf("$")>=0){if(p.indexOf("$MARKERTIME$")>=0){let P=this._xAxis.markers[h].timereference==he.TimeReference.RELATIVE?he.secTimeSpanToString(this._xAxis.markers[h].xposition,l):this.TimeToAutoSting(this._xAxis.markers[h].xposition,this.mainViewPort,i);p=p.replace("$MARKERTIME$",P)}if(p.indexOf("$VALUE")>=0)for(let P=0;P<this._series.length;P++)if(this._series[P].disabled)p=p.replace("$VALUE"+(P+1).toString()+"$","");else{let I=this._series[P].findClosestValue(_,!0),F=I!=null?I.y.toFixed(0):"--";p=p.replace("$VALUE"+(P+1).toString()+"$",F)}if(p.indexOf("$UNIT")>=0)for(let P=0;P<this._series.length;P++)this._series[P].disabled?p=p.replace("$UNIT"+(P+1).toString()+"$",""):p=p.replace("$UNIT"+(P+1).toString()+"$",this._series[P].unit);if(p.indexOf("$LEGEND")>=0)for(let P=0;P<this._series.length;P++)this._series[P].disabled?p=p.replace("$LEGEND"+(P+1).toString()+"$",""):p=p.replace("$LEGEND"+(P+1).toString()+"$",this._series[P].legend);this._xAxis.markers[h].PatchTextCallback!=null&&(p=this._xAxis.markers[h].PatchTextCallback(p))}let w=t.MeasureString(p,this._xAxis.markers[h].font,1e4),f=w.width+2*this._xAxis.markers[h].padding+this._xAxis.markers[h].borderthickness,T=w.height+2*this._xAxis.markers[h].padding+this._xAxis.markers[h].borderthickness;t.FillRectangleXYHW(this._xAxis.markers[h].bgBrush,g-(f>>1),y-(T>>1),f>>0,T>>0),t.DrawRectangleXYHW(this._xAxis.markers[h].pen,g-(f>>1),y-(T>>1),f>>0,T>>0);let R;switch(this._xAxis.markers[h].textAlign){case Di.TextAlign.LEFT:R=g-(f>>1)+this._xAxis.markers[h].padding;break;case Di.TextAlign.RIGHT:R=g+(f>>1)-this._xAxis.markers[h].padding;break;default:R=g;break}if(t.DrawStringPF(p,this._xAxis.markers[h].font,this._xAxis.markers[h].font.brush,new me(R,y),this._xAxis.markers[h].stringFormat),t.DrawLineXY(this._xAxis.markers[h].pen,g,e.Tmargin>>0,g,y-(T>>1)),t.DrawLineXY(this._xAxis.markers[h].pen,g,y+(T>>1),g,e.Height-e.Bmargin>>0),this._xAxis.markers[h].arrowSize>0){if(this._xAxis.markers[h].yposition>25){let P=[new me(g-this._xAxis.markers[h].arrowSize,y+(T>>1)),new me(g+this._xAxis.markers[h].arrowSize,y+(T>>1)),new me(g,y+(T>>1)+this._xAxis.markers[h].arrowSize)];t.FillPolygon(this._xAxis.markers[h].arrowBrush,P)}if(this._xAxis.markers[h].yposition<75){let P=[new me(g-this._xAxis.markers[h].arrowSize,y+(T>>1)),new me(g+this._xAxis.markers[h].arrowSize,y+(T>>1)),new me(g,y-(T>>1)-this._xAxis.markers[h].arrowSize)];t.FillPolygon(this._xAxis.markers[h].arrowBrush,P)}}}}t.ResetClip()}DrawDataPanels(e,t,i,r,s,n){if(this._dataPanels.length!=0){t.SetClip(new le(e.Lmargin,e.Tmargin,e.Width-e.Rmargin-e.Lmargin,e.Height-e.Bmargin-e.Tmargin));for(let o=0;o<this._dataPanels.length;o++)if(this._dataPanels[o].enabled){let a=this._dataPanels[o];if(a.yScaleIndex<r.length){let l=e.Width-2*a.padding-a.borderthickness;l<100&&(l=100);let h=t.MeasureString(a.text,a.font,l>>0),u=h.width+2*a.padding+a.borderthickness,_=h.height+2*a.padding+a.borderthickness,d=0;switch(a.horizontalPosition){case Pt.HorizontalPosition.LEFTBORDER:d=e.Lmargin;break;case Pt.HorizontalPosition.RIGHTBORDER:d=e.Width-e.Rmargin;break;case Pt.HorizontalPosition.ABSOLUTEX:let w=(i.max-i.min)/(e.Width-e.Lmargin-e.Rmargin);d=e.Lmargin+Math.round((a.AbsoluteXposition-i.min)/w)>>0;break}let g=0;switch(a.verticalPosition){case Pt.VerticalPosition.TOPBORDER:g=e.Tmargin;break;case Pt.VerticalPosition.BOTTOMBORDER:g=e.Height-e.Bmargin;break;case Pt.VerticalPosition.ABSOLUTEY:g=e.Height-e.Bmargin-Math.round((a.AbsoluteYposition-r[a.yScaleIndex].IRLy)*r[a.yScaleIndex].zoom)>>0;break}switch(a.panelHrzAlign){case Pt.HorizontalAlign.LEFTOF:d-=u+a.horizontalMargin;break;case Pt.HorizontalAlign.RIGHTOF:d+=a.horizontalMargin;break;default:d-=u/2;break}switch(a.panelVrtAlign){case Pt.VerticalAlign.ABOVE:g-=_+a.verticalMargin;break;case Pt.VerticalAlign.BELOW:g+=a.verticalMargin;break;default:g-=_/2;break}t.FillRectangleXYHW(a.bgBrush,d>>0,g>>0,u>>0,_>>0),a.borderthickness>0&&t.DrawRectangleXYHW(a.pen,d>>0,g>>0,u>>0,_>>0);let y=new qe(16384);switch(a.panelTextAlign){case Ve.TextAlign.LEFT:y.LineAlignment=0,y.Alignment=0;break;case Ve.TextAlign.RIGHT:y.LineAlignment=2,y.Alignment=2;break;default:y.LineAlignment=1,y.Alignment=1;break}let p=new le(d+a.padding+a.borderthickness/2>>0,g+a.padding+a.borderthickness/2>>0,h.width>>=1,(h.height>>0)+1);t.DrawStringRect(a.text,a.font,a.font.brush,p,y)}else throw new RangeError("Cannot renderer data panel #"+o.toString()+", no such Y axis")}}}findSegmentIndex(e,t,i){let r=this._series[e];if(r.segments.length<=0)return-1;let s=0,n=r.segments.length-1;if(i){console.log("looking for "+t);for(let o=0;o<r.segments.length;o++)console.log("seg "+o+" ["+r.segments[o].data[0].x+".."+r.segments[o].data[r.segments[o].count-1].x+"]");debugger}for(;;){let o=r.segments[s],a=r.segments[n];if(t>o.data[o.count-1].x)return s-.5;if(t<a.data[0].x)return n+.5;if(t>=o.data[0].x)return s;if(t<=a.data[a.count-1].x)return n;if(n==s){debugger;return-99}if(n-s==1)return s+.5;let l=s+n>>1,h=r.segments[l];t<=h.data[h.count-1].x?(n=n-1,s=l):(n=l-1,s=s+1)}}findTimestampIndexInSegment(e,t,i){let r=this._series[e].segments[t];if(!r)debugger;if(i<=r.data[0].x)return 0;let s=this._series[e].segments[t].count;if(i>=r.data[s-1].x)return s-1;let n=0,o=s-1,a=0;for(;;){if(o-n<=1)return i<=r.data[n].x?n:o;a=n+o>>1,i<=r.data[a].x?o=a:n=a}}Render(e,t,i){if(t<50||i<50)return 0;let r=this.mainViewPort.Lmargin,s=this.mainViewPort.Rmargin;this.mainViewPort.Width=t,this.mainViewPort.Height=i,this.mainViewPort.Lmargin=0,this.mainViewPort.Rmargin=0,e.SmoothingMode=Ze.HighQuality;let n=5;for(let f=0;f<this._yAxes.length;f++)if(this._yAxes[f].visible){let R=(e.MeasureString("8",this._yAxes[f].font,1e5).height+1)/2>>0;n<R&&(n=R)}this.mainViewPort.Tmargin=this._xAxis.position==ct.VrtPosition.TOP?0:n,this.mainViewPort.Bmargin=this._xAxis.position==ct.VrtPosition.BOTTOM?0:n,this._legendPanel.overlap||this.drawLegendPanel(e,t,i,this.mainViewPort),this.drawAnnotationPanels(e,this._annotationPanels,t,i,!1,this.mainViewPort),this.mainViewPort.Bmargin==0&&(this.mainViewPort.Bmargin=5),this.mainViewPort.Tmargin==0&&(this.mainViewPort.Tmargin=5);let o=this.DrawXAxis(this.mainViewPort,e,this._xAxis,!0);this._xAxis.position==ct.VrtPosition.TOP?this.mainViewPort.Tmargin+=o:this.mainViewPort.Bmargin+=o,this.mainViewPort.IRLx=this._xAxis.min;let a;for(let f=0;f<this._yAxes.length;f++){a=Me.DefaultValue();for(let T=0;T<this._series.length;T++)if(this._series[T].yAxisIndex==f&&!this._series[T].disabled)for(let R=0;R<this._series[T].segments.length;R++)a=Me.Combine(a,re.FindMinMax(this._xAxis.min,this._xAxis.max,this._series[T].segments[R].data,this._series[T].segments[R].count));this._yAxes[f].computeStartAndStep(a)}this.mainViewPort.Lmargin==0&&(this.mainViewPort.Lmargin=5),this.mainViewPort.Rmargin==0&&(this.mainViewPort.Rmargin=5);for(let f=0;f<this._yAxes.length;f++){let T=re.DrawYAxis(this.mainViewPort,e,this._yAxes[f],0,!0);this.mainViewPort.Lmargin+=this._yAxes[f].position==Nt.HrzPosition.LEFT?T:0,this.mainViewPort.Rmargin+=this._yAxes[f].position==Nt.HrzPosition.RIGHT?T:0}if(this._navigator.enabled){(r!=this.mainViewPort.Lmargin||s!=this.mainViewPort.Rmargin)&&(this.navigatorCache=null);let f=this._navigator.relativeheight*this.UIContainer.height/100>>0,T=this.xAxis.position==ct.VrtPosition.BOTTOM?o:0;this._navigator.setPosition(t,i,this.mainViewPort.Lmargin,this.mainViewPort.Rmargin,this.mainViewPort.Height-f-this.mainViewPort.Bmargin+T,this.mainViewPort.Bmargin-T),this.mainViewPort.Bmargin+=f}(this.lastTopMargin!=this.mainViewPort.Tmargin||this.lastBottomMargin!=this.mainViewPort.Bmargin)&&(this._bgBrush=null,this.lastTopMargin=this.mainViewPort.Tmargin,this.lastBottomMargin=this.mainViewPort.Bmargin),this._bgBrush==null&&(this._bgBrush=new Bt(this._bgColor2,this._bgColor1)),e.FillRectangleXYHW(this._bgBrush,this.mainViewPort.Lmargin,this.mainViewPort.Tmargin,this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin,this.mainViewPort.Height-this.mainViewPort.Bmargin-this.mainViewPort.Tmargin),this._borderThickness>0&&(this._borderPen==null&&(this._borderPen=new Ce(this._borderColor,this._borderThickness)),e.DrawRectangleXYHW(this._borderPen,this.mainViewPort.Lmargin,this.mainViewPort.Tmargin,this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin,this.mainViewPort.Height-this.mainViewPort.Bmargin-this.mainViewPort.Tmargin)),e.SetClip(new le(this.mainViewPort.Lmargin,this.mainViewPort.Tmargin,this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin,this.mainViewPort.Height-this.mainViewPort.Bmargin-this.mainViewPort.Tmargin));for(let f=0;f<this._yAxes.length;f++)this.DrawYAxisZones(this.mainViewPort,e,this._yAxes[f]);this.DrawXAxisZones(this.mainViewPort,e,this.xAxis),e.ResetClip(),this.DrawXAxis(this.mainViewPort,e,this._xAxis,!1);let l=0,h=0;for(let f=0;f<this._yAxes.length;f++){let T=re.DrawYAxis(this.mainViewPort,e,this._yAxes[f],this._yAxes[f].position==Nt.HrzPosition.LEFT?l:h,!1);this._yAxes[f].position==Nt.HrzPosition.LEFT&&(l+=T),this._yAxes[f].position==Nt.HrzPosition.RIGHT&&(h+=T)}e.SetClip(new le(this.mainViewPort.Lmargin,this.mainViewPort.Tmargin,this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin,this.mainViewPort.Height-this.mainViewPort.Bmargin-this.mainViewPort.Tmargin)),this.mainViewPort.zoomx=(this.mainViewPort.Width-this.mainViewPort.Lmargin-this.mainViewPort.Rmargin)/(this._xAxis.max-this._xAxis.min);let u=null,_=0,d=0,g=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Lmargin,this.mainViewPort.Height-this.mainViewPort.Bmargin)),y=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Width-this.mainViewPort.Rmargin,this.mainViewPort.Tmargin)),p=g.x,x=y.x,w=this.mainViewPort.Width-this.mainViewPort.Rmargin-this.mainViewPort.Lmargin;for(let f=0;f<this._series.length;f++)if(this._series[f].visible&&!this._series[f].disabled&&this._series[f].segments.length>0){let T=this._series[f].yAxisIndex;u=this._series[f].pen,this.mainViewPort.IRLy=this._yAxes[T].startStopStep.dataMin,this._yAxes[this._series[f].yAxisIndex].IRLy=this.mainViewPort.IRLy;let R=this._yAxes[T].startStopStep.dataMax-this._yAxes[T].startStopStep.dataMin;R==0&&(R=1,this.mainViewPort.IRLy-=R/2),this.mainViewPort.zoomy=(this.mainViewPort.Height-this.mainViewPort.Tmargin-this.mainViewPort.Bmargin)/R,this._yAxes[this._series[f].yAxisIndex].zoom=this.mainViewPort.zoomy,e.comment("** main view-port series "+f.toString());let P=this.findSegmentIndex(f,x,!1),I=this.findSegmentIndex(f,p,!1),F=!0,z=this._series[f].segments.length-1;if(P<0&&I<0&&(F=!1),P>z&&I>z&&(F=!1),F){let U=Math.floor(P+.5),j=Math.floor(I);if(j<0)throw new Error("findSegmentIndex return an invalid index ("+j+")");if(U<0)throw new Error("findSegmentIndex return an invalid index ("+U+")!");if(U>this._series[f].segments.length-1)throw new Error("findSegmentIndex return an invalid index ("+U+")!!");if(j>this._series[f].segments.length-1)throw new Error("findSegmentIndex return an invalid index ("+j+")!!!");let se=this.findTimestampIndexInSegment(f,U,x),ne=this.findTimestampIndexInSegment(f,j,p),ee=0;if(U==j)ee=se-ne;else if(U<j){ee=this._series[f].segments[j].count-ne+se;for(let te=U+1;te<j;te++)ee+=this._series[f].segments[te].count}let _e=Math.round(ee/w);if(_e<$e||$e<=0)for(let te=0;te<this._series[f].segments.length;te++)_+=re.DoSegmentRendering(this.mainViewPort,e,u,this._series[f].segments[te].data,this._series[f].segments[te].count,p,x),d+=this._series[f].segments[te].count;else{let te=Math.floor(Math.log(_e)/Math.log($e))-1,pe=this._series[f].summaries[te],Xe=null;for(let Oe=0;Oe<pe.segments.length;Oe++)Oe==pe.segments.length-1&&(Xe=pe.getBufferpoint()),_+=re.DoSummarySegmentRendering(this.mainViewPort,e,u,pe.segments[Oe].data,pe.segments[Oe].ptCount,Xe,p,x),d+=pe.segments[Oe].ptCount}}else console.log("Data are ouside dataview")}if(e.ResetClip(),this._navigator.enabled){e.comment("** navigator **");let f=this._navigator.viewport,T=Me.DefaultValue();for(let ne=0;ne<this._series.length;ne++)this._series[ne].disabled||(T=Me.Combine(T,this._series[ne].timeRange));if(this._navigator.Xrange=Me.extend(T,1.05),f.zoomx=(f.Width-f.Lmargin-f.Rmargin)/(this._navigator.Xrange.Max-this._navigator.Xrange.Min),this.lastPointCount!=d&&!this.mainViewPort.Capture&&!this._navigator.Capture||this.navigatorCache==null||e instanceof ei){e.comment("Redraw navigator"),this.navigatorCache!=null&&(this.navigatorCache=null),this.navigatorCache=document.createElement("canvas"),this.navigatorCache.width=f.Width,this.navigatorCache.height=f.Height,this.lastPointCount=d;let ne;if(e instanceof ei?ne=e:ne=new Kt(this.navigatorCache,f.Width,f.Height,90),ne.SetClip(new le(f.Lmargin,f.Tmargin,f.Width-f.Rmargin-f.Lmargin,f.Height-f.Bmargin-f.Tmargin)),ne.FillRectangleXYHW(this._navigator.bgBrush,f.Lmargin,f.Tmargin,f.Width-f.Rmargin-f.Lmargin,f.Height-f.Bmargin-f.Tmargin),this.xAxis.zones.length>0&&this._navigator.showXAxisZones){let _e=(this._navigator.Xrange.Max-this._navigator.Xrange.Min)/(f.Width-f.Lmargin-f.Rmargin);for(let te=0;te<this.xAxis.zones.length;te++)if(this.xAxis.zones[te].visible){let pe=this.xAxis.zones[te].min,Xe=this.xAxis.zones[te].max;isNaN(pe)&&(pe=this._navigator.Xrange.Min),isNaN(Xe)&&(Xe=this._navigator.Xrange.Max),ne.FillRectangleXYHW(this.xAxis.zones[te].zoneBrush,f.Lmargin+(pe-this._navigator.Xrange.Min)/_e>>0,f.Tmargin>>0,(Xe-pe)/_e>>0,f.Height-f.Bmargin-f.Tmargin)}}if(Me.isDefined(this._navigator.Xrange)&&this._navigator.Xrange.Max-this._navigator.Xrange.Min>0){let ee,_e;f.IRLx=this._navigator.Xrange.Min;let te=4/(f.Height-f.Bmargin-f.Tmargin),pe=re.ViewPortPointToIRL(f,new ze(f.Lmargin,f.Height-f.Bmargin)),Xe=re.ViewPortPointToIRL(f,new ze(f.Width-f.Rmargin,f.Tmargin)),Oe=pe.x,H=Xe.x;if(this._navigator.yAxisHandling==Vi.YAxisHandling.AUTO){for(let ie=0;ie<this._series.length;ie++)if(!this._series[ie].disabled){ne.comment("** navigator series "+ie.toString()),f.IRLy=this._series[ie].valueRange.Min;let mt=this._series[ie].yAxisIndex;if(u=this._series[ie].navigatorpen,ee=this._series[ie].valueRange.Min,_e=this._series[ie].valueRange.Max,_e-ee<=0)f.IRLy=ee-.5,_e=ee+.5;else{let bt=_e-ee;ee-=bt*te,_e+=bt*te}f.IRLy=ee,f.zoomy=(f.Height-f.Tmargin-f.Bmargin)/(_e-ee);let je=f.Width-f.Lmargin-f.Rmargin,Qr=0;for(let bt=0;bt<this._series[ie].segments.length;bt++)Qr+=this._series[ie].segments[bt].count;let Rr=Math.round(Qr/je);if(Rr<$e||$e<=0)for(let bt=0;bt<this._series[ie].segments.length;bt++)_+=re.DoSegmentRendering(f,ne,u,this._series[ie].segments[bt].data,this._series[ie].segments[bt].count,Oe,H);else{let bt=Math.floor(Math.log(Rr)/Math.log($e))-1,yt=this._series[ie].summaries[bt],Li=null;for(let Yi=0;Yi<yt.segments.length;Yi++)Yi==yt.segments.length-1&&(Li=yt.getBufferpoint()),_+=re.DoSummarySegmentRendering(f,ne,u,yt.segments[Yi].data,yt.segments[Yi].ptCount,Li,Oe,H)}}}else for(let ie=0;ie<this._yAxes.length;ie++){let mt=Me.DefaultValue();for(let je=0;je<this._series.length;je++)this._series[je].yAxisIndex==ie&&!this._series[je].disabled&&(mt=Me.Combine(mt,this._series[je].valueRange));mt=Me.extend(mt,1+2*te),ee=this._yAxes[ie].min,isNaN(ee)&&(ee=mt.Min),_e=this._yAxes[ie].max,isNaN(_e)&&(_e=mt.Max),Number.isNaN(ee)&&(ee=0,_e=1),_e-ee<=0&&(ee=ee-.5,_e=ee+.5),f.IRLy=ee,f.zoomy=(f.Height-f.Tmargin-f.Bmargin)/(_e-ee);for(let je=0;je<this._series.length;je++)if(this._series[je].yAxisIndex==ie&&!this._series[je].disabled&&this._series[je].visible){ne.comment("** navigator series "+je.toString()),u=this._series[je].navigatorpen;let Qr=f.Width-f.Lmargin-f.Rmargin,Rr=0;for(let yt=0;yt<this._series[je].segments.length;yt++)Rr+=this._series[je].segments[yt].count;let bt=Math.round(Rr/Qr);if(bt<$e||$e<=0)for(let yt=0;yt<this._series[je].segments.length;yt++)_+=re.DoSegmentRendering(f,ne,u,this._series[je].segments[yt].data,this._series[je].segments[yt].count,Oe,H);else{let yt=Math.floor(Math.log(bt)/Math.log($e))-1;console.log("Navigator (YAXIS=INHERIT), Serie "+je+", density is ~"+bt+"pts/pixel drawing summarized data level "+yt);let Li=this._series[je].summaries[yt],Yi=null;for(let Dr=0;Dr<Li.segments.length;Dr++)Dr==Li.segments.length-1&&(Yi=Li.getBufferpoint()),_+=re.DoSummarySegmentRendering(f,ne,u,Li.segments[Dr].data,Li.segments[Dr].ptCount,Yi,Oe,H)}}}for(let ie=0;ie<this._xAxis.markers.length;ie++)if(this._xAxis.markers[ie].enabled){let mt=re.IRLPointToViewPort(f,new ot(this._xAxis.markers[ie].xposition+(this._xAxis.markers[ie].timereference==he.TimeReference.RELATIVE?this._xAxis.zeroTime:0),0));ne.DrawLineXY(this._xAxis.markers[ie].navigatorpen,mt.X,f.Tmargin,mt.X,f.Height-f.Bmargin)}this._navigator.borderThickness>0&&ne.DrawLineXY(this._navigator.borderPen,f.Lmargin,f.Tmargin,f.Width-f.Rmargin,f.Tmargin),this.DrawMonitorXAxis(f,ne,this._navigator.Xrange,this.xAxis.labelFormat),this._navigator.setIRLPosition(f.IRLx,f.IRLy,f.zoomx,f.zoomy)}ne.ResetClip(),e instanceof ei||ne.Dispose()}let R=f.Width-f.Rmargin-f.Lmargin+1,P=f.Width-f.Rmargin-f.Lmargin+1,I=new le(f.Lmargin,f.Tmargin-1,R,P),F=new le(f.Lmargin,f.Tmargin,R,P);e.SetClip(F),e instanceof ei||e.DrawImage(this.navigatorCache,I,F,2),this._navigator.borderThickness>0&&(e.DrawLineXY(this._navigator.borderPen,f.Lmargin+1,f.Tmargin,f.Lmargin+1,f.Height-f.Bmargin-1),e.DrawLineXY(this._navigator.borderPen,f.Width-f.Rmargin,f.Tmargin,f.Width-f.Rmargin,f.Height-f.Bmargin-1),e.DrawLineXY(this._navigator.borderPen,f.Lmargin+1,f.Tmargin,f.Width-f.Rmargin,f.Tmargin));let z=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Lmargin,0)),U=re.ViewPortPointToIRL(this.mainViewPort,new ze(this.mainViewPort.Width-this.mainViewPort.Rmargin,0)),j=re.IRLPointToViewPort(this._navigator.viewport,new ot(z.x,0)),se=re.IRLPointToViewPort(this._navigator.viewport,new ot(U.x,0));e.FillRectangle(this._navigator.cursorBrush,new le(j.X-1,f.Tmargin,se.X-j.X+2,f.Height-f.Bmargin-f.Tmargin-1)),e.DrawLineXY(this._navigator.cursorBorderPen,j.X-1>>0,f.Tmargin>>0,j.X-1>>0,f.Height-f.Bmargin-1),e.DrawLineXY(this._navigator.cursorBorderPen,se.X+1>>0,f.Tmargin>>0,se.X+1>>0,f.Height-f.Bmargin-1),e.ResetClip()}return this._legendPanel.overlap&&this.drawLegendPanel(e,t,i,this.mainViewPort),e.TextRenderingHint=Ye.SingleBitPerPixelGridFit,this.DrawMarkers(this.mainViewPort,e,this.xAxis,t,i),this.drawAnnotationPanels(e,this._annotationPanels,t,i,!0,this.mainViewPort),this.DrawDataPanels(this.mainViewPort,e,this.xAxis,this._yAxes,t,i),this.DrawDataTracker(e,t,i,this.xAxis),this.DrawMessagePanels(e,t,i),0}KeyDown(e,t){if(t.code=="ArrowLeft"){let i=.2*(this._xAxis.max-this._xAxis.min);this._xAxis.set_minMax(this._xAxis.min-i,this._xAxis.max-i),this.redraw()}if(t.code=="ArrowRight"){let i=.2*(this._xAxis.max-this._xAxis.min);this._xAxis.set_minMax(this._xAxis.min+i,this._xAxis.max+i),this.redraw()}t.code=="ArrowUp"&&this.mouseWheel(new ze(this.UIContainer.width>>1,this.UIContainer.height>>1),10),t.code=="ArrowDown"&&this.mouseWheel(new ze(this.UIContainer.width>>1,this.UIContainer.height>>1),-10)}mouseWheel(e,t){let i=Math.pow(1.25,t/120),r=this.mainViewPort.zoomx*i;if(r>this.mainViewPort.zoomx&&r>1e3||(this._xAxis.max-this._xAxis.min)/i>25*365*86400)return;this.mainViewPort.IRLx+=(e.X-this.mainViewPort.Lmargin)/this.mainViewPort.zoomx-(e.X-this.mainViewPort.Lmargin)/r;let n=this._xAxis.max-this._xAxis.min;this._xAxis.set_minMax(this.mainViewPort.IRLx,this.mainViewPort.IRLx+n/i),this.mainViewPort.zoomx=r,this.redraw()}mouseWheelEvent(e,t){let i=this.Scr2ElmMatrix.multiplyByV(Ut.FromXYCoord(t.pageX,t.pageY)).toPoint(),r=i.X,s=i.Y;this.mouseWheel(new ze(r,s),t.deltaY>0?-150:150),t.preventDefault()}};m(re,"YGraph");var Rt=re;Rt._defaultVerticalDragZoomEnabled=!1;Rt.captureCursor=null;var Vn=class Vn{constructor(){this.outerRadius=0,this.innerRadius=0,this.angleStart=0,this.angleEnd=0,this.ycenter=0,this.xcenter=0,this.heightTop=0,this.heightBottom=0,this.valueRectangle=new le(0,0,0,0),this.valueFormat=new qe(16384),this.minValueRectangle=new le(0,0,0,0),this.minValueFormat=new qe(16384),this.maxValueRectangle=new le(0,0,0,0),this.maxValueFormat=new qe(16384),this.minValue="",this.maxValue="",this.value=""}};m(Vn,"DrawPrameters");var Fn=Vn,zi=class zi extends W{get min(){return this._min}set min(e){if(e>=this._max&&!W.minMaxCheckDisabled)throw new RangeError("Min cannot be greater than max ("+this._max.toString()+")");this._min=e,this._shownValue<this._min&&(this._shownValue=this._min),this.redraw()}get max(){return this._max}set max(e){if(e<=this._min&&!W.minMaxCheckDisabled)throw new RangeError("Max cannot be less than min ("+this._min.toString()+")");this._max=e,this._shownValue>this._max&&(this._shownValue=this._max),this.redraw()}get borderpen(){return this._borderpen==null&&(this._borderpen=new Ce(this._borderColor,this._borderThickness),this._borderpen.startCap=1,this._borderpen.endCap=1),this._borderpen}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e,this._borderpen=null,this.redraw()}get backgroundColor1(){return this._backgroundColor1}set backgroundColor1(e){this._backgroundColor1=e,this._bgBrush=null,this.redraw()}get backgroundColor2(){return this._backgroundColor2}set backgroundColor2(e){this._backgroundColor2=e,this._bgBrush=null,this.redraw()}get borderThickness(){return this._borderThickness}set borderThickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._borderThickness=e,this._borderpen=null,this._path=null,this.redraw()}get valueFormater(){return this._valueFormater}set valueFormater(e){this._valueFormater=e,this.redraw()}get minmaxFormater(){return this._minmaxFormater}set minmaxFormater(e){this._minmaxFormater=e,this.redraw()}get thickness(){return this._thickness}set thickness(e){if(e<0)throw new RangeError("Thickness must be a positive value");this._thickness=Math.max(Math.min(e,80),1),this._path=null,this.redraw()}get maxSpeed(){return this._maxSpeed}set maxSpeed(e){if(e<=0)throw new RangeError("Speed must be a positive value");this._maxSpeed=e}get value(){return this._value}set value(e){this._value=e,this.redraw()}get color1(){return this._color1}set color1(e){this._color1=e,this.redraw()}get color2(){return this._color2}set color2(e){this._color2=e,this.redraw()}get font(){return this._font}get minMaxFont(){return this._minMaxFont}get showMinMax(){return this._showMinMax}set showMinMax(e){this._showMinMax=e,this._path=null,this.redraw()}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,this._path=null,this._bgBrush=null,this.redraw()}FontsizeChange(e){this._path=null}constructor(e,t,i){super(e,i),this._shownValue=0,this._min=0,this._max=100,this.SegmentMaxLength=8,this.mainViewPort=new jt,this._borderpen=null,this._borderColor=c.Black,this._bgBrush=null,this._backgroundColor1=c.FromArgb(255,240,240,240),this._backgroundColor2=c.FromArgb(255,200,200,200),this._borderThickness=5,this._valueFormater=null,this._minmaxFormater=null,this._thickness=25,this._maxSpeed=.1,this._value=0,this._color1=c.Green,this._color2=c.Red,this._font=null,this._minMaxFont=null,this._showMinMax=!0,this._path=null,this.lastDrawParameters=new Fn,this._displayMode=zi.DisplayMode.DISPLAY90,this._minMaxFont=new it(this,this,Math.min(e.width,e.height)/15,()=>{this.FontsizeChange(this._minMaxFont)}),this._displayMode=t,this._font=new it(this,this,Math.min(e.width,e.height)/5,null),this.resizeRule=Be.ResizeRule.RELATIVETOBOTH;let r=new Kt(e,e.width,e.height,90),s=this.ComputeDrawParameters(r,e.width,e.height,this.mainViewPort);r.Dispose()}clearCachedObjects(){this._bgBrush=null,this._path=null}ComputeDrawParameters(e,t,i,r){t-=r.Lmargin+r.Rmargin,i-=r.Tmargin+r.Bmargin;let s=t-5-this._borderThickness,n=i-5-this._borderThickness,o=t/2,a=0,l=0,h=0,u=0,_=new le(0,0,0,0),d=new qe(16384),g=0,y=0,p=new Ki(null,""),x=new Ki(null,"");switch(this.lastDrawParameters.value=this._valueFormater==null?this._value.toFixed(0):this._valueFormater(this,this._value),this._showMinMax&&(this.lastDrawParameters.minValue=this._minmaxFormater==null?this._min.toFixed(0):this._minmaxFormater(this,this._min),this.lastDrawParameters.maxValue=this._minmaxFormater==null?this._max.toFixed(0):this._minmaxFormater(this,this._max),p=e.MeasureString(this.lastDrawParameters.minValue,this._minMaxFont,1e5),x=e.MeasureString(this.lastDrawParameters.maxValue,this._minMaxFont,1e5),this.lastDrawParameters.minValueFormat=new qe(16384),this.lastDrawParameters.maxValueFormat=new qe(16384),y=p.height,x.height>y&&(y=x.height)),this._displayMode){case zi.DisplayMode.DISPLAY90:n=n-y,s=s-y,a=s,a>n-this._borderThickness&&(a=n-this.borderThickness),a>s-this.borderThickness&&(a=s-this.borderThickness),l=Math.PI/2,h=Math.PI,this.lastDrawParameters.heightTop=a,this.lastDrawParameters.heightBottom=0,u=r.Tmargin+n,o=r.Lmargin+t/2+a/2-y+this._borderThickness,g=a*(100-this._thickness)/100,_=new le(o-g>>0,u-g>>0,g>>0,g>>0),d.Alignment=2,d.LineAlignment=2,this._showMinMax&&(this.lastDrawParameters.minValueRectangle=new le(o-(a+g+p.width)/2>>0,u+this._borderThickness>>0,p.width+1>>0,y+1>>0),this.lastDrawParameters.minValueFormat.Alignment=0,this.lastDrawParameters.minValueFormat.LineAlignment=0,this.lastDrawParameters.maxValueRectangle=new le(o+this._borderThickness>>0,u-a+(a-g-x.width)/2>>0,y+1>>0,x.width+1>>0),this.lastDrawParameters.maxValueFormat.Alignment=0,this.lastDrawParameters.maxValueFormat.LineAlignment=0,this.lastDrawParameters.maxValueFormat.FormatFlags=2);break;case zi.DisplayMode.DISPLAY180:n=n-y;let w=new Ki(null,"");w=e.MeasureString(this.lastDrawParameters.value,this._font,1e5),a=s/2-this.borderThickness,a>n-this._borderThickness&&(a=n-this._borderThickness),a>s-this.borderThickness&&(a=s-this.borderThickness),l=0,h=Math.PI,u=a+this._borderThickness/2,g=a*(100-this._thickness)/100,this.lastDrawParameters.heightTop=a,this.lastDrawParameters.heightBottom=0,_=new le(o-g>>0,u+this._borderThickness+y-w.height>>0,2*g>>0,w.height+1>>0),d.Alignment=1,d.LineAlignment=2,this._showMinMax&&(this.lastDrawParameters.minValueRectangle=new le(o-(a+g+p.width)/2>>0,u+this._borderThickness>>0,p.width+1>>0,y+1>>0),this.lastDrawParameters.minValueFormat.Alignment=0,this.lastDrawParameters.minValueFormat.LineAlignment=0,this.lastDrawParameters.maxValueRectangle=new le(o+(a+g-x.width)/2>>0,u+this._borderThickness>>0,x.width+1>>0,y+1>>0),this.lastDrawParameters.maxValueFormat.Alignment=0,this.lastDrawParameters.maxValueFormat.LineAlignment=0);break;case zi.DisplayMode.DISPLAY270:a=s,a>n/2&&(a=n/2),a>s/2&&(a=s/2),this.lastDrawParameters.heightTop=a,this.lastDrawParameters.heightBottom=a,l=0,h=3*Math.PI/2,u=r.Tmargin+i/2,g=a*(100-this._thickness)/100,_=new le(o-g>>0,u-g>>0,2*g>>0,2*g>>0),d.Alignment=1,d.LineAlignment=1,this._showMinMax&&(this.lastDrawParameters.minValueRectangle=new le(o+this._borderThickness>>0,u+(g+g+p.height)/2>>0,p.width+1>>0,p.height+1>>0),this.lastDrawParameters.minValueFormat.Alignment=0,this.lastDrawParameters.minValueFormat.LineAlignment=0,this.lastDrawParameters.maxValueRectangle=new le(o+(g+g+p.height)/2>>0,u+this._borderThickness>>0,x.height+1>>0,x.width+1>>0),this.lastDrawParameters.maxValueFormat.Alignment=0,this.lastDrawParameters.maxValueFormat.LineAlignment=0,this.lastDrawParameters.maxValueFormat.FormatFlags=2);break;case zi.DisplayMode.DISPLAY360:if(a=s,a>n/.85/2&&(a=n/.85/2),a>s/2&&(a=s/2),this.lastDrawParameters.heightTop=a,this.lastDrawParameters.heightBottom=a*.7,u=r.Tmargin+a+this._borderThickness/2,l=-Math.PI/4,h=5*Math.PI/4,g=a*(100-this._thickness)/100,_=new le(o-g>>0,u-g>>0,2*g>>0,2*g>>0),d.Alignment=1,d.LineAlignment=1,this._showMinMax){let f=Math.abs(g*Math.cos(l)),T=g*Math.abs(Math.sin(l))+2*Math.abs((a-g)*Math.sin(l)/3);this.lastDrawParameters.minValueRectangle=new le(o-f>>0,u+T-y/2>>0,p.width+1>>0,y+1>>0),this.lastDrawParameters.minValueFormat.Alignment=0,this.lastDrawParameters.minValueFormat.LineAlignment=1,this.lastDrawParameters.maxValueRectangle=new le(o+f-x.width>>0,u+T-y/2>>0,x.width+1>>0,y+1>>0),this.lastDrawParameters.maxValueFormat.Alignment=0,this.lastDrawParameters.maxValueFormat.LineAlignment=1}break}return this.lastDrawParameters.outerRadius=a,this.lastDrawParameters.innerRadius=g,this.lastDrawParameters.angleStart=l,this.lastDrawParameters.angleEnd=h,this.lastDrawParameters.ycenter=u,this.lastDrawParameters.xcenter=o,this.lastDrawParameters.valueRectangle=_,this.lastDrawParameters.valueFormat=d,this.lastDrawParameters}Render(e,t,i){this.mainViewPort=new jt,e.SmoothingMode=Ze.HighQuality,e.TextRenderingHint=Ye.AntiAlias,this.drawAnnotationPanels(e,this._annotationPanels,t,i,!1,this.mainViewPort);let r=this.ComputeDrawParameters(e,t,i,this.mainViewPort);if(this._path==null){let o=2*r.outerRadius*Math.PI*(r.angleEnd-r.angleStart)/(2*Math.PI)/this.SegmentMaxLength>>0,a=(r.angleEnd-r.angleStart)/o;this._path=new Array(2*(o+1));let l=0;for(let h=0;h<=o;h++){let u=r.angleStart+h*a;this._path[l++]=new me(r.xcenter+r.outerRadius*Math.cos(u),r.ycenter-r.outerRadius*Math.sin(u))}for(let h=o;h>=0;h--){let u=r.angleStart+h*a;this._path[l++]=new me(r.xcenter+r.innerRadius*Math.cos(u),r.ycenter-r.innerRadius*Math.sin(u))}}if(this._bgBrush==null&&(this._bgBrush=new Bt(this._backgroundColor1,this._backgroundColor2)),this._borderpen==null&&(this._borderpen=new Ce(this._borderColor,this._borderThickness),this._borderpen.linejoin=Ce.LineJoin.Round),e.FillPolygon(this._bgBrush,this._path),this._shownValue!=this._value){let n=this._maxSpeed*(this._max-this._min)/100;Math.abs(this._value-this._shownValue)<n?this._shownValue=this._value:this._shownValue<this._value?this._shownValue+=n:this._shownValue-=n}let s=this._shownValue;if(s>=this._min){s>this._max&&(s=this._max);let n=(s-this._min)/(this._max-this.min),o=r.angleStart+(r.angleEnd-r.angleStart)*n,l=2*r.outerRadius*Math.PI*(o-r.angleStart)/(2*Math.PI)/this.SegmentMaxLength>>0,h=(o-r.angleStart)/l,u=new Array(2*(l+1)),_=0;for(let g=0;g<=l;g++){let y=r.angleEnd-g*h;u[_++]=new me(r.xcenter+r.outerRadius*Math.cos(y),r.ycenter-r.outerRadius*Math.sin(y))}for(let g=l;g>=0;g--){let y=r.angleEnd-g*h;u[_++]=new me(r.xcenter+r.innerRadius*Math.cos(y),r.ycenter-r.innerRadius*Math.sin(y))}let d;if(this._color1==this._color2)d=new at(this._color1);else{let g=this._color1.alpha,y=this._color1.hue,p=this._color1.saturation,x=this._color1.luminosity,w=this._color2.alpha,f=this._color2.hue,T=this._color2.saturation,R=this._color2.luminosity,P=Math.round(g+(w-g)*n)>>0&255,I;Math.abs(f-y)<=127?I=y+(f-y)*n>>0:(I=y+256+(f-y+256)*n>>0,I>256&&(I-=256));let F=p+(T-p)*n>>0,z=x+(R-x)*n>>0;d=new at(new c(!0,P,I,F,z))}e.FillPolygon(d,u)}return this._borderThickness>0&&e.DrawPolygon(this._borderpen,this._path),e.DrawStringRect(this.lastDrawParameters.value,this._font,this._font.brush,r.valueRectangle,r.valueFormat),this._showMinMax&&(e.DrawStringRect(this.lastDrawParameters.minValue,this._minMaxFont,this._minMaxFont.brush,this.lastDrawParameters.minValueRectangle,this.lastDrawParameters.minValueFormat),e.DrawStringRect(this.lastDrawParameters.maxValue,this._minMaxFont,this._minMaxFont.brush,this.lastDrawParameters.maxValueRectangle,this.lastDrawParameters.maxValueFormat)),this.drawAnnotationPanels(e,this._annotationPanels,t,i,!0,this.mainViewPort),this.DrawMessagePanels(e,t,i),0}renderingPostProcessing(){this._shownValue!=this._value&&this.redraw()}};m(zi,"YSolidGauge");var ri=zi;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"DisplayModeEnumItem");let e=i;D.DisplayModeEnumItem=e;let r=class r extends Le{};m(r,"DisplayMode");let t=r;t.DISPLAY90=new e("DISPLAY90","90\xB0"),t.DISPLAY180=new e("DISPLAY180","180\xB0"),t.DISPLAY270=new e("DISPLAY270","270\xB0"),t.DISPLAY360=new e("DISPLAY360","360\xB0"),D.DisplayMode=t})(ri||(ri={}));var A=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},fr=0,lh=-1,hh=-2,uh=-3,dh=-4,ch=-5,_h=-6,gh=-7,fh=-8,ph=-9,mh=-10,bh=-11,vs=-12,yh=-13,Ah=-14,Sh=-15,Ch=-16,Th=-17,xh=-18,wh=-19,Rh=-20,Dh=-21,Ih=2147483647,vh=-1,Mr=9223372036854776e3,Ge=-Number.MAX_VALUE,fe="!INVALID!",Eh=1,kh=2,Ph=4,Nh=8,gs=-Number.MAX_VALUE,fs=Number.MAX_VALUE,Sl=fe,nl=0,gl=1,On=2,Cl=gl|On,Tl=1e4,xl=2e4,Nr=30;var al="s",wl="t",Rl="u",Dl="v",Il="w",vl="x",El="y",ol="z";var kl=10;var zn=1,ll=2;var Pl=0,Nl=1,Ll=2,Yl=3,Ml=4,Fl=5,hl=6,ul=7,Vl=8,zl=9;var dl=6,Ol=28,fl=0,Ul=1,_i={Function:fl,Sensor:Ul},Un=class Un{constructor(e=""){this.msg=e}};m(Un,"YErrorMsg");var Dt=Un,ws=class ws extends Error{constructor(...e){super(...e),this.errorMsg=this.name,this.name="YoctoError","captureStackTrace"in Error&&Error.captureStackTrace(this,ws)}};m(ws,"YoctoError");var ps=ws,Bn=class Bn{constructor(e){this.orgUrl=e;let t="auto",i="",r="",s=4444,n,o="";e.slice(0,7)=="http://"?(t="http",e=e.slice(7)):e.slice(0,5)=="ws://"?(t="ws",e=e.slice(5)):e.slice(0,8)=="https://"?(t="https",s=4443,e=e.slice(8)):e.slice(0,6)=="wss://"?(t="wss",s=4443,e=e.slice(6)):e.slice(0,7)=="auto://"?e=e.slice(7):e.slice(0,9)=="secure://"&&(e=e.slice(9),s=4443,t="secure"),e=e.replace("/not.byn",""),e[e.length-1]=="/"&&(e=e.slice(0,e.length-1));let a=e.indexOf("/");a>0&&(o=e.slice(a),e=e.slice(0,a));let l=e.indexOf("@");if(l>=0){let u=e.slice(0,l),_=u.indexOf(":");_>=0?(i=u.slice(0,_),r=u.slice(_+1)):i=u,e=e.slice(l+1)}let h=e.indexOf("]");a=e.indexOf(":"),a>0&&h>0&&a<h&&(a=e.indexOf(":",h)),a<0?(n=e,o!=""&&(t=="http"?s=80:t=="https"&&(s=443))):(n=e.slice(0,a),s=be.imm_atoi(e.slice(a+1))),n=="callback"&&(s=4444),this.proto=t,this.user=i,this.pass=r,this.host=n,this.port=s,this.domain=o}imm_getHost(){return this.host}imm_getPass(){return this.pass}imm_getPort(){return this.port}imm_getUser(){return this.user}imm_getUrl(e=!1,t=!0,i=!1){if(this.proto=="usb")return"usb";let r="";return e&&(r+=this.proto+"://"),t&&this.user!=""&&(r+=this.user,this.pass!=""&&(r+=":",r+=this.pass),r+="@"),r+=this.host,r+=":",r+=this.port,r+=this.domain,i&&r[r.length-1]!="/"&&(r+="/"),r}imm_getRootUrl(){return this.imm_getUrl(!0,!1,!0)}imm_getProto(){return this.proto}imm_useWebSocket(){return this.proto.startsWith("ws")||this.proto=="auto"||this.proto=="secure"}imm_getSubDomain(){return this.domain}imm_hasAuthParam(){return this.user!=""}imm_useSecureSocket(){return this.proto=="wss"||this.proto=="https"||this.proto=="secure"}imm_testInfoJson(){return this.proto=="auto"||this.proto=="secure"||this.proto=="http"||this.proto=="https"}imm_updateBestProto(e,t){this.port=t,this.proto!="http"&&this.proto!="https"&&(this.proto=e)}imm_updateForRedirect(e,t,i){this.host=e,this.port=t,this.imm_useWebSocket()?this.proto=i?"wss":"ws":this.proto=i?"https":"http"}imm_updatePortInfo(e,t){this.proto=e,this.port=t}imm_getOriginalURL(){return this.orgUrl}imm_updateFrom(e){this.proto=e.proto,this.user=e.user,this.pass=e.pass,this.host=e.host,this.port=e.port,this.domain=e.domain,this.orgUrl=e.orgUrl}};m(Bn,"_YY_UrlInfo");var si=Bn,Hn=class Hn{constructor(){this.buf=new Uint32Array(4),this.bits=new Uint32Array(2),this.inBuf=new ArrayBuffer(64),this.in8=new Uint8Array(this.inBuf),this.in32=new Uint32Array(this.inBuf),this.in32[0]=1,this.bigEndian=this.in8[0]!=1,this.buf[0]=1732584193,this.buf[1]=4023233417,this.buf[2]=2562383102,this.buf[3]=271733878,this.bits[0]=0,this.bits[1]=0}_byteReverseIn(){for(let e=0;e<16;e++){let t=this.in32[e];this.in32[e]=(t>>>24|(t&255)<<24|(t&16711680)>>>8|(t&65280)<<8)>>>0}}_transform(){let e=m(((u,_,d)=>(d^u&(_^d))>>>0),"F1"),t=m(((u,_,d)=>e(d,u,_)),"F2"),i=m(((u,_,d)=>(u^_^d)>>>0),"F3"),r=m(((u,_,d)=>(_^(u|~d))>>>0),"F4"),s=m(((u,_,d,g,y,p,x)=>(_=_+u(d,g,y)+(p>>>0)>>>0,_=(_<<x>>>0|_>>>32-x)>>>0,_+d>>>0)),"MD5STEP"),n=this.buf[0],o=this.buf[1],a=this.buf[2],l=this.buf[3],h=this.in32;n=s(e,n,o,a,l,h[0]+3614090360,7),l=s(e,l,n,o,a,h[1]+3905402710,12),a=s(e,a,l,n,o,h[2]+606105819,17),o=s(e,o,a,l,n,h[3]+3250441966,22),n=s(e,n,o,a,l,h[4]+4118548399,7),l=s(e,l,n,o,a,h[5]+1200080426,12),a=s(e,a,l,n,o,h[6]+2821735955,17),o=s(e,o,a,l,n,h[7]+4249261313,22),n=s(e,n,o,a,l,h[8]+1770035416,7),l=s(e,l,n,o,a,h[9]+2336552879,12),a=s(e,a,l,n,o,h[10]+4294925233,17),o=s(e,o,a,l,n,h[11]+2304563134,22),n=s(e,n,o,a,l,h[12]+1804603682,7),l=s(e,l,n,o,a,h[13]+4254626195,12),a=s(e,a,l,n,o,h[14]+2792965006,17),o=s(e,o,a,l,n,h[15]+1236535329,22),n=s(t,n,o,a,l,h[1]+4129170786,5),l=s(t,l,n,o,a,h[6]+3225465664,9),a=s(t,a,l,n,o,h[11]+643717713,14),o=s(t,o,a,l,n,h[0]+3921069994,20),n=s(t,n,o,a,l,h[5]+3593408605,5),l=s(t,l,n,o,a,h[10]+38016083,9),a=s(t,a,l,n,o,h[15]+3634488961,14),o=s(t,o,a,l,n,h[4]+3889429448,20),n=s(t,n,o,a,l,h[9]+568446438,5),l=s(t,l,n,o,a,h[14]+3275163606,9),a=s(t,a,l,n,o,h[3]+4107603335,14),o=s(t,o,a,l,n,h[8]+1163531501,20),n=s(t,n,o,a,l,h[13]+2850285829,5),l=s(t,l,n,o,a,h[2]+4243563512,9),a=s(t,a,l,n,o,h[7]+1735328473,14),o=s(t,o,a,l,n,h[12]+2368359562,20),n=s(i,n,o,a,l,h[5]+4294588738,4),l=s(i,l,n,o,a,h[8]+2272392833,11),a=s(i,a,l,n,o,h[11]+1839030562,16),o=s(i,o,a,l,n,h[14]+4259657740,23),n=s(i,n,o,a,l,h[1]+2763975236,4),l=s(i,l,n,o,a,h[4]+1272893353,11),a=s(i,a,l,n,o,h[7]+4139469664,16),o=s(i,o,a,l,n,h[10]+3200236656,23),n=s(i,n,o,a,l,h[13]+681279174,4),l=s(i,l,n,o,a,h[0]+3936430074,11),a=s(i,a,l,n,o,h[3]+3572445317,16),o=s(i,o,a,l,n,h[6]+76029189,23),n=s(i,n,o,a,l,h[9]+3654602809,4),l=s(i,l,n,o,a,h[12]+3873151461,11),a=s(i,a,l,n,o,h[15]+530742520,16),o=s(i,o,a,l,n,h[2]+3299628645,23),n=s(r,n,o,a,l,h[0]+4096336452,6),l=s(r,l,n,o,a,h[7]+1126891415,10),a=s(r,a,l,n,o,h[14]+2878612391,15),o=s(r,o,a,l,n,h[5]+4237533241,21),n=s(r,n,o,a,l,h[12]+1700485571,6),l=s(r,l,n,o,a,h[3]+2399980690,10),a=s(r,a,l,n,o,h[10]+4293915773,15),o=s(r,o,a,l,n,h[1]+2240044497,21),n=s(r,n,o,a,l,h[8]+1873313359,6),l=s(r,l,n,o,a,h[15]+4264355552,10),a=s(r,a,l,n,o,h[6]+2734768916,15),o=s(r,o,a,l,n,h[13]+1309151649,21),n=s(r,n,o,a,l,h[4]+4149444226,6),l=s(r,l,n,o,a,h[11]+3174756917,10),a=s(r,a,l,n,o,h[2]+718787259,15),o=s(r,o,a,l,n,h[9]+3951481745,21),this.buf[0]=(this.buf[0]+n&4294967295)>>>0,this.buf[1]=(this.buf[1]+o&4294967295)>>>0,this.buf[2]=(this.buf[2]+a&4294967295)>>>0,this.buf[3]=(this.buf[3]+l&4294967295)>>>0}addData(e){let t=e.length,i=0,r=this.bits[0];for(this.bits[0]=r+(t<<3)>>>0,this.bits[0]<r&&this.bits[1]++,this.bits[1]+=t>>>29,r=r>>>3&63;i<t;){for(;i<t&&r<64;)this.in8[r++]=e[i++];if(r<64)return;this.bigEndian&&this._byteReverseIn(),this._transform(),r=0}}calculate(){let e=this.bits[0]>>>3&63;if(this.in8[e++]=128,e>56){for(;e<64;)this.in8[e++]=0;for(this.bigEndian&&this._byteReverseIn(),this._transform(),e=0;e<14;e++)this.in32[e]=0}else{for(;e<56;)this.in8[e++]=0;this.bigEndian&&this._byteReverseIn()}this.in32[14]=this.bits[0],this.in32[15]=this.bits[1],this._transform();let t=new Uint8Array(16);for(e=0;e<16;e++)t[e]=this.buf[e>>>2]>>>8*(e&3)&255;return t}};m(Hn,"Y_MD5Ctx");var ms=Hn,Gn=class Gn{constructor(e,t){this._yapi=e,this._className=t,this._connectedFns={},this._requestedFns={},this._hwIdByName={},this._nameByHwId={},this._valueByHwId={},this._baseType=0}imm_reindexFunction(e,t,i,r){let s=this._nameByHwId[e],n=!1;return s==null||s==""?t!=""&&(this._nameByHwId[e]=t,n=!0):s!=t&&(this._hwIdByName[s]==e&&delete this._hwIdByName[s],t!=""?this._nameByHwId[e]=t:delete this._nameByHwId[e],n=!0),t!=""&&(this._hwIdByName[t]=e),i?this._valueByHwId[e]=i:this._valueByHwId[e]==null&&(this._valueByHwId[e]=""),r&&this._baseType==0&&(this._baseType=r),n}imm_forgetFunction(e){let t=this._nameByHwId[e];t!=null&&(t!=""&&this._hwIdByName[t]==e&&delete this._hwIdByName[t],delete this._nameByHwId[e]),this._valueByHwId[e]!=null&&delete this._valueByHwId[e];let i=this._connectedFns[e];i&&(this._requestedFns[e]=i,delete this._connectedFns[e])}imm_resolve(e){let t,i=e.indexOf(".");if(i<0){if(t=this._hwIdByName[e],t!=null)return{errorType:0,errorMsg:"no error",result:String(t)};i=e.length,e+="."+this._className.substr(0,1).toLowerCase()+this._className.substr(1)}if(this._valueByHwId[e]!=null)return{errorType:0,errorMsg:"no error",result:String(e)};let r="",s;if(i>0){let n=e.substr(0,i);s=e.substr(i+1);let o=this._yapi.imm_getDevice(n);if(!o)return{errorType:-4,errorMsg:"Device ["+n+"] not online",result:""};if(r=o.imm_getSerialNumber(),t=r+"."+s,this._valueByHwId[t]!=null)return{errorType:0,errorMsg:"no error",result:String(t)};let a,l=o.imm_functionCount();for(a=0;a<l;a++){t=r+"."+o.imm_functionId(a);let h=this._nameByHwId[t];if(h!=null&&h==s)return{errorType:0,errorMsg:"no error",result:String(t)}}}else{s=e.substr(1);for(let n in this._connectedFns){let o=n.indexOf(".");if(n.substr(o+1)==s)return{errorType:0,errorMsg:"no error",result:String(n)}}}return{errorType:-4,errorMsg:"No function ["+s+"] found on device ["+r+"]",result:""}}imm_getFriendlyName(e){let t=this.imm_resolve(e),i;if(t.errorType!=0)return t;let r=t.result;if(this._className=="Module"){let s=r;return i=this._nameByHwId[s],i!=null&&i!=""&&(s=this._nameByHwId[s]),{errorType:0,errorMsg:"no error",result:String(s)}}else{let s=r.indexOf("."),n=r.substr(0,s),o=this._yapi.imm_getFriendlyNameFunction("Module",n).result,a=o.indexOf("."),l=a>0?o.substr(0,a):o,h=r.substr(s+1);return i=this._nameByHwId[r],i!=null&&i!=""&&(h=i),{errorType:0,errorMsg:"no error",result:l+"."+h}}}imm_setFunction(e,t){let i=this.imm_resolve(e);i.result?this._connectedFns[i.result]=t:this._requestedFns[e]=t}imm_getFunction(e){let t=this.imm_resolve(e);if(t.errorType==0){let i=this._connectedFns[t.result];if(i!=null)return i;let r=this._requestedFns[e];return r!=null&&(this._connectedFns[t.result]=r,delete this._requestedFns[e]),r}else return this._requestedFns[e]}imm_setFunctionValue(e,t){let i=this._valueByHwId[e];return i!=null&&i==t?!1:(this._valueByHwId[e]=t,!0)}imm_getFunctionValue(e){return this._valueByHwId[e]}imm_getBaseType(){return this._baseType}imm_matchBaseType(e){return e==fl||e==this._baseType}imm_getFirstHardwareId(){let e=null;for(e in this._valueByHwId)break;return e}imm_getNextHardwareId(e){for(let t in this._valueByHwId){if(e=="!")return t;e==t&&(e="!")}return null}};m(Gn,"YFunctionType");var gi=Gn,Wn=class Wn{constructor(e,t,i){this.fname=e,this.data=t,this.progressCb=i}};m(Wn,"YHTTPBody");var gr=Wn,Xn=class Xn{constructor(e,t=0,i="no error"){this.devUrl=null,this.obj_result=null,this.asyncId=0,this.acceptor=null,this.toBeSent=null,this.sendPos=0,this.progressCb=null,this.timeoutId=null,this.sendTimeoutId=null,this.next=null,this._creat="",this._sent="",this.bin_result=e,this.errorType=t,this.errorMsg=i}};m(Xn,"YHTTPRequest");var Ht=Xn,Zn=class Zn{constructor(e,t=0,i="no error"){this.errorType=t,this.errorMsg=i,this.obj_result=e}};m(Zn,"YFuncRequest");var bs=Zn,Pr=class Pr{constructor(e,t,i){this._cal=null,this._runNo=0,this._utcStamp=0,this._nCols=0,this._nRows=0,this._startTime=0,this._duration=0,this._dataSamplesInterval=0,this._firstMeasureDuration=0,this._columnNames=[],this._functionId="",this._isClosed=!1,this._isAvg=!1,this._minVal=0,this._avgVal=0,this._maxVal=0,this._values=[],this._isLoaded=!1,this.DATA_INVALID=Ge,this.DURATION_INVALID=Ge,this._parent=e,this._yapi=this._parent._yapi,typeof t!="undefined"&&this.imm_initFromDataSet(t,i)}_parseCalibArr(e){let t,i,r,s,n=[],o=[],a=[],l,h;if(t=e[0]/1e3>>0,t<Nr)return this._cal=null,0;if(i=this._yapi.imm_getCalibrationHandler(t),i==null)return this._cal=null,0;for(r=e.length,n.length=0,s=1;s<r;)n.push(e[s]),s=s+1;for(o.length=0,a.length=0,s=1;s+1<r;)l=e[s],l=l/1e3,h=e[s+1],h=h/1e3,o.push(l),a.push(h),s=s+2;return this._cal={src:"",hdl:i,typ:t,par:n,raw:o,cal:a},0}imm_initFromDataSet(e,t){let i,r,s,n,o=[];return this._runNo=t[0]+(t[1]<<16),this._utcStamp=t[2]+(t[3]<<16),i=t[4],this._isAvg=(i&256)==0,s=i&255,(i&256)!=0?s=s*3600:(i&512)!=0&&(s=s*60),this._dataSamplesInterval=3600/s,r=t[6],r<1e3?this._startTime=this._utcStamp+r/1e3:this._startTime=this._utcStamp-this._dataSamplesInterval,this._firstMeasureDuration=t[5],this._isAvg||(this._firstMeasureDuration=this._firstMeasureDuration/1e3),i=t[7],this._isClosed=i!=65535,i==65535&&(i=0),this._nRows=i,this._nRows>0?this._firstMeasureDuration>0?this._duration=this._firstMeasureDuration+(this._nRows-1)*this._dataSamplesInterval:this._duration=this._nRows*this._dataSamplesInterval:this._duration=0,o=e.imm_get_calibration(),n=o[0],n==0?this._cal=null:this._parseCalibArr(o),this._functionId=e.imm_get_functionId(),this._isAvg?(this._columnNames.length=0,this._columnNames.push(this._functionId+"_min"),this._columnNames.push(this._functionId+"_avg"),this._columnNames.push(this._functionId+"_max"),this._nCols=3):(this._columnNames.length=0,this._columnNames.push(this._functionId),this._nCols=1),this._nRows>0&&(this._avgVal=this.imm_decodeAvg(t[8]+((t[9]^32768)<<16),1),this._minVal=this.imm_decodeVal(t[10]+(t[11]<<16)),this._maxVal=this.imm_decodeVal(t[12]+(t[13]<<16))),0}imm_parseStream(e){let t,i=[],r=[];if(this._isLoaded&&!this._isClosed)return 0;if(e.length==0)return this._nRows=0,0;if(i=this._yapi.imm_decodeWords(this._parent.imm_json_get_string(e)),this._values.length=0,t=0,this._isAvg)for(;t+3<i.length;)r.length=0,i[t]==65535&&i[t+1]==65535?(r.push(NaN),r.push(NaN),r.push(NaN)):(r.push(this.imm_decodeVal(i[t+2]+(i[t+3]<<16))),r.push(this.imm_decodeAvg(i[t]+((i[t+1]^32768)<<16),1)),r.push(this.imm_decodeVal(i[t+4]+(i[t+5]<<16)))),t=t+6,this._values.push(r.slice());else for(;t+1<i.length;)r.length=0,i[t]==65535&&i[t+1]==65535?r.push(NaN):r.push(this.imm_decodeAvg(i[t]+((i[t+1]^32768)<<16),1)),this._values.push(r.slice()),t=t+2;return this._nRows=this._values.length,this._isLoaded=!0,0}imm_wasLoaded(){return this._isLoaded}imm_get_url(){let e;return e="logger.json?id="+this._functionId+"&run="+String(Math.round(this._runNo))+"&utc="+String(Math.round(this._utcStamp)),e}imm_get_baseurl(){let e;return e="logger.json?id="+this._functionId+"&run="+String(Math.round(this._runNo))+"&utc=",e}imm_get_urlsuffix(){let e;return e=String(Math.round(this._utcStamp)),e}loadStream(){return A(this,void 0,void 0,function*(){return this.imm_parseStream(yield this._parent._download(this.imm_get_url()))})}imm_decodeVal(e){let t;return t=e/1e3,this._cal!=null&&(t=this._cal.hdl(t,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)),t}imm_decodeAvg(e,t){let i;return i=e/1e3,this._cal!=null&&(i=this._cal.hdl(i,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)),i}isClosed(){return A(this,void 0,void 0,function*(){return this._isClosed})}get_runIndex(){return A(this,void 0,void 0,function*(){return this._runNo})}get_startTime(){return A(this,void 0,void 0,function*(){return this._utcStamp-(Date.now()/1e3>>0)})}get_startTimeUTC(){return A(this,void 0,void 0,function*(){return Math.round(this._startTime)})}get_realStartTimeUTC(){return A(this,void 0,void 0,function*(){return this._startTime})}get_dataSamplesIntervalMs(){return A(this,void 0,void 0,function*(){return Math.round(this._dataSamplesInterval*1e3)})}get_dataSamplesInterval(){return A(this,void 0,void 0,function*(){return this._dataSamplesInterval})}get_firstDataSamplesInterval(){return A(this,void 0,void 0,function*(){return this._firstMeasureDuration})}get_rowCount(){return A(this,void 0,void 0,function*(){return this._nRows!=0&&this._isClosed?this._nRows:(yield this.loadStream(),this._nRows)})}get_columnCount(){return A(this,void 0,void 0,function*(){return this._nCols!=0?this._nCols:(yield this.loadStream(),this._nCols)})}get_columnNames(){return A(this,void 0,void 0,function*(){return this._columnNames.length!=0?this._columnNames:(yield this.loadStream(),this._columnNames)})}get_minValue(){return A(this,void 0,void 0,function*(){return this._minVal})}get_averageValue(){return A(this,void 0,void 0,function*(){return this._avgVal})}get_maxValue(){return A(this,void 0,void 0,function*(){return this._maxVal})}get_realDuration(){return A(this,void 0,void 0,function*(){return this._isClosed?this._duration:(Date.now()/1e3>>0)-this._utcStamp})}get_dataRows(){return A(this,void 0,void 0,function*(){return(this._values.length==0||!this._isClosed)&&(yield this.loadStream()),this._values})}get_data(e,t){return A(this,void 0,void 0,function*(){return(this._values.length==0||!this._isClosed)&&(yield this.loadStream()),e>=this._values.length||t>=this._values[e].length?Pr.DATA_INVALID:this._values[e][t]})}};m(Pr,"YDataStream");var Lr=Pr;Lr.DATA_INVALID=Ge;Lr.DURATION_INVALID=Ge;var Kn=class Kn{constructor(e,t="",i="",r=0,s=0){this._hardwareId="",this._functionId="",this._unit="",this._bulkLoad=0,this._startTimeMs=0,this._endTimeMs=0,this._progress=0,this._calib=[],this._streams=[],this._preview=[],this._measures=[],this._summaryMinVal=0,this._summaryMaxVal=0,this._summaryTotalAvg=0,this._summaryTotalTime=0,this.DATA_INVALID=Ge,this.DURATION_INVALID=Ge,this.HARDWAREID_INVALID=fe,this.FUNCTIONID_INVALID=fe,this.UNIT_INVALID=fe,this._summary=new fi(0,0,0,0,0),t==""?(this._parent=e,this._yapi=e._yapi,this._startTimeMs=0,this._endTimeMs=0):(this._parent=e,this._yapi=e._yapi,this._functionId=t,this._unit=i,this._startTimeMs=r*1e3,this._endTimeMs=s*1e3,this._progress=-1)}imm_get_functionId(){return this._functionId}imm_get_calibration(){return this._calib}loadSummary(e){return A(this,void 0,void 0,function*(){let t=[],i,r,s,n,o,a,l,h,u,_,d,g,y,p,x,w,f,T,R,P,I,F,z,U,j,se,ne,ee,_e,te,pe,Xe,Oe,H=[];if(this._progress<0){if(Oe=this._yapi.imm_bin2str(e),Oe=="{}")return this._parent._throw(-5,"device firmware is too old"),-5;if(_=yield this._parse(Oe),_<0)return _}ee=0,_e=0,te=fs,pe=gs,se=fs,ne=gs;for(let ie of this._streams){if(P=Math.round((yield ie.get_realStartTimeUTC())*1e3),I=yield ie.get_realDuration(),F=P+Math.round(I*1e3),P>=this._startTimeMs&&(this._endTimeMs==0||F<=this._endTimeMs))p=yield ie.get_minValue(),w=yield ie.get_averageValue(),x=yield ie.get_maxValue(),f=P,T=F,R=I;else{if(ie.imm_wasLoaded()||(Xe=ie.imm_get_url(),e=yield this._parent._download(Xe),ie.imm_parseStream(e)),t=yield ie.get_dataRows(),t.length==0)return yield this.get_progress();for(i=P,n=Math.round((yield ie.get_firstDataSamplesInterval())*1e3),s=Math.round((yield ie.get_dataSamplesInterval())*1e3),a=t[0].length,l=0,a>2?h=1:h=0,a>2?u=2:u=0,g=0,y=0,f=F,T=P,p=fs,x=gs,d=0;d<t.length;)H=t[d],d==0?r=n:r=s,o=i+r,o>this._startTimeMs&&(this._endTimeMs==0||i<this._endTimeMs)&&(z=H[l],U=H[h],j=H[u],f>i&&(f=i),T<o&&(T=o),p>z&&(p=z),x<j&&(x=j),isNaN(U)||(y=y+U*r,g=g+r)),i=o,d=d+1;g>0?(w=y/g,R=(T-f)/1e3):(w=0,R=0)}this._preview.push(new fi(f/1e3,T/1e3,p,w,x)),te>p&&(te=p),pe<x&&(pe=x),se>f&&(se=f),ne<T&&(ne=T),_e=_e+w*R,ee=ee+R}return(this._startTimeMs==0||this._startTimeMs>se)&&(this._startTimeMs=se),(this._endTimeMs==0||this._endTimeMs<ne)&&(this._endTimeMs=ne),ee>0?this._summary=new fi(se/1e3,ne/1e3,te,_e/ee,pe):this._summary=new fi(0,0,Ge,Ge,Ge),yield this.get_progress()})}processMore(e,t){return A(this,void 0,void 0,function*(){let i,r=[],s,n,o,a,l,h,u,_,d,g,y,p,x,w=[],f,T,R,P=[];if(e!=this._progress)return this._progress;if(this._progress<0)return yield this.loadSummary(t);if(i=this._streams[this._progress],i.imm_wasLoaded()||i.imm_parseStream(t),r=yield i.get_dataRows(),this._progress=this._progress+1,r.length==0)return yield this.get_progress();s=Math.round((yield i.get_realStartTimeUTC())*1e3),o=Math.round((yield i.get_firstDataSamplesInterval())*1e3),n=Math.round((yield i.get_dataSamplesInterval())*1e3),o==0&&(o=n),s<n&&(s=n),h=r[0].length,u=0,h>2?_=1:_=0,h>2?d=2:d=0,g=!0;for(let I of r)g?(l=s+o,g=!1):l=s+n,a=I[_],l>this._startTimeMs&&(this._endTimeMs==0||s<this._endTimeMs)&&!isNaN(a)&&this._measures.push(new fi(s/1e3,l/1e3,I[u],a,I[d])),s=l;if(this._bulkLoad>0&&this._progress<this._streams.length){if(i=this._streams[this._progress],i.imm_wasLoaded())return yield this.get_progress();for(y=i.imm_get_baseurl(),p=i.imm_get_url(),x=i.imm_get_urlsuffix(),w.push(x),f=this._progress+1;f<this._streams.length&&w.length<this._bulkLoad;)i=this._streams[f],!i.imm_wasLoaded()&&i.imm_get_baseurl()==y&&(x=i.imm_get_urlsuffix(),w.push(x),p=p+","+x),f=f+1;for(T=yield this._parent._download(p),P=this._parent.imm_json_get_array(T),R=0,f=this._progress;f<this._streams.length&&R<w.length&&R<P.length;)i=this._streams[f],i.imm_get_baseurl()==y&&i.imm_get_urlsuffix()==w[R]&&(i.imm_parseStream(P[R]),R=R+1),f=f+1}return yield this.get_progress()})}get_privateDataStreams(){return A(this,void 0,void 0,function*(){return this._streams})}get_hardwareId(){return A(this,void 0,void 0,function*(){let e;return this._hardwareId!=""?this._hardwareId:(e=yield this._parent.get_module(),this._hardwareId=(yield e.get_serialNumber())+"."+(yield this.get_functionId()),this._hardwareId)})}get_functionId(){return A(this,void 0,void 0,function*(){return this._functionId})}get_unit(){return A(this,void 0,void 0,function*(){return this._unit})}get_startTimeUTC(){return A(this,void 0,void 0,function*(){return this.imm_get_startTimeUTC()})}imm_get_startTimeUTC(){return this._startTimeMs/1e3}get_endTimeUTC(){return A(this,void 0,void 0,function*(){return this.imm_get_endTimeUTC()})}imm_get_endTimeUTC(){return Math.round(this._endTimeMs/1e3)}get_progress(){return A(this,void 0,void 0,function*(){return this._progress<0?0:this._progress>=this._streams.length?100:(1+(1+this._progress)*98)/(1+this._streams.length)>>0})}loadMore(){return A(this,void 0,void 0,function*(){let e,t;if(this._progress<0)e="logger.json?id="+this._functionId,this._startTimeMs!=0&&(e=e+"&from="+String(Math.round(this.imm_get_startTimeUTC()))),this._endTimeMs!=0&&(e=e+"&to="+String(Math.round(this.imm_get_endTimeUTC()+1)));else{if(this._progress>=this._streams.length)return 100;if(t=this._streams[this._progress],t.imm_wasLoaded())return yield this.processMore(this._progress,this._yapi.imm_str2bin(""));e=t.imm_get_url()}try{return yield this.processMore(this._progress,yield this._parent._download(e))}catch(i){return yield this.processMore(this._progress,yield this._parent._download(e))}})}get_summary(){return A(this,void 0,void 0,function*(){return this._summary})}get_preview(){return A(this,void 0,void 0,function*(){return this._preview})}get_measuresAt(e){return A(this,void 0,void 0,function*(){let t,i,r=[],s=[],n,o,a,l,h,u,_;t=e.get_startTimeUTC()*1e3,i=null;for(let d of this._streams)Math.round((yield d.get_realStartTimeUTC())*1e3)==t&&(i=d);if(i==null||(r=yield i.get_dataRows(),r.length==0))return s;n=Math.round((yield i.get_realStartTimeUTC())*1e3),o=Math.round((yield i.get_dataSamplesInterval())*1e3),n<o&&(n=o),l=r[0].length,h=0,l>2?u=1:u=0,l>2?_=2:_=0;for(let d of r)a=n+o,a>this._startTimeMs&&(this._endTimeMs==0||n<this._endTimeMs)&&s.push(new fi(n/1e3,a/1e3,d[h],d[u],d[_])),n=a;return s})}get_measures(){return A(this,void 0,void 0,function*(){return this._measures})}_parse(e){return A(this,void 0,void 0,function*(){let t=null;try{t=JSON.parse(e)}catch(i){}if(!t)return this._progress=0,yield this.get_progress();this._functionId=t.id,this._unit=t.unit,this._bulkLoad=t.bulk?parseInt(t.bulk):0,t.calib?(this._calib=this._yapi.imm_decodeFloats(t.calib),this._calib[0]=this._calib[0]/1e3>>0):this._calib=this._yapi.imm_decodeWords(t.cal),this._summary=new fi(0,0,0,0,0),this._streams=[],this._preview=[],this._measures=[];for(let i=0;i<t.streams.length;i++){let r=this._parent.imm_findDataStream(this,t.streams[i]);if(!r)continue;let s=(yield r.get_realStartTimeUTC())*1e3,n=s+(yield r.get_realDuration())*1e3;this._startTimeMs>0&&n<=this._startTimeMs||this._endTimeMs>0&&s>=this._endTimeMs||this._streams.push(r)}return this._progress=0,this.get_progress()})}};m(Kn,"YDataSet");var zt=Kn;zt.DATA_INVALID=Ge;zt.DURATION_INVALID=Ge;zt.HARDWAREID_INVALID=fe;zt.FUNCTIONID_INVALID=fe;zt.UNIT_INVALID=fe;zt.DATA_INVALID=Ge;zt.DURATION_INVALID=Ge;zt.HARDWAREID_INVALID=fe;zt.FUNCTIONID_INVALID=fe;zt.UNIT_INVALID=fe;var Rs=class Rs{constructor(e,t,i){this._start=0,this._end=0,this._nsensors=0,this._sensors=[],this._datasets=[],this._progresss=[],this._nextidx=[],this._nexttim=[],this.imm_init(e,t,i)}imm_init(e,t,i){return this._start=e,this._end=t,this._sensors=i,this._nsensors=-1,0}static Init(e,t,i){let r,s=[],n,o,a,l;for(r=e.length,s.length=0,n=0;n<r;)o=e[n],a=rt.FindSensor(o),s.push(a),n=n+1;return l=new Rs(t,i,s),l}nextRecord(e){return A(this,void 0,void 0,function*(){let t,i,r,s,n,o,a,l,h=[],u;if(this._nsensors==-1)for(this._nsensors=this._sensors.length,this._datasets.length=0,this._progresss.length=0,this._nextidx.length=0,this._nexttim.length=0,t=0;t<this._nsensors;)r=this._sensors[t],s=yield r.get_recordedData(this._start,this._end),this._datasets.push(s),this._progresss.push(0),this._nextidx.push(0),this._nexttim.push(0),t=t+1;for(e.length=0,u=0,t=0;t<this._nsensors;){if(a=this._nexttim[t],a==0){for(i=this._nextidx[t],h=yield this._datasets[t].get_measures(),o=this._progresss[t];i>=h.length&&o<100;)o=yield this._datasets[t].loadMore(),o<0&&(o=100),this._progresss[t]=o,h=yield this._datasets[t].get_measures();i<h.length&&(a=yield h[i].get_endTimeUTC(),this._nexttim[t]=a)}a>0&&(u==0||u>a)&&(u=a),t=t+1}if(u==0)return 100;for(e.length=0,e.push(u),n=0,t=0;t<this._nsensors;)this._nexttim[t]==u?(i=this._nextidx[t],h=yield this._datasets[t].get_measures(),l=yield h[i].get_averageValue(),e.push(l),this._nexttim[t]=0,this._nextidx[t]=i+1):e.push(NaN),o=this._progresss[t],n=n+o,t=t+1;return n>0&&(n=n/this._nsensors>>0,n>99&&(n=99)),n})}};m(Rs,"YConsolidatedDataSet");var cl=Rs,jn=class jn{constructor(e,t,i,r){this._yapi=e,this._rootUrl=t,this._serialNumber="",this._logicalName="",this._productName="",this._productId=0,this._beacon=0,this._devYdx=-1,this._lastErrorType=0,this._lastErrorMsg="no error",this._cache={_expiration:0,_json:new Uint8Array(0),_precooked:{}},this._functions=[],this._busy=0,this._pendingQueries=Promise.resolve(),this._lastTimeRef=0,this._lastDuration=0,this._logCallback=null,this._logIsPulling=!1,this._logpos=0,i&&r&&(this._serialNumber=i.serialNumber,this._logicalName=i.logicalName,this._productName=i.productName,this._productId=i.productId,this._beacon=i.beacon,this._devYdx=i.index==null?-1:i.index,this.imm_updateFromYP(r),this._yapi.imm_reindexDevice(this))}_throw(e,t,i){return this._lastErrorType=e,this._lastErrorMsg=t,this._yapi._throw(e,t,i)}imm_getRootUrl(){return this._rootUrl}imm_getSerialNumber(){return this._serialNumber}imm_getLogicalName(){return this._logicalName}getLogicalName(){return A(this,void 0,void 0,function*(){return this._cache._expiration==0&&(yield this.refresh()),this._logicalName})}imm_getProductName(){return this._productName}imm_getProductId(){return this._productId}imm_getBeacon(){return this._beacon}getBeacon(){return A(this,void 0,void 0,function*(){return this._cache._expiration==0&&(yield this.refresh()),this._beacon})}imm_getLastTimeRef(){return this._lastTimeRef}imm_getLastDuration(){return this._lastDuration}imm_triggerLogPull(){if(this._logCallback==null||this._logIsPulling)return;this._logIsPulling=!0;let e="GET logs.txt?pos="+this._logpos;this._yapi.devRequest(this._rootUrl,e,null,0).then(i=>A(this,void 0,void 0,function*(){if(i.errorType!=0){this._logIsPulling=!1;return}if(this._logCallback==null){this._logIsPulling=!1;return}let r=E.imm_bin2str(i.bin_result),s=r.lastIndexOf(`
@`);if(s<0){this._logIsPulling=!1;return}let n=r.substring(0,s),o=r.substring(s+2);this._logpos=parseInt(o);let a=ke.FindModuleInContext(this._yapi,this._serialNumber),l=n.trim().split(`
`);try{for(let h=0;h<l.length;h++)yield this._logCallback(a,l[h])}catch(h){this._yapi.imm_log("Exception in device log callback:",h)}this._logIsPulling=!1}))}imm_registerLogCallback(e){this._logCallback=e,e!=null?this.imm_triggerLogPull():(this._logpos=0,this._logIsPulling=!1)}imm_setTimeRef(e,t){this._lastTimeRef=e,this._lastDuration=t}imm_getDevYdx(){return this._devYdx}imm_describe(){let e=this._rootUrl;return this._serialNumber!=""&&(e=this._serialNumber,this._logicalName!=""&&(e=e+" ("+this._logicalName+")")),this._productName+" "+e}imm_updateFromYP(e){let t=0;for(let i in e)for(let r in e[i]){let s=e[i][r],n=s.hardwareId,o=n.indexOf(".");if(n.substr(0,o)==this._serialNumber){let a=s.index;a==null&&(a=t),this._functions[a]=[n.substr(o+1),s.logicalName],t++}}}updateFromReq(e,t){return A(this,void 0,void 0,function*(){this._cache._expiration=this._yapi.GetTickCount()+this._yapi.defaultCacheValidity,this._cache._json=e.bin_result;let i,r=!1;if(this._productName==""){for(i in t)i=="module"?(this._serialNumber=t.module.serialNumber,this._logicalName=t.module.logicalName,this._productName=t.module.productName,this._productId=t.module.productId,this._beacon=t.module.beacon):i=="services"&&this.imm_updateFromYP(t.services.yellowPages);r=!0}else{let s=!1;for(i in t)if(i=="module")this._logicalName!=t.module.logicalName&&(this._logicalName=t.module.logicalName,r=!0),this._beacon=t.module.beacon;else if(i!="services"){let n=t[i].logicalName;n==null&&(n=t.module.logicalName);let o=t[i].advertisedValue;o!=null&&(yield this._yapi.setFunctionValue(t.module.serialNumber+"."+i,o));let a;for(a in this._functions)if(this._functions[a][0]==i){this._functions[a][1]!=n&&(this._functions[a][1]=n,r=!0);break}}}r&&this._yapi.imm_reindexDevice(this)})}imm_dropCache(){this._cache._expiration=0,this._cache._precooked={}}imm_functionCount(){let e=0;for(let t in this._functions)e++;return e}imm_functionId(e){let t=0;for(let i in this._functions){if(e===t)return this._functions[i][0];t++}return""}imm_functionBaseType(e){let t=this.imm_functionId(e);if(t!==""){let i=this._yapi.imm_getFunctionBaseType(this._serialNumber+"."+t);for(let r in _i)if(_i[r]===i)return r}return"Function"}imm_functionType(e){let t=this.imm_functionId(e);if(t!==""){let i;for(i=t.length;i>0&&!(t[i-1]>"9");i--);return t[0].toUpperCase()+t.substr(1,i-1)}return""}imm_functionName(e){let t=0;for(let i in this._functions){if(e===t)return this._functions[i][1];t++}return""}imm_functionValue(e){let t=this.imm_functionId(e);return t!==""?this._yapi.imm_getFunctionValue(this._serialNumber+"."+t):""}imm_functionIdByFunYdx(e){return this._functions[e]?this._functions[e][0]:""}imm_jzon2json(e,t){if(Array.isArray(e)){let i=e.length;if(Array.isArray(t)){let r=t.length>0?t[0]:null,s=[];for(let n=0;n<i;n++)s[n]=this.imm_jzon2json(e[n],r);return s}else if(typeof t=="object"){let r=0,s={};for(let n in t)t.hasOwnProperty(n)&&(s[n]=this.imm_jzon2json(e[r],t[n]),r++);return s}else return e}else if(typeof e=="object"){if(Array.isArray(t))return e;if(typeof t=="object"){let i=null;for(let s in t)if(t.hasOwnProperty(s)){i=t[s];break}let r={};for(let s in e)e.hasOwnProperty(s)&&(t.hasOwnProperty(s)&&(!Array.isArray(t[s])||t[s].length>0)?r[s]=this.imm_jzon2json(e[s],t[s]):r[s]=this.imm_jzon2json(e[s],i));return r}else return e}return e}requestAPI(e){return A(this,void 0,void 0,function*(){if(this._cache._expiration>this._yapi.GetTickCount()){let s=new Ht(this._cache._json);return s.obj_result=JSON.parse(JSON.stringify(this._cache._precooked)),s}let t="GET /api.json",i=this._cache._precooked;i.module&&i.module.firmwareRelease&&(t+="?fw="+encodeURIComponent(i.module.firmwareRelease));let r=yield this._yapi.devRequest(this._rootUrl,t,null,0);if(r.errorType!=0)return r;e||(e=this._yapi.defaultCacheValidity),this._cache._json=r.bin_result;try{if(r.obj_result=JSON.parse(this._yapi.imm_bin2str(r.bin_result)),Array.isArray(r.obj_result))if(i.module){let s=this.imm_jzon2json(r.obj_result,i);if(r.obj_result=s,s.module&&s.module.serialNumber===s.module.serialNumber&&s.module.firmwareRelease===s.module.firmwareRelease){let n=JSON.stringify(r.obj_result);this._cache._json=r.bin_result=this._yapi.imm_str2bin(n),this._cache._precooked=JSON.parse(n)}else this.imm_dropCache(),r.errorType=-8,r.errorMsg="Request failed, could not parse API JZON result for "+this._rootUrl}else r.errorType=-8,r.errorMsg="Request failed, could not parse API array result for "+this._rootUrl;else r.obj_result.module&&r.obj_result.module.firmwareRelease&&(this._cache._precooked=JSON.parse(JSON.stringify(r.obj_result)));this._cache._expiration=this._yapi.GetTickCount()+e,this._logicalName=r.obj_result.module.logicalName,this._beacon=r.obj_result.module.beacon}catch(s){r.errorType=-8,r.errorMsg="Request failed, could not parse API JSON result for "+this._rootUrl}return r})}refresh(){return A(this,void 0,void 0,function*(){let e=yield this.requestAPI(this._yapi.defaultCacheValidity);return e.errorType!=0?this._throw(e.errorType,e.errorMsg,e.errorType):(yield this.updateFromReq(e,e.obj_result),0)})}waitPendingQueries(){return A(this,void 0,void 0,function*(){let e=this._pendingQueries;if(e!=null)try{yield e}catch(t){console.log(t)}})}};m(jn,"YDevice");var ys=jn,cr=class cr{constructor(e,t,i,r,s,n,o,a,l,h,u,_){this._path=e,this._serial=t,this._pictype=i,this._product=r,this._firmware=s,this._prog_version=n,this._ROM_nb_zone=o,this._FLA_nb_zone=a,this._ROM_total_size=l,this._FLA_total_size=h,this._data=u,this._zone_ofs=_}static imm_Parse(e,t,i){let d=0,g=m((()=>{let _e=t[d]+(t[d+1]<<8);return d+=2,_e}),"getShort"),y=m((()=>{let _e=t[d]+(t[d+1]<<8)+(t[d+2]<<16)+(t[d+3]<<24);return d+=4,_e}),"getInt"),p=m((_e=>{let te=d+_e;for(;te>d&&t[te-1]==0;)te--;let pe=E.imm_bin2str(t.subarray(d,te));return d+=_e,pe}),"getString");if(p(4)!="BYN")return null;let w=g(),f=p(20),T=p(20),R=p(28),P=p(22);if(f.length>=20||R.length>=28||P.length>=22)return null;let I=0,F=0,z=0,U=0,j,se="",ne,ee;switch(w){case 4:if(ne=104,I=y(),ee=y(),I>16||ee!=t.length-104)return null;break;case 5:if(ne=128,se=p(22),!i&&!cr.imm_progCompatible(se)||(g(),I=y(),ee=y(),I>16)||ee!=t.length-128)return null;break;case 6:ne=144;let _e=t.subarray(d,d+16);d+=16;let te=E.imm_bin2hexstr(_e),pe=new ms;pe.addData(t.subarray(112));let Xe=E.imm_bin2hexstr(pe.calculate());if(te!=Xe)return E.imm_log("Invalid firmware image signature, file is corrupt"),E._logLevel>=2&&(E.imm_log("hdr MD5: "+te),E.imm_log("byn MD5: "+Xe),E.imm_log("byn size: "+t.length)),null;if(se=p(22),!i&&!cr.imm_progCompatible(se)||(I=t[d++],F=t[d++],z=y(),U=y(),I>16)||F>4)return null;break;default:return null}return new cr(e,f,T,R,P,se,I,F,z,U,t,ne)}static imm_progCompatible(e){if(e=="")return!0;let t=E.imm_GetAPIVersion(),i=t.indexOf("-");return i>0&&(t=t.slice(0,i)),t=t.slice(t.lastIndexOf(".")+1),parseInt(e)>parseInt(t)?(E.imm_log("checkProgField: byn="+e+" api="+t),!1):!0}imm_getSerial(){return this._serial}imm_getPictype(){return this._pictype}imm_getProduct(){return this._product}imm_getFirmwareRelease(){return this._firmware}imm_getFirmwareReleaseAsInt(){return parseInt(this._firmware)}imm_getProg_version(){return this._prog_version}imm_getROM_nb_zone(){return this._ROM_nb_zone}imm_getFLA_nb_zone(){return this._FLA_nb_zone}imm_getROM_total_size(){return this._ROM_total_size}imm_getFLA_total_size(){return this._FLA_total_size}imm_getData(){return this._data}imm_getPath(){return this._path}};m(cr,"YFirmwareFile");var As=cr,_r=class _r{constructor(e,t,i,r,s){this._serial="",this._settings=new Uint8Array(0),this._firmwarepath="",this._progress_msg="",this._progress_c=0,this._progress=0,this._restore_step=0,this._force=!1,this._yapi=e,this._serial=t,this._firmwarepath=i,this._settings=r,this._force=s}imm_progress(e,t){this._progress=e,this._progress_msg=t}_processMore_internal(e){return A(this,void 0,void 0,function*(){if(!e)return 0;let t;this.imm_progress(0,"Firmware update started"),typeof this._firmwarepath=="string"&&this._firmwarepath.indexOf("yoctopuce.com")>=0?(this.imm_progress(1,"Downloading firmware"),t=yield this._yapi.system_env.downloadfile(this._firmwarepath,this._yapi)):(this.imm_progress(1,"Loading firmware"),t=yield this._yapi.system_env.loadfile(this._firmwarepath));let i=As.imm_Parse(this._firmwarepath,t,this._force);if(!i)return this._yapi._throw(-4,"Device "+this._serial+" is not detected",-4);this.imm_progress(5,"Check if module is already in bootloader");let r=null,s=ke.FindModuleInContext(this._yapi,this._serial+".module");if(yield s.isOnline()){let o=this._yapi.imm_getDevice(this._serial).imm_getRootUrl(),a=o.indexOf("/bySerial/");a>=0?o=o.slice(0,a+1):o.slice(-1)!="/"&&(o=o+"/");let l=new si(o);r=this._yapi.imm_getHub(l)}else{let n=this._yapi._connectedHubs;for(let o=0;o<n.length;o++)if((yield n[o].getBootloaders()).indexOf(this._serial)>=0){r=n[o];break}}if(r==null)return this.imm_progress(-1,"Device "+this._serial+" is not detected"),this._yapi._throw(-4,"Device "+this._serial+" is not detected",-4);try{yield r.firmwareUpdate(this._serial,i,this._settings,(n,o)=>{this.imm_progress(5+(n*80+50)/100>>0,o)})}catch(n){return this.imm_progress(-1,n.message),this._yapi._throw(-8,n.message,-8)}if(s._cache.parentHub)this.imm_progress(100,"Firmware update scheduled successfully");else{this.imm_progress(80,"Wait for the device to restart");let n=this._yapi.GetTickCount()+6e4;for(yield s.clearCache();!(yield s.isOnline())&&n>this._yapi.GetTickCount();)yield this._yapi.Sleep(500),yield this._yapi.UpdateDeviceList();(yield s.isOnline())?(this._settings!=null&&(this.imm_progress(95,"Restoring device settings"),yield s.set_allSettingsAndFiles(this._settings),yield s.saveToFlash()),(yield s.get_firmwareRelease())==i.imm_getFirmwareRelease()?this.imm_progress(100,"Success"):this.imm_progress(-1,"Unable to update firmware")):this.imm_progress(-1,"Device did not reboot correctly")}return 0})}static checkFirmware_r(e,t,i){return A(this,void 0,void 0,function*(){if(e.substr(-4).toLowerCase()!=".byn")return null;let r=yield E.system_env.loadfile(e),s=As.imm_Parse(e,r,i);return!s||s.imm_getSerial().slice(0,t.length)!=t?null:s})}static CheckFirmwareEx(e,t,i,r){return A(this,void 0,void 0,function*(){let s="",n=0,o;if(typeof t=="string"&&t.indexOf("yoctopuce.com")>=0)try{let a=yield E.system_env.downloadfile("http://www.yoctopuce.com/FR/common/getLastFirmwareLink.php?serial="+e,E),l=JSON.parse(E.imm_bin2str(a));s=l.link,n=l.version}catch(a){return E.imm_log("failed to retrieve firmware information from www.yoctopuce.com",a),E._throw(-8,"failed to retrieve firmware information from www.yoctopuce.com",""),""}else{let a=yield _r.checkFirmware_r(t,e.substring(0,8),r);a!=null&&(n=a.imm_getFirmwareReleaseAsInt(),s=a.imm_getPath())}return i!=0?i<n?s:"":s})}static CheckFirmware_internal(e,t,i){return A(this,void 0,void 0,function*(){return _r.CheckFirmwareEx(e,t,i,!1)})}static GetAllBootLoadersInContext_internal(e){return A(this,void 0,void 0,function*(){let t=e._connectedHubs,i=[];for(let r=0;r<t.length;r++){let s=yield t[r].getBootloaders();for(let n=0;n<s.length;n++)i.push(s[n])}return i})}static GetAllBootLoaders_internal(){return A(this,void 0,void 0,function*(){return _r.GetAllBootLoadersInContext(E)})}_processMore(e){return A(this,void 0,void 0,function*(){return yield this._processMore_internal(e)})}static GetAllBootLoaders(){return A(this,void 0,void 0,function*(){return yield this.GetAllBootLoaders_internal()})}static GetAllBootLoadersInContext(e){return A(this,void 0,void 0,function*(){return yield this.GetAllBootLoadersInContext_internal(e)})}static CheckFirmware(e,t,i){return A(this,void 0,void 0,function*(){return yield this.CheckFirmware_internal(e,t,i)})}get_progress(){return A(this,void 0,void 0,function*(){return this._progress>=0&&(yield this._processMore(0)),this._progress})}get_progressMessage(){return A(this,void 0,void 0,function*(){return this._progress_msg})}startUpdate(){return A(this,void 0,void 0,function*(){let e,t;return e=this._yapi.imm_bin2str(this._settings),t=e.length,t>=6&&e.substr(0,6)=="error:"?(this._progress=-1,this._progress_msg=e.substr(6,t-6)):(this._progress=0,this._progress_c=0,yield this._processMore(1)),this._progress})}};m(_r,"YFirmwareUpdate");var Ss=_r,Je=class Je{constructor(e,t){this._logicalName=Je.LOGICALNAME_INVALID,this._advertisedValue=Je.ADVERTISEDVALUE_INVALID,this._valueCallbackFunction=null,this._cacheExpiration=0,this._serial="",this._funId="",this._hwId="",this.LOGICALNAME_INVALID=fe,this.ADVERTISEDVALUE_INVALID=fe,this._yapi=e,this._className="Function",this._func=t,this._lastErrorType=0,this._lastErrorMsg="no error",this._dataStreams={},this._userData=null,this._cache={_expiration:-1,functionid:"",hwid:""},this._valueCallbackFunction=null}_throw(e,t,i){return this._lastErrorType=e,this._lastErrorMsg=t,this._yapi._throw(e,t,i)}isReadOnly_internal(){return A(this,void 0,void 0,function*(){try{let e=yield this.get_serialNumber();return this._yapi.isReadOnly(e)}catch(e){return!0}})}imm_parseAttr(e,t){switch(e){case"_expiration":return this._cacheExpiration=t,1;case"logicalName":return this._logicalName=t,1;case"advertisedValue":return this._advertisedValue=t,1}return 0}get_logicalName(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Je.LOGICALNAME_INVALID:(e=this._logicalName,e)})}set_logicalName(e){return A(this,void 0,void 0,function*(){let t;return(yield E.CheckLogicalName(e))?(t=String(e),yield this._setAttr("logicalName",t)):this._throw(E.INVALID_ARGUMENT,"Invalid name :"+e,E.INVALID_ARGUMENT)})}get_advertisedValue(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Je.ADVERTISEDVALUE_INVALID:(e=this._advertisedValue,e)})}set_advertisedValue(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("advertisedValue",t)})}static FindFunction(e){let t;return t=Je._FindFromCache("Function",e),t==null&&(t=new Je(E,e),Je._AddToCache("Function",e,t)),t}static FindFunctionInContext(e,t){let i;return i=Je._FindFromCacheInContext(e,"Function",t),i==null&&(i=new Je(e,t),Je._AddToCache("Function",t,i)),i}registerValueCallback(e){return A(this,void 0,void 0,function*(){let t;return e!=null?yield Je._UpdateValueCallbackList(this,!0):yield Je._UpdateValueCallbackList(this,!1),this._valueCallbackFunction=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){return A(this,void 0,void 0,function*(){if(this._valueCallbackFunction!=null)try{yield this._valueCallbackFunction(this,e)}catch(t){this._yapi.imm_log("Exception in valueCallback:",t)}return 0})}muteValueCallbacks(){return A(this,void 0,void 0,function*(){return yield this.set_advertisedValue("SILENT")})}unmuteValueCallbacks(){return A(this,void 0,void 0,function*(){return yield this.set_advertisedValue("")})}loadAttribute(e){return A(this,void 0,void 0,function*(){let t,i;return t="api/"+(yield this.get_functionId())+"/"+e,i=yield this._download(t),this._yapi.imm_bin2str(i)})}isReadOnly(){return A(this,void 0,void 0,function*(){return yield this.isReadOnly_internal()})}get_serialNumber(){return A(this,void 0,void 0,function*(){let e;return e=yield this.get_module(),yield e.get_serialNumber()})}_parserHelper(){return 0}nextFunction(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:Je.FindFunctionInContext(this._yapi,t)}static FirstFunction(){let e=E.imm_getFirstHardwareId("Function");return e==null?null:Je.FindFunction(e)}static FirstFunctionInContext(e){let t=e.imm_getFirstHardwareId("Function");return t==null?null:Je.FindFunctionInContext(e,t)}static _FindFromCacheInContext(e,t,i){return e.imm_getFunction(t,i)}static _FindFromCache(e,t){return E.imm_getFunction(e,t)}static _AddToCache(e,t,i){i._yapi.imm_setFunction(e,t,i)}static _ClearCache(e=null){e||(e=E),e.imm_ResetToDefaults()}static _UpdateValueCallbackList(e,t){return A(this,void 0,void 0,function*(){yield e._yapi._UpdateValueCallbackList(e,t)})}static _UpdateTimedReportCallbackList(e,t){return A(this,void 0,void 0,function*(){yield e._yapi._UpdateTimedReportCallbackList(e,t)})}describe(){return A(this,void 0,void 0,function*(){if(this._hwId!="")return this._className+"("+this._func+")="+this._hwId;let e=this._yapi.imm_resolveFunction(this._className,this._func);return e.errorType!=0&&e.result!=this._func?this._className+"("+this._func+")=unresolved":this._className+"("+this._func+")="+e.result})}get_hardwareId(){return A(this,void 0,void 0,function*(){if(this._hwId!="")return this._hwId;let e=this._yapi.imm_resolveFunction(this._className,this._func);return e.errorType!=0&&(yield this.isOnline(),e=this._yapi.imm_resolveFunction(this._className,this._func),e.errorType!=0)?this._throw(e.errorType,e.errorMsg,Je.HARDWAREID_INVALID):e.result})}get_functionId(){return A(this,void 0,void 0,function*(){if(this._funId!="")return this._funId;let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=0&&(yield this.isOnline(),e=this._yapi.imm_resolveFunction(this._className,this._func),e.errorType!=0))return this._throw(e.errorType,e.errorMsg,Je.FUNCTIONID_INVALID);let t=e.result,i=t.indexOf(".");return t.substr(i+1)})}imm_get_functionId(){if(this._funId!="")return this._funId;let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=0)return this._throw(e.errorType,e.errorMsg,Je.FUNCTIONID_INVALID);let t=e.result,i=t.indexOf(".");return t.substr(i+1)}get_friendlyName(){return A(this,void 0,void 0,function*(){let e=this._yapi.imm_getFriendlyNameFunction(this._className,this._func);return e.errorType!=0&&(yield this.isOnline(),e=this._yapi.imm_getFriendlyNameFunction(this._className,this._func),e.errorType!=0)?this._throw(e.errorType,e.errorMsg,Je.FRIENDLYNAME_INVALID):e.result})}_parse(e,t){return A(this,void 0,void 0,function*(){if(e.obj_result){e.obj_result._expiration=this._yapi.GetTickCount()+t,this._cache=e.obj_result,this._serial=e.obj_result.deviceid,this._funId=e.obj_result.functionid,this._hwId=e.obj_result.hwid;for(let i in e.obj_result)this.imm_parseAttr(i,e.obj_result[i]);yield this._parserHelper()}})}isOnline_async(e,t){this.isOnline().then(i=>{e(t,this,i)}).catch(i=>{e(t,this,!1)})}load_async(e,t,i){this.load(e).then(r=>{t(i,this,0)}).catch(r=>{t(i,this,this.get_errorType())})}_getAttr(e){return A(this,void 0,void 0,function*(){return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?null:(typeof this._cache[e]=="undefined"&&this._throw(-5,"No such attribute "+e+" in function",null),this._cache[e])})}_getFixedAttr(e){return A(this,void 0,void 0,function*(){return this._cacheExpiration==0&&(yield this.load(this._yapi.defaultCacheValidity))!=0?null:(typeof this._cache[e]=="undefined"&&this._throw(-5,"No such attribute "+e+" in function",null),this._cache[e])})}imm_escapeAttr(e){return escape(e).replace(/[+]/g,"%2B").replace(/%20/g,"+").replace(/%21/g,"!").replace(/%24/g,"$").replace(/%27/g,"'").replace(/%28/g,"(").replace(/%29/g,")").replace(/%2[cC]/g,",").replace(/%2[fF]/g,"/").replace(/%3[aA]/g,":").replace(/%3[bB]/g,";").replace(/%3[fF]/g,"?").replace(/%5[bB]/g,"[").replace(/%5[dD]/g,"]")}_setAttr(e,t){return A(this,void 0,void 0,function*(){if(t==null)return this._throw(-2,"Undefined value to set for attribute "+e,null);let i=encodeURIComponent(e),r=this.imm_escapeAttr(t),s="/"+i+"?"+i+"="+r+"&.";this._cacheExpiration!=0&&(this._cacheExpiration=this._yapi.GetTickCount(),this._cache._expiration=this._cacheExpiration);let n=yield this._yapi.funcRequest(this._className,this._func,s);return n.errorType!=0?this._throw(n.errorType,n.errorMsg,n.errorType):0})}_download(e){return A(this,void 0,void 0,function*(){let t=this._serial;if(t==""&&(t=yield(yield this.module()).get_serialNumber()),t==fe)return new Uint8Array(0);let i=yield this._yapi.devRequest(t,"GET /"+e,null,0);return i.errorType!=0?this._throw(i.errorType,i.errorMsg,""):i.bin_result})}_downloadOutOfBand(e){return A(this,void 0,void 0,function*(){let t=this._serial;if(t==""&&(t=yield(yield this.module()).get_serialNumber()),t==fe)return new Uint8Array(0);let i=yield this._yapi.devRequest(t,"GET /"+e,null,1);return i.errorType!=0?this._throw(i.errorType,i.errorMsg,""):i.bin_result})}_uploadWithProgress(e,t,i){return A(this,void 0,void 0,function*(){let r=this._serial;if(r==""&&(r=yield(yield this.module()).get_serialNumber()),r==fe){let o=new Ht(null);return o.errorType=this.get_errorType(),o.errorMsg=this.get_errorMessage(),o}let s="POST /upload.html",n=t.length;return typeof t=="string"||t instanceof String?t=this._yapi.imm_str2bin(t):t instanceof Array&&(t=new Uint8Array(t)),this._yapi.devRequest(r,s,new gr(e,t,i),0)})}_uploadEx(e,t){return A(this,void 0,void 0,function*(){let i=yield this._uploadWithProgress(e,t,null);return i.errorType!=0?this._throw(i.errorType,i.errorMsg,null):i.bin_result})}_upload(e,t){return A(this,void 0,void 0,function*(){let i=yield this._uploadWithProgress(e,t,null);return i.errorType!=0?this._throw(i.errorType,i.errorMsg,null):i.errorType})}wait_async(e,t){let i=this._serial;if(i=="")return this.module().then(n=>n.get_serialNumber().then(()=>this.wait_async(e,t))),0;if(i==fe)return e(t,this),0;let r=this._yapi.imm_getDevice(i),s=m((()=>{e(t,this)}),"delayedCode");return r._pendingQueries=r._pendingQueries.then(s,s),0}imm_json_get_key(e,t){let i=JSON.parse(this._yapi.imm_bin2str(e));return typeof i[t]!="undefined"?i[t]:""}imm_json_get_string(e){return JSON.parse(this._yapi.imm_bin2str(e))}imm_json_get_array(e){let t=JSON.parse(this._yapi.imm_bin2str(e)),i=[];for(let r in t)i.push(this._yapi.imm_str2bin(JSON.stringify(t[r])));return i}imm_get_json_path(e,t){let i=JSON.parse(this._yapi.imm_bin2str(e)),r=t.split("|");for(let s=0;s<r.length;s++){let n=r[s];if(i=i[n],i==null)return new Uint8Array}return this._yapi.imm_str2bin(JSON.stringify(i))}imm_decode_json_string(e){return e.length==0?"":JSON.parse(this._yapi.imm_bin2str(e))}imm_decode_json_int(e){return e.length==0?0:JSON.parse(this._yapi.imm_bin2str(e))}imm_findDataStream(e,t){let i=e.imm_get_functionId()+":"+t;if(this._dataStreams[i])return this._dataStreams[i];let r=this._yapi.imm_decodeWords(t);if(r.length<14)return this._throw(E.VERSION_MISMATCH,"device firwmare is too old",null),null;let s=new Lr(this,e,r);return this._dataStreams[i]=s,s}clearDataStreamCache(){return A(this,void 0,void 0,function*(){this._dataStreams={}})}isOnline(){return A(this,void 0,void 0,function*(){if(this._cacheExpiration>this._yapi.GetTickCount())return!0;let e=yield this._yapi.funcRequest(this._className,this._func,"",this._yapi.defaultCacheValidity);return e.errorType!=0?e.errorType==-6:(yield this._parse(e,this._yapi.defaultCacheValidity),!0)})}get_errorType(){return this._lastErrorType}get_errorMessage(){return this._lastErrorMsg}load(e){return A(this,void 0,void 0,function*(){let t=yield this._yapi.funcRequest(this._className,this._func,"",e);return t.errorType!=0?this._throw(t.errorType,t.errorMsg,t.errorType):(yield this._parse(t,e),0)})}clearCache(){return A(this,void 0,void 0,function*(){let e=yield this._yapi._funcDev(this._className,this._func);e.errorType==0&&(e.obj_result.device.imm_dropCache(),this._cacheExpiration>0&&(this._cacheExpiration=this._yapi.GetTickCount()))})}module(){return A(this,void 0,void 0,function*(){if(this._serial!="")return ke.FindModuleInContext(this._yapi,this._serial+".module");let e=this._func,t;e.indexOf(".")<0&&(t=this._yapi.imm_resolveFunction(this._className,this._func),t.errorType==0&&(e=t.result));let i=e.indexOf(".");return i>=0?ke.FindModuleInContext(this._yapi,e.substr(0,i)+".module"):((yield this.load(this._yapi.defaultCacheValidity))==0&&(t=this._yapi.imm_resolveFunction(this._className,this._func),t.result&&(e=t.result)),i=e.indexOf("."),i>=0?ke.FindModuleInContext(this._yapi,e.substr(0,i)+".module"):ke.FindModuleInContext(this._yapi,"module_of_"+this._className+"_"+this._func))})}get_module(){return A(this,void 0,void 0,function*(){return this.module()})}get_functionDescriptor(){return A(this,void 0,void 0,function*(){if(this._hwId!="")return this._hwId;let e=this._func;if(e.indexOf(".")<0){let i=this._yapi.imm_resolveFunction(this._className,this._func);i.errorType!=0&&(e=i.result)}return e.indexOf(".")>=0?e:Sl})}get_userData(){return A(this,void 0,void 0,function*(){return this._userData})}set_userData(e){return A(this,void 0,void 0,function*(){this._userData=e})}};m(Je,"YFunction");var ue=Je;ue.LOGICALNAME_INVALID=fe;ue.ADVERTISEDVALUE_INVALID=fe;(function(D){D.FUNCTIONDESCRIPTOR_INVALID=fe,D.HARDWAREID_INVALID=fe,D.FUNCTIONID_INVALID=fe,D.FRIENDLYNAME_INVALID=fe})(ue||(ue={}));var Te=class Te extends ue{constructor(e,t){super(e,t),this._productName=Te.PRODUCTNAME_INVALID,this._serialNumber=Te.SERIALNUMBER_INVALID,this._productId=Te.PRODUCTID_INVALID,this._productRelease=Te.PRODUCTRELEASE_INVALID,this._firmwareRelease=Te.FIRMWARERELEASE_INVALID,this._persistentSettings=Te.PERSISTENTSETTINGS_INVALID,this._luminosity=Te.LUMINOSITY_INVALID,this._beacon=Te.BEACON_INVALID,this._upTime=Te.UPTIME_INVALID,this._usbCurrent=Te.USBCURRENT_INVALID,this._rebootCountdown=Te.REBOOTCOUNTDOWN_INVALID,this._userVar=Te.USERVAR_INVALID,this._valueCallbackModule=null,this._logCallback=null,this._confChangeCallback=null,this._beaconCallback=null,this.PRODUCTNAME_INVALID=fe,this.SERIALNUMBER_INVALID=fe,this.PRODUCTID_INVALID=-1,this.PRODUCTRELEASE_INVALID=-1,this.FIRMWARERELEASE_INVALID=fe,this.PERSISTENTSETTINGS_LOADED=0,this.PERSISTENTSETTINGS_SAVED=1,this.PERSISTENTSETTINGS_MODIFIED=2,this.PERSISTENTSETTINGS_INVALID=-1,this.LUMINOSITY_INVALID=-1,this.BEACON_OFF=0,this.BEACON_ON=1,this.BEACON_INVALID=-1,this.UPTIME_INVALID=Mr,this.USBCURRENT_INVALID=-1,this.REBOOTCOUNTDOWN_INVALID=2147483647,this.USERVAR_INVALID=2147483647,this._className="Module";let i=this._func,r=i.indexOf(".");r>0&&(i=i.substr(0,r));let s=this._yapi.imm_getDevice(i);s&&(this._serial=s.imm_getSerialNumber(),this._funId="module",this._hwId=this._serial+".module")}_throw(e,t,i){return this._lastErrorType=e,this._lastErrorMsg=t,this._yapi._throw(e,t,i)}static _updateModuleCallbackList(e,t){return A(this,void 0,void 0,function*(){})}imm_getDev(){let e=this._func,t=e.indexOf(".");t>0&&(e=e.substr(0,t));let i=this._yapi.imm_getDevice(e);return i||this._throw(-4,"Device ["+e+"] is not online",null),i}forceDeviceRefresh(){return A(this,void 0,void 0,function*(){!this.imm_getDev()||!this._serial||(yield this._yapi.ForceDeviceRefresh(this._serial),this._cacheExpiration>0&&(this._cacheExpiration=this._yapi.GetTickCount()))})}functionCount(){return A(this,void 0,void 0,function*(){let e=this.imm_getDev();return e?e.imm_functionCount():-4})}functionId(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDev();return t?t.imm_functionId(e):""})}functionType(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDev();return t?t.imm_functionType(e):""})}functionBaseType(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDev();return t?t.imm_functionBaseType(e):""})}functionName(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDev();return t?t.imm_functionName(e):""})}functionValue(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDev();return t?t.imm_functionValue(e):""})}get_logicalName(){return A(this,void 0,void 0,function*(){let e=this.imm_getDev();if(e!=null&&this._cache._expiration<=this._yapi.GetTickCount())return e.getLogicalName();let t=yield this._getAttr("logicalName");return t==null?Te.LOGICALNAME_INVALID:t})}set_logicalName(e){let t=Object.create(null,{set_logicalName:{get:m(()=>super.set_logicalName,"get")}});return A(this,void 0,void 0,function*(){let i=yield t.set_logicalName.call(this,e),r=this.imm_getDev();return r!=null&&r.imm_dropCache(),i})}imm_flattenJsonStruct_internal(e){let t=JSON.parse(this._yapi.imm_bin2str(e)),i=[];for(let r in t){if(r=="services")continue;let s=t[r];for(let n in s){let o=s[n];if(o===null||typeof o=="object")continue;let a=r+"/"+n+"="+o;i.push(a)}}return this._yapi.imm_str2bin(JSON.stringify(i))}get_subDevices_internal(){return A(this,void 0,void 0,function*(){let e=yield this.get_url_internal();if(!e)return[];let t=null,i="";for(let n=0;n<this._yapi._connectedHubs.length;n++)if(i=this._yapi._connectedHubs[n].imm_getRootUrl(),e.slice(0,i.length)==i){t=this._yapi._connectedHubs[n];break}if(!t||!i)return[];let r=t.serialByYdx[0];if(r!=this._serial)return[];let s=[];for(let n in this._yapi._devs)this._yapi._devs[n].imm_getRootUrl().substr(0,i.length)==i&&n!=r&&s.push(n);return s})}get_parentHub_internal(){return A(this,void 0,void 0,function*(){let e=yield this.get_url_internal();if(!e)return"";let t=null;for(let r=0;r<this._yapi._connectedHubs.length;r++){let s=this._yapi._connectedHubs[r].imm_getRootUrl();if(e.slice(0,s.length)==s){t=this._yapi._connectedHubs[r];break}}if(!t)return"";let i=t.serialByYdx[0];return i==this._serial?"":i})}get_url_internal(){return A(this,void 0,void 0,function*(){let e=this._serial;if(e==""&&(e=yield this.get_serialNumber()),e==fe)return"";let t=this._yapi.imm_getDevice(e);return t?t.imm_getRootUrl():""})}_startStopDevLog_internal(e,t){return A(this,void 0,void 0,function*(){let i=this.imm_getDev();if(i!=null)return i.imm_registerLogCallback(this._logCallback)})}imm_parseAttr(e,t){switch(e){case"productName":return this._productName=t,1;case"serialNumber":return this._serialNumber=t,1;case"productId":return this._productId=t,1;case"productRelease":return this._productRelease=t,1;case"firmwareRelease":return this._firmwareRelease=t,1;case"persistentSettings":return this._persistentSettings=t,1;case"luminosity":return this._luminosity=t,1;case"beacon":return this._beacon=t,1;case"upTime":return this._upTime=t,1;case"usbCurrent":return this._usbCurrent=t,1;case"rebootCountdown":return this._rebootCountdown=t,1;case"userVar":return this._userVar=t,1}return super.imm_parseAttr(e,t)}get_productName(){return A(this,void 0,void 0,function*(){let e,t;if(this._cacheExpiration==0){if(t=this.imm_getDev(),t!=null)return t.imm_getProductName();if((yield this.load(this._yapi.defaultCacheValidity))!=0)return Te.PRODUCTNAME_INVALID}return e=this._productName,e})}get_serialNumber(){return A(this,void 0,void 0,function*(){let e,t;if(this._cacheExpiration==0){if(t=this.imm_getDev(),t!=null)return t.imm_getSerialNumber();if((yield this.load(this._yapi.defaultCacheValidity))!=0)return Te.SERIALNUMBER_INVALID}return e=this._serialNumber,e})}get_productId(){return A(this,void 0,void 0,function*(){let e,t;if(this._cacheExpiration==0){if(t=this.imm_getDev(),t!=null)return t.imm_getProductId();if((yield this.load(this._yapi.defaultCacheValidity))!=0)return Te.PRODUCTID_INVALID}return e=this._productId,e})}get_productRelease(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration==0&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.PRODUCTRELEASE_INVALID:(e=this._productRelease,e)})}get_firmwareRelease(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.FIRMWARERELEASE_INVALID:(e=this._firmwareRelease,e)})}get_persistentSettings(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.PERSISTENTSETTINGS_INVALID:(e=this._persistentSettings,e)})}set_persistentSettings(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("persistentSettings",t)})}get_luminosity(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.LUMINOSITY_INVALID:(e=this._luminosity,e)})}set_luminosity(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("luminosity",t)})}get_beacon(){return A(this,void 0,void 0,function*(){let e,t;if(this._cacheExpiration<=this._yapi.GetTickCount()){if(t=this.imm_getDev(),t!=null)return t.imm_getBeacon();if((yield this.load(this._yapi.defaultCacheValidity))!=0)return Te.BEACON_INVALID}return e=this._beacon,e})}set_beacon(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("beacon",t)})}get_upTime(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.UPTIME_INVALID:(e=this._upTime,e)})}get_usbCurrent(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.USBCURRENT_INVALID:(e=this._usbCurrent,e)})}get_rebootCountdown(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.REBOOTCOUNTDOWN_INVALID:(e=this._rebootCountdown,e)})}set_rebootCountdown(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("rebootCountdown",t)})}get_userVar(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Te.USERVAR_INVALID:(e=this._userVar,e)})}set_userVar(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("userVar",t)})}static FindModule(e){let t,i,r;return i=e,r=e.indexOf(".module"),r!=e.length-7&&(i=e+".module"),t=ue._FindFromCache("Module",i),t==null&&(t=new Te(E,i),ue._AddToCache("Module",i,t)),t}static FindModuleInContext(e,t){let i,r,s;return r=t,s=t.indexOf(".module"),s!=t.length-7&&(r=t+".module"),i=ue._FindFromCacheInContext(e,"Module",r),i==null&&(i=new Te(e,r),ue._AddToCache("Module",r,i)),i}registerValueCallback(e){return A(this,void 0,void 0,function*(){let t;return e!=null?yield ue._UpdateValueCallbackList(this,!0):yield ue._UpdateValueCallbackList(this,!1),this._valueCallbackModule=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){let t=Object.create(null,{_invokeValueCallback:{get:m(()=>super._invokeValueCallback,"get")}});return A(this,void 0,void 0,function*(){if(this._valueCallbackModule!=null)try{yield this._valueCallbackModule(this,e)}catch(i){this._yapi.imm_log("Exception in valueCallback:",i)}else yield t._invokeValueCallback.call(this,e);return 0})}get_productNameAndRevision(){return A(this,void 0,void 0,function*(){let e,t,i;return e=yield this.get_productName(),t=yield this.get_productRelease(),t>1?i=e+" rev. "+String.fromCharCode(64+t):i=e,i})}saveToFlash(){return A(this,void 0,void 0,function*(){return yield this.set_persistentSettings(1)})}revertFromFlash(){return A(this,void 0,void 0,function*(){return yield this.set_persistentSettings(0)})}reboot(e){return A(this,void 0,void 0,function*(){return yield this.set_rebootCountdown(e)})}triggerFirmwareUpdate(e){return A(this,void 0,void 0,function*(){return yield this.set_rebootCountdown(-e)})}_startStopDevLog(e,t){return A(this,void 0,void 0,function*(){return yield this._startStopDevLog_internal(e,t)})}registerLogCallback(e){return A(this,void 0,void 0,function*(){let t;return t=yield this.get_serialNumber(),t==fe?-4:(this._logCallback=e,yield this._startStopDevLog(t,e!=null),0)})}get_logCallback(){return A(this,void 0,void 0,function*(){return this._logCallback})}registerConfigChangeCallback(e){return A(this,void 0,void 0,function*(){return e!=null?yield Te._updateModuleCallbackList(this,!0):yield Te._updateModuleCallbackList(this,!1),this._confChangeCallback=e,0})}_invokeConfigChangeCallback(){return A(this,void 0,void 0,function*(){if(this._confChangeCallback!=null)try{yield this._confChangeCallback(this)}catch(e){this._yapi.imm_log("Exception in configChangeCallback:",e)}return 0})}registerBeaconCallback(e){return A(this,void 0,void 0,function*(){return e!=null?yield Te._updateModuleCallbackList(this,!0):yield Te._updateModuleCallbackList(this,!1),this._beaconCallback=e,0})}_invokeBeaconCallback(e){return A(this,void 0,void 0,function*(){if(this._beaconCallback!=null)try{yield this._beaconCallback(this,e)}catch(t){this._yapi.imm_log("Exception in beaconCallback:",t)}return 0})}triggerConfigChangeCallback(){return A(this,void 0,void 0,function*(){return yield this._setAttr("persistentSettings","2"),0})}checkFirmware(e,t){return A(this,void 0,void 0,function*(){let i,r,s;return t?r=be.imm_atoi(yield this.get_firmwareRelease()):r=0,i=yield this.get_serialNumber(),s=yield Ss.CheckFirmware(i,e,r),s.indexOf("error:")==0&&this._throw(-2,s),s})}updateFirmwareEx(e,t){return A(this,void 0,void 0,function*(){let i,r;return i=yield this.get_serialNumber(),r=yield this.get_allSettings(),r.length==0&&(this._throw(-8,"Unable to get device settings"),r=this._yapi.imm_str2bin("error:Unable to get device settings")),new Ss(this._yapi,i,e,r,t)})}updateFirmware(e){return A(this,void 0,void 0,function*(){return yield this.updateFirmwareEx(e,!1)})}get_allSettings(){return A(this,void 0,void 0,function*(){let e,t,i,r,s,n,o,a,l,h,u,_,d,g=[],y=[];if(e=yield this._download("api.json"),e.length==0)return e;d=', "extras":[',y=yield this.get_functionIds("Temperature"),r="";for(let p of y)be.imm_atoi(yield this.get_firmwareRelease())>9e3&&(l="api/"+p+"/sensorType",o=this._yapi.imm_bin2str(yield this._download(l)),(o=="RES_NTC"||o=="RES_LINEAR")&&(a=p.substr(11,p.length-11),a==""&&(a="1"),_=yield this._download("extra.json?page="+a),_.length>0&&(n=r+'{"fid":"'+p+'", "json":'+this._yapi.imm_bin2str(_)+`}
`,d=d+n,r=",")));if(d=d+`],
"files":[`,yield this.hasFunction("files")){if(t=yield this._download("files.json?a=dir&d=1&f="),t.length==0)return t;g=this.imm_json_get_array(t),r="";for(let p of g)s=this.imm_json_get_key(p,"name"),s.length>0&&s!="startupConf.json"&&(s.substr(s.length-1,1)=="/"?h="":(u=yield this._download(this.imm_escapeAttr(s)),h=this._yapi.imm_bin2hexstr(u)),n=r+'{"name":"'+s+'", "data":"'+h+`"}
`,d=d+n,r=",")}return i=this._yapi.imm_str2bin('{ "api":'+this._yapi.imm_bin2str(e)+d+"]}"),i})}loadThermistorExtra(e,t){return A(this,void 0,void 0,function*(){let i=[],r,s,n,o,a,l,h;for(r="api/"+e+".json?command=Z",yield this._download(r),i=this.imm_json_get_array(this._yapi.imm_str2bin(t)),l=0,h=i.length;l+1<h;)n=i[l],a=i[l+1],s=this.imm_json_get_string(n),o=this.imm_json_get_string(a),r="api/"+e+".json?command=m"+s+":"+o,yield this._download(r),l=l+2;return 0})}set_extraSettings(e){return A(this,void 0,void 0,function*(){let t=[],i,r,s;t=this.imm_json_get_array(this._yapi.imm_str2bin(e));for(let n of t)i=this.imm_get_json_path(n,"fid"),r=this.imm_json_get_string(i),s=this.imm_get_json_path(n,"json"),(yield this.hasFunction(r))&&(yield this.loadThermistorExtra(r,this._yapi.imm_bin2str(s)));return 0})}set_allSettingsAndFiles(e){return A(this,void 0,void 0,function*(){let t,i,r,s,n,o;if(n=0,i=this.imm_get_json_path(e,"api"),i.length==0)return yield this.set_allSettings(e);if(s=this.imm_get_json_path(e,"extras"),s.length>0&&(yield this.set_extraSettings(this._yapi.imm_bin2str(s))),yield this.set_allSettings(i),yield this.hasFunction("files")){let a=[],l,h,u,_;if(t=yield this._download("files.json?a=format"),t=this.imm_get_json_path(t,"res"),l=this.imm_json_get_string(t),l!="ok")return this._throw(-8,"format failed",-8);r=this.imm_get_json_path(e,"files"),a=this.imm_json_get_array(r);for(let d of a)h=this.imm_get_json_path(d,"name"),u=this.imm_json_get_string(h),h=this.imm_get_json_path(d,"data"),_=this.imm_json_get_string(h),u==""?n=n+1:yield this._upload(u,this._yapi.imm_hexstr2bin(_))}return o=yield this.set_allSettings(i),n!=0?this._throw(-8,"Error during file upload",-8):o})}hasFunction(e){return A(this,void 0,void 0,function*(){let t,i,r;for(t=yield this.functionCount(),i=0;i<t;){if(r=yield this.functionId(i),r==e)return!0;i=i+1}return!1})}get_functionIds(e){return A(this,void 0,void 0,function*(){let t,i,r,s=[];for(t=yield this.functionCount(),i=0;i<t;)r=yield this.functionType(i),r==e?s.push(yield this.functionId(i)):(r=yield this.functionBaseType(i),r==e&&s.push(yield this.functionId(i))),i=i+1;return s})}imm_flattenJsonStruct(e){return this.imm_flattenJsonStruct_internal(e)}calibVersion(e){return A(this,void 0,void 0,function*(){return e=="0,"?3:e.indexOf(",")>=0?e.indexOf(" ")>0?3:1:e==""||e=="0"?1:e.length<2||e.indexOf(".")>=0?0:2})}calibScale(e,t){return A(this,void 0,void 0,function*(){return e=="g"||e=="gauss"||e=="W"?1e3:e=="C"?t==""||be.imm_atoi(t)<8?16:100:e=="m"||e=="deg"?10:1})}calibOffset(e){return A(this,void 0,void 0,function*(){return e=="% RH"||e=="mbar"||e=="lx"?0:32767})}calibConvert(e,t,i,r){return A(this,void 0,void 0,function*(){let s,n,o,a,l,h,u=[],_=[],d=[],g=[],y,p,x,w,f,T;if(s=yield this.calibVersion(e),n=yield this.calibVersion(t),o=yield this.calibScale(i,r),a=yield this.calibOffset(i),l=o,h=a,n<3&&(n==2?(u=this._yapi.imm_decodeWords(t),u[0]==1366&&u[1]==12500?(o=1,a=0):(o=u[1],a=u[0])):n==1&&(t==""||be.imm_atoi(t)>10)&&(o=0)),d.length=0,y=0,s<3){if(s==2){if(u=this._yapi.imm_decodeWords(e),u[0]==1366&&u[1]==12500?(l=1,h=0):(l=u[1],h=u[0]),u.length>=3&&u[2]>0)for(x=3+2*(u[2]%10),x>u.length&&(x=u.length),p=3;p<x;)d.push(u[p]),p=p+1}else if(s==1){_=e.split(",");for(let R of _)u.push(be.imm_atoi(R));if((e==""||u[0]>10)&&(l=0),u.length>0&&u[0]>0)for(x=1+2*(u[0]%10),x>u.length&&(x=u.length),p=1;p<x;)d.push(u[p]),p=p+1}else s==0&&(w=be.imm_atof(e),w>0&&(d.push(0),d.push(0),d.push(Math.round(65535/w)),d.push(65535)));for(p=0;p<d.length;)l>0?d[p]=(d[p]-h)/l:d[p]=this._yapi.imm_decimalToDouble(Math.round(d[p])),p=p+1}else for(g=this._yapi.imm_decodeFloats(e),y=Math.round(g[0]/1e3),y>=30&&(y=y-30),p=1;p<g.length;)d.push(g[p]/1e3),p=p+1;if(n>=3)if(d.length==0)e="0,";else{for(e=(30+y).toString(),p=0;p<d.length;)(p&1)>0?e=e+":":e=e+" ",e=e+Math.round(d[p]*1e3/1e3).toString(),p=p+1;e=e+","}else if(n>=1)for(f=d.length/2>>0,e=f.toString(),p=0;p<2*f;)o==0?T=this._yapi.imm_doubleToDecimal(Math.round(d[p])):T=d[p]*o+a,e=e+","+Math.round(T).toString(),p=p+1;else d.length==4&&(e=Math.round(1e3*(d[3]-d[1])/d[2]-d[0]).toString());return e})}_tryExec(e){return A(this,void 0,void 0,function*(){let t,i;t=0,i=1;try{yield this._download(e)}catch(r){i=0}if(i==0)try{yield E.Sleep(500),yield this._download(e)}catch(r){t=yield this.get_errorType()}return t})}set_allSettings(e){return A(this,void 0,void 0,function*(){let t=[],i,r=[],s=[],n=[],o=[],a,l=[],h=[],u=[],_=[],d,g,y,p,x,w,f,T,R,P,I,F,z,U,j,se,ne,ee,_e,te,pe,Xe,Oe,H,ie;f=0,ne=this.imm_get_json_path(e,"api"),ne.length>0&&(e=ne),z="",pe="",te="",i=this.imm_flattenJsonStruct(e),r=this.imm_json_get_array(i);for(let mt of r){if(Oe=this.imm_json_get_string(mt),y=Oe.length,g=Oe.indexOf("="),g<0||y==0)return this._throw(-2,"Invalid settings"),-2;R=Oe.substr(0,g),g=g+1,F=Oe.substr(g,y-g),s.push(R),n.push(R.length),o.push(F),R=="module/serialNumber"&&(z=F)}try{a=yield this._download("api.json")}catch(mt){yield E.Sleep(500),a=yield this._download("api.json")}U=yield this.get_serialNumber(),(z==U||z=="")&&(z="_NO_SERIAL_FILTER_"),a=this.imm_flattenJsonStruct(a),l=this.imm_json_get_array(a);for(let mt of l){if(Oe=this.imm_json_get_string(mt),y=Oe.length,g=Oe.indexOf("="),g<0||y==0)return this._throw(-2,"Invalid settings"),-2;R=Oe.substr(0,g),g=g+1,F=Oe.substr(g,y-g),h.push(R),u.push(R.length),_.push(F)}for(p=0;p<h.length;)if(T=h[p],y=T.length,d=T.indexOf("/"),!(d<0||y==0)){if(P=T.substr(0,d),d=d+1,I=T.substr(d,y-d),H=!0,P=="services"&&(H=!1),H&&I=="firmwareRelease"&&(H=!1),H&&I=="usbCurrent"&&(H=!1),H&&I=="upTime"&&(H=!1),H&&I=="persistentSettings"&&(H=!1),H&&I=="adminPassword"&&(H=!1),H&&I=="userPassword"&&(H=!1),H&&I=="rebootCountdown"&&(H=!1),H&&I=="advertisedValue"&&(H=!1),H&&I=="poeCurrent"&&(H=!1),H&&I=="readiness"&&(H=!1),H&&I=="ipAddress"&&(H=!1),H&&I=="subnetMask"&&(H=!1),H&&I=="router"&&(H=!1),H&&I=="linkQuality"&&(H=!1),H&&I=="ssid"&&(H=!1),H&&I=="channel"&&(H=!1),H&&I=="security"&&(H=!1),H&&I=="message"&&(H=!1),H&&I=="signalValue"&&(H=!1),H&&I=="currentValue"&&(H=!1),H&&I=="currentRawValue"&&(H=!1),H&&I=="currentRunIndex"&&(H=!1),H&&I=="pulseTimer"&&(H=!1),H&&I=="lastTimePressed"&&(H=!1),H&&I=="lastTimeReleased"&&(H=!1),H&&I=="filesCount"&&(H=!1),H&&I=="freeSpace"&&(H=!1),H&&I=="timeUTC"&&(H=!1),H&&I=="rtcTime"&&(H=!1),H&&I=="unixTime"&&(H=!1),H&&I=="dateTime"&&(H=!1),H&&I=="rawValue"&&(H=!1),H&&I=="lastMsg"&&(H=!1),H&&I=="delayedPulseTimer"&&(H=!1),H&&I=="rxCount"&&(H=!1),H&&I=="txCount"&&(H=!1),H&&I=="msgCount"&&(H=!1),H&&I=="rxMsgCount"&&(H=!1),H&&I=="txMsgCount"&&(H=!1),H)for(H=!1,x=0,ie=!1,te=_[p];x<s.length&&!ie;)u[p]==n[x]&&h[p]==s[x]&&(ie=!0,pe=o[x],te!=pe&&pe!=z&&(H=!0)),x=x+1;if(H)if(I=="calibrationParam"){for(Xe="",_e="",ee="",x=0,ie=!1;x<s.length&&!ie;)u[p]==n[x]&&h[p]==s[x]&&(ie=!0,Xe=o[x]),x=x+1;for(se=P+"/unit",x=0,ie=!1;x<h.length&&!ie;)se==h[x]&&(ie=!0,_e=_[x]),x=x+1;for(se=P+"/sensorType",x=0,ie=!1;x<h.length&&!ie;)se==h[x]&&(ie=!0,ee=_[x]),x=x+1;te=yield this.calibConvert(Xe,_[p],_e,ee),j="api/"+P+".json?"+I+"="+this.imm_escapeAttr(te),w=yield this._tryExec(j),f==0&&w!=0&&(f=w)}else j="api/"+P+".json?"+I+"="+this.imm_escapeAttr(pe),I=="resolution"?t.push(j):(w=yield this._tryExec(j),f==0&&w!=0&&(f=w));p=p+1}for(let mt of t)w=yield this._tryExec(mt),f==0&&w!=0&&(f=w);return yield this.clearCache(),f})}addFileToHTTPCallback(e){return A(this,void 0,void 0,function*(){let t;return t=yield this._download("@YCB+"+e),t.length==0?-3:0})}get_hardwareId(){return A(this,void 0,void 0,function*(){let e;return e=yield this.get_serialNumber(),e+".module"})}download(e){return A(this,void 0,void 0,function*(){return yield this._download(e)})}get_icon2d(){return A(this,void 0,void 0,function*(){return yield this._download("icon2d.png")})}get_lastLogs(){return A(this,void 0,void 0,function*(){let e;return e=yield this._download("logs.txt"),e.length==0?fe:this._yapi.imm_bin2str(e)})}log(e){return A(this,void 0,void 0,function*(){return yield this._upload("logs.txt",this._yapi.imm_str2bin(e))})}get_subDevices(){return A(this,void 0,void 0,function*(){return yield this.get_subDevices_internal()})}get_parentHub(){return A(this,void 0,void 0,function*(){return yield this.get_parentHub_internal()})}get_url(){return A(this,void 0,void 0,function*(){return yield this.get_url_internal()})}nextModule(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:Te.FindModuleInContext(this._yapi,t)}static FirstModule(){let e=E.imm_getFirstHardwareId("Module");return e==null?null:Te.FindModule(e)}static FirstModuleInContext(e){let t=e.imm_getFirstHardwareId("Module");return t==null?null:Te.FindModuleInContext(e,t)}};m(Te,"YModule");var ke=Te;ke.PRODUCTNAME_INVALID=fe;ke.SERIALNUMBER_INVALID=fe;ke.PRODUCTID_INVALID=-1;ke.PRODUCTRELEASE_INVALID=-1;ke.FIRMWARERELEASE_INVALID=fe;ke.PERSISTENTSETTINGS_LOADED=0;ke.PERSISTENTSETTINGS_SAVED=1;ke.PERSISTENTSETTINGS_MODIFIED=2;ke.PERSISTENTSETTINGS_INVALID=-1;ke.LUMINOSITY_INVALID=-1;ke.BEACON_OFF=0;ke.BEACON_ON=1;ke.BEACON_INVALID=-1;ke.UPTIME_INVALID=Mr;ke.USBCURRENT_INVALID=-1;ke.REBOOTCOUNTDOWN_INVALID=2147483647;ke.USERVAR_INVALID=2147483647;var ve=class ve extends ue{constructor(e,t){super(e,t),this._cal=null,this._unit=ve.UNIT_INVALID,this._currentValue=ve.CURRENTVALUE_INVALID,this._lowestValue=ve.LOWESTVALUE_INVALID,this._highestValue=ve.HIGHESTVALUE_INVALID,this._currentRawValue=ve.CURRENTRAWVALUE_INVALID,this._logFrequency=ve.LOGFREQUENCY_INVALID,this._reportFrequency=ve.REPORTFREQUENCY_INVALID,this._advMode=ve.ADVMODE_INVALID,this._calibrationParam=ve.CALIBRATIONPARAM_INVALID,this._resolution=ve.RESOLUTION_INVALID,this._sensorState=ve.SENSORSTATE_INVALID,this._valueCallbackSensor=null,this._timedReportCallbackSensor=null,this._prevTR=0,this._iresol=0,this.UNIT_INVALID=fe,this.CURRENTVALUE_INVALID=Ge,this.LOWESTVALUE_INVALID=Ge,this.HIGHESTVALUE_INVALID=Ge,this.CURRENTRAWVALUE_INVALID=Ge,this.LOGFREQUENCY_INVALID=fe,this.REPORTFREQUENCY_INVALID=fe,this.ADVMODE_IMMEDIATE=0,this.ADVMODE_PERIOD_AVG=1,this.ADVMODE_PERIOD_MIN=2,this.ADVMODE_PERIOD_MAX=3,this.ADVMODE_INVALID=-1,this.CALIBRATIONPARAM_INVALID=fe,this.RESOLUTION_INVALID=Ge,this.SENSORSTATE_INVALID=2147483647,this._className="Sensor"}imm_parseAttr(e,t){switch(e){case"unit":return this._unit=t,1;case"currentValue":return this._currentValue=Math.round(t/65.536)/1e3,1;case"lowestValue":return this._lowestValue=Math.round(t/65.536)/1e3,1;case"highestValue":return this._highestValue=Math.round(t/65.536)/1e3,1;case"currentRawValue":return this._currentRawValue=Math.round(t/65.536)/1e3,1;case"logFrequency":return this._logFrequency=t,1;case"reportFrequency":return this._reportFrequency=t,1;case"advMode":return this._advMode=t,1;case"calibrationParam":return this._calibrationParam=t,1;case"resolution":return this._resolution=Math.round(t/65.536)/1e3,1;case"sensorState":return this._sensorState=t,1}return super.imm_parseAttr(e,t)}get_unit(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.UNIT_INVALID:(e=this._unit,e)})}get_currentValue(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.CURRENTVALUE_INVALID:(this._cal==null?e=this._currentValue:e=yield this._applyCalibration(this._currentRawValue),e==ve.CURRENTVALUE_INVALID||(e=Math.round(e*this._iresol)/this._iresol),e)})}set_lowestValue(e){return A(this,void 0,void 0,function*(){let t;return t=String(Math.round(e*65536)),yield this._setAttr("lowestValue",t)})}get_lowestValue(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.LOWESTVALUE_INVALID:(e=Math.round(this._lowestValue*this._iresol)/this._iresol,e)})}set_highestValue(e){return A(this,void 0,void 0,function*(){let t;return t=String(Math.round(e*65536)),yield this._setAttr("highestValue",t)})}get_highestValue(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.HIGHESTVALUE_INVALID:(e=Math.round(this._highestValue*this._iresol)/this._iresol,e)})}get_currentRawValue(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.CURRENTRAWVALUE_INVALID:(e=this._currentRawValue,e)})}get_logFrequency(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.LOGFREQUENCY_INVALID:(e=this._logFrequency,e)})}set_logFrequency(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("logFrequency",t)})}get_reportFrequency(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.REPORTFREQUENCY_INVALID:(e=this._reportFrequency,e)})}set_reportFrequency(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("reportFrequency",t)})}get_advMode(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.ADVMODE_INVALID:(e=this._advMode,e)})}set_advMode(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("advMode",t)})}get_calibrationParam(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.CALIBRATIONPARAM_INVALID:(e=this._calibrationParam,e)})}set_calibrationParam(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("calibrationParam",t)})}set_resolution(e){return A(this,void 0,void 0,function*(){let t;return t=String(Math.round(e*65536)),yield this._setAttr("resolution",t)})}get_resolution(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.RESOLUTION_INVALID:(e=this._resolution,e)})}get_sensorState(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?ve.SENSORSTATE_INVALID:(e=this._sensorState,e)})}static FindSensor(e){let t;return t=ue._FindFromCache("Sensor",e),t==null&&(t=new ve(E,e),ue._AddToCache("Sensor",e,t)),t}static FindSensorInContext(e,t){let i;return i=ue._FindFromCacheInContext(e,"Sensor",t),i==null&&(i=new ve(e,t),ue._AddToCache("Sensor",t,i)),i}registerValueCallback(e){return A(this,void 0,void 0,function*(){let t;return e!=null?yield ue._UpdateValueCallbackList(this,!0):yield ue._UpdateValueCallbackList(this,!1),this._valueCallbackSensor=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){let t=Object.create(null,{_invokeValueCallback:{get:m(()=>super._invokeValueCallback,"get")}});return A(this,void 0,void 0,function*(){if(this._valueCallbackSensor!=null)try{yield this._valueCallbackSensor(this,e)}catch(i){this._yapi.imm_log("Exception in valueCallback:",i)}else yield t._invokeValueCallback.call(this,e);return 0})}_parserHelper(){let e;return this._resolution>0?this._iresol=Math.round(1/this._resolution):this._iresol=1e4,e=this._calibrationParam,e=="0,"||e==""||e=="0"?(this._cal=null,0):((this._cal==null||this._cal.src!=e)&&this._parseCalibStr(e),0)}isSensorReady(){return A(this,void 0,void 0,function*(){try{if((yield this.get_sensorState())!=0)return!1}catch(e){return!1}return!0})}get_dataLogger(){return A(this,void 0,void 0,function*(){let e,t,i,r;return t=yield this.get_module(),i=yield t.get_serialNumber(),i==fe?null:(r=i+".dataLogger",e=Re.FindDataLogger(r),e)})}_parseCalibStr(e){let t=[],i,r,s,n,o=[],a=[],l=[],h,u,_,d;if(e.indexOf(",")>=0){if(t=this._yapi.imm_decodeFloats(e),i=t[0]/1e3>>0,i<Nr)return this._cal=null,0;if(r=this._yapi.imm_getCalibrationHandler(i),r==null)return this._cal=null,0;for(s=t.length,o.length=0,n=1;n<s;)o.push(t[n]),n=n+1;for(a.length=0,l.length=0,n=1;n+1<s;)h=t[n],h=h/1e3,u=t[n+1],u=u/1e3,a.push(h),l.push(u),n=n+2}else{if(t=this._yapi.imm_decodeWords(e),t.length<=2)return this._cal=null,0;if(i=t[2],r=this._yapi.imm_getCalibrationHandler(i),r==null)return this._cal=null,0;for(i<=10?s=i:i<=20?s=i-10:s=5,s=3+2*s,s>t.length&&(s=t.length),o.length=0,a.length=0,l.length=0,n=3;n+1<s;)_=t[n],d=t[n+1],o.push(_),o.push(d),a.push(this._yapi.imm_decimalToDouble(_)),l.push(this._yapi.imm_decimalToDouble(d)),n=n+2}return this._cal={src:e,hdl:r,typ:i,par:o,raw:a,cal:l},0}startDataLogger(){return A(this,void 0,void 0,function*(){let e;return e=yield this._download("api/dataLogger/recording?recording=1"),e.length>0?0:this._throw(-8,"unable to start datalogger",-8)})}stopDataLogger(){return A(this,void 0,void 0,function*(){let e;return e=yield this._download("api/dataLogger/recording?recording=0"),e.length>0?0:this._throw(-8,"unable to stop datalogger",-8)})}get_recordedData(e,t){return A(this,void 0,void 0,function*(){let i,r;return i=yield this.get_functionId(),r=yield this.get_unit(),new zt(this,i,r,e,t)})}registerTimedReportCallback(e){return A(this,void 0,void 0,function*(){let t;return t=this,e!=null?yield ue._UpdateTimedReportCallbackList(t,!0):yield ue._UpdateTimedReportCallbackList(t,!1),this._timedReportCallbackSensor=e,0})}_invokeTimedReportCallback(e){return A(this,void 0,void 0,function*(){if(this._timedReportCallbackSensor!=null)try{yield this._timedReportCallbackSensor(this,e)}catch(t){this._yapi.imm_log("Exception in timedReportCallback:",t)}return 0})}calibrateFromPoints(e,t){return A(this,void 0,void 0,function*(){let i,r;return i=yield this._encodeCalibrationPoints(e,t),r=yield this._setAttr("calibrationParam",i),r})}loadCalibrationPoints(e,t){return A(this,void 0,void 0,function*(){if(e.length=0,t.length=0,this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0)return-4;if(this._cal==null)return 0;e.length=0,t.length=0;for(let i of this._cal.raw)e.push(i);for(let i of this._cal.cal)t.push(i);return 0})}_encodeCalibrationPoints(e,t){return A(this,void 0,void 0,function*(){let i,r,s;if(r=e.length,r!=t.length)return this._throw(-2,"Invalid calibration parameters (size mismatch)"),fe;if(r==0)return"0";for(i=String(Math.round(Nr)),s=0;s<r;)i=i+","+String(Math.round(e[s]*1e3)/1e3)+","+String(Math.round(t[s]*1e3)/1e3),s=s+1;return i})}_applyCalibration(e){return A(this,void 0,void 0,function*(){return this._cal==null?e:e==ve.CURRENTVALUE_INVALID?ve.CURRENTVALUE_INVALID:this._cal.hdl(e,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)})}_decodeTimedReport(e,t,i){return A(this,void 0,void 0,function*(){let r,s,n,o,a,l,h,u,_,d,g,y,p;if(t>0?_=e-t:_=this._prevTR,d=e,this._prevTR=d,_==0&&(_=d),i.length<=5){for(n=1,a=0,s=0,r=1;r<i.length;)s=i[r],a=a+n*s,n=n*256,r=r+1;(s&128)!=0&&(a=a-n),y=a/1e3,this._cal!=null&&(y=this._cal.hdl(y,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)),g=y,p=y}else{for(h=1+(i[1]&3),n=1,a=0,s=0,r=2;h>0&&r<i.length;)s=i[r],a=a+n*s,n=n*256,r=r+1,h=h-1;for((s&128)!=0&&(a=a-n),h=1+(i[1]>>2&3),n=1,u=0;h>0&&r<i.length;)s=i[r],u=u+n*s,n=n*256,r=r+1,h=h-1;for(o=a-u,h=1+(i[1]>>4&3),n=1,u=0;h>0&&r<i.length;)s=i[r],u=u+n*s,n=n*256,r=r+1,h=h-1;l=a+u,y=a/1e3,g=o/1e3,p=l/1e3,this._cal!=null&&(y=this._cal.hdl(y,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal),g=this._cal.hdl(g,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal),p=this._cal.hdl(p,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal))}return new fi(_,d,g,y,p)})}imm_decodeVal(e){let t;return t=e,this._cal!=null&&(t=this._cal.hdl(t,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)),t}imm_decodeAvg(e){let t;return t=e,this._cal!=null&&(t=this._cal.hdl(t,this._cal.typ,this._cal.par,this._cal.raw,this._cal.cal)),t}nextSensor(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:ve.FindSensorInContext(this._yapi,t)}static FirstSensor(){let e=E.imm_getFirstHardwareId("Sensor");return e==null?null:ve.FindSensor(e)}static FirstSensorInContext(e){let t=e.imm_getFirstHardwareId("Sensor");return t==null?null:ve.FindSensorInContext(e,t)}};m(ve,"YSensor");var rt=ve;rt.UNIT_INVALID=fe;rt.CURRENTVALUE_INVALID=Ge;rt.LOWESTVALUE_INVALID=Ge;rt.HIGHESTVALUE_INVALID=Ge;rt.CURRENTRAWVALUE_INVALID=Ge;rt.LOGFREQUENCY_INVALID=fe;rt.REPORTFREQUENCY_INVALID=fe;rt.ADVMODE_IMMEDIATE=0;rt.ADVMODE_PERIOD_AVG=1;rt.ADVMODE_PERIOD_MIN=2;rt.ADVMODE_PERIOD_MAX=3;rt.ADVMODE_INVALID=-1;rt.CALIBRATIONPARAM_INVALID=fe;rt.RESOLUTION_INVALID=Ge;rt.SENSORSTATE_INVALID=2147483647;var qn=class qn{constructor(e,t,i,r,s){this._start=0,this._end=0,this._minVal=0,this._avgVal=0,this._maxVal=0,this._start=e,this._end=t,this._minVal=i,this._avgVal=r,this._maxVal=s}get_startTimeUTC(){return this._start}get_endTimeUTC(){return this._end}get_minValue(){return this._minVal}get_averageValue(){return this._avgVal}get_maxValue(){return this._maxVal}get_startTimeUTC_asDate(){return new Date(Math.round(this._start*1e3))}get_endTimeUTC_asDate(){return new Date(Math.round(this._end*1e3))}};m(qn,"YMeasure");var fi=qn,Qe=class Qe extends ue{constructor(e,t){super(e,t),this._currentRunIndex=Qe.CURRENTRUNINDEX_INVALID,this._timeUTC=Qe.TIMEUTC_INVALID,this._recording=Qe.RECORDING_INVALID,this._autoStart=Qe.AUTOSTART_INVALID,this._beaconDriven=Qe.BEACONDRIVEN_INVALID,this._usage=Qe.USAGE_INVALID,this._clearHistory=Qe.CLEARHISTORY_INVALID,this._valueCallbackDataLogger=null,this.CURRENTRUNINDEX_INVALID=-1,this.TIMEUTC_INVALID=Mr,this.RECORDING_OFF=0,this.RECORDING_ON=1,this.RECORDING_PENDING=2,this.RECORDING_INVALID=-1,this.AUTOSTART_OFF=0,this.AUTOSTART_ON=1,this.AUTOSTART_INVALID=-1,this.BEACONDRIVEN_OFF=0,this.BEACONDRIVEN_ON=1,this.BEACONDRIVEN_INVALID=-1,this.USAGE_INVALID=-1,this.CLEARHISTORY_FALSE=0,this.CLEARHISTORY_TRUE=1,this.CLEARHISTORY_INVALID=-1,this._className="DataLogger"}imm_parseAttr(e,t){switch(e){case"currentRunIndex":return this._currentRunIndex=t,1;case"timeUTC":return this._timeUTC=t,1;case"recording":return this._recording=t,1;case"autoStart":return this._autoStart=t,1;case"beaconDriven":return this._beaconDriven=t,1;case"usage":return this._usage=t,1;case"clearHistory":return this._clearHistory=t,1}return super.imm_parseAttr(e,t)}get_currentRunIndex(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.CURRENTRUNINDEX_INVALID:(e=this._currentRunIndex,e)})}get_timeUTC(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.TIMEUTC_INVALID:(e=this._timeUTC,e)})}set_timeUTC(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("timeUTC",t)})}get_recording(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.RECORDING_INVALID:(e=this._recording,e)})}set_recording(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("recording",t)})}get_autoStart(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.AUTOSTART_INVALID:(e=this._autoStart,e)})}set_autoStart(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("autoStart",t)})}get_beaconDriven(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.BEACONDRIVEN_INVALID:(e=this._beaconDriven,e)})}set_beaconDriven(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("beaconDriven",t)})}get_usage(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.USAGE_INVALID:(e=this._usage,e)})}get_clearHistory(){return A(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=0?Qe.CLEARHISTORY_INVALID:(e=this._clearHistory,e)})}set_clearHistory(e){return A(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("clearHistory",t)})}static FindDataLogger(e){let t;return t=ue._FindFromCache("DataLogger",e),t==null&&(t=new Qe(E,e),ue._AddToCache("DataLogger",e,t)),t}static FindDataLoggerInContext(e,t){let i;return i=ue._FindFromCacheInContext(e,"DataLogger",t),i==null&&(i=new Qe(e,t),ue._AddToCache("DataLogger",t,i)),i}registerValueCallback(e){return A(this,void 0,void 0,function*(){let t;return e!=null?yield ue._UpdateValueCallbackList(this,!0):yield ue._UpdateValueCallbackList(this,!1),this._valueCallbackDataLogger=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){let t=Object.create(null,{_invokeValueCallback:{get:m(()=>super._invokeValueCallback,"get")}});return A(this,void 0,void 0,function*(){if(this._valueCallbackDataLogger!=null)try{yield this._valueCallbackDataLogger(this,e)}catch(i){this._yapi.imm_log("Exception in valueCallback:",i)}else yield t._invokeValueCallback.call(this,e);return 0})}forgetAllDataStreams(){return A(this,void 0,void 0,function*(){return yield this.set_clearHistory(1)})}get_dataSets(){return A(this,void 0,void 0,function*(){return yield this.parse_dataSets(yield this._download("logger.json"))})}parse_dataSets(e){return A(this,void 0,void 0,function*(){let t=[],i,r=[];t=this.imm_json_get_array(e),r.length=0;for(let s of t)i=new zt(this),yield i._parse(this._yapi.imm_bin2str(s)),r.push(i);return r})}nextDataLogger(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:Qe.FindDataLoggerInContext(this._yapi,t)}static FirstDataLogger(){let e=E.imm_getFirstHardwareId("DataLogger");return e==null?null:Qe.FindDataLogger(e)}static FirstDataLoggerInContext(e){let t=e.imm_getFirstHardwareId("DataLogger");return t==null?null:Qe.FindDataLoggerInContext(e,t)}};m(Qe,"YDataLogger");var Re=Qe;Re.CURRENTRUNINDEX_INVALID=-1;Re.TIMEUTC_INVALID=Mr;Re.RECORDING_OFF=0;Re.RECORDING_ON=1;Re.RECORDING_PENDING=2;Re.RECORDING_INVALID=-1;Re.AUTOSTART_OFF=0;Re.AUTOSTART_ON=1;Re.AUTOSTART_INVALID=-1;Re.BEACONDRIVEN_OFF=0;Re.BEACONDRIVEN_ON=1;Re.BEACONDRIVEN_INVALID=-1;Re.USAGE_INVALID=-1;Re.CLEARHISTORY_FALSE=0;Re.CLEARHISTORY_TRUE=1;Re.CLEARHISTORY_INVALID=-1;var $n=class $n{constructor(){this.isNodeJS=!1,this.hasSSDP=!1}unknownSystemEnvError(){return new ps("Unspecified runtime environment, your project should include at least once either yocto_api_nodejs or yocto_api_html")}hookUnhandledRejection(e){throw this.unknownSystemEnvError()}getWebSocketEngine(e,t){throw this.unknownSystemEnvError()}getHttpEngine(e,t,i){throw this.unknownSystemEnvError()}getWebSocketCallbackEngine(e,t,i){throw this.unknownSystemEnvError()}getHttpCallbackEngine(e,t,i,r){throw this.unknownSystemEnvError()}getSSDPManager(e){throw this.unknownSystemEnvError()}loadfile(e){return A(this,void 0,void 0,function*(){throw this.unknownSystemEnvError()})}downloadfile(e,t){return A(this,void 0,void 0,function*(){throw this.unknownSystemEnvError()})}downloadRemoteCertificate(e){return A(this,void 0,void 0,function*(){throw this.unknownSystemEnvError()})}};m($n,"YSystemEnv");var Yr=$n,Bl=new Yr,Jn=class Jn{constructor(e,t){this.lastPingStamp=0,this._hub=e,this._runtime_urlInfo=t}reconnectEngine(e){return A(this,void 0,void 0,function*(){})}imm_disconnectEngineNow(e=""){}request(e,t,i,r){return A(this,void 0,void 0,function*(){let s=new Ht(null);return s.errorType=-3,s.errorMsg="GenericHub subclass expected",s})}reportFailure(e){return A(this,void 0,void 0,function*(){})}imm_updateLastPinfStamp(){this.lastPingStamp=Date.now()}imm_isConnected(){return Date.now()-this.lastPingStamp<this._hub.imm_getNetworkTimeout()}imm_isForwarded(){return!1}waitForPendingQueries(e){return A(this,void 0,void 0,function*(){})}};m(Jn,"YHubEngine");var Cs=Jn,Ii;(function(D){D[D.LEGACY=0]="LEGACY",D[D.MIXED=1]="MIXED",D[D.SECURE=2]="SECURE",D[D.PROTO_UNKNOWN=3]="PROTO_UNKNOWN"})(Ii||(Ii={}));var Ds=class Ds{constructor(e,t){this._lastErrorType=-8,this._lastErrorMsg="Hub attachment has not been triggered",this.hubSerial="",this.serialByYdx=[],this._currentState=-6,this._targetState=-5,this.currentConnID="",this.connResolvers=[],this.disconnResolvers=[],this.retryDelay=15,this._reconnectionTimer=null,this._rwAccess=null,this.keepTryingExpiration=0,this.keepTryingTimeoutId=null,this.timeoutId=null,this.isNotifWorking=!1,this.devListExpires=0,this.notifPos=-1,this.notifCarryOver="",this._firstArrivalCallback=!0,this._missing={},this._knownUrls=[],this._portInfo=[],this._usePureHTTP=!1,this._yapi=e,this.urlInfo=t,this.stalledTimeoutMs=e._networkTimeoutMs,this._hubRef=Ds.globalHubRefCounter++,this._hubEngine=null,this._hubMode=Ii.SECURE}_throw(e,t,i){return this._lastErrorType=e,this._lastErrorMsg=t,this._yapi._throw(e,t,i)}imm_isFirstArrivalCallback(){return this._firstArrivalCallback}imm_setFirstArrivalCallback(e){this._firstArrivalCallback=e}imm_getNotifyPos(){return this.notifPos}imm_getcurrentState(){return this._currentState}imm_getCurrentConnID(){return this.currentConnID}imm_setCurrentConnID(e){this.currentConnID=e}get_errorType(){return this._lastErrorType}get_errorMessage(){return this._lastErrorType==0?"":this._lastErrorMsg}imm_forceUpdate(){this.devListExpires=this._yapi.GetTickCount()}imm_logrequest(e,t,i){let r="Request: "+e+" "+t;i&&(r+=" (file="+i.fname+")"),this._yapi.imm_log(r)}imm_setState(e){this._currentState=e}imm_setTargetState(e){this._targetState=e}imm_isDisconnecting(){return this._targetState<=-5}imm_isDisconnected(){return this._targetState<=-5&&this._currentState<=-5}imm_isPreOrRegistered(){return this._targetState>=1}imm_isOnline(){return this._hubEngine?this._hubEngine.imm_isConnected():!1}imm_getConnectionState(){return this.imm_isOnline()?Vt.CONNECTED:this._targetState<=-5?Vt.ABORTED:Vt.TRYING}imm_isForwarded(){return this._hubEngine?this._hubEngine.imm_isForwarded():!1}imm_addKnownUrl(e){this._knownUrls.includes(e.imm_getOriginalURL())||this._knownUrls.push(e.imm_getOriginalURL())}imm_updateUrl(e){if(this._knownUrls.includes(e.imm_getOriginalURL())||this._knownUrls.push(e.imm_getOriginalURL()),this.urlInfo.imm_getUrl(!1,!0,!0)==e.imm_getUrl(!1,!0,!0)){this.urlInfo.imm_updateFrom(e);return}this.urlInfo.imm_updateFrom(e),this._currentState<-1&&this._yapi._logLevel>=4&&this._yapi.imm_log("Updating auth credentials for "+this.urlInfo.imm_getRootUrl())}imm_updateForRedirect(e){let t=e.indexOf("://");t>0&&(t=e.indexOf("/",t+3),t>0&&(e=e.substring(0,t)));let i=new si(e);this.urlInfo.imm_updateForRedirect(i.imm_getHost(),i.imm_getPort(),i.imm_useSecureSocket()),this._yapi._logLevel>=4&&this._yapi.imm_log("Updating URL after HTTP redirection : "+this.urlInfo.imm_getRootUrl());let r=this._yapi._knownHubsByUrl[i.imm_getRootUrl()];if(r&&r!==this){if(r.urlInfo.imm_useSecureSocket()&&r._currentState>=this._currentState){r.imm_inheritFrom(this),this._yapi.imm_updateRegisteredHubs(this,!1);return}this._yapi._knownHubsByUrl[this.urlInfo.imm_getRootUrl()]=this,this.imm_inheritFrom(r),this._yapi.imm_updateRegisteredHubs(r,!1)}else this._yapi._knownHubsByUrl[i.imm_getRootUrl()]=this}imm_inheritFrom(e){this._targetState<e._targetState&&this.imm_setTargetState(e._targetState);for(let t=0;t<e.serialByYdx.length;t++){let i=e.serialByYdx[t];i&&!this.serialByYdx[t]&&(this.serialByYdx[t]=i)}if(this._currentState>=0&&e._currentState<0){let t={errorType:0,errorMsg:"Hub "+this.hubSerial+" already connected"},i=e.connResolvers;for(let r of i)r(t)}else for(let t of e.connResolvers)this.connResolvers.push(t);e.connResolvers=[],this._yapi._logLevel>=3&&this._yapi.imm_log("Hub "+this.hubSerial+" is connected as "+this.urlInfo.imm_getRootUrl()+", dropping connection to "+e.urlInfo.imm_getRootUrl()),e.imm_commonDisconnect("inherit",0,"Hub "+this.hubSerial+" is already connected via "+this.urlInfo.imm_getRootUrl()),e.imm_disconnectNow();for(let t of e.get_knownUrls())this._knownUrls.includes(t)||this._knownUrls.push(t)}imm_getNewConnID(){let e=new Date;return(e.getHours()+"h"+e.getMinutes()+"m"+e.getTime()%6e4/1e3).toString()+"_0"}imm_tryTestConnectFor(e){let t=Date.now()+e;this.keepTryingExpiration<t&&(this.keepTryingExpiration=t,this.keepTryingTimeoutId&&clearTimeout(this.keepTryingTimeoutId),this.keepTryingTimeoutId=setTimeout(()=>{this.keepTryingTimeoutId=null,this._targetState==0&&(this._yapi._logLevel>=4&&this._yapi.imm_log("TestHub timeout reached, disconnecting"),this.detach(E.IO_ERROR,"TestHub timeout reached"))},e))}attach(e){return A(this,void 0,void 0,function*(){if(this._targetState<=0||e>0){if(this._lastErrorType=0,this._lastErrorMsg="Reconnecting",this.imm_setTargetState(e),this._currentState==0&&e>0)try{yield this._yapi._ensureUpdateDeviceListNotRunning(),yield this._yapi._addConnectedHub(this),this.imm_setState(e)}catch(t){this.imm_disconnectNow()}e==0&&this.imm_tryTestConnectFor(100)}this._currentState<=-5?(this._yapi._logLevel>=4&&this._yapi.imm_log("New hub is detached connecting..."),this._hubEngine=null,this.stalledTimeoutMs=this._yapi._networkTimeoutMs,this.imm_setState(-1),this.reconnect(this.imm_getNewConnID())):this._currentState==-3?(this._reconnectionTimer?(this._yapi._logLevel>=4&&this._yapi.imm_log("New hub connection requested, retry now (drop ["+this.currentConnID+"])"),clearTimeout(this._reconnectionTimer),this._reconnectionTimer=null,this.currentConnID=""):this._yapi._logLevel>=4&&this._yapi.imm_log("New hub connection requested, retry now (no pending reconnection ?!?)"),this.reconnect(this.imm_getNewConnID())):(this._currentState==-4||this._currentState==-2)&&this._yapi._logLevel>=4&&(this._yapi.imm_log("Hub is currently disconnecting, reconnection will be triggered soon ["+this.currentConnID+"]"),this._yapi.imm_log("Current state: "+this._currentState),this._yapi.imm_log("Target state: "+this._targetState+" ("+e+")"))})}waitForConnection(e,t){return A(this,void 0,void 0,function*(){if(this._targetState<0)return t.msg=this._lastErrorMsg,this._lastErrorType;if(this._currentState>=0)return 0;if(e<=1)return t.msg="Hub not connected",-7;this._targetState==0&&this.imm_tryTestConnectFor(e);let i=null,r=null,s;s=new Promise((a,l)=>{i=new Promise((h,u)=>{this.connResolvers.push(h),a(h),r=setTimeout(()=>{this._yapi._logLevel>=4&&this._yapi.imm_log("Timeout waiting for hub connection"),h({errorType:-7,errorMsg:"Timeout waiting for hub connection"})},e)})});let n=yield s;if(this._targetState<0)return clearTimeout(r),t.msg=this._lastErrorMsg,this._lastErrorType;if(this._currentState>=0)return clearTimeout(r),0;let o=yield i;return clearTimeout(r),o.errorType!=0&&t&&(t.msg=o.errorMsg),o.errorType})}reconnect(e){return A(this,void 0,void 0,function*(){if(!this._hubEngine){this._yapi._logLevel>=4&&this._yapi.imm_log("look for suitable Hub engine ["+e+"]"),this._usePureHTTP=!1,this._portInfo=[];let t=null;if(this.urlInfo.imm_testInfoJson()){let r=this.urlInfo.imm_useSecureSocket();this.urlInfo.imm_getPort()==E.YOCTO_DEFAULT_HTTPS_PORT&&(r=!0);let s=(r?"https://":"http://")+this.urlInfo.imm_getUrl(!1,!1,!0)+"info.json";this._yapi._logLevel>=4&&this._yapi.imm_log("look for info.json at "+s+" ["+e+"]");try{let n=yield this._yapi.system_env.downloadfile(s,this._yapi);if(t=JSON.parse(E.imm_bin2str(n)),t){if(t.serialNumber&&this.imm_setSerialNumber(t.serialNumber),t.securityMode!==void 0&&t.securityMode==0){this.imm_commonDisconnect(e,E.UNCONFIGURED,"Remote hub is not yet configured"),this.imm_disconnectNow();return}if(t.protocol&&t.protocol=="HTTP/1.1"&&(this._usePureHTTP=!0),t.port){let o=0;for(;o<t.port.length;){let l=t.port[o++].split(":"),h=l[0],u=be.imm_atoi(l[1]);if(u==0)break;this._portInfo.push({proto:h,port:u})}}}this._yapi._logLevel>=4&&this._yapi.imm_log("info.json successfully parsed "+s+" ["+e+"]")}catch(n){if(n.errorType==E.SSL_UNK_CERT){this.imm_commonDisconnect(e,E.SSL_UNK_CERT,n.message),this.imm_disconnectNow();return}else{this._yapi._logLevel>=4&&this._yapi.imm_log("Unable to get info.json from "+s+" ["+e+"]");let o=(r?"https://":"http://")+this.urlInfo.imm_getUrl(!1,!1,!1)+"/api/module/serialNumber";try{let a=yield this._yapi.system_env.downloadfile(o,this._yapi);this.imm_setSerialNumber(E.imm_bin2str(a))}catch(a){this.imm_commonDisconnect(e,E.IO_ERROR,a.message);return}}}}let i=this.imm_UseBestProto();if(i.imm_useWebSocket()?(this._yapi._logLevel>=4&&this._yapi.imm_log("Use WebSocket hub engine ["+e+"]"),this._hubEngine=this._yapi.system_env.getWebSocketEngine(this,i)):(this._yapi._logLevel>=4&&this._yapi.imm_log("Use HTTP hub engine ["+e+"]"),this._hubEngine=this._yapi.system_env.getHttpEngine(this,i,t)),!this._hubEngine){this.imm_commonDisconnect(e,-3,"Unsupported hub protocol: "+i.imm_getProto());return}}yield this._hubEngine.reconnectEngine(e)})}signalHubConnected(e,t){return A(this,void 0,void 0,function*(){this.imm_setState(0),this.hubSerial=t,this._yapi._logLevel>=4&&this._yapi.imm_log("Hub "+t+" connected ["+e+"]");let i=this._yapi.imm_getPrimaryHub(this);if(i._targetState>=1){if(i._currentState<1)try{yield i._yapi._ensureUpdateDeviceListNotRunning(),yield i._yapi._addConnectedHub(i)}catch(n){i.imm_disconnectNow();return}i._currentState<i._targetState&&i.imm_setState(i._targetState)}else i.keepTryingExpiration=0,i.imm_tryTestConnectFor(100);let r={errorType:0,errorMsg:"Hub "+t+" connected"},s=i.connResolvers;i.connResolvers=[],i._lastErrorType=r.errorType,i._lastErrorMsg=r.errorMsg;for(let n of s)n(r)})}imm_signalHubDisconnected(e){this._yapi._logLevel>=4&&this._yapi.imm_log("imm_signalHubDisconnected  "+this.urlInfo.imm_getRootUrl()),this._currentState>-3&&this.imm_setState(-3),this.isNotifWorking=!1,this.devListExpires=0,this._yapi.imm_dropConnectedHub(this),this._firstArrivalCallback=!0;let t=this.disconnResolvers;this.disconnResolvers=[];for(let s of t)s({errorType:0,errorMsg:"Hub disconnect completed"});if(this.imm_isDisconnecting())return this.imm_setState(-5),this._yapi._logLevel>=4&&this._yapi.imm_log("Hub "+this.urlInfo.imm_getRootUrl()+" detached"),!1;if(this._reconnectionTimer)return this._yapi._logLevel>=4&&this._yapi.imm_log("Hub disconnected, reconnection is already scheduled ["+this.currentConnID+"]"),!0;let i=e.split("_"),r=i[0]+"_"+(parseInt(i[1])+1).toString();return this.retryDelay<5e3&&(this.retryDelay*=2),this._yapi._logLevel>=4&&this._yapi.imm_log("Hub reconnection scheduled in "+this.retryDelay/1e3+"s ["+r+"]"),this.currentConnID=r,this._reconnectionTimer=setTimeout(()=>{this._reconnectionTimer=null,this.currentConnID="",!this.imm_isDisconnecting()&&(this._yapi._logLevel>=4&&this._yapi.imm_log("Retry hub connection now ["+r+"]"),this.reconnect(r))},this.retryDelay),!0}imm_commonDisconnect(e,t,i){this._lastErrorType=t,this._lastErrorMsg=i,this._currentState>=-2?this.imm_setState(-4):this._currentState==-3&&this.imm_setState(-5),this.imm_setTargetState(-5),this._reconnectionTimer&&(clearTimeout(this._reconnectionTimer),this._reconnectionTimer=null),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),t!=0&&this._yapi._logLevel>=4&&e!="detach"&&this._yapi.imm_log("Hub connection failed: "+i+" ["+e+"]"),this._firstArrivalCallback=!0;let r={errorType:t,errorMsg:i},s=this.connResolvers;this.connResolvers=[];for(let n of s)n(r)}imm_disconnectNow(e=""){return e&&e!=this.currentConnID?!1:(this._currentState>-2&&this.imm_setState(-2),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this._hubEngine?this._hubEngine.imm_disconnectEngineNow(e):this.imm_signalHubDisconnected(e),!0)}detach(e=E.IO_ERROR,t="Hub has been forcibly detached"){return A(this,void 0,void 0,function*(){this.imm_commonDisconnect("detach",e,t),this.imm_disconnectNow(),this.stalledTimeoutMs=this._yapi._networkTimeoutMs,this._hubEngine=null})}waitForDisconnection(e){return A(this,void 0,void 0,function*(){let t=null,i=null;t=new Promise((r,s)=>{this.disconnResolvers.push(r),i=setTimeout(()=>{this._yapi._logLevel>=4&&this._yapi.imm_log("Timeout waiting for hub disconnection"),r({errorType:-7,errorMsg:"Timeout waiting for hub connection"})},e)}),yield t,clearTimeout(i)})}hubUpdateDeviceList(){return A(this,void 0,void 0,function*(){let e=this._yapi.imm_getDevice(this.urlInfo.imm_getRootUrl());try{e.imm_dropCache();let t=yield e.refresh();if(t!=0)return this._currentState>=1&&(yield this._yapi.updateDeviceList_process(this,e,[],{})),this.imm_disconnectNow(),this._throw(t,e._lastErrorMsg,t);let i=yield e.requestAPI(this._yapi.defaultCacheValidity);if(i.errorType!=0)return this._currentState>=1&&(yield this._yapi.updateDeviceList_process(this,e,[],{})),this.imm_disconnectNow(),i.errorType;let r=i.obj_result.services.whitePages,s=i.obj_result.services.yellowPages;return r?(t=yield this._yapi.updateDeviceList_process(this,e,r,s),t<0?(this.imm_disconnectNow(),this._throw(this._yapi._lastErrorType,this._yapi._lastErrorMsg,this._yapi._lastErrorType)):(this.isNotifWorking?this.devListExpires=this._yapi.GetTickCount()+this._yapi._deviceListValidityMs:this.devListExpires=this._yapi.GetTickCount()+500,t)):(this.imm_disconnectNow(),this._throw(-8,"Device "+e.imm_describe()+" is not a hub",-8))}catch(t){if(this._yapi._logLevel>=3&&this._yapi.imm_log("Exception during device enumeration: ",t),this._currentState>=1)try{yield this._yapi.updateDeviceList_process(this,e,[],{})}catch(i){}return this.imm_disconnectNow(),-8}})}request(e,t,i,r){return A(this,void 0,void 0,function*(){if(!this._hubEngine){let s=new Ht(null);return s.errorType=-8,s.errorMsg="HubEngine is not initialised",s}return yield this._hubEngine.request(e,t,i,r)})}imm_getBoundary(){return"Zz"+Math.floor(Math.random()*16777215).toString(16)+"zZ"}imm_formEncodeBody(e,t){let i=this._yapi.imm_str2bin('Content-Disposition: form-data; name="'+e.fname+`"; filename="api"\r
Content-Type: application/octet-stream\r
Content-Transfer-Encoding: binary\r
\r
`),r=this._yapi.imm_str2bin(t),s=this._yapi.imm_str2bin("--"),n=this._yapi.imm_str2bin(`\r
`),o=[s,r,n,i,e.data,n,s,r,s,n],a,l=0;for(a=0;a<o.length;a++)l+=o[a].length;let h=new Uint8Array(l);for(l=0,a=0;a<o.length;a++)h.set(o[a],l),l+=o[a].length;return h}getBootloaders(){return A(this,void 0,void 0,function*(){let e=yield this.request("GET","/flash.json?a=list",null,1);return e.errorType!=0?this._throw(e.errorType,e.errorMsg,[]):JSON.parse(E.imm_bin2str(e.bin_result)).list})}firmwareUpdate(e,t,i,r){return A(this,void 0,void 0,function*(){let s=!1,n="",o=!0,a=m((p=>this._throw(E.IO_ERROR,p,[p])),"_throw");r(5,"Check bootloader type");let l=yield this.request("GET","/api/module.json",null,0);if(l.errorType!=0)return a("Hub is not responding");let h=JSON.parse(this._yapi.imm_bin2str(l.bin_result)),u=h.serialNumber;u.slice(0,7)=="VIRTHUB"?s=!1:e==u?s=!0:(l=yield this.request("GET","/bySerial/"+e+"/flash.json?a=state",null,0),l.errorType==0&&l.bin_result.length>0&&(s=!0,n="/bySerial/"+e));let _=yield this.getBootloaders(),d=e.slice(0,7)=="YHUBSHL",g;for(g=0;g<_.length;g++){let p=_[g];if(p==e)o=!1;else if(d&&p.slice(0,7)=="YHUBSHL")return a("Only one YoctoHub-Shield is allowed in update mode")}if(!s&&o&&_.length>=4)return a("Too many devices in update mode");if(l=yield this.request("GET",n+"/flash.json?a=state",null,0),l.errorType!=0)return a("Cannot check state of firmware upload");if(h=JSON.parse(this._yapi.imm_bin2str(l.bin_result)),h.state=="uploading"||h.state=="flashing")return a("Cannot start firmware update: busy ("+h.state+")");r(10,"Send firmware file");let y=m(function(p,x){p>>=10,x>>=10,r(10+(28*p/x>>0),"Send firmware file: "+p+"KB / "+x+"KB")},"progressCb");if(l=yield this.request("POST",n+"/upload.html",new gr("firmware",t.imm_getData(),y),0),l.errorType!=0)return a("Firmware upload failed: "+l.errorMsg);if(l=yield this.request("GET",n+"/flash.json?a=state",null,0),l.errorType!=0)return a("Cannot check state of firmware upload");if(h=JSON.parse(this._yapi.imm_bin2str(l.bin_result)),h.state!="valid")return a("Upload of firmware failed: invalid firmware("+h.state+")");if(h.progress!="100")return a("Upload of firmware failed: incomplete upload");if(s){let p=this._yapi.imm_bin2str(i),w=JSON.parse(p).api,f={};for(let R in w)R!="services"&&(f[R]=w[R]);let T=this._yapi.imm_str2bin(JSON.stringify(f));if(r(38,"Save current settings"),l=yield this.request("POST",n+"/upload.html",new gr("startupConf.json",T,null),0),l.errorType!=0||(r(39,"Save current settings"),l=yield this.request("POST",n+"/upload.html",new gr("firmwareConf",T,null),0),l.errorType!=0))return a("Failed to save settings on hub")}if(s)r(40,"Flash firmware"),yield this.request("GET",n+"/api/module/rebootCountdown?rebootCountdown=-1003",null,0),yield this._yapi.Sleep(7e3);else{o&&(yield this.request("GET","/bySerial/"+e+"/api/module/rebootCountdown?rebootCountdown=-2",null,0));let p=E.GetTickCount()+2e4,x,w=!1;r(40,"Wait for device to be in bootloader");do{for(_=yield this.getBootloaders(),g=0;g<_.length;g++)if(_[g]==e){w=!0;break}w||(yield this._yapi.Sleep(500))}while(!w&&E.GetTickCount()<p);r(45,"Flash firmware");let f=t.imm_getData().length+512>>10,T,R=m((()=>{this.request("GET",n+"/flash.json?a=state",null,1).then(P=>{if(P.errorType==0){let I=E.imm_bin2str(P.bin_result),F=JSON.parse(I);F.state=="flashing"&&(F.progress<20?r(45+(F.progress/3>>0),"Erasing previous firmware: "+(f*(F.progress-3)/18>>0)+"KB / "+f+"KB"):r(45+(F.progress/3>>0),"Flashing new firmware: "+(f*(F.progress-20)/76>>0)+"KB / "+f+"KB"))}T=setTimeout(R,500)}).catch(P=>{this._yapi.imm_log("Exception during firmware flash: ",P),T=setTimeout(R,500)})}),"checkFlash");return T=setTimeout(R,1e3),l=yield this.request("GET","/flash.json?a=flash&s="+e,null,0),clearTimeout(T),l.errorType!=0?a("Cannot check state of firmware flash"):JSON.parse(this._yapi.imm_bin2str(l.bin_result))}return null})}reportFailure(e){return A(this,void 0,void 0,function*(){this._hubEngine&&(yield this._hubEngine.reportFailure(e))})}hasRwAccess(){return A(this,void 0,void 0,function*(){if(this._rwAccess==null){let e=yield this.request("GET","/api/module/serialNumber.json?serialNumber=rwTest",null,0);this._rwAccess=e.errorType==0}return this._rwAccess})}imm_isRwAccess(){return this._rwAccess==null?!1:this._rwAccess}imm_setRwAccess(e){this._rwAccess=e}getHubRef(){return this._hubRef}get_knownUrls(){return this._knownUrls.slice()}imm_forgetUrls(){this._knownUrls=[]}imm_getOriginalURL(){return this.urlInfo.imm_getOriginalURL()}imm_getRootUrl(){return this.urlInfo.imm_getRootUrl()}imm_getSerialNumber(){return this.hubSerial}imm_setSerialNumber(e){this.hubSerial=e}imm_getNetworkTimeout(){return this.stalledTimeoutMs}imm_setNetworkTimeout(e){this.stalledTimeoutMs=e}imm_setHubEngine(e){this._hubEngine=e}imm_setRetryDelay(e){this.retryDelay=e}imm_SetErr(e,t){this._lastErrorType=e,this._lastErrorMsg=t}WebSocketJoin(e,t,i){return A(this,void 0,void 0,function*(){return this._hubEngine.websocketJoin(e,t,i)})}imm_UseBestProto(){let e=this.urlInfo.imm_getProto(),t=this.urlInfo;if(this._hubMode=Ii.SECURE,this._portInfo.length>0)if(this._usePureHTTP){(e=="ws"||e=="wss")&&this._yapi._throw(E.NOT_SUPPORTED,"Websocket protocol is not supported by VirtualHub-4web.");for(let i=0;i<this._portInfo.length;i++){let r=this._portInfo[i];if(r.proto.startsWith("http")){this._yapi._logLevel>=3&&this._yapi.imm_log("Hub "+this.urlInfo.imm_getHost()+" will use "+r.proto+" proto on port "+r.port),t=this.urlInfo,t.imm_updateBestProto(r.proto,r.port);break}}}else{let i=0,r="ws";(this._portInfo[0].proto=="http"||this._portInfo[0].proto=="ws")&&(this._hubMode=Ii.LEGACY);for(let s=0;s<this._portInfo.length;s++){let n=this._portInfo[s];this._hubMode==Ii.SECURE&&(n.proto=="http"||n.proto=="ws")&&(this._yapi._logLevel>=3&&this._yapi.imm_log("Hub "+this.urlInfo.imm_getHost()+" use mixed or legacy mode"),this._hubMode=Ii.MIXED),e=="auto"&&i==0&&(n.proto.startsWith("http")||n.proto.startsWith("ws"))&&(r=n.proto,i=n.port),e=="secure"&&i==0&&(n.proto=="https"||n.proto=="wss")&&(r=n.proto,i=n.port)}i!=0&&(this._yapi._logLevel>=3&&this._yapi.imm_log("Hub "+this.urlInfo.imm_getHost()+" will use "+r+" proto on port "+i),t=this.urlInfo,t.imm_updateBestProto(r,i))}return t}imm_useMixedMode(){return this._hubMode==Ii.MIXED||this._hubMode==Ii.LEGACY}waitForPendingQueries(e){return A(this,void 0,void 0,function*(){this._hubEngine&&(yield this._hubEngine.waitForPendingQueries(e))})}};m(Ds,"YGenericHub");var Oi=Ds;Oi.globalHubRefCounter=0;var Qn=class Qn extends Cs{constructor(e,t,i){super(e,t),this.infoJson=null,this.ha1="",this.realm="",this.nonce="",this.opaque="",this.nonceCount=0,this.notbynRequest=null,this.infoJson=i}imm_makeRequest(e,t,i,r,s,n,o){}imm_abortRequest(e){}imm_sendRequest(e,t,i,r,s,n){let o=null,a="text/plain; charset=x-user-defined";if(this.infoJson&&this.infoJson.realm&&this.infoJson.nonce){(this.realm!=this.infoJson.realm||this.nonce!=this.infoJson.nonce)&&(this.realm=this.infoJson.realm,this.nonce=this.infoJson.nonce,this.nonceCount=0);let l=this._runtime_urlInfo.imm_getSubDomain()+t,h={"x-yauth":{method:e,uri:l,nonce:this.nonce}};if(this._runtime_urlInfo.imm_hasAuthParam()){let _=Math.floor(Math.random()*2147483647).toString(16).toLowerCase(),d=(++this.nonceCount).toString(16).toLowerCase(),g=this._runtime_urlInfo.imm_getUser()+":"+this.realm+":"+this._runtime_urlInfo.imm_getPass(),y=e+":"+l,p=this._hub._yapi.imm_bin2hexstr(this._hub._yapi.imm_yMD5(g)).toLowerCase(),x=this._hub._yapi.imm_bin2hexstr(this._hub._yapi.imm_ySHA1(y)).toLowerCase(),w=p+":"+this.nonce+":"+d+":"+_+":auth:"+x,f=this._hub._yapi.imm_bin2hexstr(this._hub._yapi.imm_ySHA1(w)).toLowerCase();h["x-yauth"].username=this._runtime_urlInfo.imm_getUser(),h["x-yauth"].cnonce=_,h["x-yauth"].nc=d,h["x-yauth"].qop="auth",h["x-yauth"].response=f}if(i){let _=this._hub._yapi.imm_bin2str(i.data);h.body={filename:i.fname,b64content:btoa(_)}}e="POST",o=JSON.stringify(h);let u=t.indexOf("?");u>0&&(t=t.slice(0,u))}else if(i!=null){let l=this._hub.imm_getBoundary();this.infoJson&&this.infoJson.nonce?a="x-upload; boundary="+l:a="multipart/form-data; boundary="+l,o=this._hub.imm_formEncodeBody(i,l)}return this.imm_makeRequest(e,t,a,o,r,s,n)}tryFetch(e){return A(this,void 0,void 0,function*(){return new Promise((t,i)=>{this.imm_sendRequest("GET",e,null,null,r=>{t({errorType:0,errorMsg:"",result:r})},(r,s,n)=>{n?this.imm_sendRequest("GET",e,null,null,o=>{t({errorType:0,errorMsg:"",result:o})},(o,a,l)=>{t({errorType:o,errorMsg:a})}):t({errorType:r,errorMsg:s})})})})}reconnectEngine(e){return A(this,void 0,void 0,function*(){if(this._hub.imm_setCurrentConnID(e),this.infoJson&&this.infoJson.nonce&&E.GetTickCount()-this.infoJson.stamp>12e3){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Trying info.json ["+e+"]");let r=yield this.tryFetch("info.json");r.errorType==0&&r.result&&(this.infoJson=JSON.parse(r.result),this.infoJson.stamp=E.GetTickCount())}if(this._hub._yapi.imm_getPrimaryHub(this._hub)!==this._hub){this._hub.imm_commonDisconnect(e,0,"Hub "+this._hub.imm_getSerialNumber()+" is already connected"),this._hub.imm_setCurrentConnID(""),this._hub.imm_signalHubDisconnected(e);return}let i="";this._hub.imm_getNotifyPos()>=0?i="?abs="+this._hub.imm_getNotifyPos().toString():this._hub.imm_setFirstArrivalCallback(!0),this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Opening http connection to hub ("+i+") ["+e+"]"),this.notbynRequest=this.imm_sendRequest("GET","/not.byn"+i,null,r=>{if(e!=this._hub.imm_getCurrentConnID()){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("Previous request still sending data ["+e+"]");return}this.infoJson&&(this.infoJson.stamp=E.GetTickCount()),this._hub.imm_getcurrentState()<0&&this._hub.signalHubConnected(e,this._hub.imm_getSerialNumber()),this.imm_updateLastPinfStamp(),this._hub._yapi.parseEvents(this._hub,r)},r=>{if(e!=this._hub.imm_getCurrentConnID()){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("Previous request completed ["+e+"]");return}this.reconnectEngine(e)},(r,s,n)=>{if(e!=this._hub.imm_getCurrentConnID()){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("Previous not.byn request says: "+s+" ["+e+"]");return}this._hub.imm_isDisconnecting()||this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("Failed to load not.byn ("+i+"): "+s+" ["+e+"]"),this._hub.imm_SetErr(r,s),(r==-12||r==-20)&&!n&&this._hub.imm_commonDisconnect(e,r,s),this._hub.imm_disconnectNow()})})}imm_disconnectEngineNow(e=""){if(this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("YHTTPEngine.imm_disconnectEngineNow "+e),!this.notbynRequest)return;let t=e||this._hub.imm_getCurrentConnID();this.imm_abortRequest(this.notbynRequest),this.notbynRequest=null,this._hub.imm_setCurrentConnID(""),this._hub.imm_signalHubDisconnected(t)}request(e,t,i,r){return A(this,void 0,void 0,function*(){return this._hub._yapi._logLevel>=3&&this._hub.imm_logrequest(e,t,i),this._hub.imm_getcurrentState()<0?new Ht(null,E.IO_ERROR,"Hub is currently unavailable"):new Promise((s,n)=>{this.imm_sendRequest(e,t,i,null,o=>{this._hub.imm_getcurrentState()<0?s(new Ht(null,E.IO_ERROR,"Hub is currently unavailable")):(this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log(e+" "+t+" succeeded"),s(new Ht(this._hub._yapi.imm_str2bin(o))))},(o,a,l)=>{this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log(e+" "+t+" failed ("+a+")"),s(new Ht(null,o,a))})})})}};m(Qn,"YHttpEngine");var Ts=Qn,ea=class ea extends Cs{constructor(e,t){super(e,t),this._DEFAULT_TCP_ROUND_TRIP_TIME=30,this._DEFAULT_TCP_MAX_WINDOW_SIZE=4*65536,this._YIO_DEFAULT_TCP_TIMEOUT=2e4,this._YIO_1_MINUTE_TCP_TIMEOUT=6e4,this._YIO_10_MINUTES_TCP_TIMEOUT=6e5,this._USB_META_UTCTIME_SIZE=5,this._USB_META_DLFLUSH_SIZE=1,this._USB_META_ACK_D2H_PACKET_SIZE=2,this._USB_META_WS_ANNOUNCE_SIZE=28,this._USB_META_WS_AUTHENTICATION_SIZE=28,this._USB_META_WS_ERROR_SIZE=6,this._USB_META_ACK_UPLOAD_SIZE=6,this._USB_META_WS_VALID_SHA1=1,this._USB_META_WS_RW=2,this.websocket=null,this.tcpChan=[],this.nextAsyncId=48,this._connectionTime=0,this._remoteVersion=0,this._remoteSerial="",this._remoteNonce=-1,this._nonce=-1,this._session_error=null,this._session_errno=null,this._lastUploadAckBytes=[0],this._lastUploadAckTime=[0],this._lastUploadRateBytes=[0],this._lastUploadRateTime=[0],this._uploadRate=[0],this.fwd_nonce=-1,this.fwd_websocket=null,this.fwd_credentials=[],this.fwd_closeCallback=null,this._connectionState=2,this._tcpRoundTripTime=this._DEFAULT_TCP_ROUND_TRIP_TIME,this._tcpMaxWindowSize=this._DEFAULT_TCP_MAX_WINDOW_SIZE,this.fwd_connectionState=1}imm_asyncWebSocketError(e,t){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("WS: "+t+" on "+this._runtime_urlInfo.imm_getRootUrl())}reconnectEngine(e){return A(this,void 0,void 0,function*(){this._connectionState=2,this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Opening websocket connection ["+e+"]"),this._hub.imm_setCurrentConnID(e);let t=(this._runtime_urlInfo.imm_useSecureSocket()?"wss://":"ws://")+this._runtime_urlInfo.imm_getUrl(!1,!0,!0);if(this.imm_webSocketOpen(t+"not.byn"),this._hub.imm_setFirstArrivalCallback(!0),!this.websocket){this._hub.imm_commonDisconnect(e,-8,"Failed to create WebSocket");return}this.websocket.onmessage=(i=>{if(this._hub.imm_getCurrentConnID()!=e){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Incoming WebSocket data for previous connection ["+e+"]");return}if(this._webSocketMsg(new Uint8Array(i.data)),this._connectionState==4)this._connectionState=5,this._hub.signalHubConnected(e,this._remoteSerial);else if(this._connectionState==0){let r=this._session_error?"WebSocket error: "+this._session_error:"Websocket I/O error";this._session_errno==401?this._hub.imm_commonDisconnect(e,-12,r):this._hub.imm_SetErr(-8,r),this._hub.imm_disconnectNow()}}),this.websocket.onclose=(i=>{if(this._hub.imm_getCurrentConnID()!=e){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("WebSocket close received for previous connection ["+e+"], now using ["+this._hub.imm_getCurrentConnID()+"]");return}this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("WebSocket connection closed ["+e+"]"),this._connectionState=1,this.websocket=null,this._hub.retryDelay<0&&this._hub.imm_commonDisconnect(e,-8,"Websocket callback connection closed"),this.imm_dropAllPendingConnection(),this._hub.imm_signalHubDisconnected(e)}),this.websocket.onerror=(i=>{if(this._hub.imm_getCurrentConnID()!=e){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("WebSocket error received for previous connection ["+e+"]");return}i.message&&(!/ ETIMEDOUT /.test(i.message)||this._hub._yapi._logLevel>=4)&&(this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("WebSocket error ["+e+"]: ",i),i.error.code=="DEPTH_ZERO_SELF_SIGNED_CERT"?this._hub.imm_commonDisconnect(e,-20,i.message):this._hub.imm_SetErr(-8,i.message)),this._hub.retryDelay<0&&this._hub.imm_commonDisconnect(e,-8,"Websocket callback connection closed"),this._hub.imm_disconnectNow(),this._hub.imm_signalHubDisconnected(e)}),this._hub.timeoutId&&clearTimeout(this._hub.timeoutId),this._hub.timeoutId=setTimeout(()=>{this.imm_isForwarded()||(this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("WS: connection stalled during open ["+e+"]"),this._hub.imm_disconnectNow())},this._hub.imm_getNetworkTimeout())})}imm_computeAuth(e,t,i,r){let s=e+":"+i+":"+t,n=this._hub._yapi.imm_bin2hexstr(this._hub._yapi.imm_yMD5(s)).toLowerCase(),o=new Uint8Array([(r&255)>>>0,(r&65280)>>>8,(r&16711680)>>>16,r>>>24]),a=n+this._hub._yapi.imm_bin2hexstr(o).toLowerCase();return this._hub._yapi.imm_ySHA1(a.toLowerCase())}imm_isForwarded(){return this.fwd_connectionState==5&&this.fwd_websocket!==null}_webSocketMsg(e){return A(this,void 0,void 0,function*(){try{if(this.imm_isForwarded()){this.imm_updateLastPinfStamp(),this.fwd_websocket.send(e);return}let t=(this._hub._yapi.GetTickCount()-this._connectionTime)/1e3,i=e[0]>>>3,r="";if(i==8){for(let o=1;o<e.length;o++)r+=String.fromCharCode(e[o]);this.imm_updateLastPinfStamp(),yield this._hub._yapi.parseEvents(this._hub,r);return}let s=this.websocket,n=e[0]&7;if(i==1||i==2||i==9){if(n>3){this.imm_asyncWebSocketError(-8,"Unexpected frame for tcpChan "+n+" ("+i+")");return}let o=e.length,a=this.tcpChan[n];if(!a){this.imm_asyncWebSocketError(-8,"Drop frame for closed tcpChan "+n+" ("+i+")");return}if(i==9){o--;let u=e[o];if(this._hub._yapi._logLevel>=5&&this._hub._yapi.imm_log("async-"+u+" close received"),a.asyncId==0){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("async-"+u+" close received while req @"+a._creat+" was pending"),this.imm_asyncWebSocketError(-8,"Asynchronous close received, sync reply request");return}else if(a.asyncId!=u){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("async-"+u+" close received instead of async-"+a.asyncId+" close"),this.imm_asyncWebSocketError(-8,"Incorrect async-close signature on tcpChan "+n);return}}let l=a.bin_result,h=new Uint8Array(l.length+o-1);if(h.set(l,0),h.set(e.subarray(1,o),l.length),a.bin_result=h,i==2||i==9){if(this.tcpChan[n]=a.next,i==2){if(a.asyncId!=0){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Synchronous close received instead of async-"+a.asyncId+" close"),this.imm_asyncWebSocketError(-8,"Synchronous close received, async ack expected");return}else if(this.websocket){if(a.toBeSent&&a.sendPos<a.toBeSent.length){if(this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log("WS: tcpclose at "+a.sendPos+" < "+a.toBeSent.length),this._hub.imm_disconnectNow(),a.timeoutId&&clearTimeout(a.timeoutId),a.asyncId==0&&(a.errorType=-8,a.errorMsg="TCP closed during upload",a.acceptor))try{a.acceptor(a)}catch(_){}return}if(a.timeoutId){let _=new Uint8Array(1);_[0]=16+n,this.websocket.send(_)}}}a.timeoutId&&(clearTimeout(a.timeoutId),a.timeoutId=0);let u=a.bin_result.indexOf(13);if(u<0)a.errorType=-8,a.errorMsg="Bad response header";else{let _=this._hub._yapi.imm_bin2str(a.bin_result.subarray(0,u)),d=_.split(" ");if(d[0]=="OK"){a.errorType=0;let g=a.bin_result.indexOf(13,u+2);for(;g>u+2;)u=g,g=a.bin_result.indexOf(13,u+2);g<0&&(g=u),a.bin_result=a.bin_result.subarray(g+2)}else if(d[0]=="0K")a.errorType=-8,a.errorMsg="Unexpected persistent connection";else{let g=parseInt(d[1]);a.errorType=g==401?-12:-8,a.errorMsg="HTTP error "+_.slice(d[0].length+1)+" on "+a.devUrl}}a.asyncId==0?(this._hub._yapi._logLevel>=5&&this._hub._yapi.imm_log("request @"+a._creat+" done, status="+a.errorType),this.imm_sendPendingRequest(n),a.acceptor&&a.acceptor(a)):a.errorType!=0&&this.imm_asyncWebSocketError(-8,"Async request error: "+a.errorMsg)}return}if(!this.websocket)return;if(i==5){switch(e[1]){case 4:if(e.length<1+this._USB_META_WS_ANNOUNCE_SIZE||(this._remoteVersion=e[2],this._remoteVersion<1))return;let a=(e[3]<<4)+(e[4]<<12);a>0&&(this._tcpMaxWindowSize=a),this._remoteNonce=e[5]+(e[6]<<8)+(e[7]<<16)+(e[8]<<24);for(let y=9;y<29;y++)if(e[y]==0){this._remoteSerial=this._hub._yapi.imm_bin2str(e.subarray(9,y));break}let l=new Uint8Array(4);this.imm_getRandomValues(l),this._nonce=l[0]+(l[1]<<8)+(l[2]<<16)+(l[3]<<24),this._connectionTime=this._hub._yapi.GetTickCount(),this._connectionState=3;let h=new Uint8Array(1+this._USB_META_WS_AUTHENTICATION_SIZE),u=this._remoteVersion<2?this._remoteVersion:2,_=0;if(h[0]=40,h[1]=5,h[2]=u,this._runtime_urlInfo.imm_getPass()!=""){_=this._USB_META_WS_VALID_SHA1;let y=this.imm_computeAuth(this._runtime_urlInfo.imm_getUser(),this._runtime_urlInfo.imm_getPass(),this._remoteSerial,this._remoteNonce);for(let p=0;p<y.length;p++)h[9+p]=y[p]}h[3]=_&255,h[4]=_>>>8,h[5]=this._nonce&255,h[6]=this._nonce>>>8&255,h[7]=this._nonce>>>16&255,h[8]=this._nonce>>>24&255,this.websocket.send(h);break;case 5:if(this._connectionState!=3||e.length<1+this._USB_META_WS_AUTHENTICATION_SIZE)return;this._tcpRoundTripTime=this._hub._yapi.GetTickCount()-this._connectionTime+1,this._tcpMaxWindowSize<2048&&this._tcpRoundTripTime<7&&(this._tcpRoundTripTime=7);let d=this._tcpMaxWindowSize*1e3/this._tcpRoundTripTime>>0;if(this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("RTT="+this._tcpRoundTripTime+"ms, WS="+this._tcpMaxWindowSize+", uploadRate="+d/1e3+" KB/s"),this._remoteVersion=e[2],this._remoteVersion<1)return;let g=e[3]+(e[4]<<8);if((g&this._USB_META_WS_RW)!=0?this._hub.imm_setRwAccess(!0):this._hub.imm_setRwAccess(!1),(g&this._USB_META_WS_VALID_SHA1)!=0){let y=e.subarray(9,29),p=this.imm_computeAuth(this._runtime_urlInfo.imm_getUser(),this._runtime_urlInfo.imm_getPass(),this._remoteSerial,this._nonce);for(let x=0;x<p.length;x++)if(p[x]!=y[x]){this._session_errno=401,this._session_error="Authentication failed",this._connectionState=0;return}this._connectionState=4}else if(this._runtime_urlInfo.imm_getPass()=="")this._connectionState=4;else{this._session_errno=401,this._runtime_urlInfo.imm_getUser()=="admin"&&!this._hub.imm_isRwAccess()?this._session_error="Authentication as admin failed":this._session_error="Password not set on remote hub",this._connectionState=0;return}break;case 6:this._session_errno=e[3]+(e[4]<<8),this._session_errno==401?this._session_error="Authentication failed":this._session_error="Remote hub closed connection with error "+this._session_errno,this._connectionState=0;break;case 7:if(n=e[2],this.tcpChan[n]){let y=this.tcpChan[n],p=e[3]+(e[4]<<8)+(e[5]<<16)+(e[6]<<24),x=this._hub._yapi.GetTickCount();if(this._lastUploadAckTime[n]!=0&&p>this._lastUploadAckBytes[n]){this._lastUploadAckBytes[n]=p,this._lastUploadAckTime[n]=x;let w=p-this._lastUploadRateBytes[n],f=x-this._lastUploadRateTime[n];if(f<500||f<1e3&&w<65536)break;this._lastUploadRateBytes[n]=p,this._lastUploadRateTime[n]=x,y.progressCb&&y.toBeSent&&y.progressCb(p,y.toBeSent.length);let T=w*1e3/f;this._uploadRate[n]=.8*this._uploadRate[n]+.3*T>>0,this._hub._yapi._logLevel>=5&&this._hub._yapi.imm_log("New rate: "+this._uploadRate[n]/1e3+" KB/s (last "+(w/1e3>>0)+"KB sent at "+(T>>0)/1e3+" KB/s)")}else this._lastUploadAckBytes[n]=p,this._lastUploadAckTime[n]=x,this._lastUploadRateBytes[n]=p,this._lastUploadRateTime[n]=x,y.progressCb&&y.toBeSent&&y.progressCb(p,y.toBeSent.length),this.imm_sendPendingRequest(n)}break}return}this.imm_asyncWebSocketError(-8,"Unsupported message: "+this._hub._yapi.imm_bin2hexstr(e))}catch(t){this._hub._yapi.imm_log("Unhandled exception in _webSocketMsg:",t)}})}imm_webSocketSend(e){this.websocket&&this.websocket.send(e)}imm_hasPendingRequest(){for(let e=0;e<4;e++)if(this.tcpChan[e])return!0;return!1}waitForPendingQueries(e){return A(this,void 0,void 0,function*(){let t=this._hub._yapi.GetTickCount()+e,i=e;for(;this.imm_hasPendingRequest()&&i>0;){let r=Math.min(i,25);yield new Promise((s,n)=>{setTimeout(s,r)}),i=t-this._hub._yapi.GetTickCount()}})}request(e,t,i,r){return A(this,void 0,void 0,function*(){return this._hub._yapi._logLevel>=3&&this._hub.imm_logrequest(e,t,i),new Promise((n,o)=>{let a=e+" "+t+` \r
\r
`,l=this.websocket,h=this._remoteVersion>0&&t.slice(-2)=="&.",u=new Ht(new Uint8Array(0));if(this._hub._yapi._logLevel>=5&&(u._creat=(Date.now()%6e5).toString(),this._hub._yapi.imm_log("request @"+u._creat+": "+e+" "+t)),u.acceptor=n,u.devUrl=t,u.sendPos=0,i){let d=this._hub.imm_getBoundary(),g=this._hub.imm_formEncodeBody(i,d);a=a.slice(0,-2)+"Content-Type: x-upload, boundary="+d+`\r
\r
`,u.toBeSent=new Uint8Array(a.length+g.length),u.toBeSent.set(g,a.length),u.progressCb=i.progressCb}else u.toBeSent=new Uint8Array(a.length);for(let d=0;d<a.length;d++)u.toBeSent[d]=a.charCodeAt(d);if(r>3){u.errorType=-8,u.errorMsg="Unsupported tcpChan "+r;try{u.acceptor(u)}catch(d){}return}if(!l||this._hub.imm_isDisconnecting()||this._connectionState!=5){if(this._hub._yapi._logLevel>=4){let d=l?" websocket=NULL":"",g=this._hub.imm_isDisconnecting()?" disconnecting":"",y=this._connectionState!=5?" connState="+this._connectionState:"";this._hub._yapi.imm_log("request @"+u._creat+" failed, websocket is down:"+d+g+y)}u.errorType=-8,u.errorMsg="WebSocket not connected";try{u.acceptor(u)}catch(d){}return}h&&(u.asyncId=this.nextAsyncId++,this.nextAsyncId>=127&&(this.nextAsyncId=48));let _=this.tcpChan[r];if(_){for(;_.next;)_=_.next;_.next=u}else this.tcpChan[r]=u;this.imm_sendPendingRequest(r)})})}imm_sendPendingRequest(e){let t=this.tcpChan[e];for(;t;){if(!this.websocket||this._hub.imm_isDisconnecting()||this._connectionState!=5){if(this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("request @"+t._creat+" failed, websocket is down"),t.errorType=-8,t.errorMsg="WebSocket not connected",t.acceptor)try{t.acceptor(t)}catch(_){}t=t.next;continue}let i=1;for(let _=t;_.next;_=_.next)i++;if(!t.toBeSent){if(t.asyncId==0){this._hub._yapi._logLevel>=5&&this._hub._yapi.imm_log(i.toString()+" req pending, @"+t._creat+" not completed");return}t=t.next;continue}let r=t.asyncId!=0,s=!1,n=t.sendPos,o=t.toBeSent.length,a,l;if(o>2108&&this._remoteVersion>=2&&e==0)if(n==0)o=2108,this._lastUploadAckBytes[e]=0,this._lastUploadAckTime[e]=0,this._uploadRate[e]=this._tcpMaxWindowSize*1e3/this._tcpRoundTripTime>>0;else if(this._lastUploadAckTime[e]==0){t.sendTimeoutId&&clearTimeout(t.sendTimeoutId),t.sendTimeoutId=setTimeout(()=>{this.imm_sendPendingRequest(e)},this._tcpRoundTripTime);return}else{let _=n-this._lastUploadAckBytes[e],d=this._uploadRate[e],g=this._hub._yapi.GetTickCount()-this._lastUploadAckTime[e],y=2*d+1024-_+d*g/1e3>>0;if(y+_>this._DEFAULT_TCP_MAX_WINDOW_SIZE&&(y=this._DEFAULT_TCP_MAX_WINDOW_SIZE-_),y<64){let p=1e3*(128-y)/d>>0;p<2&&(p=2),t.sendTimeoutId&&clearTimeout(t.sendTimeoutId),t.sendTimeoutId=setTimeout(()=>{this.imm_sendPendingRequest(e)},p);return}o>n+y&&(y>124&&(y=(y/124>>0)*124),o=n+y)}for(;n<o;){let _=1+o-n;_>125&&(_=125);let d=_-1;n<180&&n+d>=192&&(d=191-n,_=d+1),r&&n+d==t.toBeSent.length&&_<125?(l=new Uint8Array(_+1),l[0]=72+e,l[_]=t.asyncId,s=!0):(l=new Uint8Array(_),l[0]=8+e),l.set(t.toBeSent.subarray(n,n+d),1),n+=d,this.imm_webSocketSend(l)}let h=n-t.sendPos;if(t.sendPos=n,t.sendPos<t.toBeSent.length){let _=1e3*h/this._uploadRate[e]>>0;_<2&&(_=2),t.sendTimeoutId&&clearTimeout(t.sendTimeoutId),t.sendTimeoutId=setTimeout(()=>{this.imm_sendPendingRequest(e)},_);return}if(r&&!s&&(l=new Uint8Array(2),l[0]=72+e,l[1]=t.asyncId,this.imm_webSocketSend(l)),t.toBeSent=null,r&&t.acceptor)try{t.acceptor(t)}catch(_){this._hub._yapi.imm_log("WS: async acceptor exception: ",_)}let u=this._hub._yapi._networkTimeoutMs;if(t.devUrl&&(t.devUrl.indexOf("/testcb.txt")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/logger.json")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/rxmsg.json")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/rxdata.bin")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/at.txt")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/files.json")>=0?u=this._YIO_1_MINUTE_TCP_TIMEOUT:t.devUrl.indexOf("/upload.html")>=0?u=this._YIO_10_MINUTES_TCP_TIMEOUT:t.devUrl.indexOf("/flash.json")>=0?u=this._YIO_10_MINUTES_TCP_TIMEOUT:t.devUrl.indexOf("/Yvw4I.js")>=0&&(u=this._YIO_10_MINUTES_TCP_TIMEOUT)),t.timeoutId=setTimeout((_,d)=>{this.imm_abortRequest(_,d)},u,e,t),t._sent=(Date.now()%6e5).toString(),this._hub._yapi._logLevel>=5&&this._hub._yapi.imm_log("req @"+t._creat+" sent (1/"+i.toString()+")"+(r?" async-"+t.asyncId+", continue":", waiting for reply")),!r)return;t=t.next}}imm_abortRequest(e,t){if(t.timeoutId){if(t.timeoutId=null,t.asyncId==0){let i=new Uint8Array(1);if(i[0]=16+e,this.imm_webSocketSend(i),this._hub._yapi._logLevel>=4){let r=1;for(let s=t;s.next;s=s.next)r++;this._hub._yapi.imm_log(r.toString()+" req pending, @"+t._creat+" is in timeout")}setTimeout((r,s)=>{this._hub._yapi.imm_log("Dropping synchronous request after timeout: "+s.devUrl),this.imm_forgetRequest(r,s)},5e3,e,t)}this.imm_asyncWebSocketError(-8,"Timeout on "+t.devUrl+" (tcpchan "+e+")")}}imm_forgetRequest(e,t){if(this.tcpChan[e]==t){if(this.tcpChan[e]=t.next,t.asyncId==0&&(t.errorType=-8,t.errorMsg="Timeout on "+t.devUrl+" (tcpchan "+e+")",t.acceptor))try{t.acceptor(t)}catch(r){}this.imm_sendPendingRequest(e)}}imm_dropAllPendingConnection(){this.fwd_connectionState!=1&&this.fwd_websocket&&(this.fwd_connectionState=1,this.fwd_websocket.close(),this.fwd_websocket=null);for(let e=0;e<this.tcpChan.length;e++)for(let t=this.tcpChan[e];t;t=t.next)if(this.tcpChan[e]=t.next,t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=0),t.asyncId==0&&(this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("drop @"+t._creat+" (websocket down)"),t.errorType=-8,t.errorMsg="Request "+t.devUrl+" dropped (websocket down)",t.acceptor))try{t.acceptor(t)}catch(i){}}websocketJoin(e,t,i){return A(this,void 0,void 0,function*(){return this._connectionState!=5?(this.imm_asyncWebSocketError(-8,"Hub is disconnected, cannot join"),!1):(this.fwd_websocket=e,this.fwd_credentials=t,this.fwd_closeCallback=i,this.fwd_connectionState=2,e.onmessage=(r=>{this.fwd_connectionState==5?this._connectionState==5?this.imm_webSocketSend(r.data):this._hub._yapi.imm_log("WS: drop packet from fwd API (state="+this._connectionState+")"):this.fwd_connectionState==3?this.imm_handleAPIAuthPkt(r.data):this._hub._yapi.imm_log("WS: drop packet from fwd API (fwd_state="+this.fwd_connectionState+")")}),e.onclose=(r=>{this.fwd_connectionState=1,this.fwd_websocket=null,this.fwd_closeCallback&&this.fwd_closeCallback()}),this.imm_sendAPIAnnouncePkt())})}imm_sendAPIAnnouncePkt(){if(!this.fwd_websocket)return!1;let e=new Uint8Array(1+this._USB_META_WS_ANNOUNCE_SIZE),t=new Uint8Array(4);this.imm_getRandomValues(t),e[0]=40,e[1]=4,e[2]=2,e[3]=this._tcpMaxWindowSize>>4&255,e[4]=this._tcpMaxWindowSize>>12&255;for(let i=0;i<4;i++)e[5+i]=t[i];for(let i=0;i<this._remoteSerial.length&&i<20;i++)e[9+i]=this._remoteSerial.charCodeAt(i);return this.fwd_nonce=e[5]+(e[6]<<8)+(e[7]<<16)+(e[8]<<24),this.fwd_connectionState=3,this.fwd_websocket.send(e),!0}imm_handleAPIAuthPkt(e){if(e.length<1+this._USB_META_WS_AUTHENTICATION_SIZE||e[0]!=40){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log(`bad-apiauth1
`),this.fwd_connectionState=0;return}if(e[1]!=5||e[2]>2){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log(`bad-apiauth2
`),this.fwd_connectionState=0;return}if(this._remoteVersion=e[2],(e[3]+(e[4]<<8)&this._USB_META_WS_VALID_SHA1)==0){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log(`bad-apiauth3
`),this.fwd_connectionState=0;return}if(!this.fwd_websocket){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log(`no-fwd-ws
`),this.fwd_connectionState=0;return}let i,r=e.subarray(9,29),s=this.fwd_credentials;for(i=0;i<s.length;i++){let o,a=this.imm_computeAuth(s[i].user,s[i].pass,this._remoteSerial,this.fwd_nonce);for(o=0;o<a.length&&a[o]==r[o];o++);if(o>=a.length)break}if(i>=s.length){this._hub._yapi._logLevel>=3&&this._hub._yapi.imm_log(`bad-apiauth4
`),e.fill(0,3),this.fwd_websocket.send(e),this.fwd_connectionState=0;return}e[3]|=this._USB_META_WS_RW,this.fwd_nonce=e[5]+(e[6]<<8)+(e[7]<<16)+(e[8]<<24);let n=this.imm_computeAuth(s[i].user,s[i].pass,this._remoteSerial,this.fwd_nonce);for(let o=0;o<n.length;o++)e[9+o]=n[o];this.fwd_websocket.send(e),this.fwd_connectionState=5}detach(e=E.IO_ERROR,t="Hub has been forcibly detached"){return A(this,void 0,void 0,function*(){let i,r=this._hub._yapi.GetTickCount()+3e3;do{i=!1;for(let s=0;s<4;s++)if(this.tcpChan[s]!=null){i=!0;break}i&&(yield this._hub._yapi._microSleep_internal())}while(i&&r>this._hub._yapi.GetTickCount());this._hub.imm_commonDisconnect("detach",e,t),this._hub.imm_disconnectNow()})}imm_disconnectEngineNow(e=""){if(!this.websocket)return;this._connectionState=1;let t=e||this._hub.imm_getCurrentConnID(),i=this.websocket;this._hub.imm_setCurrentConnID(""),this.websocket=null,i.onclose=null,i.onerror=null;try{i.close()}catch(r){}i.terminate&&setTimeout(()=>{try{i.terminate&&i.terminate()}catch(r){}},900),this.imm_dropAllPendingConnection(),this._hub.imm_signalHubDisconnected(t)}imm_isConnected(){return this._connectionState!=5?!1:super.imm_isConnected()}};m(ea,"YWebSocketEngine");var xs=ea,ta=class ta{constructor(e){this._started=!1,this._callback=null,this._SSDPCache={},this._thread=null,this.YSSDP_PORT=1900,this.YSSDP_MCAST_ADDR_STR="239.255.255.250",this.YSSDP_URN_YOCTOPUCE="urn:yoctopuce-com:device:hub:1",this.YSSDP_DISCOVERY_MSG=`M-SEARCH * HTTP/1.1\r
HOST:`+this.YSSDP_MCAST_ADDR_STR+":"+this.YSSDP_PORT+`\r
MAN:"ssdp:discover"\r
MX:5\r
ST:`+this.YSSDP_URN_YOCTOPUCE+`\r
\r
`,this._yapi=e}_invokeCallback(e,t,i){return A(this,void 0,void 0,function*(){if(this._callback)try{yield this._callback(e,t,i)}catch(r){this._yapi.imm_log("Exception in hub discovery callback:",r)}})}imm_uuidToSerial(e){let t="",i="",r=0,s=0;for(;r<4;r++,s+=2)t+=String.fromCharCode(parseInt(e.substr(s,2),16));for(s++;r<6;r++,s+=2)t+=String.fromCharCode(parseInt(e.substr(s,2),16));for(s++;r<8;r++,s+=2)t+=String.fromCharCode(parseInt(e.substr(s,2),16));if(t+="-",s=e.indexOf("-COFF-EE"),s<0)return null;for(s+=8;e.charAt(s)==="0";)s++;return t.substr(0,8)==="VIRTHUB0"?i="0000000000":i="00000",t+=i.substr(e.length-s),t+=e.substr(s),t}ySSDPUpdateCache(e,t,i){return A(this,void 0,void 0,function*(){i<=0&&(i=1800),i*=1e3;let r=this._yapi.GetTickCount(),s=this._SSDPCache[e];if(s)s.detectedTime=r,s.maxAge=i,t!==s.url?(yield this._invokeCallback(s.serial,t,s.url),s.url=t):yield this._invokeCallback(s.serial,t,null);else{let n=this.imm_uuidToSerial(e);n&&(this._SSDPCache[e]={serial:n,url:t,detectedTime:r,maxAge:i},yield this._invokeCallback(n,t,null))}})}ySSDPParseMessage(e){return A(this,void 0,void 0,function*(){let t="HTTP/1.1 200 OK",i="NOTIFY * HTTP/1.1",r=e.split(`\r
`),s={};if(r[0]===t||r[0]===i){for(let n=1;n<r.length;n++){let o=r[n].split(": ");o.length===2&&(s[o[0].trim()]=o[1].trim())}if(s.LOCATION&&s.USN&&s["CACHE-CONTROL"]&&s.USN.indexOf(this.YSSDP_URN_YOCTOPUCE)>0){let n=s.USN.split(":")[1],o=s.LOCATION.split("/")[2],a=parseInt(s["CACHE-CONTROL"]);yield this.ySSDPUpdateCache(n,o,a)}}})}ySSDPCheckExpiration(){return A(this,void 0,void 0,function*(){let e=this._yapi.GetTickCount();this._thread&&(clearTimeout(this._thread),this._thread=null);for(let t in this._SSDPCache){let i=this._SSDPCache[t];i&&e-i.detectedTime>i.maxAge&&(i.maxAge=0,yield this._invokeCallback(i.serial,null,i.url))}this._thread=setTimeout(()=>{this.ySSDPCheckExpiration()},3e3)})}ySSDPStart(e){return A(this,void 0,void 0,function*(){return this._started||(this._callback=e,yield this.ySSDPOpenSockets(),this.ySSDPDiscover(),this._started=!0,yield this.ySSDPCheckExpiration()),E.SUCCESS})}ySSDPStop(){return A(this,void 0,void 0,function*(){this._thread&&(clearTimeout(this._thread),this._thread=null),yield this.ySSDPCloseSockets();for(let e in this._SSDPCache){let t=this._SSDPCache[e];t&&t.maxAge&&(yield this._yapi.UnregisterHub(t.url),t.maxAge=0,yield this._invokeCallback(t.serial,null,t.url))}this._SSDPCache={},this._started=!1})}ySSDPDiscover(){return A(this,void 0,void 0,function*(){for(let e=0;e<3;e++)yield E.Sleep(10<<e),yield this.ySSDPSendPacket(this.YSSDP_DISCOVERY_MSG,this.YSSDP_PORT,this.YSSDP_MCAST_ADDR_STR)})}};m(ta,"YGenericSSDPManager");var _l=ta,Is=class Is{constructor(e,t){this._hubref=0,this.TRYING=1,this.CONNECTED=2,this.RECONNECTING=3,this.ABORTED=4,this.UNREGISTERED=5,this._ctx=e,this._hubref=t}_getStrAttr_internal(e){return A(this,void 0,void 0,function*(){let t=this._ctx.getGenHub(this._hubref);if(t==null)return"";switch(e){case"registeredUrl":return t.imm_getOriginalURL();case"connectionUrl":return t.imm_getRootUrl();case"serialNumber":return t.imm_getSerialNumber();case"errorMessage":return t.get_errorMessage();default:return""}})}_getIntAttr_internal(e){return A(this,void 0,void 0,function*(){let t=this._ctx.getGenHub(this._hubref);if(e=="isInUse")return t!=null?1:0;if(e=="connectionState")return t==null?Is.UNREGISTERED:t.imm_getConnectionState();if(t==null)return-1;switch(e){case"isOnline":return t.imm_isOnline()?1:0;case"isReadOnly":return(yield t.hasRwAccess())?0:1;case"networkTimeout":return t.imm_getNetworkTimeout();case"errorType":return t.get_errorType();default:return-1}})}_setIntAttr_internal(e,t){return A(this,void 0,void 0,function*(){let i=this._ctx.getGenHub(this._hubref);i!=null&&e=="networkTimeout"&&i.imm_setNetworkTimeout(t)})}get_knownUrls_internal(){let e=this._ctx.getGenHub(this._hubref);return e!=null?e.get_knownUrls():[]}_getStrAttr(e){return A(this,void 0,void 0,function*(){return yield this._getStrAttr_internal(e)})}_getIntAttr(e){return A(this,void 0,void 0,function*(){return yield this._getIntAttr_internal(e)})}_setIntAttr(e,t){return A(this,void 0,void 0,function*(){return yield this._setIntAttr_internal(e,t)})}get_registeredUrl(){return A(this,void 0,void 0,function*(){return yield this._getStrAttr("registeredUrl")})}get_knownUrls(){return A(this,void 0,void 0,function*(){return yield this.get_knownUrls_internal()})}get_connectionUrl(){return A(this,void 0,void 0,function*(){return yield this._getStrAttr("connectionUrl")})}get_connectionState(){return A(this,void 0,void 0,function*(){return yield this._getIntAttr("connectionState")})}get_serialNumber(){return A(this,void 0,void 0,function*(){return yield this._getStrAttr("serialNumber")})}isInUse(){return A(this,void 0,void 0,function*(){return(yield this._getIntAttr("isInUse"))>0})}isOnline(){return A(this,void 0,void 0,function*(){return(yield this._getIntAttr("isOnline"))>0})}isReadOnly(){return A(this,void 0,void 0,function*(){return(yield this._getIntAttr("isReadOnly"))>0})}set_networkTimeout(e){return A(this,void 0,void 0,function*(){yield this._setIntAttr("networkTimeout",e)})}get_networkTimeout(){return A(this,void 0,void 0,function*(){return yield this._getIntAttr("networkTimeout")})}get_errorType(){return A(this,void 0,void 0,function*(){return yield this._getIntAttr("errorType")})}get_errorMessage(){return A(this,void 0,void 0,function*(){return yield this._getStrAttr("errorMessage")})}get_userData(){return A(this,void 0,void 0,function*(){return this._userData})}set_userData(e){return A(this,void 0,void 0,function*(){this._userData=e})}static FirstHubInUse(){return E.nextHubInUseInternal(-1)}static FirstHubInUseInContext(e){return e.nextHubInUseInternal(-1)}static FindHubInUse(e){return A(this,void 0,void 0,function*(){return yield E.findYHubFromID(e)})}static FindHubInUseInContext(e,t){return A(this,void 0,void 0,function*(){return yield e.findYHubFromID(t)})}nextHubInUse(){return this._ctx.nextHubInUseInternal(this._hubref)}};m(Is,"YHub");var Vt=Is;Vt.TRYING=1;Vt.CONNECTED=2;Vt.RECONNECTING=3;Vt.ABORTED=4;Vt.UNREGISTERED=5;var ia=class ia{constructor(e){this._detectType=nl,this._knownHubsBySerial={},this._knownHubsByUrl={},this._connectedHubs=[],this._registeredHubs=[],this._trustedCertificate=[],this._networkSecurityOptions=0,this._yhub_cache={},this._ssdpManager=null,this._devs={},this._snByUrl={},this._snByName={},this._fnByType={},this._lastErrorType=0,this._lastErrorMsg="no error",this._updateDevListStarted=0,this._pendingCallbacks=[],this._logLevel=4,this._logCallback=null,this._arrivalCallback=null,this._namechgCallback=null,this._removalCallback=null,this._hubDiscoveryCallback=null,this._forwardValues=0,this._calibHandlers=[],this._ValueCallbackList=[],this._TimedReportCallbackList=[],this._beacons={},this._isNodeJS=!1,this._networkTimeoutMs=xl,this._deviceListValidityMs=Tl,this._crcTable=null,this.defaultEncoding="binary",this.exceptionsDisabled=!1,this.SUCCESS=0,this.NOT_INITIALIZED=-1,this.INVALID_ARGUMENT=-2,this.NOT_SUPPORTED=-3,this.DEVICE_NOT_FOUND=-4,this.VERSION_MISMATCH=-5,this.DEVICE_BUSY=-6,this.TIMEOUT=-7,this.IO_ERROR=-8,this.NO_MORE_DATA=-9,this.EXHAUSTED=-10,this.DOUBLE_ACCES=-11,this.UNAUTHORIZED=-12,this.RTC_NOT_READY=-13,this.FILE_NOT_FOUND=-14,this.SSL_ERROR=-15,this.RFID_SOFT_ERROR=-16,this.RFID_HARD_ERROR=-17,this.BUFFER_TOO_SMALL=-18,this.DNS_ERROR=-19,this.SSL_UNK_CERT=-20,this.UNCONFIGURED=-21,this.NO_TRUSTED_CA_CHECK=1,this.NO_EXPIRATION_CHECK=2,this.NO_HOSTNAME_CHECK=4,this.LEGACY=8,this.defaultCacheValidity=5,this.INVALID_INT=2147483647,this.INVALID_UINT=-1,this.INVALID_LONG=Mr,this.INVALID_DOUBLE=Ge,this.MIN_DOUBLE=gs,this.MAX_DOUBLE=fs,this.INVALID_STRING=fe,this.HASH_BUF_SIZE=Ol,this.DETECT_NONE=nl,this.DETECT_USB=gl,this.DETECT_NET=On,this.DETECT_ALL=Cl,this.YOCTO_DEFAULT_HTTP_PORT=4444,this.YOCTO_DEFAULT_HTTPS_PORT=4443,this.system_env=e||E&&E.system_env||Bl,this._isNodeJS=this.system_env.isNodeJS,this._uniqueID=String.fromCharCode(Math.random()*79+48,Math.random()*79+48,Math.random()*79+48),this.imm_ResetToDefaults()}imm_ResetToDefaults(){this._detectType=this.DETECT_NONE,this._knownHubsBySerial={},this._knownHubsByUrl={},this._connectedHubs=[],this._registeredHubs=[],this._trustedCertificate=[],this._networkSecurityOptions=0,this._devs={},this._snByUrl={},this._snByName={},this._fnByType={},this._fnByType.Module=new gi(this,"Module"),this._lastErrorType=0,this._lastErrorMsg="no error",this._updateDevListStarted=0,this._pendingCallbacks=[],this._logLevel=2,this._logCallback=null,this._arrivalCallback=null,this._namechgCallback=null,this._removalCallback=null,this._hubDiscoveryCallback=null,this._forwardValues=0,this._ValueCallbackList=[],this._TimedReportCallbackList=[],this._beacons={},this._calibHandlers=[];for(let e=1;e<=20;e++)this.RegisterCalibrationHandler(e,this.LinearCalibrationHandler);this.RegisterCalibrationHandler(Nr,this.LinearCalibrationHandler),this.exceptionsDisabled=!1}_throw(e,t,i){if(this._lastErrorType=e,this._lastErrorMsg=t,!this.exceptionsDisabled){let r=new ps(t);throw r.errorType=e,r}return i}imm_setErr(e,t,i,r){return e&&(e.msg=i),this._lastErrorType=t,this._lastErrorMsg=i,r}imm_setSystemEnv(e){this.system_env=e,this._isNodeJS=e.isNodeJS}imm_log(e,...t){let i=new Date,r=i.getFullYear().toString()+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+("0"+i.getDate()).slice(-2),s=("0"+i.getHours().toString()).slice(-2)+":"+("0"+i.getMinutes()).slice(-2)+":"+("0"+i.getSeconds()).slice(-2),n=r+" "+s+" ["+this._uniqueID+"] ",o=!1;if(t.length>0&&t[0].constructor&&/Error/i.test(t[0].constructor.name)&&(o=!0),this._logCallback)try{t.length>0&&(t[0].message?e+=t[0].message:e+=t[0].toString()),this._logCallback(n+e)}catch(a){console.error(n+"Exception in custom log callback: ",a),console.log("... while trying to log:"),o?console.error(n+e,...t):console.log(n+e,...t)}else o?console.error(n+e,...t):console.log(n+e,...t)}RegisterLogFunction(e){return A(this,void 0,void 0,function*(){return this._logCallback=e,0})}imm_getHub(e){let t=this._knownHubsByUrl[e.imm_getRootUrl()];if(!t){for(let i in this._knownHubsByUrl)if(this._knownHubsByUrl[i].imm_getOriginalURL()==e.imm_getOriginalURL())return this._knownHubsByUrl[i]}return t}imm_getPrimaryHub(e){let t=this._knownHubsBySerial[e.imm_getSerialNumber()];return!t||t===e?(this._knownHubsBySerial[e.imm_getSerialNumber()]=e,this._knownHubsByUrl[e.imm_getRootUrl()]=e,e):(t.urlInfo.imm_useSecureSocket()||!e.urlInfo.imm_useSecureSocket())&&t.imm_getcurrentState()>=e.imm_getcurrentState()?(t.imm_inheritFrom(e),this.imm_updateRegisteredHubs(e,!1),t):(this._knownHubsBySerial[e.imm_getSerialNumber()]=e,e.imm_inheritFrom(t),this.imm_updateRegisteredHubs(t,!1),e)}_addConnectedHub(e){return A(this,void 0,void 0,function*(){this._snByUrl[e.imm_getRootUrl()]||(yield new ys(this,e.imm_getRootUrl(),null,null).refresh());let i=!1;for(let r=0;r<this._connectedHubs.length;r++){let s=this._connectedHubs[r].imm_getRootUrl();if(e.imm_getRootUrl()==s){i=!0;break}}i||this._connectedHubs.push(e)})}imm_isActiveHub(e){for(let t=0;t<this._connectedHubs.length;t++){let i=this._connectedHubs[t].serialByYdx;if(i&&i[0]==e)return!0}return!1}imm_dropConnectedHub(e){let t=this._connectedHubs.indexOf(e);if(!(t<0)){for(let i=0;i<e.serialByYdx.length;i++){let r=e.serialByYdx[i];if(r&&this._devs[r]){if(this._removalCallback){let s=ke.FindModuleInContext(this,r+".module");this._pendingCallbacks.push({event:"-",serial:r,module:s})}try{this.imm_forgetDevice(this._devs[r])}catch(s){}}}t=this._connectedHubs.indexOf(e),t>=0&&this._connectedHubs.splice(t,1),this.imm_updateRegisteredHubs(e,!1)}}_ensureUpdateDeviceListNotRunning(){return A(this,void 0,void 0,function*(){for(;this._updateDevListStarted&&this.GetTickCount()-this._updateDevListStarted<30*1e3;)yield this.Sleep(25)})}_updateDeviceList_internal(e,t){return A(this,void 0,void 0,function*(){if(this._updateDevListStarted&&this.GetTickCount()-this._updateDevListStarted<30*1e3)return{errorType:0,errorMsg:"no error"};for(let i=0;i<this._connectedHubs.length;i++)if(this._connectedHubs[i].imm_isFirstArrivalCallback()&&t&&this._arrivalCallback){e=!0;break}if(e)for(let i=0;i<this._connectedHubs.length;i++)this._connectedHubs[i].imm_forceUpdate();try{this._updateDevListStarted=this.GetTickCount();let i=[];for(let o=0;o<this._connectedHubs.length;o++){let a=this._connectedHubs[o],l=a.imm_getRootUrl();if(this.imm_getDevice(l)){if(a.imm_getcurrentState()<1){this._logLevel>=4&&this.imm_log("Skip updateDeviceList for hub "+a.urlInfo.imm_getHost()+", currently offline");continue}a.devListExpires<=this.GetTickCount()&&(a._missing={},i.push(a))}}for(let o in this._devs){let a=this._devs[o].imm_getRootUrl();for(let l=0;l<i.length;l++){let h=i[l].imm_getRootUrl();a.substr(0,h.length)==h&&(i[l]._missing[o]=!0)}}let r=[];for(let o=0;o<i.length;o++){let a=i[o].hubUpdateDeviceList();r.push(a)}let s=yield Promise.all(r),n=!1;for(let o of s)n=n||o>0;if(t){let o=this._pendingCallbacks.length;for(let a=0;a<o;a++){let l=this._pendingCallbacks[a];switch(l.event){case"+":if(this._logLevel>=3&&this.imm_log("Device "+l.serial+" plugged"),this._arrivalCallback)try{yield l.module.load(this.defaultCacheValidity),yield this._arrivalCallback(l.module)}catch(h){this.imm_log("Exception in device arrival callback:",h)}break;case"/":if(this._namechgCallback)try{yield this._namechgCallback(l.module)}catch(h){this.imm_log("Exception in device change callback:",h)}break;case"-":if(this._logLevel>=3&&this.imm_log("Device "+l.serial+" unplugged"),this._removalCallback)try{yield this._removalCallback(l.module)}catch(h){this.imm_log("Exception in device removal callback:",h)}break}}this._pendingCallbacks=this._pendingCallbacks.slice(o)}if(n){for(let o of this._ValueCallbackList)o._hwId||o.isOnline();for(let o of this._TimedReportCallbackList)o._hwId||o.isOnline()}}finally{this._updateDevListStarted=0}return{errorType:0,errorMsg:"no error"}})}updateDeviceList_process(e,t,i,r){return A(this,void 0,void 0,function*(){let s=0,n={},o=null;for(let a in r){let l=r[a],h=this._fnByType[a];h==null&&(h=new gi(this,a),this._fnByType[a]=h);for(let u=0;u<l.length;u++){let _=l[u],d=_.hardwareId,g=_.baseType;h.imm_reindexFunction(d,_.logicalName,_.advertisedValue,g)&&(o=d.substr(0,d.indexOf(".")),n[o]=!0)}}for(let a=0;a<i.length;a++){let l=i[a];o=l.serialNumber;let h=l.index,u=l.networkUrl.slice(0,-3);u.charAt(0)=="/"&&(u=t.imm_getRootUrl()+u.substr(1));let _=this._devs[o];if(this._logLevel>=5&&this.imm_log("Device "+o+" present, currdev "+(_?"":"NOT ")+"set"+(e.imm_isFirstArrivalCallback()?", firstArrival":"")),_&&e.imm_isFirstArrivalCallback()&&(s++,this._arrivalCallback)){let d=ke.FindModuleInContext(this,o+".module");this._pendingCallbacks.push({event:"+",serial:o,module:d})}if(e.serialByYdx[h]=o,_)if(_.imm_getLogicalName()!=l.logicalName){if(yield _.refresh(),this._namechgCallback){let d=ke.FindModuleInContext(this,o+".module");this._pendingCallbacks.push({event:"/",serial:o,module:d})}}else(n[o]||_.imm_getRootUrl()!=u||_.imm_getBeacon()!=l.beacon)&&(yield _.refresh());else if(new ys(this,u,l,r),s++,this._arrivalCallback){let d=ke.FindModuleInContext(this,o+".module");this._pendingCallbacks.push({event:"+",serial:o,module:d})}e._missing[o]=!1}this._arrivalCallback&&e.imm_isFirstArrivalCallback()&&e.imm_setFirstArrivalCallback(!1);for(o in e._missing)if(e._missing[o]&&this._devs[o]){if(this._removalCallback){let a=ke.FindModuleInContext(this,o+".module");this._pendingCallbacks.push({event:"-",serial:o,module:a})}this.imm_forgetDevice(this._devs[o])}return s})}parseEvents(e,t){return A(this,void 0,void 0,function*(){if(e.imm_isDisconnecting())return;e.isNotifWorking=!0,e.timeoutId&&clearTimeout(e.timeoutId),e.timeoutId=setTimeout(()=>{e.imm_isForwarded()||(this.imm_log("Closing stalled connection after "+e.imm_getNetworkTimeout()/1e3+"s"),e.imm_disconnectNow())},e.imm_getNetworkTimeout());let i=(e.notifCarryOver+t).split(`
`),r=i.length,s;t.substr(-1)!=`
`?e.notifCarryOver=i[--r]:(r--,e.notifCarryOver="");for(let n=0;n<r;n++){let o=i[n];if(o.length==0)continue;let a=o.charAt(0);if(o.length>=3&&a>=al&&a<=ol){e.retryDelay=15,e.notifPos>=0&&(e.notifPos+=o.length+1);let l=o.charCodeAt(1)-65,h=o.charCodeAt(2)-48;h>=64&&(h-=64,l+=128);let u=e.serialByYdx[l];if(u&&this._devs[u]){let _=h==15?"time":this._devs[u].imm_functionIdByFunYdx(h);if(_!=""){let d;switch(s=o.slice(3),a){case El:s!=""&&(s=s.split("\0")[0]),yield this.setFunctionValue(u+"."+_,s);break;case Il:d=this._devs[u],d!=null&&d.imm_triggerLogPull();break;case al:yield this.setConfChange(u);break;case vl:case ol:case Dl:let g,y=[a=="x"?0:a=="z"?1:2];for(g=0;g<s.length;g+=2)y.push(parseInt(s.substr(g,2),16));if(d=this._devs[u],_=="time"){let x=y[1]+256*y[2]+65536*y[3]+16777216*y[4],w=y[5]*4,f;if(y.length>=7){w+=y[6]>>6;let T=y[7];T+=(y[6]&15)*256,y[6]&16?f=T:f=T/1e3}else f=0;d.imm_setTimeRef(x+w/1e3,f)}else yield this.setTimedReport(u+"."+_,d.imm_getLastTimeRef(),d.imm_getLastDuration(),y);break;case Rl:let p=this.imm_decodeNetFuncValV2(s);if(p!=null){let x=this.imm_decodePubVal(p[0],p,1,6);yield this.setFunctionValue(u+"."+_,x)}break;case wl:default:break}}}}else if(o.length>5&&o.substr(0,4)=="YN01"){e.retryDelay=15,e.notifPos>=0&&(e.notifPos+=o.length+1);let l=o.substr(4,1),h;if(l=="@")e.notifPos=parseInt(o.slice(5));else switch(parseInt(l)){case 0:if(h=o.slice(5).split(","),h.length>2){let u=parseInt(h[2]);yield this.setBeaconChange(h[0],u)}case 2:case 4:case 8:e.devListExpires=0;break;case 5:h=o.slice(5).split(","),h.length>2&&(s=h[2].split("\0"),yield this.setFunctionValue(h[0]+"."+h[1],s[0]));break}}else e.devListExpires=0,this.imm_log("Bad event on received from server:",o),e.notifPos=-1}this._forwardValues>0&&(yield this.HandleEvents(new Dt))})}imm_decodeNetFuncValV2(e){let t=0,i=e.charCodeAt(t)&255,r=0,s=[0,0,0,0,0,0,0];if(i<32||i>159)return null;for(i-=32,s[0]=(i&64)!=0?zn:ll,i&=63;r<dl&&(t++,!(t>=e.length));){let n=e.charCodeAt(t)&255;if(n==kl)break;if(n<32||n>159)return null;n-=32,i=(i<<7)+n,s[r+1]=i>>>5-r&255,r++}return s}imm_decodePubVal(e,t,i,r){let s="",n;if(e==zn||e==ll){let o;switch(e==zn?o=hl:o=t[i++],o){case Pl:break;case Nl:case Ll:case Yl:case Ml:case Fl:case hl:for(let g=0;g<o;g++){let y=t[i++],p=y>>>4;s+=p.toString(16),p=y&15,s+=p.toString(16)}return s;case ul:case zl:let l=t[i++];if(l+=t[i++]<<8,l+=t[i++]<<16,l+=t[i++]<<24,o==ul)return String(Math.round(l));for(s=String(Math.round(l*1e3)/1e6),n=s.length;n>0&&s[n-1]=="0";)--n;return n>0&&s[n-1]=="."&&(--n,s=s.substr(0,n)),s;case Vl:let h=t[i++];h+=t[i++]<<8,h+=t[i++]<<16,h+=t[i++]<<24;let u=(h&(1<<23)-1)+(1<<23)*(h>>>31|1),_=(h>>>23&255)-127,d=u*Math.pow(2,_-23);for(s=String(Math.round(d*1e6)/1e6),n=s.length;n>0&&s[n-1]=="0";)--n;return n>0&&s[n-1]=="."&&(--n,s=s.substr(0,n)),s;default:return"?"}let a=0;for(s="";a<dl&&a<r&&t[a]!=0;)s+=String.fromCharCode(t[a]),a++}return s}imm_decExp(e){return[1e-6,1e-5,1e-4,.001,.01,.1,1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9][e]}imm_decimalToDouble(e){let t=!1,i,r=e&2047;if(r==0)return 0;e>32767?(t=!0,e=65536-e):e<0&&(t=!0,e=-e);let s=this.imm_decExp(e>>>11);return s>=1?i=r*s:i=r/Math.round(1/s),t?-i:i}imm_doubleToDecimal(e){let t=!1,i,r,s,n;if(e==0)return 0;for(e<0&&(t=!0,e=-e),i=e/1999,s=0;i>this.imm_decExp(s)&&s<15;)s++;return r=e/this.imm_decExp(s),s==15&&r>2047?n=32767:n=(s<<11)+Math.round(r),t?-n:n}imm_getCalibrationHandler(e){return this._calibHandlers[e]}imm_decodeWords(e){let t=[];for(let i=0;i<e.length;){let r=e[i],s=0;if(r=="*")i++;else if(r=="X")s=65535,i++;else if(r=="Y")s=32767,i++;else if(r>="a"){let n=t.length-1-(e.charCodeAt(i++)-97);n>=0&&(s=t[n])}else{if(i+3>e.length)return t;s=e.charCodeAt(i++)-48,s+=e.charCodeAt(i++)-48<<5;let n=e.charCodeAt(i++);n==122&&(n=92),s+=n-48<<10}t.push(s)}return t}imm_decodeFloats(e){let t=[],i=0,r=e.length;for(;i<r;){let s=0,n=1,o=0,a=0,l=e[i++];for(;l!="-"&&(l<"0"||l>"9");){if(i>=r)return t;l=e[i++]}if(l=="-"){if(i>=r)return t;n=-n,l=e[i++]}for(;l>="0"&&l<="9"||l==".";)l=="."?a=1:o<3&&(s=s*10+(l.charCodeAt(0)-48),o+=a),i<r?l=e[i++]:l="\0";o<3&&(o==0?s*=1e3:o==1?s*=100:s*=10),t.push(n*s)}return t}static imm_atoi(e){let t=parseInt(e);return isNaN(t)?0:Math.floor(t)}static imm_atof(e){let t=parseFloat(e);return isNaN(t)?0:t}imm_bin2str(e){let t=e.length,i="";for(let r=0;r<t;r+=20){let s=e.subarray(r,Math.min(r+20,t));i+=String.fromCharCode.apply(null,Array.from(s))}return i}imm_str2bin(e){let t=e.length,i=new Uint8Array(t);for(let r=0;r<t;r++)i[r]=e.charCodeAt(r);return i}imm_bin2hexstr(e){let t=e.length,i="";for(let r=0;r<t;r++){let s=e[r].toString(16);i+=s.length<2?"0"+s:s}return i.toUpperCase()}imm_bincrc(e,t,i){let r=this._crcTable;if(!r){r=new Int32Array(256);for(let o=0;o<256;o++){let a=o;for(let l=0;l<8;l++)a=a&1?3988292384^a>>>1:a>>>1;r[o]=a}this._crcTable=r}let s=t+i,n=-1;for(;t<s;)n=n>>>8^r[(n^e[t])&255],t++;return n^-1}imm_hexstr2bin(e){let t=e.length>>>1,i=new Uint8Array(t);for(let r=0;r<t;r++)i[r]=parseInt(e.substr(2*r,2),16);return i}imm_getDevice(e){let t=null,i;return e.substr(0,7)=="http://"||e.substr(0,5)=="ws://"||e.substr(0,8)=="https://"||e.substr(0,6)=="wss://"?(i=this._snByUrl[e],i!=null&&(t=this._devs[i])):this._devs[e]?t=this._devs[e]:(i=this._snByName[e],i&&(t=this._devs[i])),t}_UpdateValueCallbackList(e,t){return A(this,void 0,void 0,function*(){let i=this._ValueCallbackList.indexOf(e);t?(yield e.isOnline(),i<0&&this._ValueCallbackList.push(e)):i>=0&&this._ValueCallbackList.splice(i,1)})}_UpdateTimedReportCallbackList(e,t){return A(this,void 0,void 0,function*(){let i=this._TimedReportCallbackList.indexOf(e);t?(yield e.isOnline(),i<0&&this._TimedReportCallbackList.push(e)):i>=0&&this._TimedReportCallbackList.splice(i,1)})}imm_functionClass(e){let t=e.indexOf(".");t>=0&&(e=e.substr(t+1));let i=e.length;for(;e.substr(i-1,1)<="9";)i--;let r=e.substr(0,1).toUpperCase()+e.substr(1,i-1);return this._fnByType[r]==null&&(this._fnByType[r]=new gi(this,r)),r}imm_reindexDevice(e){let t=e.imm_getRootUrl(),i=e.imm_getSerialNumber(),r=e.imm_getLogicalName();this._devs[i]=e,this._snByUrl[t]=i,r!=""&&(this._snByName[r]=i),this._fnByType.Module.imm_reindexFunction(i+".module",r,null,null);let s,n=e.imm_functionCount();for(s=0;s<n;s++){let o=e.imm_functionId(s);if(o!=""){let a=e.imm_functionName(s),l=this.imm_functionClass(o);this._fnByType[l].imm_reindexFunction(i+"."+o,a,null,null)}}}imm_forgetDevice(e){let t=e.imm_getRootUrl(),i=e.imm_getSerialNumber(),r=e.imm_getLogicalName();delete this._devs[i],delete this._snByUrl[t],this._snByName[r]==i&&delete this._snByName[r],this._fnByType.Module.imm_forgetFunction(i+".module");let s,n=e.imm_functionCount();for(s=0;s<n;s++){let o=e.imm_functionId(s);if(o!=""){let a=this.imm_functionClass(o);this._fnByType[a].imm_forgetFunction(i+"."+o)}}}imm_resolveFunction(e,t){if(_i[e]==null)return this._fnByType[e]==null&&(this._fnByType[e]=new gi(this,e)),this._fnByType[e].imm_resolve(t);let i=_i[e],r;for(e in this._fnByType)if(this._fnByType[e].imm_matchBaseType(i)&&(r=this._fnByType[e].imm_resolve(t),r.errorType==0))return r;return{errorType:-4,errorMsg:"No "+e+" ["+t+"] found (old firmware?)"}}imm_getFriendlyNameFunction(e,t){if(_i[e]==null)return this._fnByType[e]==null&&(this._fnByType[e]=new gi(this,e)),this._fnByType[e].imm_getFriendlyName(t);let i=_i[e],r;for(e in this._fnByType)if(this._fnByType[e].imm_matchBaseType(i)&&(r=this._fnByType[e].imm_getFriendlyName(t),r.errorType==0))return r;return{errorType:-4,errorMsg:"No "+e+" ["+t+"] found (old firmware?)"}}imm_setFunction(e,t,i){this._fnByType[e]==null&&(this._fnByType[e]=new gi(this,e)),this._fnByType[e].imm_setFunction(t,i)}imm_getFunction(e,t){return this._fnByType[e]==null&&(this._fnByType[e]=new gi(this,e)),this._fnByType[e].imm_getFunction(t)}setFunctionValue(e,t){return A(this,void 0,void 0,function*(){let i=this.imm_functionClass(e);if(this._fnByType[i].imm_setFunctionValue(e,t)){let r=this._ValueCallbackList;for(let s=0;s<r.length;s++){let n=r[s];n._hwId&&n._hwId==e&&(yield n._invokeValueCallback(t))}}})}setTimedReport(e,t,i,r){return A(this,void 0,void 0,function*(){let s=this.imm_functionClass(e),n=this._TimedReportCallbackList;for(let o=0;o<n.length;o++){let a=n[o];if(a._hwId&&a._hwId==e&&this.imm_getDevice(a._serial)){let h=a,u=yield h._decodeTimedReport(t,i,r);yield h._invokeTimedReportCallback(u)}}})}setConfChange(e){return A(this,void 0,void 0,function*(){yield ke.FindModuleInContext(this,e+".module")._invokeConfigChangeCallback()})}setBeaconChange(e,t){return A(this,void 0,void 0,function*(){if(this._beacons[e]===void 0||this._beacons[e]!=t){this._beacons[e]=t;let i=this.imm_getDevice(e);i&&(i._beacon=t),yield ke.FindModuleInContext(this,e+".module")._invokeBeaconCallback(t)}})}imm_getFunctionValue(e){let t=this.imm_functionClass(e);return this._fnByType[t].imm_getFunctionValue(e)}imm_getFunctionBaseType(e){let t=this.imm_functionClass(e);return this._fnByType[t].imm_getBaseType()}imm_getFirstHardwareId(e){if(_i[e]==null)return this._fnByType[e]==null&&(this._fnByType[e]=new gi(this,e)),this._fnByType[e].imm_getFirstHardwareId();let t=_i[e],i;for(e in this._fnByType)if(this._fnByType[e].imm_matchBaseType(t)&&(i=this._fnByType[e].imm_getFirstHardwareId(),i))return i;return null}imm_getNextHardwareId(e,t){if(_i[e]==null)return this._fnByType[e].imm_getNextHardwareId(t);let i=_i[e],r=this.imm_functionClass(t),s=this._fnByType[r].imm_getNextHardwareId(t);if(s)return s;for(e in this._fnByType){if(r!=""){if(e!=r)continue;r="";continue}if(this._fnByType[e].imm_matchBaseType(i)&&(s=this._fnByType[e].imm_getFirstHardwareId(),s))return s}return null}devRequest(e,t,i=null,r=0){return A(this,void 0,void 0,function*(){let s=t.split(`
`),n=new Ht(null),o=null,a;if(e.substr(0,7)=="http://"||e.substr(0,5)=="ws://"||e.substr(0,8)=="https://"||e.substr(0,6)=="wss://"||e.substr(0,9)=="secure://"||e.substr(0,7)=="auto://"){if(a=e,a.slice(-1)!="/"&&(a=a+"/"),s[0].substr(0,12)!="GET /not.byn"){let g=this._snByUrl[a];g&&(o=this._devs[g])}}else{if(o=this.imm_getDevice(e),!o)return n.errorType=-4,n.errorMsg="Device ["+e+"] not online",n;if(s[0]=="GET /api.json")return o.requestAPI(this.defaultCacheValidity);a=o.imm_getRootUrl()}let l=s[0].split(" ");if(l.length<2)return n.errorType=-2,n.errorMsg="Invalid request, not enough words; expected a method name and a URL",n;if(l.length>2)return n.errorType=-2,n.errorMsg="Invalid request, too many words; make sure the URL is URI-encoded",n;let h=null;for(let g=0;g<this._connectedHubs.length;g++){let y=this._connectedHubs[g].imm_getRootUrl();if(a.slice(0,y.length)==y){h=this._connectedHubs[g];break}}if(!h&&this._knownHubsByUrl[e]&&(h=this._knownHubsByUrl[e]),!h)return n.errorType=-4,n.errorMsg="No hub found for URL "+a,n;let u=l[0],_=l[1];if(_.substr(0,1)=="/"&&(_=_.substr(1)),a.substr(0,h.imm_getRootUrl().length)==h.imm_getRootUrl())_=a.substr(h.imm_getRootUrl().length-1)+_;else{let g=a.indexOf("//");g=a.indexOf("/",g+3),_=a.slice(g)+_}if(_.slice(-2)=="&."&&!(yield h.hasRwAccess()))return n.errorType=-12,n.errorMsg="Access denied: admin credentials required",n;let d=m(function(){return h.request(u,_,i,r).catch(y=>{let p=new Ht(null);return p.errorType=-8,p.errorMsg=y.message,p})},"delayedRequest");if(o&&r==0){let g=o._pendingQueries.then(d,d);o._pendingQueries=g,n=yield g}else n=yield d();return n})}isReadOnly(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDevice(e);if(!t)return!0;let i=t.imm_getRootUrl(),r=null;for(let s=0;s<this._connectedHubs.length;s++){let n=this._connectedHubs[s].imm_getRootUrl();if(i.slice(0,n.length)==n){r=this._connectedHubs[s];break}}return!r||!(yield r.hasRwAccess())})}imm_funcDev_internal(e,t){let i=new bs(null),r=this.imm_resolveFunction(e,t);if(r.errorType!=0)i.errorType=r.errorType,i.errorMsg=r.errorMsg;else{t=r.result;let s=t.indexOf("."),n=t.substr(0,s),o=t.substr(s+1),a=this.imm_getDevice(n);a==null?(i.errorType=-4,i.errorMsg="Device ["+n+"] not found"):i.obj_result={_expiration:-1,device:a,deviceid:n,functionid:o,hwid:t}}return i}_funcDev(e,t){return A(this,void 0,void 0,function*(){let i=this.imm_funcDev_internal(e,t);if(i.errorType==0)return i;if(i.errorType==-4&&this._connectedHubs.length==0)return i.errorMsg="Impossible to contact any device because no hub has been registered",i;let r=yield this._updateDeviceList_internal(!0,!1);return r.errorType!=0?(i.errorType=r.errorType,i.errorMsg=r.errorMsg,i):this.imm_funcDev_internal(e,t)})}funcRequest(e,t,i,r=0){return A(this,void 0,void 0,function*(){let s=this.imm_funcDev_internal(e,t);if(s.errorType!=0&&(s=yield this._funcDev(e,t),s.errorType!=0))return s;let n=s.obj_result,o=null;if(i==""){let a=yield n.device.requestAPI(r);if(a!=null){if(a.errorType!=0||!a.obj_result){let l=new bs(null);return l.errorType=a.errorType,l.errorMsg=a.errorMsg,l}o=a.obj_result[n.functionid]}}else n.device.imm_dropCache();if(!o){i==""&&(i=".json");let a="GET /api/"+n.functionid+i,l=yield this.devRequest(n.deviceid,a,null,0);if(l.errorType!=0)return l;let h=l.bin_result;if(h.length==0&&a.indexOf("?")>=0)return s.obj_result=null,s;try{o=JSON.parse(this.imm_bin2str(h))}catch(u){}}if(!o)s.errorType=-8,s.errorMsg="Request failed, could not parse API value for function "+n.hwid;else{for(let a in n)o[a]=n[a];s.obj_result=o}return s})}HTTPRequest(e,t){return A(this,void 0,void 0,function*(){let i=yield this.devRequest(e,t,null,0);return i.errorType!=0?this._throw(i.errorType,i.errorMsg,null):i.bin_result})}ForceDeviceRefresh(e){return A(this,void 0,void 0,function*(){let t=this.imm_getDevice(e);if(!t)return-4;let i=t.imm_getRootUrl();for(let r=0;r<this._connectedHubs.length;r++){let n=this._connectedHubs[r].urlInfo.imm_getRootUrl();if(i.substr(0,n.length)===n){let o=this.imm_getDevice(n);o.imm_dropCache();let a=yield o.refresh();if(a!=0)return this._throw(a,o._lastErrorMsg,a);let l=yield o.requestAPI(this.defaultCacheValidity);if(l.errorType!=0)return l.errorType;let h=l.obj_result.services.yellowPages;t.imm_updateFromYP(h)}}return t.imm_dropCache(),0})}SetDeviceListValidity_internal(e){return A(this,void 0,void 0,function*(){this._deviceListValidityMs=e*1e3})}GetDeviceListValidity_internal(){return A(this,void 0,void 0,function*(){return this._deviceListValidityMs/1e3>>0})}SetNetworkTimeout_internal(e){return A(this,void 0,void 0,function*(){this._networkTimeoutMs=e})}GetNetworkTimeout_internal(){return A(this,void 0,void 0,function*(){return this._networkTimeoutMs})}GetYAPISharedLibraryPath_internal(){return A(this,void 0,void 0,function*(){return""})}AddUdevRule_internal(e){return A(this,void 0,void 0,function*(){return"error: Not supported in TypeScript"})}DownloadHostCertificate_internal(e,t){return A(this,void 0,void 0,function*(){return yield this.system_env.downloadRemoteCertificate(new si(e))})}SetTrustedCertificatesList_internal(e){return A(this,void 0,void 0,function*(){return"error: Not supported in TypeScript"})}SetNetworkSecurityOptions_internal(e){return A(this,void 0,void 0,function*(){return this._networkSecurityOptions=e,""})}AddTrustedCertificates_internal(e){return A(this,void 0,void 0,function*(){return this._trustedCertificate.push(e),""})}imm_updateRegisteredHubs(e,t){let i;for(i=0;i<this._registeredHubs.length;i++)if(this._registeredHubs[i]===e){t||(this._logLevel>=4&&this.imm_log("Unlisting registered hub: "+e.imm_getOriginalURL()),this._registeredHubs.splice(i,1));return}if(t)this._logLevel>=4&&this.imm_log("Adding registered hub: "+e.imm_getOriginalURL()),this._registeredHubs.push(e);else if(this._logLevel>=4)for(this.imm_log("Could not unlist registered hub: "+e.imm_getOriginalURL()),i=0;i<this._registeredHubs.length;i++)this.imm_log("- "+this._registeredHubs[i].imm_getOriginalURL())}SetDeviceListValidity(e){return A(this,void 0,void 0,function*(){return yield this.SetDeviceListValidity_internal(e)})}GetDeviceListValidity(){return A(this,void 0,void 0,function*(){return yield this.GetDeviceListValidity_internal()})}GetYAPISharedLibraryPath(){return A(this,void 0,void 0,function*(){return yield this.GetYAPISharedLibraryPath_internal()})}AddUdevRule(e){return A(this,void 0,void 0,function*(){return yield this.AddUdevRule_internal(e)})}DownloadHostCertificate(e,t){return A(this,void 0,void 0,function*(){return yield this.DownloadHostCertificate_internal(e,t)})}AddTrustedCertificates(e){return A(this,void 0,void 0,function*(){return yield this.AddTrustedCertificates_internal(e)})}SetTrustedCertificatesList(e){return A(this,void 0,void 0,function*(){return yield this.SetTrustedCertificatesList_internal(e)})}SetNetworkSecurityOptions(e){return A(this,void 0,void 0,function*(){return yield this.SetNetworkSecurityOptions_internal(e)})}SetNetworkTimeout(e){return A(this,void 0,void 0,function*(){return yield this.SetNetworkTimeout_internal(e)})}GetNetworkTimeout(){return A(this,void 0,void 0,function*(){return yield this.GetNetworkTimeout_internal()})}SetCacheValidity(e){return A(this,void 0,void 0,function*(){this.defaultCacheValidity=e})}GetCacheValidity(){return A(this,void 0,void 0,function*(){return this.defaultCacheValidity})}nextHubInUseInternal(e){return this.nextHubInUseInternal_internal(e)}getYHubObj(e){let t;return t=this._findYHubFromCache(e),t==null&&(t=new Vt(this,e),this._addYHubToCache(e,t)),t}findYHubFromID(e){return A(this,void 0,void 0,function*(){let t;for(t=this.nextHubInUseInternal(-1);t!=null;){if((yield t.get_serialNumber())==e||(yield t.get_registeredUrl())==e)return t;t=t.nextHubInUse()}return t})}GetAPIVersion(){return A(this,void 0,void 0,function*(){return this.imm_GetAPIVersion()})}imm_GetAPIVersion(){return"2.1.10284"}InitAPI(e,t){return A(this,void 0,void 0,function*(){return this._detectType=e,this.system_env.hasSSDP&&(e&this.DETECT_NET)!==0&&(yield this.TriggerHubDiscovery()),0})}FreeAPI(){return A(this,void 0,void 0,function*(){for(let e in this._devs)yield this._devs[e].waitPendingQueries();yield this.KillAPI()})}KillAPI(){return A(this,void 0,void 0,function*(){this._ssdpManager&&(yield this._ssdpManager.ySSDPStop(),this._ssdpManager=null);for(let e of this._connectedHubs)this.imm_dropConnectedHub(e);for(let e in this._knownHubsBySerial){let t=this._knownHubsBySerial[e];t.imm_getcurrentState()>-5&&(yield t.detach(E.IO_ERROR,"Connection closed by FreeAPI"))}this.imm_ResetToDefaults()})}DisableExceptions(){return A(this,void 0,void 0,function*(){this.exceptionsDisabled=!0})}EnableExceptions(){return A(this,void 0,void 0,function*(){this.exceptionsDisabled=!1})}LogUnhandledPromiseRejections(){return A(this,void 0,void 0,function*(){this.system_env.hookUnhandledRejection((e,t)=>{this.imm_log("Unhandled Rejection at: Promise ",t," reason: ",e)})})}RegisterHub(e,t){return A(this,void 0,void 0,function*(){if(this._logLevel>=4&&this.imm_log("Registering hub: "+e),e==="net")return this.system_env.hasSSDP?(this._detectType|=this.DETECT_NET,this.TriggerHubDiscovery()):this.imm_setErr(t,-3,"Network discovery is not possible in a browser",-3);if(e==="usb")return this.imm_setErr(t,-3,"Use the VirtualHub on 127.0.0.1 to access USB devices",-3);let i=new si(e),r=this.imm_getHub(i);r?(this._logLevel>=3&&this.imm_log("Registering existing hub: "+i.imm_getRootUrl()+" old="+r.imm_getRootUrl()),r.imm_updateUrl(i)):(this._logLevel>=3&&this.imm_log("Registering new hub: "+i.imm_getRootUrl()),r=new Oi(this,i),r.imm_addKnownUrl(i),this._knownHubsByUrl[i.imm_getRootUrl()]=r),this.imm_updateRegisteredHubs(r,!0),yield r.attach(2);let s=new Dt,n=yield r.waitForConnection(this._networkTimeoutMs,s);if(n!=0)return this.imm_dropConnectedHub(r),this.imm_updateRegisteredHubs(r,!1),yield r.detach(n,s.msg),r.imm_forgetUrls(),this.imm_setErr(t,n,s.msg,n);let o=yield this._updateDeviceList_internal(!0,!1);return o.errorType!=0?(this._logLevel>=3&&this.imm_log("Registering failed with"+o.errorType+" ("+o.errorMsg+")"),this.imm_dropConnectedHub(r),this.imm_updateRegisteredHubs(r,!1),yield r.detach(o.errorType,o.errorMsg),r.imm_forgetUrls(),this.imm_setErr(t,o.errorType,o.errorMsg,o.errorType)):0})}PreregisterHub(e,t){return A(this,void 0,void 0,function*(){let i=new si(e),r=this.imm_getHub(i);if(r)this._logLevel>=3&&this.imm_log("Preregistering existing hub: "+i.imm_getRootUrl()),r.imm_updateUrl(i);else{if(this._logLevel>=3&&this.imm_log("Preregistering new hub: "+i.imm_getRootUrl()),r=new Oi(this,i),!r)return this.imm_setErr(t,-3,"Unsupported hub protocol: "+i.imm_getProto(),-3);r.imm_addKnownUrl(i),this._knownHubsByUrl[i.imm_getRootUrl()]=r}return yield r.attach(1),this.imm_updateRegisteredHubs(r,!0),0})}RegisterHubHttpCallback(e,t,i){return A(this,void 0,void 0,function*(){let r="http://callback:4444",s=new si(r),n=this.imm_getHub(s);if(!n){n=new Oi(this,s);let h=this.system_env.getHttpCallbackEngine(n,s,e,t);if(!h)return this.imm_setErr(i,-3,"HTTP Callback mode is not available in this environment",-3);n.imm_setHubEngine(h)}yield n.attach(3);let o=new Dt,a=yield n.waitForConnection(this._networkTimeoutMs,o);if(a!=0)return this.imm_dropConnectedHub(n),yield n.detach(a,o.msg),this.imm_setErr(i,a,o.msg,a);let l=yield this._updateDeviceList_internal(!0,!1);return l.errorType!=0?(yield n.reportFailure(l.errorMsg),this.imm_setErr(i,l.errorType,l.errorMsg,l.errorType)):(this.imm_updateRegisteredHubs(n,!0),0)})}RegisterHubWebSocketCallback(e,t,i){return A(this,void 0,void 0,function*(){let s="http://"+(i?"ws:"+i+"@":"")+"callback:4444",n=new si(s),o=this.imm_getHub(n);if(!o){o=new Oi(this,n);let u=this.system_env.getWebSocketCallbackEngine(o,n,e);if(!u)return this.imm_setErr(t,-3,"WebSocket Callback mode is not available in this environment",-3);o.imm_setHubEngine(u)}yield o.attach(3);let a=new Dt,l=yield o.waitForConnection(this._networkTimeoutMs,a);if(l!=0)return this.imm_dropConnectedHub(o),yield o.detach(l,a.msg),this.imm_setErr(t,l,a.msg,l);let h=yield this._updateDeviceList_internal(!0,!1);return h.errorType!=0?(this.imm_dropConnectedHub(o),yield o.detach(h.errorType,h.errorMsg),this.imm_setErr(t,h.errorType,h.errorMsg,h.errorType)):(this.imm_updateRegisteredHubs(o,!0),0)})}WebSocketJoin(e,t,i){return A(this,void 0,void 0,function*(){return this._connectedHubs.length==0?!1:yield this._connectedHubs[0].WebSocketJoin(e,t,i)})}UnregisterHub(e){return A(this,void 0,void 0,function*(){let t=new si(e),i=this.imm_getHub(t);if(i){for(let o in this._devs)yield this._devs[o].waitPendingQueries();yield i.waitForPendingQueries(200);let r=i.imm_getSerialNumber();if(r){let o=this._knownHubsBySerial[r];o&&(i.imm_forgetUrls(),i=o,t=i.urlInfo)}if(this._logLevel>=3&&this.imm_log("Unregistering hub "+e+" ("+t.imm_getRootUrl()+")"),this.imm_dropConnectedHub(i),i.imm_isDisconnected()){this._logLevel>=3&&this.imm_log("Hub "+t.imm_getRootUrl()+" is already disconnected"),this.imm_updateRegisteredHubs(i,!1);return}let s=this.GetTickCount(),n=i.waitForDisconnection(500);i.imm_isDisconnecting()?this._logLevel>=3&&this.imm_log("Hub "+t.imm_getRootUrl()+" is already disconnecting"):yield i.detach(E.IO_ERROR,"Hub has been unregistered"),yield n,i.imm_forgetUrls(),this.imm_updateRegisteredHubs(i,!1),this._logLevel>=4&&this.imm_log("Disconnected after "+(this.GetTickCount()-s)+" ms")}else this._logLevel>=4&&this.imm_log("No hub to Unregister with "+e+" ("+t.imm_getRootUrl()+")")})}TestHub(e,t,i){return A(this,void 0,void 0,function*(){if(e=="net")return this.imm_setErr(i,-2,"Not supported",-2);let r=new si(e),s=this.imm_getHub(r);if(s)this._logLevel>=4&&this.imm_log("Testing existing hub: "+s.imm_getRootUrl());else if(this._logLevel>=4&&this.imm_log("Testing new hub: "+r.imm_getRootUrl()),s=new Oi(this,r),!s)return this.imm_setErr(i,-3,"Unsupported hub protocol: "+r.imm_getProto(),-3);yield s.attach(0);let n=new Dt,o=yield s.waitForConnection(t,n);return o!=0?this.imm_setErr(i,o,n.msg,o):0})}UpdateDeviceList(e=null){return A(this,void 0,void 0,function*(){let t=yield this._updateDeviceList_internal(!1,!0);return t.errorType!==0?this.imm_setErr(e,t.errorType,t.errorMsg,t.errorType):0})}_hubDiscoveryCallback_internal(e,t,i){return A(this,void 0,void 0,function*(){if(this._hubDiscoveryCallback&&t)try{yield this._hubDiscoveryCallback(e,t)}catch(r){this.imm_log("Exception in hub discovery callback:",r)}(this._detectType&On)!==0&&t&&(i&&(yield this.UnregisterHub(i)),yield this.PreregisterHub(t,new Dt))})}TriggerHubDiscovery(e=null){return A(this,void 0,void 0,function*(){if(this._ssdpManager)yield this._ssdpManager.ySSDPDiscover();else{if(this._ssdpManager=this.system_env.getSSDPManager(this),!this._ssdpManager)return this._lastErrorType;yield this._ssdpManager.ySSDPStart((t,i,r)=>{this._hubDiscoveryCallback_internal(t,i,r)})}return 0})}HandleEvents(e=null){return A(this,void 0,void 0,function*(){return 0})}Sleep(e,t=null){return A(this,void 0,void 0,function*(){let i=this.GetTickCount()+e,r=e;for(;r>0;){let s=Math.min(r,25);yield new Promise((n,o)=>{setTimeout(n,s)}),r=i-this.GetTickCount()}return 0})}_microSleep_internal(){return new Promise(function(e,t){setTimeout(e,3)})}SetTimeout(e,t,i){let r=this.GetTickCount()+t,s=m(()=>A(this,void 0,void 0,function*(){let n=r-this.GetTickCount();n<40?(n>3&&(yield new Promise((o,a)=>{setTimeout(o,n)})),e.apply(null,i)):(n>=150&&(yield this.UpdateDeviceList(),n=Math.min(r-E.GetTickCount(),110)),yield this.Sleep(n-20),s())}),"setTimeout_internal");return s(),0}GetTickCount(){return Date.now()}imm_CheckLogicalName(e){return e==""?!0:!e||e.length>19?!1:/^[A-Za-z0-9_\-]*$/.test(e)}CheckLogicalName(e){return A(this,void 0,void 0,function*(){return this.imm_CheckLogicalName(e)})}RegisterDeviceArrivalCallback(e){return A(this,void 0,void 0,function*(){this._arrivalCallback=e})}RegisterDeviceChangeCallback(e){return A(this,void 0,void 0,function*(){this._namechgCallback=e})}RegisterDeviceRemovalCallback(e){return A(this,void 0,void 0,function*(){this._removalCallback=e})}RegisterHubDiscoveryCallback(e){return A(this,void 0,void 0,function*(){return this.system_env.hasSSDP?(this._hubDiscoveryCallback=e,this.TriggerHubDiscovery()):this._throw(-3,"Hub discovery is not supported in this environment",-3)})}RegisterCalibrationHandler(e,t){return A(this,void 0,void 0,function*(){this._calibHandlers[e]=t})}LinearCalibrationHandler(e,t,i,r,s){let n,o=r[0],a=s[0]-o,l=0;for(t<Nr?n=Math.min(t%10,r.length,s.length):n=s.length;e>r[l]&&++l<n;){let h=o,u=a;o=r[l],a=s[l]-o,e<o&&o>h&&(a=u+(a-u)*(e-h)/(o-h))}return e+a}imm_yMD5(e){let t=new ms;return t.addData(this.imm_str2bin(e)),t.calculate()}imm_initshaw(e,t,i,r,s){let n,o=-1,a=0,l=e.length;for(n=0;n<64;n++){let h=t+n,u=0;h<l?u=e.charCodeAt(h):i!=0&&((i&128)!=0?h==l&&(u=i):h==l+3?u=i:h==l+4&&(u=128)),a==0&&(o++,s[o]=0,a=32),a-=8,s[o]|=u<<a}if(i!=0&&(i==128?l<=t+55&&(s[15]=8*l):s[15]=8*(64+l+4)),r!=0){let h=r<<16|r;for(o=0;o<16;o++)s[o]^=h}}imm_itershaw(e,t){let i,r,s,n,o,a,l;for(i=e[0],r=e[1],s=e[2],n=e[3],o=e[4],l=16;l<80;l++)a=t[l-3]^t[l-8]^t[l-14]^t[l-16],t[l]=a<<1|a>>>31;for(l=0;l<20;l++)a=(i<<5|i>>>27)+o+t[l]+1518500249+(r&s|~r&n),o=n,n=s,s=r<<30|r>>>2,r=i,i=a&4294967295;for(l=20;l<40;l++)a=(i<<5|i>>>27)+o+t[l]+1859775393+(r^s^n),o=n,n=s,s=r<<30|r>>>2,r=i,i=a&4294967295;for(l=40;l<60;l++)a=(i<<5|i>>>27)+o+t[l]+2400959708+(r&s|r&n|s&n),o=n,n=s,s=r<<30|r>>>2,r=i,i=a&4294967295;for(l=60;l<80;l++)a=(i<<5|i>>>27)+o+t[l]+3395469782+(r^s^n),o=n,n=s,s=r<<30|r>>>2,r=i,i=a&4294967295;t[0]=e[0]+i&4294967295,t[1]=e[1]+r&4294967295,t[2]=e[2]+s&4294967295,t[3]=e[3]+n&4294967295,t[4]=e[4]+o&4294967295}imm_ySHA1(e){let t=[1732584193,4023233417,2562383102,271733878,3285377520],i,r=0,s=e.length,n=new Uint32Array(80);do{for(this.imm_initshaw(e,r,128,0,n),this.imm_itershaw(t,n),i=0;i<5;i++)t[i]=n[i];r+=64}while(s>r-9);let o=new Uint8Array(20);for(i=0;i<20;i++)o[i]=t[i>>>2]>>>24-8*(i&3)&255;return o}ComputePSK(e,t){return A(this,void 0,void 0,function*(){let i=[1732584193,4023233417,2562383102,271733878,3285377520],r=[],s=[],n=[],o=[],a,l,h,u;for(u=new Uint32Array(80),this.imm_initshaw(t,0,0,13878,u),this.imm_itershaw(i,u),h=0;h<5;h++)r[h]=u[h];for(u=new Uint32Array(80),this.imm_initshaw(t,0,0,23644,u),this.imm_itershaw(i,u),h=0;h<5;h++)s[h]=u[h];for(l=0,h=0;h<5;h++)n[h]=0;for(u=new Uint32Array(80),this.imm_initshaw(e,0,1,0,u),a=0;a<8192;){for(this.imm_itershaw(r,u),u[5]=2147483648,h=6;h<15;h++)u[h]=0;if(u[15]=672,this.imm_itershaw(s,u),n[0]^=u[0],n[1]^=u[1],n[2]^=u[2],n[3]^=u[3],n[4]^=u[4],a++,(a&4095)==0){for(h=0;h<5&&l<32;h++)o[l++]=n[h]>>>24&255,o[l++]=n[h]>>>16&255,o[l++]=n[h]>>>8&255,o[l++]=n[h]&255;if(a==4096){for(h=0;h<5;h++)n[h]=0;u=new Uint32Array(80),this.imm_initshaw(e,0,2,0,u)}}}let _="";for(h=0;h<32;h++)_+=("0"+Number(o[h]).toString(16)).slice(-2);return _})}nextHubInUseInternal_internal(e){let t=e<0?0:e+1,i,r;do{r=!1,i=!1;for(let s in this._registeredHubs){let o=this._registeredHubs[s].getHubRef();if(o==t)return this.getYHubObj(t);o>t&&(r=!0)}r&&(t++,i=!0)}while(i);return null}getGenHub(e){for(let t=0;t<this._registeredHubs.length;t++){let i=this._registeredHubs[t];if(i.getHubRef()==e)return i}return null}_findYHubFromCache(e){return this._yhub_cache[e]}_addYHubToCache(e,t){this._yhub_cache[e]=t}};m(ia,"YAPIContext");var be=ia;be.SUCCESS=0;be.NOT_INITIALIZED=-1;be.INVALID_ARGUMENT=-2;be.NOT_SUPPORTED=-3;be.DEVICE_NOT_FOUND=-4;be.VERSION_MISMATCH=-5;be.DEVICE_BUSY=-6;be.TIMEOUT=-7;be.IO_ERROR=-8;be.NO_MORE_DATA=-9;be.EXHAUSTED=-10;be.DOUBLE_ACCES=-11;be.UNAUTHORIZED=-12;be.RTC_NOT_READY=-13;be.FILE_NOT_FOUND=-14;be.SSL_ERROR=-15;be.RFID_SOFT_ERROR=-16;be.RFID_HARD_ERROR=-17;be.BUFFER_TOO_SMALL=-18;be.DNS_ERROR=-19;be.SSL_UNK_CERT=-20;be.UNCONFIGURED=-21;be.NO_TRUSTED_CA_CHECK=1;be.NO_EXPIRATION_CHECK=2;be.NO_HOSTNAME_CHECK=4;be.LEGACY=8;var E=new be;var Hl=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},aa=class aa extends Yr{constructor(){super(...arguments),this.isNodeJS=!1,this.hasSSDP=!1}hookUnhandledRejection(e){window.addEventListener("onunhandledrejection",t=>{let i=t;e(i.reason,i.promise)})}getWebSocketEngine(e,t){return new na(e,t)}getHttpEngine(e,t,i){return new sa(e,t,i)}getWebSocketCallbackHub(e,t){return e._yapi._throw(E.NOT_SUPPORTED,"WebSocket Callback mode is not available in this environment",null)}getHttpCallbackHub(e,t,i){return e._yapi._throw(E.NOT_SUPPORTED,"HTTP Callback mode is not available in this environment",null)}getSSDPManager(e){return e._throw(E.NOT_SUPPORTED,"Hub discovery is not available in this environment",null)}loadfile(e){return new Promise((t,i)=>{let r=new FileReader;r.onerror=function(s){i(s.target.error)},r.onload=function(s){t(new Uint8Array(s.target.result))},r.readAsArrayBuffer(e)})}downloadfile(e,t){return new Promise((i,r)=>{let s=new XMLHttpRequest;s.open("GET",e,!0),s.overrideMimeType("text/plain; charset=x-user-defined"),s.onreadystatechange=(()=>{s.readyState==4&&(s.status!=200&&s.status!=304?s.status?r(new Error("HTTP error "+s.status)):r(new Error("Unable to complete HTTP request, network down?")):i(E.imm_str2bin(s.responseText)))}),s.send("")})}downloadRemoteCertificate(e){return Hl(this,void 0,void 0,function*(){return"error: Not supported in browser"})}};m(aa,"YSystemEnvHtml");var ra=aa,Gl=new ra;E.imm_setSystemEnv(Gl);var oa=class oa extends Ts{constructor(e,t,i){super(e,t,i)}imm_makeRequest(e,t,i,r,s,n,o){let a=new XMLHttpRequest,l=0;return a.open(e,this._runtime_urlInfo.imm_getUrl(!0,!0,!1)+t,!0,"",""),a.setRequestHeader("Content-Type",i),a.overrideMimeType("text/plain; charset=x-user-defined"),a.onreadystatechange=()=>{if(a.readyState>=3){let h=a.status>>0;if(a.readyState==4&&h!=200&&h!=304){h==401||h==204?(this.infoJson.stamp=0,o(E.UNAUTHORIZED,"Unauthorized access ("+a.status+")",!1)):h==404?o(E.FILE_NOT_FOUND,"HTTP request return status 404 (not found)",!1):this._hub.imm_isDisconnecting()?o(E.IO_ERROR,"Hub is disconnecting",!1):o(E.IO_ERROR,"HTTP request failed with status "+a.status,!1);return}if(this._hub.imm_isDisconnecting()){this._hub._yapi._logLevel>=4&&this._hub._yapi.imm_log("Dropping request "+t+" because hub is disconnecting");return}if(s&&a.responseText){let u=a.responseText.length;u>l&&(s(a.responseText.slice(l,u)),l=u)}n&&a.readyState==4&&n(a.responseText)}},a.onerror=()=>{o(E.IO_ERROR,"HTTP request failed without status",!1)},a.send(r),a}imm_abortRequest(e){e.abort()}};m(oa,"YHttpHtmlEngine");var sa=oa,la=class la extends xs{imm_webSocketOpen(e){let t=new WebSocket(e);t.binaryType="arraybuffer",this.websocket=t}imm_getRandomValues(e){return window.crypto.getRandomValues(e)}};m(la,"YWebSocketHtmlEngine");var na=la;var $=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},K=class K extends ue{constructor(e,t){super(e,t),this._readiness=K.READINESS_INVALID,this._macAddress=K.MACADDRESS_INVALID,this._ipAddress=K.IPADDRESS_INVALID,this._subnetMask=K.SUBNETMASK_INVALID,this._router=K.ROUTER_INVALID,this._currentDNS=K.CURRENTDNS_INVALID,this._ipConfig=K.IPCONFIG_INVALID,this._primaryDNS=K.PRIMARYDNS_INVALID,this._secondaryDNS=K.SECONDARYDNS_INVALID,this._ntpServer=K.NTPSERVER_INVALID,this._userPassword=K.USERPASSWORD_INVALID,this._adminPassword=K.ADMINPASSWORD_INVALID,this._httpPort=K.HTTPPORT_INVALID,this._httpsPort=K.HTTPSPORT_INVALID,this._securityMode=K.SECURITYMODE_INVALID,this._defaultPage=K.DEFAULTPAGE_INVALID,this._discoverable=K.DISCOVERABLE_INVALID,this._wwwWatchdogDelay=K.WWWWATCHDOGDELAY_INVALID,this._callbackUrl=K.CALLBACKURL_INVALID,this._callbackMethod=K.CALLBACKMETHOD_INVALID,this._callbackEncoding=K.CALLBACKENCODING_INVALID,this._callbackTemplate=K.CALLBACKTEMPLATE_INVALID,this._callbackCredentials=K.CALLBACKCREDENTIALS_INVALID,this._callbackInitialDelay=K.CALLBACKINITIALDELAY_INVALID,this._callbackSchedule=K.CALLBACKSCHEDULE_INVALID,this._callbackMinDelay=K.CALLBACKMINDELAY_INVALID,this._callbackMaxDelay=K.CALLBACKMAXDELAY_INVALID,this._poeCurrent=K.POECURRENT_INVALID,this._valueCallbackNetwork=null,this.READINESS_DOWN=0,this.READINESS_EXISTS=1,this.READINESS_LINKED=2,this.READINESS_LAN_OK=3,this.READINESS_WWW_OK=4,this.READINESS_INVALID=-1,this.MACADDRESS_INVALID=E.INVALID_STRING,this.IPADDRESS_INVALID=E.INVALID_STRING,this.SUBNETMASK_INVALID=E.INVALID_STRING,this.ROUTER_INVALID=E.INVALID_STRING,this.CURRENTDNS_INVALID=E.INVALID_STRING,this.IPCONFIG_INVALID=E.INVALID_STRING,this.PRIMARYDNS_INVALID=E.INVALID_STRING,this.SECONDARYDNS_INVALID=E.INVALID_STRING,this.NTPSERVER_INVALID=E.INVALID_STRING,this.USERPASSWORD_INVALID=E.INVALID_STRING,this.ADMINPASSWORD_INVALID=E.INVALID_STRING,this.HTTPPORT_INVALID=E.INVALID_UINT,this.HTTPSPORT_INVALID=E.INVALID_UINT,this.SECURITYMODE_UNDEFINED=0,this.SECURITYMODE_LEGACY=1,this.SECURITYMODE_MIXED=2,this.SECURITYMODE_SECURE=3,this.SECURITYMODE_INVALID=-1,this.DEFAULTPAGE_INVALID=E.INVALID_STRING,this.DISCOVERABLE_FALSE=0,this.DISCOVERABLE_TRUE=1,this.DISCOVERABLE_INVALID=-1,this.WWWWATCHDOGDELAY_INVALID=E.INVALID_UINT,this.CALLBACKURL_INVALID=E.INVALID_STRING,this.CALLBACKMETHOD_POST=0,this.CALLBACKMETHOD_GET=1,this.CALLBACKMETHOD_PUT=2,this.CALLBACKMETHOD_INVALID=-1,this.CALLBACKENCODING_FORM=0,this.CALLBACKENCODING_JSON=1,this.CALLBACKENCODING_JSON_ARRAY=2,this.CALLBACKENCODING_CSV=3,this.CALLBACKENCODING_YOCTO_API=4,this.CALLBACKENCODING_JSON_NUM=5,this.CALLBACKENCODING_EMONCMS=6,this.CALLBACKENCODING_AZURE=7,this.CALLBACKENCODING_INFLUXDB=8,this.CALLBACKENCODING_MQTT=9,this.CALLBACKENCODING_YOCTO_API_JZON=10,this.CALLBACKENCODING_PRTG=11,this.CALLBACKENCODING_INFLUXDB_V2=12,this.CALLBACKENCODING_INVALID=-1,this.CALLBACKTEMPLATE_OFF=0,this.CALLBACKTEMPLATE_ON=1,this.CALLBACKTEMPLATE_INVALID=-1,this.CALLBACKCREDENTIALS_INVALID=E.INVALID_STRING,this.CALLBACKINITIALDELAY_INVALID=E.INVALID_UINT,this.CALLBACKSCHEDULE_INVALID=E.INVALID_STRING,this.CALLBACKMINDELAY_INVALID=E.INVALID_UINT,this.CALLBACKMAXDELAY_INVALID=E.INVALID_UINT,this.POECURRENT_INVALID=E.INVALID_UINT,this._className="Network"}imm_parseAttr(e,t){switch(e){case"readiness":return this._readiness=t,1;case"macAddress":return this._macAddress=t,1;case"ipAddress":return this._ipAddress=t,1;case"subnetMask":return this._subnetMask=t,1;case"router":return this._router=t,1;case"currentDNS":return this._currentDNS=t,1;case"ipConfig":return this._ipConfig=t,1;case"primaryDNS":return this._primaryDNS=t,1;case"secondaryDNS":return this._secondaryDNS=t,1;case"ntpServer":return this._ntpServer=t,1;case"userPassword":return this._userPassword=t,1;case"adminPassword":return this._adminPassword=t,1;case"httpPort":return this._httpPort=t,1;case"httpsPort":return this._httpsPort=t,1;case"securityMode":return this._securityMode=t,1;case"defaultPage":return this._defaultPage=t,1;case"discoverable":return this._discoverable=t,1;case"wwwWatchdogDelay":return this._wwwWatchdogDelay=t,1;case"callbackUrl":return this._callbackUrl=t,1;case"callbackMethod":return this._callbackMethod=t,1;case"callbackEncoding":return this._callbackEncoding=t,1;case"callbackTemplate":return this._callbackTemplate=t,1;case"callbackCredentials":return this._callbackCredentials=t,1;case"callbackInitialDelay":return this._callbackInitialDelay=t,1;case"callbackSchedule":return this._callbackSchedule=t,1;case"callbackMinDelay":return this._callbackMinDelay=t,1;case"callbackMaxDelay":return this._callbackMaxDelay=t,1;case"poeCurrent":return this._poeCurrent=t,1}return super.imm_parseAttr(e,t)}get_readiness(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.READINESS_INVALID:(e=this._readiness,e)})}get_macAddress(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration==0&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.MACADDRESS_INVALID:(e=this._macAddress,e)})}get_ipAddress(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.IPADDRESS_INVALID:(e=this._ipAddress,e)})}get_subnetMask(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.SUBNETMASK_INVALID:(e=this._subnetMask,e)})}get_router(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.ROUTER_INVALID:(e=this._router,e)})}get_currentDNS(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CURRENTDNS_INVALID:(e=this._currentDNS,e)})}get_ipConfig(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.IPCONFIG_INVALID:(e=this._ipConfig,e)})}set_ipConfig(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("ipConfig",t)})}get_primaryDNS(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.PRIMARYDNS_INVALID:(e=this._primaryDNS,e)})}set_primaryDNS(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("primaryDNS",t)})}get_secondaryDNS(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.SECONDARYDNS_INVALID:(e=this._secondaryDNS,e)})}set_secondaryDNS(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("secondaryDNS",t)})}get_ntpServer(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.NTPSERVER_INVALID:(e=this._ntpServer,e)})}set_ntpServer(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("ntpServer",t)})}get_userPassword(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.USERPASSWORD_INVALID:(e=this._userPassword,e)})}set_userPassword(e){return $(this,void 0,void 0,function*(){let t;return e.length>E.HASH_BUF_SIZE?this._throw(E.INVALID_ARGUMENT,"Password too long :"+e,E.INVALID_ARGUMENT):(t=String(e),yield this._setAttr("userPassword",t))})}get_adminPassword(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.ADMINPASSWORD_INVALID:(e=this._adminPassword,e)})}set_adminPassword(e){return $(this,void 0,void 0,function*(){let t;return e.length>E.HASH_BUF_SIZE?this._throw(E.INVALID_ARGUMENT,"Password too long :"+e,E.INVALID_ARGUMENT):(t=String(e),yield this._setAttr("adminPassword",t))})}get_httpPort(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.HTTPPORT_INVALID:(e=this._httpPort,e)})}set_httpPort(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("httpPort",t)})}get_httpsPort(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.HTTPSPORT_INVALID:(e=this._httpsPort,e)})}set_httpsPort(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("httpsPort",t)})}get_securityMode(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.SECURITYMODE_INVALID:(e=this._securityMode,e)})}set_securityMode(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("securityMode",t)})}get_defaultPage(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.DEFAULTPAGE_INVALID:(e=this._defaultPage,e)})}set_defaultPage(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("defaultPage",t)})}get_discoverable(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.DISCOVERABLE_INVALID:(e=this._discoverable,e)})}set_discoverable(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("discoverable",t)})}get_wwwWatchdogDelay(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.WWWWATCHDOGDELAY_INVALID:(e=this._wwwWatchdogDelay,e)})}set_wwwWatchdogDelay(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("wwwWatchdogDelay",t)})}get_callbackUrl(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKURL_INVALID:(e=this._callbackUrl,e)})}set_callbackUrl(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackUrl",t)})}get_callbackMethod(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKMETHOD_INVALID:(e=this._callbackMethod,e)})}set_callbackMethod(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackMethod",t)})}get_callbackEncoding(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKENCODING_INVALID:(e=this._callbackEncoding,e)})}set_callbackEncoding(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackEncoding",t)})}get_callbackTemplate(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKTEMPLATE_INVALID:(e=this._callbackTemplate,e)})}set_callbackTemplate(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackTemplate",t)})}get_callbackCredentials(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKCREDENTIALS_INVALID:(e=this._callbackCredentials,e)})}set_callbackCredentials(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackCredentials",t)})}callbackLogin(e,t){return $(this,void 0,void 0,function*(){let i;return i=e+":"+t,yield this._setAttr("callbackCredentials",i)})}get_callbackInitialDelay(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKINITIALDELAY_INVALID:(e=this._callbackInitialDelay,e)})}set_callbackInitialDelay(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackInitialDelay",t)})}get_callbackSchedule(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKSCHEDULE_INVALID:(e=this._callbackSchedule,e)})}set_callbackSchedule(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackSchedule",t)})}get_callbackMinDelay(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKMINDELAY_INVALID:(e=this._callbackMinDelay,e)})}set_callbackMinDelay(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackMinDelay",t)})}get_callbackMaxDelay(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.CALLBACKMAXDELAY_INVALID:(e=this._callbackMaxDelay,e)})}set_callbackMaxDelay(e){return $(this,void 0,void 0,function*(){let t;return t=String(e),yield this._setAttr("callbackMaxDelay",t)})}get_poeCurrent(){return $(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?K.POECURRENT_INVALID:(e=this._poeCurrent,e)})}static FindNetwork(e){let t;return t=ue._FindFromCache("Network",e),t==null&&(t=new K(E,e),ue._AddToCache("Network",e,t)),t}static FindNetworkInContext(e,t){let i;return i=ue._FindFromCacheInContext(e,"Network",t),i==null&&(i=new K(e,t),ue._AddToCache("Network",t,i)),i}registerValueCallback(e){return $(this,void 0,void 0,function*(){let t;return e!=null?yield ue._UpdateValueCallbackList(this,!0):yield ue._UpdateValueCallbackList(this,!1),this._valueCallbackNetwork=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){let t=Object.create(null,{_invokeValueCallback:{get:m(()=>super._invokeValueCallback,"get")}});return $(this,void 0,void 0,function*(){if(this._valueCallbackNetwork!=null)try{yield this._valueCallbackNetwork(this,e)}catch(i){this._yapi.imm_log("Exception in valueCallback:",i)}else yield t._invokeValueCallback.call(this,e);return 0})}useDHCP(e,t,i){return $(this,void 0,void 0,function*(){return yield this.set_ipConfig("DHCP:"+e+"/"+String(Math.round(t))+"/"+i)})}useDHCPauto(){return $(this,void 0,void 0,function*(){return yield this.set_ipConfig("DHCP:")})}useStaticIP(e,t,i){return $(this,void 0,void 0,function*(){return yield this.set_ipConfig("STATIC:"+e+"/"+String(Math.round(t))+"/"+i)})}ping(e){return $(this,void 0,void 0,function*(){let t;return t=yield this._download("ping.txt?host="+e),this._yapi.imm_bin2str(t)})}triggerCallback(){return $(this,void 0,void 0,function*(){return yield this.set_callbackMethod(yield this.get_callbackMethod())})}set_periodicCallbackSchedule(e,t){return $(this,void 0,void 0,function*(){return yield this.set_callbackSchedule("every "+e+"+"+String(Math.round(t)))})}nextNetwork(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:K.FindNetworkInContext(this._yapi,t)}static FirstNetwork(){let e=E.imm_getFirstHardwareId("Network");return e==null?null:K.FindNetwork(e)}static FirstNetworkInContext(e){let t=e.imm_getFirstHardwareId("Network");return t==null?null:K.FindNetworkInContext(e,t)}};m(K,"YNetwork");var q=K;q.READINESS_DOWN=0;q.READINESS_EXISTS=1;q.READINESS_LINKED=2;q.READINESS_LAN_OK=3;q.READINESS_WWW_OK=4;q.READINESS_INVALID=-1;q.MACADDRESS_INVALID=E.INVALID_STRING;q.IPADDRESS_INVALID=E.INVALID_STRING;q.SUBNETMASK_INVALID=E.INVALID_STRING;q.ROUTER_INVALID=E.INVALID_STRING;q.CURRENTDNS_INVALID=E.INVALID_STRING;q.IPCONFIG_INVALID=E.INVALID_STRING;q.PRIMARYDNS_INVALID=E.INVALID_STRING;q.SECONDARYDNS_INVALID=E.INVALID_STRING;q.NTPSERVER_INVALID=E.INVALID_STRING;q.USERPASSWORD_INVALID=E.INVALID_STRING;q.ADMINPASSWORD_INVALID=E.INVALID_STRING;q.HTTPPORT_INVALID=E.INVALID_UINT;q.HTTPSPORT_INVALID=E.INVALID_UINT;q.SECURITYMODE_UNDEFINED=0;q.SECURITYMODE_LEGACY=1;q.SECURITYMODE_MIXED=2;q.SECURITYMODE_SECURE=3;q.SECURITYMODE_INVALID=-1;q.DEFAULTPAGE_INVALID=E.INVALID_STRING;q.DISCOVERABLE_FALSE=0;q.DISCOVERABLE_TRUE=1;q.DISCOVERABLE_INVALID=-1;q.WWWWATCHDOGDELAY_INVALID=E.INVALID_UINT;q.CALLBACKURL_INVALID=E.INVALID_STRING;q.CALLBACKMETHOD_POST=0;q.CALLBACKMETHOD_GET=1;q.CALLBACKMETHOD_PUT=2;q.CALLBACKMETHOD_INVALID=-1;q.CALLBACKENCODING_FORM=0;q.CALLBACKENCODING_JSON=1;q.CALLBACKENCODING_JSON_ARRAY=2;q.CALLBACKENCODING_CSV=3;q.CALLBACKENCODING_YOCTO_API=4;q.CALLBACKENCODING_JSON_NUM=5;q.CALLBACKENCODING_EMONCMS=6;q.CALLBACKENCODING_AZURE=7;q.CALLBACKENCODING_INFLUXDB=8;q.CALLBACKENCODING_MQTT=9;q.CALLBACKENCODING_YOCTO_API_JZON=10;q.CALLBACKENCODING_PRTG=11;q.CALLBACKENCODING_INFLUXDB_V2=12;q.CALLBACKENCODING_INVALID=-1;q.CALLBACKTEMPLATE_OFF=0;q.CALLBACKTEMPLATE_ON=1;q.CALLBACKTEMPLATE_INVALID=-1;q.CALLBACKCREDENTIALS_INVALID=E.INVALID_STRING;q.CALLBACKINITIALDELAY_INVALID=E.INVALID_UINT;q.CALLBACKSCHEDULE_INVALID=E.INVALID_STRING;q.CALLBACKMINDELAY_INVALID=E.INVALID_UINT;q.CALLBACKMAXDELAY_INVALID=E.INVALID_UINT;q.POECURRENT_INVALID=E.INVALID_UINT;var Gt=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},ua=class ua{constructor(e){this._name="",this._size=0,this._crc=0;let t=JSON.parse(e);this._name=t.name,this._size=t.size,this._crc=t.crc}get_name(){return this._name}get_size(){return this._size}get_crc(){return this._crc}};m(ua,"YFileRecord");var ha=ua,$t=class $t extends ue{constructor(e,t){super(e,t),this._filesCount=$t.FILESCOUNT_INVALID,this._freeSpace=$t.FREESPACE_INVALID,this._valueCallbackFiles=null,this._ver=0,this.FILESCOUNT_INVALID=E.INVALID_UINT,this.FREESPACE_INVALID=E.INVALID_UINT,this._className="Files"}imm_parseAttr(e,t){switch(e){case"filesCount":return this._filesCount=t,1;case"freeSpace":return this._freeSpace=t,1}return super.imm_parseAttr(e,t)}get_filesCount(){return Gt(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?$t.FILESCOUNT_INVALID:(e=this._filesCount,e)})}get_freeSpace(){return Gt(this,void 0,void 0,function*(){let e;return this._cacheExpiration<=this._yapi.GetTickCount()&&(yield this.load(this._yapi.defaultCacheValidity))!=this._yapi.SUCCESS?$t.FREESPACE_INVALID:(e=this._freeSpace,e)})}static FindFiles(e){let t;return t=ue._FindFromCache("Files",e),t==null&&(t=new $t(E,e),ue._AddToCache("Files",e,t)),t}static FindFilesInContext(e,t){let i;return i=ue._FindFromCacheInContext(e,"Files",t),i==null&&(i=new $t(e,t),ue._AddToCache("Files",t,i)),i}registerValueCallback(e){return Gt(this,void 0,void 0,function*(){let t;return e!=null?yield ue._UpdateValueCallbackList(this,!0):yield ue._UpdateValueCallbackList(this,!1),this._valueCallbackFiles=e,e!=null&&(yield this.isOnline())&&(t=this._advertisedValue,t!=""&&(yield this._invokeValueCallback(t))),0})}_invokeValueCallback(e){let t=Object.create(null,{_invokeValueCallback:{get:m(()=>super._invokeValueCallback,"get")}});return Gt(this,void 0,void 0,function*(){if(this._valueCallbackFiles!=null)try{yield this._valueCallbackFiles(this,e)}catch(i){this._yapi.imm_log("Exception in valueCallback:",i)}else yield t._invokeValueCallback.call(this,e);return 0})}sendCommand(e){return Gt(this,void 0,void 0,function*(){let t;return t="files.json?a="+e,yield this._download(t)})}_getVersion(){return Gt(this,void 0,void 0,function*(){let e;return this._ver>0?this._ver:(e=yield this.sendCommand("info"),e[0]!=123?this._ver=30:this._ver=be.imm_atoi(this.imm_json_get_key(e,"ver")),this._ver)})}format_fs(){return Gt(this,void 0,void 0,function*(){let e,t;return e=yield this.sendCommand("format"),t=this.imm_json_get_key(e,"res"),t!="ok"?this._throw(this._yapi.IO_ERROR,"format failed",this._yapi.IO_ERROR):this._yapi.SUCCESS})}get_list(e){return Gt(this,void 0,void 0,function*(){let t,i=[],r=[];t=yield this.sendCommand("dir&f="+e),i=this.imm_json_get_array(t),r.length=0;for(let s of i)r.push(new ha(this._yapi.imm_bin2str(s)));return r})}fileExist(e){return Gt(this,void 0,void 0,function*(){let t,i=[];return e.length==0?!1:(t=yield this.sendCommand("dir&f="+e),i=this.imm_json_get_array(t),i.length>0)})}download(e){return Gt(this,void 0,void 0,function*(){return yield this._download(e)})}upload(e,t){return Gt(this,void 0,void 0,function*(){return yield this._upload(e,t)})}remove(e){return Gt(this,void 0,void 0,function*(){let t,i;return t=yield this.sendCommand("del&f="+e),i=this.imm_json_get_key(t,"res"),i!="ok"?this._throw(this._yapi.IO_ERROR,"unable to remove file",this._yapi.IO_ERROR):this._yapi.SUCCESS})}get_content_crc(e){return Gt(this,void 0,void 0,function*(){let t,i,r,s,n,o,a,l;if(i=e.length,i==0)return l=this._yapi.imm_bincrc(e,0,0),l;if(t=yield this._getVersion(),t<40)return l=this._yapi.imm_bincrc(e,0,i),l;for(r=(i+255)/256>>0,s=new Uint8Array(4*r),n=0;n<r;)o=i-n*256,o>256&&(o=256),a=this._yapi.imm_bincrc(e,n*256,o)^4294967295,s.set([a&255],4*n),s.set([a>>8&255],4*n+1),s.set([a>>16&255],4*n+2),s.set([a>>24&255],4*n+3),n=n+1;return l=this._yapi.imm_bincrc(s,0,4*r)^4294967295,l})}nextFiles(){let e=this._yapi.imm_resolveFunction(this._className,this._func);if(e.errorType!=E.SUCCESS)return null;let t=this._yapi.imm_getNextHardwareId(this._className,e.result);return t==null?null:$t.FindFilesInContext(this._yapi,t)}static FirstFiles(){let e=E.imm_getFirstHardwareId("Files");return e==null?null:$t.FindFiles(e)}static FirstFilesInContext(e){let t=e.imm_getFirstHardwareId("Files");return t==null?null:$t.FindFilesInContext(e,t)}};m($t,"YFiles");var Ui=$t;Ui.FILESCOUNT_INVALID=E.INVALID_UINT;Ui.FREESPACE_INVALID=E.INVALID_UINT;var B=class B{static get versionInfo(){return["2.1.10284","70284"]}static get buildVersion(){return this.versionInfo[0]}static get trueBuild(){return this.versionInfo[1]}static get deviceScreenWidth(){return screen.width*window.devicePixelRatio}static get deviceScreenHeight(){return screen.height*window.devicePixelRatio}static get isPhoneOrTablet(){return B.ScreenDPI>96&&Math.max(B.deviceScreenWidth,B.deviceScreenHeight)/B.ScreenDPI<12}static get captureSizePolicy(){return B._defaultCaptureSizePolicy}static set captureSizePolicy(e){B._defaultCaptureSizePolicy=e}static get dbleClickBringsUpContextMenu(){return B._defaulDbleClickBringsUpContextMenu}static set dbleClickBringsUpContextMenu(e){B._defaulDbleClickBringsUpContextMenu=e}static get maxPointsPerGraphSerie(){return B._defaultMaxPointsPerGraphSerie}static set maxPointsPerGraphSerie(e){e>=0&&(B._defaultMaxPointsPerGraphSerie=e>>0)}static get maxPointsPerDataloggerSerie(){return B._defaultMaxPointsPerDataloggerSerie}static set maxPointsPerDataloggerSerie(e){e>=-1&&(B._defaultMaxPointsPerDataloggerSerie=e>>0)}static get maxDataRecordsPerSensor(){return B._defaultMaxDataRecordsPerSensor}static set maxDataRecordsPerSensor(e){e>=0&&(B._defaultMaxDataRecordsPerSensor=e>>0)}static get captureWidth(){return B._defaultCaptureWidth}static set captureWidth(e){e>0&&(B._defaultCaptureWidth=e)}static get captureHeight(){return B._defaultCaptureHeight}static set captureHeight(e){e>0&&(B._defaultCaptureHeight=e)}static get captureDPI(){return B._defaultCaptureDPI}static set captureDPI(e){e>0&&(B._defaultCaptureDPI=e)}static get captureType(){return B._defaultCaptureType}static set captureType(e){B._defaultCaptureType=e}static get generalFontFamily(){return B.FontFamily}static get generalFontSize(){return B.FontSize}static get generalSizeCoef(){return B.FontSize/12}static get screenDPI(){return B.ScreenDPI}static get guiDPIFactor(){return B.DPIfactor}static get guiDPIFactorWasOverriden(){return B.DPIfactorOverriden}static get guiDPIFactorIsOverriden(){let e=B.getCookie(B.DPIFactorKey);return e==null?!1:parseFloat(e)>0}static get guiDPIFactorOverrideValue(){let e=B.getCookie(B.DPIFactorKey);if(e==null)return B.DPIfactor;let t=parseFloat(e);return t>0?t:B.DPIfactor}static overrideGuiDPIFactor(e,t){e&&typeof t!="undefined"?B.setCookie(B.DPIFactorKey,t.toString(),3650):B.setCookie(B.DPIFactorKey,"none",3650)}static get RunningOnAndroid(){return B.isAndroid}static get WindowBackgroundColor(){return"#f0f0f0"}static get WindowBorder(){return"1px solid #808080"}static get WindowPadding(){return 2}static get WindowInnerBorderColor(){return" #A0A0A0"}static get WindowInnerBackgroundColor(){return"#fAfAfA"}static get WindowInnerBorder(){return"1px solid "+B.WindowInnerBorderColor}static get WindowHeaderBackgroundColor(){return"#0072ca"}static get WindowHeaderColor(){return"white"}static get WindowHeaderBorder(){return"1px solid #0072ca"}static get WindowHeaderHeight(){return 20}static get WindowHeaderFontSize(){return 8*B.FontSize/6}static get WindowHeaderFontFamily(){return B.FontFamily}static get mustCheckForUpdate(){return B._checkForUpdate}static set mustCheckForUpdate(e){e!=B._checkForUpdate&&(B._checkForUpdate=e,B.edited=!0)}static get edited(){return B._edited}static set edited(e){B._edited!=e&&(B._edited=e,O.ShowSaveReminder(e))}static InitColorHistory(e){let t=e.get_childsByIndex();for(let i=0;i<t.length;i++){let r=t[i];switch(t[i].Name){case"Color":try{let s=r.Attributes.value,n=c.FromString(s);n!=null&&ni.AddColorToHistory(n)}catch(s){}}}}static findDPI(){let e=1;for(;!matchMedia("(max-resolution: "+e.toString()+"dpi)").matches;)e=e<<1;let t=e>>1,i=e;for(;i-t>1;){let r=i+t>>1;matchMedia("(max-resolution: "+r.toString()+"dpi)").matches?i=r:t=r}return i*(B.isAndroid?window.devicePixelRatio:1)}static InitCaptureParams(e){let t=e.get_childsByName();for(let i in t){let r=t[i],s;switch(i){case"Target":"value"in r.Attributes&&(B._captureTarget=W.CaptureTarget.fromString(W.CaptureTarget,r.Attributes.value));break;case"Type":"value"in r.Attributes&&(B._defaultCaptureType=W.CaptureType.fromString(W.CaptureType,r.Attributes.value));break;case"Size":"value"in r.Attributes&&(B._defaultCaptureSizePolicy=W.CaptureFormats.fromString(W.CaptureFormats,r.Attributes.value));break;case"Resolution":"value"in r.Attributes&&(B.captureDPI=parseInt(r.Attributes.value));break;case"Width":"value"in r.Attributes&&(B.captureWidth=s=parseInt(r.Attributes.value));break;case"Height":"value"in r.Attributes&&(B.captureHeight=parseInt(r.Attributes.value));break;case"Folder":"value"in r.Attributes&&(B._captureFolder=r.Attributes.value);break}}}static InitUIParams(e){let t=e.get_childsByName();for(let i in t){let r=t[i];switch(i){case"VerticalDragZoom":"value"in r.Attributes&&(Rt.verticalDragZoomEnabled=r.Attributes.value.toUpperCase()=="TRUE");break;case"DbleClickContextMenu":"value"in r.Attributes&&(B.dbleClickBringsUpContextMenu=r.Attributes.value.toUpperCase()=="TRUE");break}}}static InitCheckForUpdateParams(e){let t=e.get_childsByName();for(let i in t){let r=t[i];switch(i){case"checkForUpdate":"value"in r.Attributes&&(B._checkForUpdate=r.Attributes.value.toUpperCase()=="TRUE");break;case"ignoreBuild":"value"in r.Attributes&&(B._ignoreBuild=parseInt(r.Attributes.value.toUpperCase()));break}}}static InitMemoryUsageParams(e){let t=e.get_childsByName();for(let i in t){let r=t[i];switch(i){case"maxPointsPerGraphSerie":if("value"in r.Attributes){let s=parseInt(r.Attributes.value);B.maxPointsPerGraphSerie=s,Ri.MaxPointsPerSeries=s}break;case"maxDataRecordsPerSensor":if("value"in r.Attributes){let s=parseInt(r.Attributes.value);s>=0&&(B.maxDataRecordsPerSensor=s,st.MaxDataRecords=s)}break;case"maxPointsPerDataloggerSerie":if("value"in r.Attributes){let s=parseInt(r.Attributes.value);B.maxPointsPerDataloggerSerie=s,st.MaxLoggerRecords=s}break;case"deviceListValidity":if("value"in r.Attributes){let s=parseInt(r.Attributes.value);s>0&&(B._deviceListValidity=s,E.SetDeviceListValidity(s).then())}break}}}static Init(e){let t=e.get_childsByName();for(let i in t){let r=t[i];switch(i){case"UseUSB":"value"in r.Attributes&&(B._useUSB=r.Attributes.value.toUpperCase()=="TRUE");break;case"Colors":B.InitColorHistory(r);break;case"Capture":B.InitCaptureParams(r);break;case"UI":B.InitUIParams(r);break;case"Updates":B.InitCheckForUpdateParams(r);break;case"MemoryUsage":B.InitMemoryUsageParams(r);break;case"UseVirtualHub":"value"in r.Attributes&&(B._useVirtualHub=r.Attributes.value.toUpperCase()=="TRUE");break;case"Hubs":oe.InitHubList(r);break}}}static get CRCTable(){if(B._crcTable!=null)return B._crcTable;B._crcTable=[];let e;for(var t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;B._crcTable[i]=e}return B._crcTable}static crc32(e){for(var t=B.CRCTable,i=-1,r=0;r<e.length;r++)i=i>>>8^t[(i^e.charCodeAt(r))&255];return(i^-1)>>>0}static setCookie(e,t,i){let r=new Date;r.setTime(r.getTime()+i*24*60*60*1e3);let s="expires="+r.toUTCString();document.cookie=e+"="+t+";"+s+";path=/"}static getCookie(e){let t=e+"=",r=decodeURIComponent(document.cookie).split(";");for(let s=0;s<r.length;s++){let n=r[s];for(;n.charAt(0)==" ";)n=n.substring(1);if(n.indexOf(t)==0)return n.substring(t.length,n.length)}return null}static XMLquote(e){return e.replace("'","&apos;").replace('"',"&quot;")}static GetXMLConfiguration(){let e=`<Config>
  <UseUSB value="`+(B._useUSB?"TRUE":"FALSE")+`"/>
  <UseVirtualHub value="`+(B._useVirtualHub?"TRUE":"FALSE")+`"/>
  <Hubs>
`;e+=oe.getXmlHublist(),e+=`  </Hubs>
`,e+=`  <Colors>
`;for(let t=0;t<ni.colorHistory.length;t++)e=e+'    <Color value="'+ni.colorHistory[t].toString()+`"/>
`;return e+=`  </Colors>
`,e+=`  <MemoryUsage>
`,e+='    <maxPointsPerGraphSerie value= "'+B.maxPointsPerGraphSerie.toString()+`"/>
`,e+='    <maxDataRecordsPerSensor value= "'+B.maxDataRecordsPerSensor.toString()+`"/>
`,e+='    <maxPointsPerDataloggerSerie value= "'+B.maxPointsPerDataloggerSerie.toString()+`"/>
`,e+='    <deviceListValidity value= "'+B._deviceListValidity.toString()+`"/>
`,e+=`  </MemoryUsage>
`,e+=`  <Capture>
`,e+='    <Target value= "'+B._captureTarget.toString+`"/>
`,e+='    <Type value= "'+B.captureType.toString+`"/>
`,e+='    <Size value= "'+B.captureSizePolicy.toString+`"/>
`,e+='    <Resolution value= "'+B.captureDPI.toString()+`"/>
`,e+='    <Folder value= "'+B.XMLquote(B._captureFolder)+`"/>
`,e+='    <Width value= "'+B.captureWidth.toString()+`"/>
`,e+='    <Height value= "'+B.captureHeight.toString()+`"/>
`,e+=`  </Capture>
`,e+=`  <Updates>
`,e+='    <checkForUpdate  value = "'+(B._checkForUpdate?"True":"False")+`"/>
`,e+='    <ignoreBuild  value = "'+B._ignoreBuild.toString()+`"/>
`,e+=`  </Updates>
`,e+=`  <UI>
`,e+='    <VerticalDragZoom value= "'+(Rt.verticalDragZoomEnabled?"True":"False")+`"/>
`,e+='    <DbleClickContextMenu value= "'+(B.dbleClickBringsUpContextMenu?"True":"False")+`"/>
`,e+=`  </UI>
`,e+=`</Config>
`,e}};m(B,"constants");var S=B;S.DPIFactorKey="YoctoVisualization4WebDPIFactor";S.isAndroid=navigator.userAgent.toLowerCase().indexOf("android")>=0;S.ScreenDPI=S.findDPI();S.FontFamily="Arial, Helvetica, sans-serif";S.DPIfactorCookieValue=S.getCookie(S.DPIFactorKey);S.DPIfactorOverriden=S.DPIfactorCookieValue!=null;S.DPIfactor=S.DPIfactorOverriden&&parseFloat(S.DPIfactorCookieValue)>0?parseFloat(S.DPIfactorCookieValue):S.isPhoneOrTablet?Math.round(10*S.ScreenDPI/(96*1.2))/10:1;S.FontSize=12*S.DPIfactor;S._defaultCaptureType=W.CaptureType.PNG;S._defaultCaptureWidth=1024;S._defaultCaptureHeight=1024;S._defaultCaptureDPI=70;S._defaultCaptureSizePolicy=W.CaptureFormats.Keep;S._defaultMaxPointsPerGraphSerie=0;S._defaultMaxPointsPerDataloggerSerie=0;S._defaultMaxDataRecordsPerSensor=0;S._defaulDbleClickBringsUpContextMenu=!1;S._useUSB=!0;S._useVirtualHub=!1;S._captureTarget=W.CaptureTarget.ToFile;S._captureFolder="";S._checkForUpdate=!0;S._ignoreBuild=0;S._deviceListValidity=3600;S._edited=!1;S._crcTable=null;var Ke=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},Wt=class Wt{static Decrypt(e,t){if(e==""||e.length%4)return"";let i=new Uint16Array(e.length>>2);for(let n=0;n<i.length;n++)i[n]=parseInt(e.slice(n*4,n*4+4),16);let r=i[0];for(let n=1;n<i.length-1;n++)r^=i[n];if(r!=i[i.length-1])return"";let s="";for(let n=0;n<i.length-2;n++)s+=String.fromCharCode(i[n+1]&255^t.charCodeAt(n%t.length)^i[0]+n&255^(i[n+1]&2048)>>11<<((i[n+1]&1792)>>8)^(i[n+1]&32768)>>15<<((i[n+1]&28672)>>12));return s}static Encrypt(e,t){if(e=="")return"";let i=crypto.getRandomValues(new Uint16Array(e.length+2));for(let s=0;s<e.length;s++)i[s+1]=i[s+1]&65280|e.charCodeAt(s)^t.charCodeAt(s%t.length)^i[0]+s&255^(i[s+1]&2048)>>11<<((i[s+1]&1792)>>8)^(i[s+1]&32768)>>15<<((i[s+1]&28672)>>12);i[i.length-1]=i[0];for(let s=1;s<i.length-1;s++)i[i.length-1]^=i[s];let r="";for(let s=0;s<i.length;s++)r+=("000"+i[s].toString(16)).slice(-4).toUpperCase();return r}static encryptPassword(e){return e==""?"":Wt.Encrypt(e,Wt.loginCypherPassword)}get hubType(){return this._hubType}set hubType(e){this._hubType=e}get protocol(){return this._protocol}set protocol(e){this._protocol=e}get user(){return this._user}set user(e){this._user=e}get encryptedPassword(){return this._password}set encryptedPassword(e){this._password=e}get clearPassword(){return this._password==""?"":Wt.Decrypt(this._password,Wt.loginCypherPassword)}set clearPassword(e){this._password=e==""?"":Wt.encryptPassword(e)}get addr(){return this._addr}set addr(e){this._addr=e}get port(){return this._port}set port(e){this._port=e}get removable(){return this._removable}set removable(e){this._removable=e}get path(){return this._path}set path(e){this._path=e}ConnectionState(){return Ke(this,void 0,void 0,function*(){return this._apiHub!=null&&(yield this._apiHub.get_errorType())!=0&&(this._state=3),this._state})}ConnectionDescription(){return Ke(this,void 0,void 0,function*(){switch(this._state){case 1:return this._apiHub!=null&&(yield this._apiHub.get_errorType())!=0?(this._state=3,yield this._apiHub.get_errorMessage()):"Connecting..";case 2:return(this._logicname!=""?this._logicname:this._netname)+" OK";case 3:return this._apiHub!=null?yield this._apiHub.get_errorMessage():"Connection failed ";default:return"Not connected."}})}constructor(e,t,i,r,s,n,o,a,l){for(this._netname="",this._module=null,this._logicname="",this._previousURL="",this._previousobfuscatedURL="",this._apiHub=null,this._hubType=2,this._protocol="",this._user="",this._password="",this._addr="",this._port="",this._removable=!0,this._path="",this._state=0;/^\//.test(a);)a=a.slice(1);for(;/\/$/.test(a);)a=a.slice(0,-1);this._hubType=e,this._protocol=t,this._user=i,this._port=o,this._password=s?r!=""?Wt.Encrypt(r,Wt.loginCypherPassword):"":r,this._addr=n,this._path=a,this._removable=typeof l=="undefined"?!0:l}static HubFromXml(e){let t=2,i="ws",r=!0;"protocol"in e.Attributes&&(i=e.Attributes.protocol);let s="";"user"in e.Attributes&&(s=e.Attributes.user);let n="";"password"in e.Attributes&&(n=e.Attributes.password);let o="";"port"in e.Attributes&&(o=e.Attributes.port);let a="";"path"in e.Attributes&&(a=e.Attributes.path);let l="";return"addr"in e.Attributes&&(l=e.Attributes.addr),"removable"in e.Attributes&&(r=e.Attributes.removable.toUpperCase()=="TRUE"),new Wt(t,i,s,n,!1,l,o,a,r)}Connect(){return Ke(this,void 0,void 0,function*(){let e=new Dt;this._state=1,Z.log("preregistering  "+this.get_obfuscatedURL()),O.readonly||ye.hubStateChanged(this);let t=this.get_fullUrl();if((yield E.PreregisterHub(t,e))!=0)Z.log("[!] preregistering  "+this.get_obfuscatedURL()+" failed ("+e.msg+")"),this._state=3,this._previousURL="",this._previousobfuscatedURL="";else{let i=Vt.FirstHubInUse();for(;i!=null;)(yield this.matches(i))&&(this._apiHub=i),i=i.nextHubInUse();this._previousURL=t,this._previousobfuscatedURL=this.get_obfuscatedURL()}O.readonly||ye.hubStateChanged(this)})}Disconnect(){return Ke(this,void 0,void 0,function*(){this._previousURL!=""&&(Z.log("Unregistering  "+this._previousobfuscatedURL),yield E.UnregisterHub(this._previousURL),this._previousURL="",this._previousobfuscatedURL="",this._state=0,this._apiHub=null,O.readonly||ye.hubStateChanged(this))})}arrival(e,t,i,r){this._state=2,this._netname=t,this._module=i,this._logicname=r,this._state=2,O.readonly||ye.hubStateChanged(this)}get address(){return this._addr}get_consoleUrl(){let e=this._protocol+"://"+this._addr;return this._port!=""&&(e=e+":"+this._port),e}toString(){return this.get_consoleUrl()}get_fullUrl(){let e="";return this._protocol!=""&&(e=this._protocol+"://"),this._user!=""&&(e=e+this._user,this._password!=""&&(e=e+":"+Wt.Decrypt(this._password,Wt.loginCypherPassword)),e=e+"@"),e=e+this._addr,this._port!=""?e=e+":"+this._port:e=e+":4444",e=e+"/",this._path&&(e=e+this._path+"/"),e}get_connexionUrl(){let e;return this._protocol!=""?e=this._protocol+"://":e="ws://",e=e+this._addr,this._port!=""?e=e+":"+this._port:e=e+":4444",e=e+"/",e.toLowerCase()}get_obfuscatedURL(){let e="";return this._protocol!=""&&(e=this._protocol+"://"),this._user!=""&&(e=e+this._user,this._password!=""&&(e=e+":#####"),e=e+"@"),e=e+this._addr,this._port!=""&&(e=e+":"+this._port),this._path!=""&&(e=e+"/"+this._path),e}matches(e){return Ke(this,void 0,void 0,function*(){let t=this.get_connexionUrl()+this._path,i=yield e.get_connectionUrl();return t.slice(-1)=="/"&&(t=t.substr(0,t.length-1)),i.slice(-1)=="/"&&(i=i.substr(0,i.length-1)),t==i})}XmlCode(){let e="<Hub ";return this._protocol!=""&&(e=e+'protocol="'+S.XMLquote(this._protocol)+'" '),this._user!=""&&(e=e+'user="'+S.XMLquote(this._user)+'" '),this._password!=""&&(e=e+'password="'+S.XMLquote(this._password)+'" '),e=e+'addr="'+S.XMLquote(this._addr)+'" ',this._port!=""&&(e=e+'port="'+S.XMLquote(this.port)+'" '),this._path!=""&&(e=e+'path="'+S.XMLquote(this._path)+'" '),this._removable||(e=e+'removable="FALSE" '),e+"/>"}};m(Wt,"Hub");var oi=Wt;oi.loginCypherPassword="+>*X[?_ih$N7wA!}";var _a=class _a{constructor(e,t){this._DateTime=e,this._value=t}get DateTime(){return this._DateTime}get value(){return this._value}};m(_a,"TimedSensorValue");var ai=_a,ga=class ga{static ExecuteCommand(e,t){}constructor(e,t,i){this.index=0,this.Condition=0,this.Source=0,this.Value=0,this.Delay=15,this.Commandline="",this.lastAlarm=new Date(0),this.index=e,this.parent=t,typeof i!="undefined"&&("Source"in i.Attributes&&(this.Source=parseInt(i.Attributes.Source)),"Condition"in i.Attributes&&(this.Condition=parseInt(i.Attributes.Condition)),"Value"in i.Attributes&&(this.Value=parseFloat(i.Attributes.Value)),"Cmd"in i.Attributes&&(this.Commandline=i.Attributes.Cmd),"Delay"in i.Attributes&&(this.Delay=parseInt(i.Attributes.Delay)))}getXmlData(){return'<Alarm Source="'+this.Source.toString()+'" Condition="'+this.Condition.toString()+'" Value="'+this.Value.toString()+'" Cmd="'+de.escapeXml(this.Commandline)+'" Delay="'+this.Delay.toString()+`"/>
`}setCondition(e){this.Condition=e}getCondition(){return this.Condition}setSource(e){this.Source=e}getSource(){return this.Source}setValue(e){this.Value=e}getValue(){return this.Value}setDelay(e){if(e<0)throw"delay must be a positive value";this.Delay=e}getDelay(){return this.Delay}setCommandline(e){this.Commandline=e}getCommandline(){return this.Commandline}check(e){let t=!1,i="",r,s;switch(this.Source){case 1:r="MIN",s=e.get_minValue();break;case 2:r="MAX",s=e.get_maxValue();break;default:r="AVG",s=e.get_averageValue();break}switch(this.Condition){default:return;case 1:i=">",s>this.Value&&(t=!0);break;case 2:i=">=",s>=this.Value&&(t=!0);break;case 3:i="=",s==this.Value&&(t=!0);break;case 4:i="<=",s<=this.Value&&(t=!0);break;case 5:i="<",s<this.Value&&(t=!0);break}let n=new Date;if(!t||n.getTime()-this.lastAlarm.getTime()<1e3*this.Delay)return;let o="ALARM "+(this.index+1).toString();Z.log(o+" on "+this.parent.get_hardwareId()+"/"+this.parent.get_friendlyName()+" ("+s.toString()+i+this.Value.toString()+")");let a=this.Commandline;a=a.replace("$SENSORVALUE$",s.toString()),a=a.replace("$HWDID$",this.parent.get_hardwareId()),a=a.replace("$NAME$",this.parent.get_friendlyName()),a=a.replace("$UNIT$",this.parent.get_unit()),a=a.replace("$CONDITION$",i),a=a.replace("$DATATYPE$",r),a=a.replace("$TRIGGER$",this.Value.toString()),a=a.replace("$NOW$",Z.dateToString(n));try{Function(a)()}catch(l){Z.log("ALARM "+(this.index+1)+" code ("+a+") caused an exception :"+l.message)}this.lastAlarm=n}};m(ga,"AlarmSettings");var ks=ga,fa=class fa{constructor(e,t){this._start=0,this._stop=0,this._start=e,this._stop=t}get start(){return this._start}get stop(){return this._stop}};m(fa,"DataLoggerBoundary");var da=fa,pa=class pa{constructor(e,t){this.MergeSourceStart=0,this.MergeSourceStop=0,this.MergeSourceStart=e,this.MergeSourceStop=t}};m(pa,"MergeSourceRange");var ca=pa,lt=class lt{get isReadOnly(){return this._readonly||!this._online}get dataloggerLoadisRunning(){return this._dataloggerLoadisRunning}get dataloggerLoadProgress(){return this._dataloggerLoadProgress}setDataloggerLoadProgress(e){this._dataloggerLoadProgress=e;for(let t=0;t<this.FormsToNotify.length;t++)this.FormsToNotify[t]instanceof gt&&this.FormsToNotify[t].dataLoggerLoadprocessIsRunningNotification(this)}static get MaxDataRecords(){return lt._MaxDataRecords}static set MaxDataRecords(e){lt._MaxDataRecords=e}static get MaxLoggerRecords(){return lt._MaxLoggerRecords}static set MaxLoggerRecords(e){lt._MaxLoggerRecords=e}get_lastAvgValue(){return this._online?this._lastAvgValue:Number.NaN}get_lastMaxValue(){return this._online?this._lastMaxValue:Number.NaN}get_lastMinValue(){return this._online?this._lastMinValue:Number.NaN}ConfigHasChanged(){return Ke(this,void 0,void 0,function*(){this.cfgChgNotificationsSupported=!0,this.mustReloadConfig=!0,this._online=!0,yield this.reloadConfig(),yield this.forceUpdate()})}constructor(e,t,i){if(this.unit="",this._frequency="",this.resolution=1,this._recording=!1,this._online=!1,this.preloadDone=!1,this.loadDone=!1,this.cfgChgNotificationsSupported=!1,this.mustReloadConfig=!1,this._readonly=!1,this._plzCancelDataloggerLoading=!1,this._predloadProcessIsBusy=!1,this._loadProcessIsBusy=!1,this.lastGetConfig=0,this.recordedDataLoadProgress=0,this.recordedData=null,this.dataLoggerFeature=!1,this.dataLoggerLoadCompleted=!1,this.loadFailed=!1,this.loadCanceled=!1,this.firstLiveDataTimeStamp=0,this.firstDataloggerTimeStamp=0,this.lastDataTimeStamp=0,this.lastDataSource="",this.consecutiveBadTimeStamp=0,this.minData=[],this.curData=[],this.maxData=[],this.previewMinData=[],this.previewCurData=[],this.previewMaxData=[],this._lastAvgValue=Number.NaN,this._lastMinValue=Number.NaN,this._lastMaxValue=Number.NaN,this._dataloggerLoadisRunning=!0,this._dataloggerLoadProgress=0,this.dataLoggerStartReadTime=0,this.Alarms=[],this.FormsToNotify=[],this.sensor=e,this.hwdName=t,this._friendlyname=t,e!=null&&i!=null){let r=0,s=i.get_childsByIndex();for(let n=0;n<s.length;n++){let o=s[n];o.Name=="Alarm"&&(this.checkAlarmIndex(r),this.Alarms[r]=new ks(r,this,o),r++)}}}checkAlarmIndex(e){for(;this.Alarms.length<e+1;)this.Alarms.push(new ks(this.Alarms.length,this))}getAlarmCount(){return this.Alarms.length}setAlarmCondition(e,t){this.checkAlarmIndex(e),this.Alarms[e].setCondition(t)}getAlarmCondition(e){return this.checkAlarmIndex(e),this.Alarms[e].getCondition()}setAlarmSource(e,t){this.checkAlarmIndex(e),this.Alarms[e].setSource(t)}getAlarmSource(e){return this.checkAlarmIndex(e),this.Alarms[e].getSource()}setAlarmValue(e,t){this.checkAlarmIndex(e),this.Alarms[e].setValue(t)}getAlarmValue(e){return this.checkAlarmIndex(e),this.Alarms[e].getValue()}setAlarmDelay(e,t){this.checkAlarmIndex(e),this.Alarms[e].setDelay(t)}getAlarmDelay(e){return this.checkAlarmIndex(e),this.Alarms[e].getDelay()}setAlarmCommandline(e,t){this.checkAlarmIndex(e),this.Alarms[e].setCommandline(t)}getAlarmCommandline(e){return this.checkAlarmIndex(e),this.Alarms[e].getCommandline()}GetXmlData(){let e='<Sensor ID="'+this.get_hardwareId()+`">
`;for(let t=0;t<this.getAlarmCount();t++)e=e+this.Alarms[t].getXmlData();return e=e+`</Sensor>
`,e}get_firstLiveDataTimeStamp(){return this.firstLiveDataTimeStamp}get_firstDataloggerTimeStamp(){return this.firstDataloggerTimeStamp}get_lastDataTimeStamp(){return this.lastDataTimeStamp}preload_DoWork(e){return Ke(this,void 0,void 0,function*(){if(this._predloadProcessIsBusy){console.log("!!! multiple datalogger load attempt");return}if(this.dataLoggerLoadCompleted){console.log("!!!  datalogger load attempt although datalogger is already loaded.");return}this._predloadProcessIsBusy=!0,Z.log(this.hwdName+": preloading data from "+e.start.toString()+" to "+e.stop.toString()+"(delta= "+(e.stop-e.start).toFixed(3)+")"),this.setDataloggerLoadProgress(1),this.recordedData=yield this.sensor.get_recordedData(e.start,e.stop);try{this.recordedDataLoadProgress=yield this.recordedData.loadMore()}catch(o){Z.log(this.hwdName+": load more caused an exception "+o.message)}let t=yield this.recordedData.get_preview();this.previewMinData=[],this.previewCurData=[],this.previewMaxData=[];let i=0,r=0,s=10,n=-1;lt._MaxDataRecords>0&&t.length>lt._MaxDataRecords&&(i=t.length-lt._MaxDataRecords);for(let o=i;o<t.length;o++){let a=t[o].get_endTimeUTC();a>=e.start&&a<=e.stop&&(this.previewMinData.push(new ai(a,t[o].get_minValue())),this.previewCurData.push(new ai(a,t[o].get_averageValue())),this.previewMaxData.push(new ai(a,t[o].get_maxValue())),a<n&&r<s?(Z.log(this.hwdName+" preloading warning:  timestamp going back in time "+a+"<"+n+(r<s-1?"":", further similar errors wont be logged.")),r++):a==n&&r<s&&(Z.log(this.hwdName+" preloading warning: duplicate timestamp  "+a+(r<s-1?"":", further similar errors wont be logged.")),r++),n=a)}if(this.previewCurData.length>1){let o=this.previewCurData[0].DateTime,a=this.previewCurData[this.previewCurData.length-1].DateTime;if(Z.log(this.hwdName+": preloaded data from "+o.toString()+" to "+a.toString()+" (delta="+(a-o).toFixed(3)+")"),lt._MaxLoggerRecords>0&&e.start==0){let l=yield this.recordedData.get_privateDataStreams(),h=l.length-1,u=0;for(;h>0&&u<lt._MaxLoggerRecords;)u+=yield l[h].get_rowCount(),this.dataLoggerStartReadTime=yield l[h].get_startTimeUTC(),h--;let _=0;for(;_<this.previewMinData.length&&this.previewMinData[_].DateTime<this.dataLoggerStartReadTime;)_++;_>1&&(this.previewMinData.splice(0,_-1),this.previewCurData.splice(0,_-1),this.previewMaxData.splice(0,_-1))}}this.preload_Completed(e)})}findMergeBoundaries(e){let t=0,i=0;if(this.minData.length>0){for(;t<this.minData.length&&e[0].DateTime>this.minData[t].DateTime;)t++;for(i=t;i<this.minData.length&&e[e.length-1].DateTime>=this.minData[i].DateTime;)i++}return new ca(t,i)}preload_Completed(e){if(this.previewMinData==null)return;if(Z.log(this.hwdName+" : datalogger preloading completed ("+this.previewMinData.length+" rows)"),this.previewMinData.length>1){let i=this.findMergeBoundaries(this.previewMinData),r=i.MergeSourceStart,s=i.MergeSourceStop-i.MergeSourceStart;this.minData=this.minData.slice(0,r).concat(this.previewMinData,this.minData.slice(r+s)),this.curData=this.curData.slice(0,r).concat(this.previewCurData,this.curData.slice(r+s)),this.maxData=this.maxData.slice(0,r).concat(this.previewMaxData,this.maxData.slice(r+s));for(let n=0;n<this.FormsToNotify.length;n++)this.FormsToNotify[n]instanceof gt&&this.FormsToNotify[n].SensorNewDataBlock(this,i.MergeSourceStart,i.MergeSourceStart+this.previewMinData.length-1,0,!0)}let t=this.curData.length;t>0&&this.curData[t-1].DateTime>this.lastDataTimeStamp&&(this.lastDataTimeStamp=this.curData[t-1].DateTime,this.lastDataSource="last preload timestamp"),Z.log(this.hwdName+" : start datalogger loading"),this._predloadProcessIsBusy=!1,this.load_DoWork(e).then()}get_frequency(){return this._frequency}updateFrequncy(e){return Ke(this,void 0,void 0,function*(){if(yield this.sensor.isOnline()){this._frequency=e,yield this.sensor.set_reportFrequency(this._frequency);let t=yield this.sensor.get_logFrequency();try{t!="OFF"&&(yield this.sensor.set_logFrequency(this._frequency)),yield(yield this.sensor.get_module()).saveToFlash()}catch(i){Z.log("failed to change "+this.hwdName+" log frequency ("+i.message+")")}}else this._online=!1})}set_frequency(e){this._online&&this.updateFrequncy(e).then()}get_recording(){return this._recording}set_recording(e){this.updaterecording(e).then()}updaterecording(e){return Ke(this,void 0,void 0,function*(){if(this.dataLoggerFeature)if(yield this.sensor.isOnline()){this._recording=e;try{yield this.sensor.set_logFrequency(this._recording?this._frequency:"OFF");let t=yield this.sensor.get_module(),i=yield t.get_serialNumber(),r=Re.FindDataLogger(i+".dataLogger");yield r.set_recording(this._recording?Re.RECORDING_ON:Re.RECORDING_OFF),yield r.set_autoStart(this._recording?Re.AUTOSTART_ON:Re.AUTOSTART_OFF),yield t.saveToFlash()}catch(t){Z.log("failed to change "+this.hwdName+" recording ("+t.message+")")}}else this._online=!1})}reportDataloggerLoadProgress(e){}load_DoWork(e){return Ke(this,void 0,void 0,function*(){if(this._loadProcessIsBusy||(this._loadProcessIsBusy=!0,this.dataLoggerLoadCompleted))return;Z.log(this.hwdName+" loading main data from datalogger"),this.dataLoggerStartReadTime>0&&(this.recordedData=yield this.sensor.get_recordedData(this.dataLoggerStartReadTime,0));let t=0,i=10,r=-1,s=this.recordedDataLoadProgress;for(;this.recordedDataLoadProgress<100;){if(this._plzCancelDataloggerLoading){this.loadDone=!0,this.loadFailed=!1,this.loadCanceled=!0,this.setDataloggerLoadProgress(100);break}try{this.recordedDataLoadProgress=yield this.recordedData.loadMore()}catch(a){this.loadFailed=!0;return}if(s!=this.recordedDataLoadProgress){s=this.recordedDataLoadProgress;let a=s;a<1&&(a=1),a>99&&(a=99),this.setDataloggerLoadProgress(a<1?1:a>99?99:a)}this.recordedDataLoadProgress-s>=2&&(s=this.recordedDataLoadProgress)}let n=yield this.recordedData.get_measures();this.previewMinData=[],this.previewCurData=[],this.previewMaxData=[];for(let a=0;a<n.length;a++){let l=n[a].get_endTimeUTC();if(l>=e.start&&l<=e.stop)l<r&&t<i?(Z.log(this.hwdName+" loading warning:  timestamp going back in time "+l+"<"+r+(t<i-1?"":", further similar errors wont be logged.")),t++):l==r&&t<i&&(Z.log(this.hwdName+" loading warning: duplicate timestamp  "+l+(t<i-1?"":", further similar errors wont be logged.")),t++),r=l,(this.previewMinData.length==0||l>this.previewMinData[this.previewMinData.length-1].DateTime)&&(this.previewMinData.push(new ai(l,n[a].get_minValue())),this.previewCurData.push(new ai(l,n[a].get_averageValue())),this.previewMaxData.push(new ai(l,n[a].get_maxValue())));else{let h=new Date(l*1e3),u=new Date(e.start*1e3),_=new Date(e.stop*1e3),d=h.toLocaleDateString()+" "+h.toLocaleTimeString(),g=u.toLocaleDateString()+" "+u.toLocaleTimeString(),y=_.toLocaleDateString()+" "+_.toLocaleTimeString();Z.log(this.hwdName+" note: skipping measure at "+d+", not in range "+g+" ... "+y)}}lt._MaxDataRecords>0&&this.previewDataCleanUp();for(let a=0;a<this.previewMinData.length-1;a++)if(this.previewMinData[a].DateTime>=this.previewMinData[a+1].DateTime)throw"Time-stamp inconsistency";if(this.previewCurData.length>1?Z.log(this.hwdName+" loaded "+this.previewCurData.length.toString()+"/"+n.length.toString()+" records over "+(this.previewCurData[this.previewCurData.length-1].DateTime-this.previewCurData[0].DateTime).toFixed(3)+" sec, last timed stamp was "+this.previewCurData[this.previewCurData.length-1].DateTime):Z.log(this.hwdName+" loaded "+this.previewCurData.length.toString()+" records"),this.previewMinData.length>2){let a=this.previewMinData[this.previewMinData.length-1].DateTime,l=this.findMergeBoundaries(this.previewMinData),h=l.MergeSourceStop-l.MergeSourceStart;this.minData=this.minData.slice(0,l.MergeSourceStart).concat(this.previewMinData,this.minData.slice(l.MergeSourceStart+h)),this.curData=this.curData.slice(0,l.MergeSourceStart).concat(this.previewCurData,this.curData.slice(l.MergeSourceStart+h)),this.maxData=this.maxData.slice(0,l.MergeSourceStart).concat(this.previewMaxData,this.maxData.slice(l.MergeSourceStart+h)),this.firstDataloggerTimeStamp=this.curData[0].DateTime}this.loadDone=!0,this.loadFailed=!1;let o=this.curData.length;o>0&&this.curData[o-1].DateTime>this.lastDataTimeStamp&&(this.lastDataTimeStamp=this.curData[o-1].DateTime,this.lastDataSource="end of datalogger"),this.load_Completed()})}load_Completed(){if(Z.log(this.hwdName+".loadcompleted()"),this.loadFailed){Z.log(this.hwdName+" : datalogger loading failed"),this._loadProcessIsBusy=!1;return}if(this.loadCanceled){Z.log(this.hwdName+" : datalogger loading was canceled"),this.previewMinData=[],this.previewCurData=[],this.previewMaxData=[],this.loadCanceled=!1,this._loadProcessIsBusy=!1,this.preloadDone=!1,this.loadDone=!1;return}this.previewCurData.length<=2&&(this.preloadDone=!1,this.loadDone=!1),Z.log(this.hwdName+" : datalogger loading completed  ("+this.previewMinData.length+" rows)"),this.resetDataloggerLoader(),this.dataLoggerLoadCompleted=!0;for(let e=0;e<this.FormsToNotify.length;e++)this.FormsToNotify[e]instanceof gt&&this.FormsToNotify[e].DataloggerCompleted(this);this.setDataloggerLoadProgress(100)}get dataloggerWasUsed(){return this.dataLoggerLoadCompleted}dataCleanUp(){if(lt._MaxDataRecords<=0)return;let e=lt._MaxDataRecords*90/100>>0;this.curData!=null&&lt._MaxDataRecords<this.curData.length&&(this.minData.splice(0,this.minData.length-e),this.curData.splice(0,this.curData.length-e),this.maxData.splice(0,this.maxData.length-e))}previewDataCleanUp(){if(lt._MaxDataRecords<=0)return;let e=lt._MaxDataRecords*90/100>>0;this.previewMinData!=null&&lt._MaxDataRecords<this.previewMinData.length&&(this.previewMinData.splice(0,this.previewMinData.length-e),this.previewCurData.splice(0,this.previewCurData.length-e),this.previewMaxData.splice(0,this.previewMaxData.length-e))}stopDataloggerloading(){}isOnline(){return this._online}reloadConfig(){return Ke(this,void 0,void 0,function*(){if(this._online)if(yield this.sensor.isOnline())try{this.unit=yield this.sensor.get_unit(),this._friendlyname=yield this.sensor.get_friendlyName(),this.resolution=yield this.sensor.get_resolution(),this._frequency=yield this.sensor.get_reportFrequency(),this._readonly=yield this.sensor.isReadOnly(),this.dataLoggerFeature?this._recording=(yield this.sensor.get_logFrequency())!="OFF":this._recording=!1,this.lastGetConfig=E.GetTickCount(),this.mustReloadConfig=!1}catch(t){Z.log("reload configuration error: "+t.message)}else this._online=!1})}get_unit(){return this.cfgChgNotificationsSupported&&!this.mustReloadConfig?this.unit:((this.lastGetConfig<=0||E.GetTickCount()-this.lastGetConfig>5e3)&&this.reloadConfig().then(),this.unit)}get_resolution(){return this.cfgChgNotificationsSupported&&!this.mustReloadConfig?this.resolution:((this.lastGetConfig<=0||E.GetTickCount()-this.lastGetConfig>5e3)&&this.reloadConfig().then(),this.resolution)}resetDataloggerLoader(){this._predloadProcessIsBusy=!1,this._loadProcessIsBusy=!1,this.dataLoggerLoadCompleted=!1,this.preloadDone=!1,this.loadDone=!1,this._dataloggerLoadisRunning=!1,this.previewMinData=[],this.previewCurData=[],this.previewMaxData=[]}loadDatalogger(e,t){if(this.dataLoggerFeature&&!this._predloadProcessIsBusy&&!this._loadProcessIsBusy){if(S.maxPointsPerDataloggerSerie<0){Z.log(this.hwdName+" : datalogger access is disabled");return}!this.preloadDone&&this.dataLoggerFeature&&(Z.log(this.hwdName+" : start datalogger preloading"),this.preload_DoWork(new da(e,t)).then())}}arrival(e){return Ke(this,void 0,void 0,function*(){yield this.configureSensor(),this._online=!0,yield this.reloadConfig();let t=yield this.sensor.get_dataLogger();if(t==null)return;let i=Math.floor(new Date().getTime()/1e3);if(this.curData.length>0&&this.dataLoggerLoadCompleted){let r=yield t.get_timeUTC(),s=this.curData[this.curData.length-1].DateTime,n=r-s;n==0&&(s=this.curData[this.curData.length-2].DateTime,n=r-s),n>1&&(Z.log(this.hwdName+" is back online trying to load "+n.toFixed(3)+" sec of data from datalogger "),this.resetDataloggerLoader(),this.loadDatalogger(s,r))}this.isReadOnly&&Z.log(this.hwdName+" is read only"),this.notifySensorStateChange(),this.notifySensorArrival()})}startDataloggerload(e){return Ke(this,void 0,void 0,function*(){if(!this.dataLoggerFeature||this.sensor==null||this._loadProcessIsBusy||this._predloadProcessIsBusy)return;if(this.dataLoggerLoadCompleted){e.DataloggerCompleted(this);return}let t=yield this.sensor.get_dataLogger();t!=null&&this.loadDatalogger(0,yield t.get_timeUTC())})}notifySensorArrival(){for(let e=0;e<this.FormsToNotify.length;e++)this.FormsToNotify[e].SensorArrivalcallback(this)}notifySensorStateChange(){for(let e=0;e<this.FormsToNotify.length;e++)this.FormsToNotify[e].SensorStateChangedcallback(this)}removal(){this._online=!1,this.forceUpdate(),this.notifySensorStateChange()}configureSensor(){return Ke(this,void 0,void 0,function*(){if(Z.log("Configuring  "+this.hwdName),!(yield this.sensor.isOnline()))return;let e=!1,t=yield this.sensor.get_logFrequency(),i=yield this.sensor.get_reportFrequency(),r=yield this.sensor.isReadOnly(),s=t,n=i,o=yield this.sensor.get_module();for(let a=0;a<(yield o.functionCount());a++)(yield o.functionType(a))=="DataLogger"&&(this.dataLoggerFeature=!0);try{if(this.dataLoggerFeature){let a=yield this.sensor.get_module(),l=Re.FindDataLogger((yield a.get_serialNumber())+".dataLogger"),h=(yield l.get_recording())!=Re.RECORDING_OFF,u=(yield l.get_autoStart())!=Re.AUTOSTART_OFF;if(h||(s="OFF"),s!="OFF"?n=s:n=="OFF"&&(n="1/s"),s!=t){if(r)throw new Error(this.hwdName+" is read only, cannot change its logFrequency from "+t+" to "+s);yield this.sensor.set_logFrequency(s),e=!0}if(n!=i){if(r)throw new Error(this.hwdName+" is read only, connot change its  reportFrequency from "+i+" to "+n);yield this.sensor.set_reportFrequency(n),e=!0}if(s!="OFF"){if(!h){if(r)throw new Error(this.hwdName+" is read only, cannot change set its  datalogger recording to ON");yield l.set_recording(Re.RECORDING_ON)}if(!u){if(r)throw new Error(this.hwdName+" is read only, cannot change set its datalogger autostart to ON");yield l.set_autoStart(Re.AUTOSTART_ON),e=!0}}}else if(s="OFF",n=="OFF"){if(n="1/s",r)throw new Error(this.hwdName+" is read only, connot change is reportFrequency from OFF to "+n);yield this.sensor.set_reportFrequency(n),e=!0}e&&(yield o.saveToFlash())}catch(a){Z.log("failed to configure "+this.hwdName+"  ("+a.message+")")}Z.log("registering timed callback for  "+(yield this.sensor.get_hardwareId())),yield this.sensor.registerTimedReportCallback((a,l)=>{this.TimedCallback(a,l)}),this._recording=s!="OFF",this._frequency=n})}registerCallback(e){this.FormsToNotify.indexOf(e)>=0||this.FormsToNotify.push(e)}forceUpdate(){this.TimedCallback(this.sensor,null).then()}TimedCallback(e,t){return Ke(this,void 0,void 0,function*(){if(this._online=!0,t!=null){let i=t.get_endTimeUTC();this.firstLiveDataTimeStamp==0&&(this.firstLiveDataTimeStamp=i),i>this.lastDataTimeStamp?(this.lastDataTimeStamp=i,this.lastDataSource="last timedReport",this.consecutiveBadTimeStamp=0):(this.consecutiveBadTimeStamp++,this.consecutiveBadTimeStamp<10&&Z.log(this.hwdName+": ignoring bad timestamp "+i.toFixed(3)+" (previous "+this.lastDataSource+" at "+this.lastDataTimeStamp.toFixed(3)+")")),(this.consecutiveBadTimeStamp==0||this.consecutiveBadTimeStamp>=10)&&(this._lastAvgValue=t.get_averageValue(),this._lastMinValue=t.get_minValue(),this._lastMaxValue=t.get_maxValue(),this.curData.push(new ai(i,this._lastAvgValue)),this.minData.push(new ai(i,this._lastMinValue)),this.maxData.push(new ai(i,this._lastMaxValue)),lt._MaxDataRecords>0&&this.dataCleanUp());for(let r=0;r<this.Alarms.length;r++)this.Alarms[r].check(t);for(let r=0;r<this.FormsToNotify.length;r++)this.FormsToNotify[r].SensorValuecallback(this,t)}})}forgetForm(e){for(let t=this.FormsToNotify.length-1;t>=0;t--)e==this.FormsToNotify[t]&&this.FormsToNotify.splice(t,1)}get_sensor(){return this.sensor}get_hardwareId(){return this.hwdName}get_friendlyName(){return this._friendlyname}toString(){let e=this._friendlyname;return this._readonly&&(e+=" (readonly)"),this._online?e:e+" (OFFLINE)"}};m(lt,"CustomYSensor");var st=lt;st._MaxDataRecords=0;st._MaxLoggerRecords=0;var ma=class ma extends st{constructor(){super(null,"",null),this.hwdName="NOTAREALSENSOR",this._friendlyname="NOTAREALSENSOR",this.dataLoggerFeature=!1}preload_DoWork(e){return Ke(this,void 0,void 0,function*(){})}get dataloggerLoadisRunning(){return!1}get_unit(){return""}registerCallback(e){}forceUpdate(){}get_frequency(){return""}set_frequency(e){}get_sensor(){return null}toString(){return"(none)"}setAlarmCondition(e,t){}getAlarmCondition(e){return 0}setAlarmValue(e,t){}getAlarmValue(e){return 0}setAlarmDelay(e,t){}getAlarmDelay(e){return 0}setAlarmCommandline(e,t){}getAlarmCommandline(e){return""}};m(ma,"NullYSensor");var Ae=ma,G=class G{static clearHublist(){return Ke(this,void 0,void 0,function*(){for(let e=G._hubList.length-1;e>=0;e--)G._hubList[e].removable&&(yield E.UnregisterHub(G._hubList[e].get_fullUrl()),G._hubList.splice(e,1))})}static registerChangeCallback(e){this._changeCallback=e}static registerChangeExternalCallback(e){this._changeExternalCallback=e}static forgetForm(e){for(let t=0;t<G.sensorList.length;t++)G.sensorList[t].forgetForm(e)}static InitHubList(e){let t=e.get_childsByIndex();for(let i=0;i<t.length;i++)if(t[i].Name.toUpperCase()=="HUB"){let r=oi.HubFromXml(t[i]),s=!1;for(let n=0;n<G._hubList.length;n++)r.get_connexionUrl()==G._hubList[n].get_connexionUrl()&&(s=!0);s||(G._hubList.push(r),r.Connect().then())}}static get hubList(){return G._hubList}static hubWasremoved(e){for(let t=G._hubList.length-1;t>=0;t--)G._hubList[t]==e&&G._hubList.splice(t,1)}static newHubCreated(e){let t=e.get_connexionUrl();for(let i=0;i<G._hubList.length;i++)if(G._hubList[i].get_connexionUrl()==t)return alert("This connection already exists"),!1;return G._hubList.push(e),!0}static removeExtraInfoFromUrl(e){let t=new URL(e),i=t.hostname+t.pathname;return i.slice(0,4).toLowerCase()==="www."&&(i=i.slice(4)),i}static NetworkArrival(e){return Ke(this,void 0,void 0,function*(){Z.log("Network device detected: "+(yield e.get_hardwareId()));let t=yield e.get_ipAddress(),i=yield e.get_logicalName(),r=yield e.get_module(),s=yield r.get_logicalName(),n=G.removeExtraInfoFromUrl(yield r.get_url());for(let o=0;o<G._hubList.length;o++)G.removeExtraInfoFromUrl(G.hubList[o].get_fullUrl())==n&&G.hubList[o].arrival(t,i,r,s)})}static getXmlHublist(){let e="";for(let t=0;t<G._hubList.length;t++)e+="    "+G._hubList[t].XmlCode()+`
`;return e}static getXMLSensorsConfig(){let e=`<Sensors>
`;return G.sensorList.forEach(t=>{t instanceof Ae||(e=e+t.GetXmlData())}),e=e+`</Sensors>
`,e}static setKnownSensors(e){this.KnownSensors=e}static FindSensorLastLocalConfig(e){let t=null;if(G.KnownSensors!=null){let i=G.KnownSensors.get_childsByIndex();for(let r=0;r<i.length;r++){let s=i[r];s.Name=="Sensor"&&s.get_attributes().ID==e&&(t=s)}}return t}static deviceConfigChanged(e){return Ke(this,void 0,void 0,function*(){Z.log("Configuration change on device  "+(yield e.get_serialNumber()));let t=(yield e.get_serialNumber()).substring(0,8);for(let i=0;i<G.sensorList.length;i++)G.sensorList[i].get_hardwareId().substring(0,8)==t&&(yield G.sensorList[i].ConfigHasChanged());if(G._changeCallback!=null&&G._changeCallback(),G._changeExternalCallback!=null){let i=yield G._changeExternalCallback(e);i!=null&&O.ConfigChanged(i)}})}static deviceArrival(e){return Ke(this,void 0,void 0,function*(){try{let t=yield e.functionCount(),i=yield e.get_serialNumber(),r=yield e.get_luminosity();Z.log("Device Arrival "+i);let s=!1;for(let n=0;n<t;n++){let o=yield e.functionType(n),a=yield e.functionId(n);if(o=="Network"){let l=yield q.FindNetwork(i+"."+a);yield oe.NetworkArrival(l)}else if(o=="DataLogger"){let h=yield Re.FindDataLogger(i+"."+a).get_recording();(h==Re.RECORDING_ON||h==Re.RECORDING_PENDING)&&(s=!0)}}for(let n=0;n<t;n++){let o=yield e.functionBaseType(n),a=yield e.functionId(n);if(o=="Sensor"){let l=i+"."+a;Z.log("New sensor arrival: "+l);let h=!1;for(let u=0;u<G.sensorList.length&&!h;u++)G.sensorList[u].get_hardwareId()==l&&(h=!0,yield G.sensorList[u].arrival(s));if(!h){let u=rt.FindSensor(l),_=yield u.get_hardwareId(),d=new st(u,_,G.FindSensorLastLocalConfig(_));G.sensorList.push(d),yield d.configureSensor(),O.refreshEditor(),d.notifySensorStateChange()}}}yield e.registerConfigChangeCallback(G.deviceConfigChanged),setTimeout(()=>{G.deviceConfigChanged(e)},100),G._changeCallback!=null&&G._changeCallback()}catch(t){Z.log("Device Arrival Error: "+t.message)}G._customArrivalCallback!=null&&G._customArrivalCallback(e)})}static deviceRemoval(e){return Ke(this,void 0,void 0,function*(){let t=yield e.get_serialNumber();Z.log("Device removal "+t),G.sensorList.forEach(i=>{if(!(i instanceof Ae)){let r=i.get_hardwareId();r.length>=t.length&&r.substring(0,t.length)==t&&i.removal()}}),G._changeCallback!=null&&G._changeCallback(),G._customRemovalCallback!=null&&G._customRemovalCallback(e)})}static RegisterDeviceArrivalCallback(e){G._customArrivalCallback=e}static RegisterDeviceRemovalCallback(e){G._customRemovalCallback=e}static AddNewSensor(e){for(let r=0;r<G.sensorList.length;r++)if(G.sensorList[r]!=null&&G.sensorList[r].get_hardwareId()==e)return G.sensorList[r];let t=rt.FindSensor(e),i=new st(t,e,G.FindSensorLastLocalConfig(e));return G.sensorList.push(i),i}static getNullSensor(){return G.NullSensor}static UpdateDeviceList(){return Ke(this,void 0,void 0,function*(){let e=new Dt;try{(yield E.UpdateDeviceList(e))!=0&&Z.log("UpdateDeviceList failed :"+e.msg)}catch(i){Z.log("UpdateDeviceList failed :"+i.message)}let t=Vt.FirstHubInUse();for(;t!=null;){let i=yield t.get_errorType();if(i!=0){let r="Cannot connect to "+(yield t.get_connectionUrl())+" ("+(yield t.get_errorMessage())+")";if(i==-12)for(let s=0;s<this._hubList.length;s++)(yield this._hubList[s].matches(t))&&!this._hubList[s].removable&&(r+=". Update hub credentials in 'Global configuration' window.");Z.log(r)}t=t.nextHubInUse()}})}static _runAsync(){return Ke(this,void 0,void 0,function*(){let e=new Dt;yield E.RegisterDeviceArrivalCallback(t=>{G.deviceArrival(t)}),yield E.RegisterDeviceRemovalCallback(t=>{G.deviceRemoval(t)}),yield G.UpdateDeviceList(),setInterval(()=>{G.UpdateDeviceList()},2e3)})}static run(){G.NullSensor=new Ae,G.sensorList=[],G.sensorList.push(G.NullSensor),this._runAsync().then()}};m(G,"sensorsManager");var oe=G;oe.counter=0;oe.KnownSensors=null;oe._hubList=[];oe._customArrivalCallback=null;oe._customRemovalCallback=null;oe._changeCallback=null;oe._changeExternalCallback=null;var Wl=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},Fe=class Fe{constructor(e,t,i,r){this.index=t,this.container=e,this.isactive=!1,this.div=document.createElement("DIV");let s=Fe.HANDLESIZE-2;switch(this.index==Fe.RESIZEHANDLE_CENTER&&(s=s*2),this.div.style.position="absolute",this.div.style.border="0px solid black",this.div.style.background="transparent",this.div.style.pointerEvents="auto",this.div.style.width=s.toString()+"px",this.div.style.height=s.toString()+"px",t){case Fe.RESIZEHANDLE_TOPLEFT:this.div.style.cursor="nw-resize",this.div.style.left="0px",this.div.style.top="0px";break;case Fe.RESIZEHANDLE_TOPCENTER:this.div.style.cursor="n-resize",this.div.style.top="0px",this.div.style.left="50%",this.div.style.transform="translate(-50%,0)";break;case Fe.RESIZEHANDLE_TOPRIGHT:this.div.style.cursor="ne-resize",this.div.style.right="0px",this.div.style.top="0px";break;case Fe.RESIZEHANDLE_CENTERRIGHT:this.div.style.cursor="e-resize",this.div.style.right="0px",this.div.style.top="50%",this.div.style.transform="translate(0,-50%)";break;case Fe.RESIZEHANDLE_BOTTOMRIGHT:this.div.style.cursor="se-resize",this.div.style.right="0px",this.div.style.bottom="0px";break;case Fe.RESIZEHANDLE_BOTTOMCENTER:this.div.style.cursor="s-resize",this.div.style.bottom="0px",this.div.style.left="50%",this.div.style.transform="translate(-50%,0)";break;case Fe.RESIZEHANDLE_BOTTOMLEFT:this.div.style.cursor="sw-resize",this.div.style.left="0px",this.div.style.bottom="0px";break;case Fe.RESIZEHANDLE_CENTERLEFT:this.div.style.cursor="w-resize",this.div.style.left="0px",this.div.style.top="50%",this.div.style.transform="translate(0,-50%)";break;case Fe.RESIZEHANDLE_CENTER:this.div.style.cursor="move",this.div.style.left="50%",this.div.style.top="50%",this.div.style.transform="translate(-50%,-50%)";break}this.container.appendChild(this.div),this.div.addEventListener("mousedown",i),this.div.addEventListener("touchstart",r),this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttribute("viewBox","0 0 "+s+" "+s),this.svg.setAttribute("version","1.1"),this.svg.setAttribute("width",s.toString()),this.svg.setAttribute("height",s.toString());let n=0,o=0,a=s;switch(this.index){case Fe.RESIZEHANDLE_TOPLEFT:break;case Fe.RESIZEHANDLE_TOPCENTER:n=s/2;break;case Fe.RESIZEHANDLE_TOPRIGHT:n=s;break;case Fe.RESIZEHANDLE_CENTERRIGHT:n=s,o=s/2;break;case Fe.RESIZEHANDLE_BOTTOMRIGHT:n=s,o=s;break;case Fe.RESIZEHANDLE_BOTTOMCENTER:n=s/2,o=s;break;case Fe.RESIZEHANDLE_BOTTOMLEFT:o=s;break;case Fe.RESIZEHANDLE_CENTERLEFT:o=s/2;break;case Fe.RESIZEHANDLE_CENTER:n=s/2,o=s/2,a=s/2;break}this.circle=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.circle.setAttribute("cx",n.toString()),this.circle.setAttribute("cy",o.toString()),this.circle.setAttribute("r",a.toString()),this.circle.setAttribute("style","fill:white"),this.circle.setAttribute("opacity","0.75"),this.svg.appendChild(this.circle),this.arrow=document.createElementNS("http://www.w3.org/2000/svg","path");let l="";for(let h=0;h<Fe.RESIZEHANDLE_data[t].length>>1;h++){let u=1+(s-2)*Fe.RESIZEHANDLE_data[t][h<<1]/12,_=1+(s-2)*Fe.RESIZEHANDLE_data[t][1+(h<<1)]/12;l+=h==0?"M ":"L ",l+=Math.round(u).toString()+" "+Math.round(_).toString()+" "}l+="z",this.arrow.setAttribute("d",l),this.arrow.setAttribute("fill",Fe.inactiveColor),this.svg.appendChild(this.arrow),this.div.appendChild(this.svg),this.container.appendChild(this.div)}get active(){return this.isactive}set active(e){e!=this.isactive&&(this.isactive=e,this.arrow.setAttribute("fill",this.active?Fe.activeColor:Fe.inactiveColor))}};m(Fe,"ResizeMoveHandle");var It=Fe;It.HANDLESIZE=Math.round(20*(1+2*(S.guiDPIFactor-1)));It.activeColor="lightgreen";It.inactiveColor="grey";It.RESIZEHANDLE_TOPLEFT=0;It.RESIZEHANDLE_TOPCENTER=1;It.RESIZEHANDLE_TOPRIGHT=2;It.RESIZEHANDLE_CENTERRIGHT=3;It.RESIZEHANDLE_BOTTOMRIGHT=4;It.RESIZEHANDLE_BOTTOMCENTER=5;It.RESIZEHANDLE_BOTTOMLEFT=6;It.RESIZEHANDLE_CENTERLEFT=7;It.RESIZEHANDLE_CENTER=8;It.RESIZEHANDLE_data=[[0,0,0,7,2,5,7,10,10,7,5,2,7,0],[6,0,11,5,8,5,8,12,4,12,4,5,1,5],[12,0,12,7,10,5,5,10,2,7,7,2,5,0],[12,6,7,11,7,8,0,8,0,4,7,4,7,1],[12,12,5,12,7,10,2,5,5,2,10,7,12,5],[6,12,1,7,4,7,4,0,8,0,8,7,11,7],[0,12,0,5,2,7,7,2,10,5,5,10,7,12],[0,6,5,1,5,4,12,4,12,8,5,8,5,11],[6,0,8,2,7,2,7,5,10,5,10,4,12,6,10,8,10,7,7,7,7,10,8,10,6,12,4,10,5,10,5,7,2,7,2,8,0,6,2,4,2,5,5,5,5,2,4,2]];var Q=class Q{static log(e){Z.log(e)}SourceChanged(e,t){}loadRecordedDataIfNeeded(){}removeDataloggerData(){}delete(){this.editStopped(),oe.forgetForm(this),this.destroy()}get confirmDeleteString(){return"not defined"}snapshot(){let e=1024,t=1024,i=this.UIContainer.offsetHeight!=0?this.UIContainer.offsetWidth/this.UIContainer.offsetHeight:1;switch(S.captureSizePolicy){case W.CaptureFormats.Keep:e=this.UIContainer.offsetWidth,t=this.UIContainer.offsetHeight;break;case W.CaptureFormats.FixedHeight:t=S.captureHeight,e=t*i;break;case W.CaptureFormats.FixedWidth:e=S.captureWidth,t=e/i;break;case W.CaptureFormats.Fixed:e=S.captureWidth,t=S.captureHeight;break}this._genRenderer.captureAndDownloadImage(S.captureType,"",e,t,S.captureDPI)}get BackColor(){return this._BackColor}set BackColor(e){this._BackColor=e,this.UIContainer.style.backgroundColor=this._BackColor.htmlCode}get BorderColor(){return this._BorderColor}set BorderColor(e){this._BorderColor=e,this.UIContainer.style.border="1px solid "+this._BorderColor.htmlCode}get parentWidth(){return this.UIContainer.parentNode==document.body||this.UIContainer.parentNode==null?window.innerWidth:this.UIContainer.parentNode.clientWidth}get parentHeight(){return this.UIContainer.parentNode==document.body||this.UIContainer.parentNode==null?window.innerHeight:this.UIContainer.parentNode.clientHeight}get relativePositionX(){return this._SizeIsRelative?this._relativePositionX:this.sizeRound(100*this.UIContainer.offsetLeft/this.parentWidth)}set relativePositionX(e){this._relativePositionX=e,this._PositionX=Math.round(e*this.parentWidth/100)}set relativePositionY(e){this._relativePositionY=e,this._PositionY=Math.round(e*this.parentHeight/100)}get relativePositionY(){return this._SizeIsRelative?this._relativePositionY:this.sizeRound(100*this.UIContainer.offsetTop/this.parentHeight)}get PositionX(){return this._SizeIsRelative?this.relativePositionX:this.UIContainer.offsetLeft}set PositionX(e){this._SizeIsRelative?this.relativePositionX=e:this._PositionX=e,this.UIContainer.style.left=this._PositionX.toString()+"px",this._genRenderer!=null&&this._genRenderer.clearTransformationMatrix(),this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight)}get PositionY(){return this._SizeIsRelative?this.relativePositionY:this.UIContainer.offsetTop}set PositionY(e){this._SizeIsRelative?this.relativePositionY=e:this._PositionY=e,this.UIContainer.style.top=this._PositionY.toString()+"px",this._genRenderer!=null&&this._genRenderer.clearTransformationMatrix(),this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight)}sizeRound(e){return Math.round(100*e)/100}get relativeWidth(){return this._SizeIsRelative?this._relativeWidth:this.sizeRound(100*this.UIContainer.offsetWidth/this.parentWidth)}set relativeWidth(e){if(e<=0)throw"Value must be strictly positive";this._relativeWidth=e,this._Width=Math.round(e*this.parentWidth/100)}set relativeHeight(e){if(e<=0)throw"Value must be strictly positive";this._relativeHeight=e,this._Height=Math.round(e*this.parentHeight/100)}get relativeHeight(){return this._SizeIsRelative?this._relativeHeight:this.sizeRound(100*this.UIContainer.offsetHeight/this.parentHeight)}updateRelativeSize(){Math.abs(this._relativeWidth*this.parentWidth/100-this.UIContainer.offsetWidth)>1&&(this._relativeWidth=this.sizeRound(100*this.UIContainer.offsetWidth/this.parentWidth)),Math.abs(this._relativeHeight*this.parentHeight/100-this.UIContainer.offsetHeight)>1&&(this._relativeHeight=this.sizeRound(100*this.UIContainer.offsetHeight/this.parentHeight)),Math.abs(this._relativePositionX*this.parentWidth/100-this.UIContainer.offsetLeft)>1&&(this._relativePositionX=this.sizeRound(100*this.UIContainer.offsetLeft/this.parentWidth)),Math.abs(this._relativePositionY*this.parentHeight/100-this.UIContainer.offsetTop)>1&&(this._relativePositionY=this.sizeRound(100*this.UIContainer.offsetTop/this.parentHeight))}get Width(){return this._SizeIsRelative?this.relativeWidth:this.UIContainer.offsetWidth}set Width(e){if(e<=0)throw"Value must be strictly positive";this._SizeIsRelative?this.relativeWidth=e:this._Width=e,this.UIContainer.style.width=(this._Width-2).toString()+"px",this.UIContainer.width=this._Width-2,this._genRenderer!=null&&this._genRenderer.clearTransformationMatrix(),this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight),this.containerResized()}get Height(){return this._SizeIsRelative?this.relativeHeight:this.UIContainer.offsetHeight}set Height(e){if(e<=0)throw"Value must be strictly positive";this._SizeIsRelative?this.relativeHeight=e:this._Height=e,this.UIContainer.style.height=(this._Height-2).toString()+"px",this.UIContainer.height=this._Height-2,this._genRenderer!=null&&this._genRenderer.clearTransformationMatrix(),this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight),this.containerResized()}get SizeIsRelative(){return this._SizeIsRelative}set SizeIsRelative(e){this._SizeIsRelative!=e&&(this._SizeIsRelative=e,this._SizeIsRelative&&(this._relativePositionX=this.sizeRound(100*this.UIContainer.offsetLeft/this.parentWidth),this._relativePositionY=this.sizeRound(100*this.UIContainer.offsetTop/this.parentHeight),this._relativeWidth=this.sizeRound(100*this.UIContainer.offsetWidth/this.parentWidth),this._relativeHeight=this.sizeRound(100*this.UIContainer.offsetHeight/this.parentHeight)),this.windowResized())}get containerID(){return this._containerID}set containerID(e){if(this._containerID==e)return;let t=e!=""?document.getElementById(e):null;if(e!=""&&t==null)throw"No HTMLElement on the page with such ID ("+e+")";this.UIContainer.parentNode!=null?this.UIContainer.parentNode.removeChild(this.UIContainer):document.body.removeChild(this.UIContainer),t!=null?(this.UIContainer.style.position="relative",t.insertBefore(this.UIContainer,t.firstChild)):(this.UIContainer.style.position="absolute",document.body.insertBefore(this.UIContainer,document.body.firstChild)),this._genRenderer.clearTransformationMatrix(),this.windowResized(),this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight),this._containerID=e}get Text(){return this._Text}set Text(e){this._Text=e,this.UIContainer.title=e}set_name(e){this.Text=e,this._genProp.Form_Text=e}windowResized(){this._genRenderer.DisableRedraw(),this._SizeIsRelative&&(this.PositionX=this._relativePositionX,this.PositionY=this._relativePositionY,this.Height=this._relativeHeight,this.Width=this._relativeWidth),this.containerResized(),this._genRenderer.AllowRedraw()}ApplyRelativeSizeIfRequired(){this._initialContainerID!=""&&(document.getElementById(this._initialContainerID)!=null?this.containerID=this._initialContainerID:Z.log('Warning: cannot place widget in "'+this._initialContainerID+'" : no such HTML element.')),this._SizeIsRelative=this._InitialSizeIsRelative,this.windowResized()}destroy(){window.removeEventListener("resize",this._windowResizeCallback),this._genRenderer.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}getContainerOffset(){let e=this.UIContainer.offsetParent,t=0,i=0;for(;e;)i+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return new ot(t,i)}contextMenuCallBack(e,t){let i=this._genRenderer.Scr2ElmMatrix.multiplyByV(Ut.FromXYCoord(e,t)).toPoint();i.X>=0&&i.X<=this.UIContainer.offsetWidth&&i.Y>=0&&i.Y<=this.UIContainer.offsetHeight&&this.contextMenuIsOpening()}contextMenuIsOpening(){}constructor(e,t,i,r,s,n){this._genProp=null,this._genRenderer=null,this._BackColor=c.Transparent,this._BorderColor=c.Gray,this._relativePositionX=0,this._relativePositionY=0,this._PositionX=0,this._PositionY=0,this._relativeWidth=100,this._relativeHeight=100,this._Width=300,this._Height=0,this._InitialSizeIsRelative=!1,this._SizeIsRelative=!1,this._initialContainerID="",this._containerID="",this._Text="",this.resizeCaptureRunning=!1,this.resizeCaptureXOrigineMouse=0,this.resizeCaptureYOrigineMouse=0,this.resizeCaptureXOrigine=0,this.resizeCaptureYOrigine=0,this.resizeCaptureOriginalTop=0,this.resizeCaptureOriginalLeft=0,this.resizeCaptureOriginalWidth=0,this.resizeCaptureOriginalHeight=0,this.resizeCaptureHandleIndex=0,this.resizeCaptureOriginalMatrix=null,this.resizeCaptureOriginalMatrixInv=null,this.previousTRansform="",this.previousWidth=0,this.previousHeight=0;let o=typeof i!="undefined"?i:0,a=typeof r!="undefined"?r:0,l=typeof s!="undefined"?s:0,h=typeof n!="undefined"?n:0,u=Number.NaN,_=Number.NaN;if(e!=null){let y=e.get_childsByName();if("location"in y){let x=y.location.get_attributes();"x"in x&&(o=parseInt(x.x)),"y"in x&&(a=parseInt(x.y))}if("size"in y){let x=y.size.get_attributes();"w"in x&&(l=parseInt(x.w)),"h"in x&&(h=parseInt(x.h))}if("relativeCoord"in y){let x=y.relativeCoord.get_attributes();"x"in x&&(this._relativePositionX=this.sizeRound(parseFloat(x.x))),"y"in x&&(this._relativePositionY=this.sizeRound(parseFloat(x.y))),"w"in x&&(this._relativeWidth=this.sizeRound(parseFloat(x.w))),"h"in x&&(this._relativeHeight=this.sizeRound(parseFloat(x.h))),"active"in x&&(this._InitialSizeIsRelative=x.active.toUpperCase()=="TRUE")}if("container"in y){let x=y.container.get_attributes();"id"in x&&(this._initialContainerID=x.id)}}this.UIContainer=document.createElement("CANVAS"),this.UIContainer.style.position="absolute",Q.currentEdited=null;let d=window.innerHeight,g=window.innerWidth;this.PositionX=this._InitialSizeIsRelative?Math.round(g*(this._relativePositionX/100)):o,this.PositionY=this._InitialSizeIsRelative?Math.round(d*(this._relativePositionY/100)):a,this.Width=this._InitialSizeIsRelative?Math.round(g*(this._relativeWidth/100)):l,this.Height=this._InitialSizeIsRelative?Math.round(d*(this._relativeHeight/100)):h,this.UIContainer.style.border="1px solid black",this.UIContainer.style.backgroundColor=this._BackColor.htmlCode,this.UIContainer.setAttribute("name","YoctoVisualizationWidget"),document.body.appendChild(this.UIContainer),this._windowResizeCallback=()=>this.windowResized(),window.addEventListener("resize",this._windowResizeCallback)}rearrangeZindexes(){let e=document.getElementsByName("YoctoVisualizationWidget"),t=0;for(let i=0;i<e.length;i++)e[i]!=this.UIContainer&&(e[i].style.zIndex=t.toString(),t++);this.UIContainer.style.zIndex=t.toString(),t++,Q.HandlesDiv.style.zIndex=t.toString()}SensorArrivalcallback(e){}SensorStateChangedcallback(e){Q.currentEdited==this&&O.refreshEditor()}SensorValuecallback(e,t){}get isBeingEdited(){return Q.currentEdited==this}static stopEdition(){Q.currentEdited!=null&&(Q.currentEdited.editStopped(),Q.currentEdited=null)}refreshProperties(){}edit(){if(Q.stopEdition(),Q.currentEdited=this,Q.editHandles.length<=0){Q.HandlesDiv=document.createElement("DIV"),Q.HandlesDiv.style.position="absolute",Q.HandlesDiv.style.left="0px",Q.HandlesDiv.style.top="0px",Q.HandlesDiv.style.backgroundColor="transparent",Q.HandlesDiv.style.transformOrigin="top left",Q.HandlesDiv.style.pointerEvents="none";for(let e=0;e<9;e++)Q.editHandles.push(new It(Q.HandlesDiv,e,t=>{Q.currentEdited!=null&&Q.currentEdited.mouseStartCapture(t,e)},t=>{Q.currentEdited!=null&&Q.currentEdited.touchStartCapture(t,e)}));document.body.appendChild(Q.HandlesDiv),document.addEventListener("touchmove",e=>{Q.currentEdited!=null&&Q.currentEdited.touchCaptureRun(e)},{passive:!1}),document.addEventListener("touchend",e=>{Q.currentEdited!=null&&Q.currentEdited.touchCaptureStop(e)},{passive:!1}),document.addEventListener("mousemove",e=>{Q.currentEdited!=null&&Q.currentEdited.mouseCaptureRun(e)},{passive:!1}),document.addEventListener("mouseup",e=>{Q.currentEdited!=null&&Q.currentEdited.mouseCaptureStop(e)},{passive:!1})}this.DrawHandles(this.UIContainer.offsetLeft,this.UIContainer.offsetTop,this.UIContainer.offsetWidth,this.UIContainer.offsetHeight),Q.HandlesDiv.style.display="",this.rearrangeZindexes()}DrawHandles(e,t,i,r){if(Q.currentEdited==null||Q.editHandles.length<=0)return;if(Q.HandlesDiv.style.width=i.toString()+"px",Q.HandlesDiv.style.height=r.toString()+"px",this._genRenderer==null)debugger;let s=parseFloat(this.UIContainer.style.border),n=Yt.newTranslateMatrix(-s,-s);Q.HandlesDiv.style.transform=n.multiplyByM(this._genRenderer.Elm2ScrMatrix).toCSS(),Q.HandlesDiv.style.transform="top left"}updateWindowPositionProperties(e){e.Form_PositionX=this.PositionX,e.Form_PositionY=this.PositionY,e.Form_Width=this.Width,e.Form_Height=this.Height}touchStartCapture(e,t){e.touches.length==1&&(this.handleMouseStartCapture(e.touches[0].pageX,e.touches[0].pageY,t),e.preventDefault())}mouseStartCapture(e,t){e.button==0&&this.handleMouseStartCapture(e.pageX,e.pageY,t)}handleMouseStartCapture(e,t,i){this.resizeCaptureOriginalMatrix=this._genRenderer.Scr2ElmMatrix,this.resizeCaptureOriginalMatrixInv=this._genRenderer.Elm2ScrMatrix;let r=this.resizeCaptureOriginalMatrix.multiplyByV(Ut.FromXYCoord(e,t)).toPoint();this.resizeCaptureRunning=!0,this.resizeCaptureXOrigine=r.X,this.resizeCaptureYOrigine=r.Y,this.resizeCaptureOriginalLeft=this.UIContainer.offsetLeft,this.resizeCaptureOriginalTop=this.UIContainer.offsetTop,this.resizeCaptureOriginalWidth=this.UIContainer.offsetWidth,this.resizeCaptureOriginalHeight=this.UIContainer.offsetHeight,this.resizeCaptureHandleIndex=i,Q.editHandles[this.resizeCaptureHandleIndex].active=!0,this.previousTRansform=Q.HandlesDiv.style.transform}touchCaptureRun(e){e.touches.length==1&&(this.handleCaptureRun(e.touches[0].pageX,e.touches[0].pageY),e.preventDefault())}mouseCaptureRun(e){this.handleCaptureRun(e.pageX,e.pageY)}handleCaptureRun(e,t){if(!this.resizeCaptureRunning)return;let i=this.resizeCaptureOriginalMatrix.multiplyByV(Ut.FromXYCoord(e,t)).toPoint(),r=i.X-this.resizeCaptureXOrigine,s=i.Y-this.resizeCaptureYOrigine,n=this.resizeCaptureOriginalLeft,o=this.resizeCaptureOriginalTop,a=this.resizeCaptureOriginalWidth,l=this.resizeCaptureOriginalHeight;switch(this.resizeCaptureHandleIndex){case 0:n+=r,o+=s,a-=r,l-=s;break;case 1:o+=s,l-=s;break;case 2:o+=s,a+=r,l-=s;break;case 3:a+=r;break;case 4:a+=r,l+=s;break;case 5:l+=s;break;case 6:n+=r,a-=r,l+=s;break;case 7:n+=r,a-=r;break;case 8:n+=r,o+=s;break}a<2*Q.HANDLESIZE&&(a=2*Q.HANDLESIZE),l<2*Q.HANDLESIZE&&(l=2*Q.HANDLESIZE),this.UIContainer.style.left=n.toString()+"px",this.UIContainer.style.top=o.toString()+"px",(this.resizeCaptureOriginalWidth!=a||this.resizeCaptureOriginalHeight!=l)&&this.resize(a-2,l-2),this._genRenderer.clearTransformationMatrix(),Q.HandlesDiv.style.width=a.toString()+"px",Q.HandlesDiv.style.height=l.toString()+"px",Q.HandlesDiv.style.left="0px",Q.HandlesDiv.style.top="0px";let h=this.resizeCaptureOriginalMatrixInv,u=Yt.newTranslateMatrix(n-this.resizeCaptureOriginalLeft,o-this.resizeCaptureOriginalTop),_=parseFloat(this.UIContainer.style.border),d=Yt.newTranslateMatrix(-_,-_);Q.HandlesDiv.style.transform=d.multiplyByM(h.multiplyByM(u)).toCSS()}editStopped(){this.resizeCaptureRunning=!1,Q.HandlesDiv!=null&&(Q.HandlesDiv.style.display="none")}touchCaptureStop(e){this.mouseCaptureStop(null)}mouseCaptureStop(e){this.resizeCaptureRunning&&(this.resizeCaptureRunning=!1,Q.editHandles[this.resizeCaptureHandleIndex].active=!1,(this.previousTRansform!=Q.HandlesDiv.style.transform||this.resizeCaptureOriginalWidth!=this.UIContainer.offsetWidth||this.resizeCaptureOriginalHeight!=this.UIContainer.offsetHeight)&&(this._SizeIsRelative&&this.updateRelativeSize(),S.edited=!0),this.refreshProperties())}resize(e,t){this.UIContainer.style.width=e.toString()+"px",this.UIContainer.style.height=t.toString()+"px",this.containerResized()}containerResized(){}getContentsConfigData(){return"  <location x='"+this.UIContainer.offsetLeft.toString()+"' y='"+this.UIContainer.offsetTop.toString()+`'/>
  <size     w='`+this.UIContainer.offsetWidth.toString()+"' h='"+this.UIContainer.offsetHeight.toString()+`'  state='Normal'/>
  <relativeCoord x='`+this._relativePositionX.toString()+"' y='"+this._relativePositionY.toString()+"' w='"+this._relativeWidth.toString()+"' h='"+this._relativeHeight.toString()+"' active='"+(this._SizeIsRelative?"True":"False")+`'/>
  <container id='`+S.XMLquote(this._containerID)+`'/>
`+this.getPropertiesXml()}getPropertiesXml(){return""}PatchSensorAnnotationCallback(e,t){let i="None",r="N/A",s="N/A",n="N/A",o="";if(!(e instanceof Ae)){let a=-Math.round(Math.log10(e.get_resolution()));i=e.get_friendlyName(),e.isOnline()&&(r=e.get_lastAvgValue().toFixed(a),s=e.get_lastMinValue().toFixed(a),n=e.get_lastMaxValue().toFixed(a)),o=e.get_unit()}return t=t.replace("$NAME$",i),t=t.replace("$AVGVALUE$",r),t=t.replace("$MAXVALUE$",n),t=t.replace("$MINVALUE$",s),t=t.replace("$UNIT$",o),t}};m(Q,"YWidget");var Tt=Q;Tt.HANDLESIZE=Math.round(20*(1+2*(S.guiDPIFactor-1)));Tt.editHandles=[];Tt.currentEdited=null;var pr=class pr extends Tt{getPropertiesXml(){return this.prop.getXml(1)}containerResized(){this._gauge!=null&&this._gauge.containerResized()}destroy(){this.prop.destroy(),super.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}contextMenuIsOpening(){O.snapshotMenuItem.userdata=this,O.snapshotMenuItem.visible=!0,O.resetDataViewMenuItem.visible=!1,O.editMenuItem!=null&&(O.clearDataloggerMenuItem.visible=!0,O.editMenuItem.caption="Configure this gauge",O.editMenuItem.visible=!0,O.deleteMenuItem.caption="Delete this gauge",O.deleteMenuItem.visible=!0,O.addMarkerMenuItem.visible=!1,O.disableMarkerMenuItem.visible=!1,O.editMenuItem.userdata=this,O.deleteMenuItem.userdata=this)}get confirmDeleteString(){return"Do you really want to delete this gauge ?"}AnnotationCallback(e){let t=this.prop.DataSource_source;return this.PatchSensorAnnotationCallback(t,e)}constructor(e,t,i,r,s,n){super(e,t,i,r,s,n),this._gauge=new ri(this.UIContainer,ri.DisplayMode.DISPLAY90,Tt.log),this._genRenderer=this._gauge,this.noDataSourcepanel=this._gauge.addMessagePanel(),this.noDataSourcepanel.font.size=S.generalFontSize,this.noDataSourcepanel.text=`No data source configured
 1 - Make sure you have a Yoctopuce sensor connected.
 2 - Do a right-click or a long touch on this widget.
 3 - Choose "Configure this gauge" to bring up the properties editor.
 4 - Choose a data source
`,this.prop=new Ps(e,this),this._genProp=this.prop;let o=de.getAllProperties(this.prop);if(pr.AnnotationPanelCount==0)for(let a in o.byName)a.startsWith("SolidGauge_annotationPanel")&&pr.AnnotationPanelCount++;for(let a=0;a<pr.AnnotationPanelCount;a++)this._gauge.addAnnotationPanel();this._gauge.setPatchAnnotationCallback(a=>this.AnnotationCallback(a)),this._gauge.valueFormater=(a,l)=>this.valueFormater(a,l),this.updateWindowPositionProperties(this.prop),this.prop.ApplyAllProperties(this),W.minMaxCheckDisabled=!0,this.prop.ApplyAllProperties(this._gauge),W.minMaxCheckDisabled=!1,this._gauge.resetRefrenceSize(),this._gauge.resizeRule=Be.ResizeRule.RELATIVETOBOTH,this.ApplyRelativeSizeIfRequired(),this.SizeIsRelative&&this.refreshProperties(),this._gauge.AllowRedraw()}valueFormater(e,t){if(this.prop.DataSource_source instanceof Ae)return"N/A";if(!this.prop.DataSource_source.isOnline())return"OFFLINE";let i=this.prop.DataSource_precision,r=i.indexOf("."),s=0;r>=0&&(s=i.length-r-1);let n=this.prop.DataSource_source.get_unit();return t.toFixed(s)+n}PropertyChanged2(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":de.copyProperty_STT(this,this.prop,t.fullpropname,i);break;case"SolidGauge":de.copyProperty_STT(this._gauge,this.prop,t.fullpropname,i);break;case"DataSource":break}}Get_PropertyValue(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":return de.newGetProperty(this,this.prop,t.fullpropname,i,null);case"SolidGauge":return de.newGetProperty(this._gauge,this.prop,t.fullpropname,i,null)}return null}edit(){super.edit(),O.EditObject(this,this.prop,e=>{this.PropertyChanged2(e)},e=>this.Get_PropertyValue(e),()=>{this.editStopped()})}refreshProperties(){this.prop.RefreshAllProperties(this),this.prop.RefreshAllProperties(this._gauge),O.refreshPropertiesForm()}SourceChanged(e,t){this.noDataSourcepanel.enabled=e instanceof Ae,e instanceof Ae?this._gauge.value=0:e.registerCallback(this)}SensorValuecallback(e,t){this.prop!=null&&e==this.prop.DataSource_source&&(this._gauge.value=e.isOnline()?t.get_averageValue():0)}getConfigData(){return`<GaugeForm>
`+this.getContentsConfigData()+`</GaugeForm>
`}};m(pr,"gaugeWidget");var Hi=pr;Hi.AnnotationPanelCount=0;var Bi=class Bi extends Tt{getPropertiesXml(){return this.prop.getXml(1)}containerResized(){this._angularGauge!=null&&this._angularGauge.containerResized()}destroy(){this.prop.destroy(),super.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}AnnotationCallback(e){let t=this.prop.DataSource_source;return this.PatchSensorAnnotationCallback(t,e)}contextMenuIsOpening(){O.snapshotMenuItem.userdata=this,O.snapshotMenuItem.visible=!0,O.resetDataViewMenuItem.visible=!1,O.editMenuItem!=null&&(O.clearDataloggerMenuItem.visible=!1,O.editMenuItem.caption="Configure this gauge",O.editMenuItem.visible=!0,O.deleteMenuItem.caption="Delete this gauge",O.deleteMenuItem.visible=!0,O.addMarkerMenuItem.visible=!1,O.disableMarkerMenuItem.visible=!1,O.editMenuItem.userdata=this,O.deleteMenuItem.userdata=this)}get confirmDeleteString(){return"Do you really want to delete this gauge ?"}constructor(e,t,i,r,s,n){super(e,t,i,r,s,n),this._angularGauge=new ar(this.UIContainer,Tt.log),this._genRenderer=this._angularGauge,this.noDataSourcepanel=this._angularGauge.addMessagePanel(),this.noDataSourcepanel.font.size=S.generalFontSize,this.noDataSourcepanel.text=`No data source configured
 1 - Make sure you have a Yoctopuce sensor connected.
 2 - Do a right-click  or a long touch on this widget.
 3 - Choose "Configure this gauge" to bring up the properties editor.
 4 - Choose a data source
`,this.prop=new Ns(e,this),this._genProp=this.prop;let o=de.getAllProperties(this.prop);if(Bi.AnnotationPanelCount==0)for(let a in o.byName)a.startsWith("AngularGauge_annotationPanel")&&Bi.AnnotationPanelCount++,a.startsWith("AngularGauge_zone")&&Bi.zonesCount++;for(let a=0;a<Bi.zonesCount;a++)this._angularGauge.AddZone();for(let a=0;a<Bi.AnnotationPanelCount;a++)this._angularGauge.addAnnotationPanel();this._angularGauge.setPatchAnnotationCallback(a=>this.AnnotationCallback(a)),this.initDataNode=e,this.updateWindowPositionProperties(this.prop),this.prop.ApplyAllProperties(this),W.minMaxCheckDisabled=!0,this.prop.ApplyAllProperties(this._angularGauge),W.minMaxCheckDisabled=!1,this._angularGauge.resetRefrenceSize(),this._angularGauge.resizeRule=Be.ResizeRule.RELATIVETOBOTH,this.ApplyRelativeSizeIfRequired(),this.SizeIsRelative&&this.refreshProperties(),this._angularGauge.AllowRedraw()}PropertyChanged2(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":de.copyProperty_STT(this,this.prop,t.fullpropname,i);break;case"AngularGauge":de.copyProperty_STT(this._angularGauge,this.prop,t.fullpropname,i);break;case"DataSource":break}}Get_PropertyValue(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":return de.newGetProperty(this,this.prop,t.fullpropname,i,null);case"AngularGauge":return de.newGetProperty(this._angularGauge,this.prop,t.fullpropname,i,null)}return null}edit(){super.edit(),O.EditObject(this,this.prop,e=>{this.PropertyChanged2(e)},e=>this.Get_PropertyValue(e),()=>{this.editStopped()})}refreshProperties(){this.prop.RefreshAllProperties(this),this.prop.RefreshAllProperties(this._angularGauge),O.refreshPropertiesForm()}showStatus(e){e!=""&&(this._angularGauge.value=0),this._angularGauge.showNeedle=e=="",this._angularGauge.statusLine=e}SourceChanged(e,t){this._angularGauge.DisableRedraw(),this.noDataSourcepanel.enabled=e instanceof Ae,e instanceof Ae?(this.showStatus("N/A"),this._angularGauge.unit=""):e.isOnline()?(this.showStatus(""),this._angularGauge.unit=e.get_unit()):this.showStatus("OFFLINE"),this._angularGauge.AllowRedraw(),e.registerCallback(this)}SensorValuecallback(e,t){this.prop!=null&&e==this.prop.DataSource_source&&(this._angularGauge.DisableRedraw(),this.prop.DataSource_source instanceof Ae?(this.showStatus("N/A"),this._angularGauge.unit=""):this.prop.DataSource_source.isOnline()?(this._angularGauge.DisableRedraw(),this.showStatus(""),this._angularGauge.unit=e.get_unit(),this._angularGauge.value=t.get_averageValue(),this._angularGauge.AllowRedraw()):this.showStatus("OFFLINE"),this._angularGauge.AllowRedraw())}getConfigData(){return`<angularGaugeForm>
`+this.getContentsConfigData()+`</angularGaugeForm>
`}};m(Bi,"angularGaugeWidget");var vi=Bi;vi.AnnotationPanelCount=0;vi.zonesCount=0;var mr=class mr extends Tt{getPropertiesXml(){return this.prop.getXml(1)}containerResized(){this._display!=null&&this._display.containerResized()}destroy(){this.prop.destroy(),super.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}AnnotationCallback(e){let t=this.prop.DataSource_source;return this.PatchSensorAnnotationCallback(t,e)}contextMenuIsOpening(){O.snapshotMenuItem.userdata=this,O.snapshotMenuItem.visible=!0,O.resetDataViewMenuItem.visible=!1,O.editMenuItem!=null&&(O.clearDataloggerMenuItem.visible=!1,O.editMenuItem.caption="Configure this digital display",O.editMenuItem.visible=!0,O.deleteMenuItem.caption="Delete this digital display",O.deleteMenuItem.visible=!0,O.addMarkerMenuItem.visible=!1,O.disableMarkerMenuItem.visible=!1,O.editMenuItem.userdata=this,O.deleteMenuItem.userdata=this)}get confirmDeleteString(){return"Do you really want to delete this digital display ?"}constructor(e,t,i,r,s,n){super(e,t,i,r,s,n),this._unit="",this._display=new di(this.UIContainer,Tt.log),this._genRenderer=this._display,this.noDataSourcepanel=this._display.addMessagePanel(),this.noDataSourcepanel.font.size=S.generalFontSize,this.noDataSourcepanel.text=`No data source configured
 1 - Make sure you have a Yoctopuce sensor connected.
 2 - Do a right-click  or a long touch on this widget.
 3 - Choose "Configure this digital display" to bring up the properties editor.
 4 - Choose a data source
`,this.prop=new Ls(e,this),this._genProp=this.prop;let o=de.getAllProperties(this.prop);if(mr.AnnotationPanelCount==0)for(let a in o.byName)a.startsWith("display_annotationPanel")&&mr.AnnotationPanelCount++;for(let a=0;a<mr.AnnotationPanelCount;a++)this._display.addAnnotationPanel();this._display.setPatchAnnotationCallback(a=>this.AnnotationCallback(a)),this._display.valueFormater=(a,l)=>this.valueFormater(a,l),this.updateWindowPositionProperties(this.prop),this.prop.ApplyAllProperties(this),W.minMaxCheckDisabled=!0,this.prop.ApplyAllProperties(this._display),W.minMaxCheckDisabled=!1,this._display.resetRefrenceSize(),this._display.AllowPrintScreenCapture=!0,this._display.resetRefrenceSize(),this._display.resizeRule=Be.ResizeRule.RELATIVETOBOTH,this.ApplyRelativeSizeIfRequired(),this.SizeIsRelative&&this.refreshProperties(),this._display.AllowRedraw()}valueFormater(e,t){if(this.prop.DataSource_source instanceof Ae)return"N/A";if(!this.prop.DataSource_source.isOnline())return"OFFLINE";let i=this.prop.DataSource_precision,r=i.indexOf("."),s=0;r>=0&&(s=i.length-r-1);let n=this.prop.DataSource_source.get_unit();return t.toFixed(s)+n}PropertyChanged2(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":de.copyProperty_STT(this,this.prop,t.fullpropname,i);break;case"display":de.copyProperty_STT(this._display,this.prop,t.fullpropname,i);break;case"DataSource":break}}Get_PropertyValue(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":return de.newGetProperty(this,this.prop,t.fullpropname,i,null);case"display":return de.newGetProperty(this._display,this.prop,t.fullpropname,i,null)}return null}edit(){super.edit(),O.EditObject(this,this.prop,e=>{this.PropertyChanged2(e)},e=>this.Get_PropertyValue(e),()=>{this.editStopped()})}refreshProperties(){this.prop.RefreshAllProperties(this),this.prop.RefreshAllProperties(this._display),O.refreshPropertiesForm()}SourceChanged(e,t){this.noDataSourcepanel.enabled=e instanceof Ae,this.SensorValuecallback(e,null),e instanceof Ae?this._display.alternateValue="N/A":e.isOnline()||(this._display.alternateValue="OFFLINE"),e.registerCallback(this)}SensorValuecallback(e,t){this.prop!=null&&(this.prop.DataSource_source instanceof Ae?this._display.alternateValue="N/A":this.prop.DataSource_source.isOnline()?t==null?this._display.alternateValue="--"+this._unit:e==this.prop.DataSource_source&&(this._display.DisableRedraw(),this._display.alternateValue=null,this._display.value=t.get_averageValue(),this._display.AllowRedraw()):this._display.alternateValue="OFFLINE")}getConfigData(){return`<digitalDisplayForm>
`+this.getContentsConfigData()+`</digitalDisplayForm>
`}};m(mr,"digitalDisplayWidget");var Gi=mr;Gi.AnnotationPanelCount=0;var Pe=class Pe extends Tt{AnnotationCallback(e){for(let t=0;t<Pe.SeriesCount;t++){let i=Reflect.get(this.prop,"Graph_series"+t.toString()),r=i.DataSource_source,s="None",n="N/A",o="N/A",a="N/A",l="";if(!(r instanceof Ae)){let h=-Math.round(Math.log10(r.get_resolution()));s=i.legend!=""?i.legend:r.get_friendlyName(),r.isOnline()&&(n=r.get_lastAvgValue().toFixed(h),o=r.get_lastMinValue().toFixed(h),a=r.get_lastMaxValue().toFixed(h)),l=r.get_unit()}e=e.replace("$NAME"+(t+1).toString()+"$",s),e=e.replace("$AVGVALUE"+(t+1).toString()+"$",n),e=e.replace("$MAXVALUE"+(t+1).toString()+"$",a),e=e.replace("$MINVALUE"+(t+1).toString()+"$",o),e=e.replace("$UNIT"+(t+1).toString()+"$",l)}return e}destroy(){this.prop.destroy(),super.destroy(),Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}getPropertiesXml(){return this.prop.getXml(1)}containerResized(){this._graph!=null&&this._graph.containerResized()}contextMenuIsOpening(){if(O.snapshotMenuItem.userdata=this,O.snapshotMenuItem.visible=!0,O.resetDataViewMenuItem.visible=!0,O.resetDataViewMenuItem.userdata=this,O.editMenuItem!=null){O.clearDataloggerMenuItem.visible=!0,O.clearDataloggerMenuItem.userdata=this,O.editMenuItem.caption="Configure this graph",O.editMenuItem.visible=!0,O.deleteMenuItem.caption="Delete this graph",O.deleteMenuItem.visible=!0,O.addMarkerMenuItem.visible=!0,O.disableMarkerMenuItem.visible=!0,O.editMenuItem.userdata=this,O.deleteMenuItem.userdata=this,O.disableMarkerMenuItem.userdata=this;for(let e=0;e<O.markersSubMenuItems.length;e++)O.markersSubMenuItems[e].caption="Place marker #"+(e+1).toString(),O.markersSubMenuItems[e].userdata=this}}startMarkerCapture(e){this.markers[e].startCapture()}AxisParamtersChangedAutomatically(e){let t=e.userData;t.visible=e.visible,O.refreshPropertiesForm()}get confirmDeleteString(){return"Do you really want to delete this graph ?"}constructor(e,t,i,r,s,n){super(e,t,i,r,s,n),this.editedMarkerWasEnabled=!1,this.editedMarkerPosition=0,this._graph=new Rt(this.UIContainer,Tt.log),this.noDataSourcepanel=this._graph.addMessagePanel(),this.noDataSourcepanel.font.size=S.generalFontSize,this.noDataSourcepanel.text=`No data source configured
 1 - Make sure you have a Yoctopuce sensor connected.
 2 - Do a right-click  or a long touch on this widget.
 3 - Choose "Configure this graph" to bring up the properties editor.
 4 - Choose a data source
`,this.dataloggerProgress=this._graph.addMessagePanel(),this.dataloggerProgress.font.size=12*S.guiDPIFactor,this.dataloggerProgress.font.color=c.DarkGray,this.dataloggerProgress.borderColor=c.Gray,this.dataloggerProgress.panelHrzAlign=Ve.HorizontalAlignPos.LEFT,this.dataloggerProgress.panelVrtAlign=Ve.VerticalAlignPos.TOP,this.dataloggerProgress.text=Pe.DataLoggerLoadingMsg,this.dataloggerProgress.enabled=!1,this.prop=new Fr(e,this),this._genProp=this.prop;let o=de.getAllProperties(this.prop);if(Pe.YAxisCount==0)for(let a in o.byName)a.startsWith("Graph_annotationPanel")&&Pe.AnnotationPanelCount++,a.startsWith("Graph_series")&&Pe.SeriesCount++,a.startsWith("Graph_yAxes")&&Pe.YAxisCount++;if(Pe.ZoneCountPerYaxis==0){let a=new Ji(0,!1),l=de.getAllProperties(a);for(let h in l.byName)h.startsWith("zones")&&Pe.ZoneCountPerYaxis++}if(Pe.MarkerCountPerXaxis==0){let a=new Qi,l=de.getAllProperties(a);for(let h in l.byName)h.startsWith("markers")&&Pe.MarkerCountPerXaxis++}this.offLineSourcesPanel=this._graph.addMessagePanel(),this.offLineSourcesPanel.bgColor=c.FromArgb(192,255,192,192),this.offLineSourcesPanel.borderColor=c.DarkRed,this.offLineSourcesPanel.font.color=c.DarkRed,this.offLineSourcesPanel.panelHrzAlign=Ve.HorizontalAlignPos.RIGHT,this.offLineSourcesPanel.panelVrtAlign=Ve.VerticalAlignPos.TOP,this.captureRunningPanel=this._graph.addMessagePanel(),this.captureRunningPanel.bgColor=c.FromArgb(240,200,255,193),this.captureRunningPanel.borderColor=c.DarkGreen,this.captureRunningPanel.font.color=c.DarkGreen,this.captureRunningPanel.panelHrzAlign=Ve.HorizontalAlignPos.LEFT,this.captureRunningPanel.panelVrtAlign=Ve.VerticalAlignPos.TOP;for(let a=0;a<Pe.YAxisCount;a++){let l=this._graph.addYAxis();for(let h=0;h<Pe.ZoneCountPerYaxis;h++)l.AddZone()}this.markers=[];for(let a=0;a<Pe.MarkerCountPerXaxis;a++){let l=this._graph.xAxis.AddMarker();l.xposition=he.ToUnixTime(new Date)+a*60,this.markers.push(l)}for(let a=0;a<Pe.AnnotationPanelCount;a++)this._graph.addAnnotationPanel();this.seriesProperties=[];for(let a=0;a<Pe.SeriesCount;a++)this.seriesProperties.push(Reflect.get(this.prop,"Graph_series"+a.toString())),this._graph.addSerie();this._graph.yAxes[0].visible=!0,this._graph.setPatchAnnotationCallback(a=>this.AnnotationCallback(a)),this._genRenderer=this._graph,this._graph.resetRefrenceSize(),this._graph.AllowPrintScreenCapture=!0,this._graph.setMarkerCaptureCallbacks(a=>{this.MarkedCaptureStarted(a)},a=>{this.MarkedCaptureStopped(a)}),this.offlineMessages=new Array(Pe.SeriesCount),this.showOffline=new Array(Pe.SeriesCount),this.updateWindowPositionProperties(this.prop),this.prop.ApplyAllProperties(this),W.minMaxCheckDisabled=!0,this.prop.ApplyAllProperties(this._graph),W.minMaxCheckDisabled=!1;for(let a=0;a<Pe.YAxisCount;a++)this._graph.yAxes[a].AxisChanged=()=>{this.AxisParamtersChangedAutomatically(this._graph.yAxes[a])},this._graph.yAxes[a].AllowAutoShow=!0;for(let a=0;a<Pe.SeriesCount;a++){let l=Reflect.get(this.prop,"Graph_series"+a.toString());l.Init(this,a),l.DataSource_source!=null&&this.SourceChanged(l.DataSource_source,a)}this._graph.resetRefrenceSize(),this._graph.resizeRule=Be.ResizeRule.FIXED,this.ApplyRelativeSizeIfRequired(),this.SizeIsRelative&&this.refreshProperties(),this.loadRecordedDataIfNeeded(),this._graph.AllowRedraw()}MarkedCaptureStarted(e){let t=e.text!=""?'Click to place the "'+e.shortText+'" marker.':"Click to place the marker.";t+=`
Right-click to cancel the operation.`,this.editedMarkerWasEnabled=e.enabled,this.editedMarkerPosition=e.positionOnXAxis.value,this.captureRunningPanel.text=t,this.captureRunningPanel.enabled=!0}MarkedCaptureStopped(e){e!=null&&this.editedMarkerWasEnabled!=e.enabled&&this.editedMarkerPosition!=e.positionOnXAxis.value&&(S.edited=!0),this.captureRunningPanel.enabled=!1,this.refreshProperties()}refreshProperties(){this.prop.RefreshAllProperties(this),this.prop.RefreshAllProperties(this._graph),O.refreshPropertiesForm()}decomposeToSegments(e,t,i){let r=t,s=0,n=[],o=0;for(;r<t+i-1;){try{o=e[r+1].DateTime-e[r].DateTime}catch(l){debugger}for(s=r+1;s<i&&e[s].DateTime-e[s-1].DateTime<2*o;)s++;let a=s-r;if(a>0){let l=new Array(a);for(let h=0;h<a;h++)l[h]=new ot(e[r+h].DateTime,e[r+h].value);n.push(l)}r=s}return n}SourceChanged(e,t){this._graph.DisableRedraw();let i,r=!0;for(let s=0;s<Pe.SeriesCount;s++)i=Reflect.get(this.prop,"Graph_series"+s.toString()),i.DataSource_source instanceof Ae||(r=!1);this.noDataSourcepanel.enabled=r,e!=null?e instanceof Ae?this.showOffline[t]=!1:e.isOnline()?this.showOffline[t]=!1:(this.offlineMessages[t]=e.get_friendlyName()+" is OFFLINE",this.showOffline[t]=!0,Z.log(e.get_friendlyName()+" is OFFLINE")):this.showOffline[t]=!1,this.updateOfflinePanel(),this.preLoadSensorData(e,t),this.loadRecordedDataIfNeeded(),e&&e.registerCallback(this),this._graph.AllowRedraw()}SensorArrivalcallback(e){this.loadRecordedDataIfNeeded();for(let t=0;t<Pe.SeriesCount;t++){let i=this.seriesProperties[t];i.DataSource_source==e&&(i.DataSource_source.isOnline()?this.showOffline[t]=!1:this.showOffline[t]=!0)}this.updateOfflinePanel()}preLoadSensorData(e,t){if(e instanceof Ae){this._graph.series[t].clear();return}let i=Reflect.get(this.prop,"Graph_series"+t.toString()),r;switch(i.DataSource_datatype){case 1:r=e.minData;break;case 2:r=e.maxData;break;default:r=e.curData;break}let s=this.decomposeToSegments(r,0,r.length);this._graph.series[t].clear();for(let n=s.length-1;n>=0;n--)this._graph.series[t].InsertPoints(s[n]);this._graph.series[t].rebuildSummaries()}PropertyChanged2(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":de.copyProperty_STT(this,this.prop,t.fullpropname,i);break;case"Graph":de.copyProperty_STT(this._graph,this.prop,t.fullpropname,i);break;case"DataSource":break}}Get_PropertyValue(e){let t=new li,i=e.ExtractPropPath(t);switch(t.propType){case"Form":return de.newGetProperty(this,this.prop,t.fullpropname,i,null);case"Graph":return de.newGetProperty(this._graph,this.prop,t.fullpropname,i,null);case"DataSource":return null}return null}edit(){super.edit(),O.EditObject(this,this.prop,e=>{this.PropertyChanged2(e)},e=>this.Get_PropertyValue(e),()=>{this.editStopped()})}updateOfflinePanel(){let e="";for(let t=0;t<Pe.SeriesCount;t++)this.showOffline[t]&&(e=e+(e!=""?`
`:"")+this.offlineMessages[t]);e==""&&this.offLineSourcesPanel.enabled&&(this.offLineSourcesPanel.enabled=!1),e!=""&&(this.offLineSourcesPanel.text!=e||!this.offLineSourcesPanel.enabled)&&(this.offLineSourcesPanel.text=e,this.offLineSourcesPanel.enabled=!0)}SensorValuecallback(e,t){if(this.prop!=null)for(let i=0;i<Pe.SeriesCount;i++){let r=this.seriesProperties[i];if(r.DataSource_source==e){if(!r.DataSource_source.isOnline()){this.offlineMessages[i]=r.DataSource_source.get_friendlyName()+" is OFFLINE",this.showOffline[i]=!0,this.updateOfflinePanel();return}this.showOffline[i]=!1,this.updateOfflinePanel();let s=r.DataSource_source.curData.length-1;if(s>=0)switch(r.DataSource_datatype){case 1:this._graph.series[i].AddPoint(new ot(r.DataSource_source.minData[s].DateTime,r.DataSource_source.minData[s].value));break;case 2:this._graph.series[i].AddPoint(new ot(r.DataSource_source.maxData[s].DateTime,r.DataSource_source.maxData[s].value));break;default:this._graph.series[i].AddPoint(new ot(r.DataSource_source.curData[s].DateTime,r.DataSource_source.curData[s].value));break}this._graph.series[i].unit=r.DataSource_source.get_unit()}}}disableAllMarkers(){pi.ask("Do you really want to disable all markers?",()=>{for(let e=0;e<this.markers.length;e++)this.markers[e].enabled=!1},()=>{},null)}clearDataLogger(){pi.ask("Do you really want to erase contents of all dataloggers related to this graph?",()=>{this.startToClearDataLoggers()},()=>{},null)}truncateView(){for(let t=0;t<Pe.SeriesCount;t++)this._graph.series[t].clear();let e=Math.floor(new Date().getTime()/1e3);this._graph.xAxis.set_minMax(e,e+this._graph.xAxis.initialZoom)}resetDataView(){this.prop.Graph_showRecordedData=!1,this.truncateView()}startToClearDataLoggers(){return Wl(this,void 0,void 0,function*(){let e=[];for(let i=0;i<Pe.SeriesCount;i++){let s=Reflect.get(this.prop,"Graph_series"+i.toString()).DataSource_source;if(!(s instanceof Ae)){s.stopDataloggerloading();let n=s.get_hardwareId(),o=n.indexOf(".");n=n.substring(0,o);let a=yield Re.FindDataLogger(n+".dataLogger");if(yield a.isOnline()){let l=!1;for(let h=0;h<e.length;h++)e[h]==a&&(l=!0);l||e.push(a)}}}for(let i=0;i<e.length;i++)yield e[i].forgetAllDataStreams(),yield e[i].set_recording(Re.RECORDING_ON);let t=this.prop.Graph_showRecordedData;this.prop.Graph_showRecordedData=!1,this.truncateView(),this.prop.Graph_showRecordedData=t})}dataLoggerLoadprocessIsRunningNotification(e){let t=0,i=0;if(!this.prop.Graph_showRecordedData)return;for(let s=0;s<Pe.SeriesCount;s++){let o=Reflect.get(this.prop,"Graph_series"+s.toString()).DataSource_source;o.dataloggerLoadisRunning&&(t+=o.dataloggerLoadProgress,i++)}i>0&&(this.dataloggerProgress.text=Pe.DataLoggerLoadingMsg+" ("+(t/i).toFixed(0)+"%)");let r=i>0&&t>0&&t<i*100;this.dataloggerProgress.enabled=r}SensorNewDataBlock(e,t,i,r,s){if(this.prop==null||s&&!this.prop.Graph_showRecordedData)return;let n=null;for(let o=0;o<Pe.SeriesCount;o++){let a=Reflect.get(this.prop,"Graph_series"+o.toString());if(a.DataSource_source==e){let l=i-t+1;if(l>1)switch(a.DataSource_datatype){case 1:n=this.decomposeToSegments(a.DataSource_source.minData,t,l);for(let h=n.length-1;h>=0;h--)this._graph.series[o].InsertPoints(n[h]);break;case 2:n=this.decomposeToSegments(a.DataSource_source.maxData,t,l);for(let h=n.length-1;h>=0;h--)this._graph.series[o].InsertPoints(n[h]);break;default:n=this.decomposeToSegments(a.DataSource_source.curData,t,l);for(let h=n.length-1;h>=0;h--)this._graph.series[o].InsertPoints(n[h]);break}this._graph.series[o].unit=e.get_unit()}}}loadRecordedDataIfNeeded(){if(this.prop!=null&&this.prop.Graph_showRecordedData)for(let e=0;e<Pe.SeriesCount;e++)Reflect.get(this.prop,"Graph_series"+e.toString()).DataSource_source.startDataloggerload(this)}removeDataloggerData(){}DataloggerCompleted(e){if(!this.prop.Graph_showRecordedData)return;let t=de.getAllProperties(this.prop);for(let i=0;i<this.seriesProperties.length;i++)this.seriesProperties[i].DataSource_source==e&&(this.seriesProperties[i].dataloggerAlreadyLoaded||(this._graph.DisableRedraw(),this.preLoadSensorData(e,i),this._graph.AllowRedraw()))}getConfigData(){return`<GraphForm>
`+this.getContentsConfigData()+`</GraphForm>
`}};m(Pe,"graphWidget");var gt=Pe;gt.AnnotationPanelCount=0;gt.SeriesCount=0;gt.ZoneCountPerYaxis=0;gt.MarkerCountPerXaxis=0;gt.YAxisCount=0;gt.DataLoggerLoadingMsg="Loading from datalogger";var Vr=class Vr{constructor(e){this.node=e}get Name(){return this.node.nodeName}get_childsByName(){let e={};return this.node.childNodes.forEach(t=>{e[t.nodeName]=new Vr(t)}),e}get_childsByIndex(){let e=[];return this.node.childNodes.forEach(t=>{e.push(new Vr(t))}),e}get_attributes(){let e=this.node,t={},i=e.getAttributeNames();for(let r=0;r<i.length;r++)t[i[r]]=e.getAttribute(i[r]);return t}get Attributes(){return this.get_attributes()}};m(Vr,"YXmlNode");var mi=Vr,Sa=class Sa{constructor(){this.ttype="",this.stype="",this.finalTarget=null,this.terminalSource=null,this.propertyName=null}};m(Sa,"PropertyAccess");var Ys=Sa,Ms=class Ms{constructor(e){if(this._value=Number.NaN,typeof e!="undefined")if(typeof e=="number")this._value=e;else if(typeof e=="string")e==""?this._value=Number.NaN:this._value=Number(e);else debugger}toString(){return Number.isNaN(this._value)?"":this._value.toString()}clone(){return new Ms(this.value)}get value(){return this._value}set value(e){this._value=e}};m(Ms,"doubleNan");var et=Ms,Ca=class Ca{constructor(e){this.isWritable=!1,this.isEnum=!1,this.type="",this.Attributes={},this.name=e}};m(Ca,"PropertyDescriptor");var ba=Ca,Ta=class Ta{constructor(){this.byIndex=[],this.byName={}}};m(Ta,"PropertiesList");var ya=Ta,xa=class xa{constructor(e,t){this.name=e,this.prop=t}};m(xa,"PropDescription");var Aa=xa,Ue=class Ue{static NoFilter(e){return!0}static escapeXml(e){return e.replace(/[^ !#$%(-;=?-z]/g,t=>"&#"+t.charCodeAt(0)+";")}constructor(e){this._Form_Text="New window",this._Form_BackColor=c.FromArgb(255,240,240,240),this._Form_BorderColor=c.LightGray,this._SizeIsRelative=!1,this._Form_PositionX=0,this._Form_PositionY=0,this._Form_Width=300,this._Form_Height=200,this._containerID="",this.ownerForm=e,this._Form_Text="new window"}destroy(){Object.entries(this).forEach(e=>{Reflect.set(this,e[0],null)})}initFromXmlData(e){e!=null&&this.loadProperties(e,this.ownerForm,this)}loadProperties(e,t,i){let r;if(this.ownerForm=t,e!=null){let s=Ue.getAllProperties(i),n=e.get_childsByName();for(let o in s.byName){let a=s.byName[o];if(a.isWritable){for(let l in n)if(l==o){let h=Reflect.get(i,o),u=!0;if("NotSavedInXMLAttribute"in a.Attributes&&(u=a.Attributes.NotSavedInXMLAttribute),u)if(Ue.IsStructured(h))this.loadProperties(n[l],t,h);else{let _=typeof h,d=n[l].get_attributes(),g=d.value;if(h instanceof st)if(g.toUpperCase()!="NULL"&&g!=""){let y=oe.AddNewSensor(g);Reflect.set(i,o,y)}else Reflect.set(i,o,oe.getNullSensor());else if(h instanceof De)Reflect.set(i,o,h.fromString(g));else if(h instanceof et){let y=new et(g);Reflect.set(i,o,y)}else if(h instanceof _t){let y=Number(g),p=d.relative.toUpperCase()=="TRUE";Reflect.set(i,o,new _t(y,p))}else if(h instanceof c){let y=c.FromString(g);y==null&&(y=c.Black),Reflect.set(i,o,y.clone())}else if(h instanceof it){let y=d.size,p=d.color,x=d.italic,w=d.bold,f=Reflect.get(i,o);f.name=g,f.size=y!=="undefined"?Number(y):10;let T=c.FromString(p);f.color=T!=null?T:c.Black.clone(),f.italic=x.toUpperCase()=="TRUE",f.bold=w.toUpperCase()=="TRUE"}else switch(_){case"string":Reflect.set(i,o,g);break;case"number":Reflect.set(i,o,Number(g));break;case"boolean":let y=g.toUpperCase()=="TRUE";Reflect.set(i,o,y);break;default:debugger;throw"unhandled target type : "+_+"("+h.constructor.name+")"}}}}}}}get ATTR_Form_Text__DisplayName(){return"Window title"}get ATTR_Form_Text__CategoryAttribute(){return"Window"}get ATTR_Form_Text__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_Form_Text__DescriptionAttribute(){return"Widget name. This name is not show on display, but it might help you to identify each widget. "}get Form_Text(){return this._Form_Text}set Form_Text(e){this._Form_Text=e}get ATTR_Form_BackColor__DisplayName(){return"Background color"}get ATTR_Form_BackColor__CategoryAttribute(){return"Window"}get ATTR_Form_BackColor__DescriptionAttribute(){return"Window background color."}get Form_BackColor(){return this._Form_BackColor}set Form_BackColor(e){this._Form_BackColor=e}get ATTR_Form_BorderColor__DisplayName(){return"Border color"}get ATTR_Form_BorderColor__CategoryAttribute(){return"Window"}get ATTR_Form_BorderColor__DescriptionAttribute(){return"Window border color, use transparent color to hide the border."}get Form_BorderColor(){return this._Form_BorderColor}set Form_BorderColor(e){this._Form_BorderColor=e}get ATTR_Form_SizeIsRelative__NotSavedInXMLAttribute(){return!0}get ATTR_Form_SizeIsRelative__DisplayName(){return"Rel. size and pos."}get ATTR_Form_SizeIsRelative__CategoryAttribute(){return"Window"}get ATTR_Form_SizeIsRelative__DescriptionAttribute(){return"Makes widget size and position relative to container size. This, for instance, allows to make a widget automatically occupy all of the browser viewport, no matter the browser window size. In relative mode, position and size value are expressed in %"}get ATTR_Form_SizeIsRelative__ChangeCausesParentRefreshAttribute(){return!0}get Form_SizeIsRelative(){return this._SizeIsRelative}set Form_SizeIsRelative(e){this._SizeIsRelative=e}get ATTR_Form_PositionX__NotSavedInXMLAttribute(){return!0}get ATTR_Form_PositionX__DisplayName(){return"Left"}get ATTR_Form_PositionX__CategoryAttribute(){return"Window"}get ATTR_Form_PositionX__DescriptionAttribute(){return"Widget left border X position"}get Form_PositionX(){return this._Form_PositionX}set Form_PositionX(e){this._Form_PositionX=e}get ATTR_Form_PositionY__NotSavedInXMLAttribute(){return!0}get ATTR_Form_PositionY__DisplayName(){return"Top"}get ATTR_Form_PositionY__CategoryAttribute(){return"Window"}get ATTR_Form_PositionY__DescriptionAttribute(){return"Widget top border Y position"}get Form_PositionY(){return this._Form_PositionY}set Form_PositionY(e){this._Form_PositionY=e}get ATTR_Form_Width__NotSavedInXMLAttribute(){return!0}get ATTR_Form_Width__DisplayName(){return"Width"}get ATTR_Form_Width__CategoryAttribute(){return"Window"}get ATTR_Form_Width__DescriptionAttribute(){return"Widget width"}get Form_Width(){return this._Form_Width}set Form_Width(e){this._Form_Width=e}get ATTR_Form_Height__NotSavedInXMLAttribute(){return!0}get ATTR_Form_Height__DisplayName(){return"Height"}get ATTR_Form_Height__CategoryAttribute(){return"Window"}get ATTR_Form_Height__DescriptionAttribute(){return"Widget height"}get Form_Height(){return this._Form_Height}set Form_Height(e){this._Form_Height=e}get ATTR_Form_containerID__NotSavedInXMLAttribute(){return!0}get ATTR_Form_containerID__DisplayName(){return"Container ID"}get ATTR_Form_containerID__CategoryAttribute(){return"Window"}get ATTR_Form_containerID__DescriptionAttribute(){return"Forces the widget to be shown inside an HTML element with a specific ID already present on the page. If ID is empty, the widget is inserted at root level. Be aware that X,Y offsets are kept, you may want to set them to Zero. "}get Form_containerID(){return this._containerID}set Form_containerID(e){this._containerID=e}indent(e){return" ".repeat(e)}getXml(e,t){typeof t=="undefined"&&(t=this);let i="",r="",s=Ue.getAllProperties(t),n="";for(n in s.byName){let o=s.byName[n];if(o.isWritable){let a=!0;"NotSavedInXMLAttribute"in o.Attributes&&(a=!o.Attributes.NotSavedInXMLAttribute);let l=Reflect.get(t,o.name);if(Ue.IsStructured(l))a&&(i=i+this.indent(2*e)+"<"+o.name+`>\r
`+this.getXml(e+1,l)+this.indent(2*e)+"</"+o.name+`>\r
`);else if(a){if(l instanceof De)r=l.toString;else{let h=typeof l;switch(h=="object"&&(h=l.constructor.name),h){case"boolean":r=l?"TRUE":"FALSE";break;case"number":r=l.toString();break;case"string":r=de.escapeXml(l);break;case c.name:r=l.toString();break;case et.name:r=l.value.toString();break;case _t.name:let u=l;r=u.value.toString()+'" relative="'+(u.relative?"True":"False");break;case Ae.name:case st.name:let _=l;r=_==null||_ instanceof Ae?"NULL":_.get_hardwareId();break;default:throw"XML generation : unhandled type ("+o.type+")"}}i=i+this.indent(2*e)+"<"+o.name+' value="'+r+`"/>
`}}}return i}static IsStructured(e){return e==null||typeof e=="string"||e instanceof String||typeof e=="number"||e instanceof Number||typeof e=="boolean"||e instanceof Boolean||e instanceof De||e instanceof st||e instanceof c||e instanceof et||e instanceof _t?!1:Object.getOwnPropertyNames(e).length>0}static getObjectFromPath(e,t){let i=e;for(let r=0;r<t.length-1;r++){let s=t[r],n="";for(;s.charCodeAt(s.length-1)>=48&&s.charCodeAt(s.length-1)<=57;)n=s.charAt(s.length-1)+n,s=s.substring(0,s.length-1);if(n=="")i=Reflect.get(i,s);else{let o=Reflect.get(i,s);i=Reflect.get(o,parseInt(n))}}return i}static computePropertyAccess_SFT(e,t,i,r){let s=new Ys;s.ttype="",s.stype="",s.finalTarget=null,s.terminalSource=null,s.terminalSource=Ue.getObjectFromPath(e,r);let n=Ue.getAllProperties(s.terminalSource);if(!(r[r.length-1]in n.byName)||(s.stype=typeof s.terminalSource[r[r.length-1]],s.stype=="object"&&s.terminalSource[r[r.length-1]]!=null&&(s.stype=s.terminalSource[r[r.length-1]].constructor.name),s.terminalSource=s.terminalSource[r[r.length-1]],s.terminalSource==null))return s;s.propertyName=i,s.finalTarget=t;let o=s.finalTarget[i];if(s.ttype=typeof o,s.ttype=="object"&&o!=null&&(s.ttype=o.constructor.name),r.length<=1)return s;for(let a=1;a<r.length;a++)s.finalTarget=s.finalTarget[s.propertyName],s.propertyName=r[a];return s.ttype=typeof s.finalTarget[s.propertyName],s.ttype=="object"&&s.finalTarget[s.propertyName]!=null&&(s.ttype=s.finalTarget[s.propertyName].constructor.name),s}static Reflect_getIndexed(e,t){let i=Reflect.get(e,t);if(typeof i!="undefined")return i;let r=t,s="";for(;r.charCodeAt(r.length-1)>=48&&r.charCodeAt(r.length-1)<=57;)s=r.charAt(r.length-1)+s,r=r.substring(0,r.length-1);return s==""?null:(i=Reflect.get(e,r),Reflect.get(i,parseInt(s)))}static computePropertyAccess(e,t,i,r){let s=new Ys;s.ttype="",s.finalTarget=Ue.getObjectFromPath(e,r),s.terminalSource=t,s.terminalSource=Reflect.get(s.terminalSource,i);for(let n=1;n<r.length;n++)s.terminalSource=Reflect.get(s.terminalSource,r[n]);if(s.stype=typeof s.terminalSource,s.stype=="object"&&(s.stype=s.terminalSource.constructor.name),r.length>0){s.propertyName=r[r.length-1];let n=Ue.Reflect_getIndexed(e,r[0]);if(n==null)return null;for(let o=1;o<r.length;o++)try{n=Ue.Reflect_getIndexed(n,r[o])}catch(a){debugger}s.ttype=typeof n,s.ttype=="object"&&(s.ttype=n.constructor.name)}else{let n=i,o=n.indexOf("__");s.propertyName=n.substring(o+2);let a=Reflect.get(e,s.propertyName);s.ttype=typeof a,s.ttype=="object"&&(s.ttype=a.constructor.name)}return s}static newGetProperty(e,t,i,r,s){let n=Ue.computePropertyAccess(e,t,i,r);return n==null?null:Reflect.get(n.finalTarget,n.propertyName)}static copyProperty_SFT(e,t,i,r,s){let n="",o="",a=null,l=Ue.computePropertyAccess_SFT(e,t,i,r);l.finalTarget!=null&&(n=l.ttype,o=l.stype,o==c.name&&n==c.name||o==_t.name&&n==_t.name?Reflect.set(l.finalTarget,l.propertyName,l.terminalSource.clone()):l.stype=="number"&&n==et.name?Reflect.set(l.finalTarget,l.propertyName,new et(l.terminalSource)):Reflect.set(l.finalTarget,l.propertyName,l.terminalSource))}static copyProperty_STT(e,t,i,r,s){let n=Ue.computePropertyAccess(e,t,i,r);if(n!=null)if(n.stype==et.name&&n.ttype=="number"){let o=n.terminalSource.value;Reflect.get(n.finalTarget,n.propertyName)!=o&&(Reflect.set(n.finalTarget,n.propertyName,o),S.edited=!0)}else if(n.stype!=n.ttype)debugger;else if(n.stype==c.name&&n.ttype==c.name){let o=n.terminalSource;o.equal(Reflect.get(n.finalTarget,n.propertyName))||(Reflect.set(n.finalTarget,n.propertyName,o.clone()),S.edited=!0)}else if(n.stype==et.name&&n.ttype==et.name){let o=n.terminalSource;Reflect.get(n.finalTarget,n.propertyName)!=o&&(Reflect.set(n.finalTarget,n.propertyName,o.clone()),S.edited=!0)}else if(n.stype==_t.name&&n.ttype==_t.name){let o=n.terminalSource,a=Reflect.get(n.finalTarget,n.propertyName);(o.relative!=a.relative||o.value!=a.value)&&(Reflect.set(n.finalTarget,n.propertyName,o.clone()),S.edited=!0)}else Reflect.get(n.finalTarget,n.propertyName)!=n.terminalSource&&(Reflect.set(n.finalTarget,n.propertyName,n.terminalSource),S.edited=!0)}ApplyAllProperties(e){this.ApplyAllPropertiesEx(e,Ue.NoFilter,0)}RefreshAllProperties(e){this.ApplyAllPropertiesEx(e,Ue.NoFilter,1)}ApplyProperties(e,t,i,r,s,n){if(r instanceof Jt)return;let o=Ue.getAllProperties(this);if(!("CopyToTarget"in o.byName[i].Attributes&&!o.byName[i].Attributes.CopyToTarget))if(!Ue.IsStructured(r))n==0?Ue.copyProperty_STT(t,this,i,s):Ue.copyProperty_SFT(t,this,i,s);else{let a=s.slice();a.push("");let l=Ue.getObjectFromPath(t,a);Reflect.set(l,"userData",r);let h=Ue.getAllProperties(r);for(let u in h.byName){let _=!0;"CopyToTarget"in h.byName[u].Attributes&&(_=h.byName[u].Attributes.CopyToTarget),h.byName[u].isWritable&&_&&(s.push(u),this.ApplyProperties(e,t,i,Reflect.get(r,u),s,n),s.splice(s.length-1,1))}}}static isProperty(e,t){let i=Reflect.getOwnPropertyDescriptor(e,t),r=Object.getOwnPropertyNames(i);for(let s=0;s<r.length;s++)if(r[s]=="set"||r[s]=="get")return!0;return!1}static isWritable(e,t){let i=Reflect.getOwnPropertyDescriptor(e,t),r=Object.getOwnPropertyNames(i);for(let s=0;s<r.length;s++)if(r[s]=="set"&&typeof i.set!="undefined")return!0;return!1}static getAllProperties(e){if(typeof e=="undefined")debugger;if(e.hasOwnProperty("PropertiesDescriptionCache"))return e.PropertiesDescriptionCache;let t=Object.getPrototypeOf(e),i=new ya,r=t,s=[],n=[];for(;r!=null;)n.push(r),r=Object.getPrototypeOf(r);for(let o=n.length-1;o>=0;o--){let a=Object.getOwnPropertyNames(n[o]),l=0;for(let h=0;h<a.length;h++)if(a[h]!="constructor"&&!a[h].startsWith("__")){s.splice(l,0,new Aa(a[h],n[o])),l++;for(let u=s.length-1;u>=l;u--)s[u].name==a[h]&&s.splice(u,1)}}for(let o=0;o<s.length;o++)if(!s[o].name.startsWith("ATTR")&&s[o].name!="constructor"&&!s[o].name.startsWith("__")&&Ue.isProperty(s[o].prop,s[o].name)){let a=new ba(s[o].name);i.byIndex.push(a),i.byName[a.name]=a,a.isWritable=Ue.isWritable(s[o].prop,s[o].name),a.isEnum=e[s[o].name]instanceof De,a.type=typeof e[s[o].name],a.type=="object"&&e[s[o].name]!=null&&(a.type=e[s[o].name].constructor.name)}for(let o=0;o<s.length;o++)if(s[o].name.startsWith("ATTR_")){let a=s[o].name.indexOf("__");if(a<5)debugger;let l=s[o].name.substring(5,a),h=s[o].name.substring(a+2);if(typeof i.byName[l]=="undefined")debugger;try{i.byName[l].Attributes[h]=Reflect.get(e,s[o].name)}catch(u){debugger}}return e.PropertiesDescriptionCache=i,i}ApplyAllPropertiesEx(e,t,i){let r=Ue.getAllProperties(this);for(let s in r.byName)if(r.byName[s].isWritable){let n=s.indexOf("_");if(n<0)throw"invalid Property name";let o=s.substring(0,n),a=s.substring(n+1),l=[];l.push(a),e instanceof Tt&&o=="Form"&&this.ApplyProperties(this,e,s,Reflect.get(this,s),l,i),e instanceof ar&&o=="AngularGauge"&&this.ApplyProperties(this,e,s,Reflect.get(this,s),l,i),e instanceof di&&o=="display"&&this.ApplyProperties(this,e,s,Reflect.get(this,s),l,i),e instanceof ri&&o=="SolidGauge"&&this.ApplyProperties(this,e,s,Reflect.get(this,s),l,i),e instanceof Rt&&o=="Graph"&&this.ApplyProperties(this,e,s,Reflect.get(this,s),l,i)}}};m(Ue,"GenericProperties");var de=Ue;de.XmlFileVersion=-1;var Da=class Da{};m(Da,"GenericHints");var vt=Da;vt.DevConfAffected=" Changing this value will affect the device configuration.";vt.CheckSensor="If the sensor you want to use is connected, but not listed or listed as OFFLINE, check USB / Network configuration in the global configuration.";vt.AnnotationGraph="Annotation text.  Use \\n for carriage returns. Some variables are available: $DAY$ $MONTH$ $YEAR$ for date, $HOUR$ $MINUTE$ $SECOND$ for time, $AVGVALUE1$ $MINVALUE1$ $MAXVALUE1$ $NAME1$ $UNIT1$  for first series data, $AVGVALUE2$ $MINVALUE2$ $MAXVALUE2$ $NAME2$ $UNIT2$  for second series data and so on";vt.Annotation="Annotation text.  Use \\n for carriage returns. Some variables are available: $DAY$ $MONTH$ $YEAR$ for date, $HOUR$ $MINUTE$ $SECOND$ for time, $AVGVALUE$ $MINVALUE$ $MAXVALUE$ $NAME$ $UNIT$ for sensor related data.";var Ia=class Ia{static get AllowedValues(){return[]}};m(Ia,"TypeDescription");var pl=Ia,va=class va{static get AllowedValues(){return this._AllowedValues}};m(va,"sensorFreqTypeDescription");var er=va;er._AllowedValues=["25/s","10/s","5/s","4/s","3/s","2/s","1/s","60/m","30/m","12/m","6/m","4/m","3/m","2/m","1/m","30/h","12/h","6/h","4/h","3/h","2/h","1/h"];var yr=class yr{static initialize(){let e=0,t=new Fr(null,null);Object.getOwnPropertyNames(t).forEach(r=>{r.startsWith("_Graph_yAxes")&&e++});for(let r=0;r<e;r++)switch(r){case 0:this._AllowedValues.push("1rst Y axis");break;case 1:this._AllowedValues.push("2nd Y axis");break;case 2:this._AllowedValues.push("3rd Y axis");break;default:this._AllowedValues.push((r+1).toString()+"th Y axis");break}yr.initialized=!0}static get AllowedValues(){return yr.initialized||yr.initialize(),this._AllowedValues}};m(yr,"yAxisDescription");var Fs=yr;Fs._AllowedValues=[];var Ea=class Ea{static get AllowedValues(){return this._AllowedValues}};m(Ea,"AlarmTestTypeDescription");var Vs=Ea;Vs._AllowedValues=["Disabled",">",">=","=","<=","<"];var ka=class ka{static fontNameTypeDescription(){}static get AllowedValues(){return this._AllowedValues}};m(ka,"fontNameTypeDescription");var zs=ka;zs._AllowedValues=["Arial","Brush Script MT","Comic Sans MS","Courier New","Garamond","Georgia","Helvetica","Impact","Tahoma","Times New Roman","Trebuchet MS","Verdana"];var Pa=class Pa{static get AllowedValues(){return this._AllowedValues}};m(Pa,"sensorPrecisionTypeDescription");var Ur=Pa;Ur._AllowedValues=["0","0.1","0.12","0.123"];var Na=class Na{static get AllowedValues(){return this._AllowedValues}};m(Na,"sensorDataTypeDescription");var Br=Na;Br._AllowedValues=["Avg values","Min values","Max values"];var La=class La extends de{constructor(e,t){super(t),this._DataSource_source=oe.getNullSensor(),this._DataSource_precision="0.1",this._DataSource_AlarmSection0=new Jt(0),this._DataSource_AlarmSection1=new Jt(1),this._SolidGauge_min=0,this._SolidGauge_max=100,this._SolidGauge_showMinMax=!0,this._SolidGauge_color1=c.LightGreen,this._SolidGauge_color2=c.Red,this._SolidGauge_font=new Et("Arial",20,c.Black,!1,!0),this._SolidGauge_minMaxFont=new Et("Arial",10,c.Black,!1,!0),this._SolidGauge_displayMode=ri.DisplayMode.DISPLAY90,this._SolidGauge_borderColor=c.Black,this._SolidGauge_borderThickness=2,this._SolidGauge_backgroundColor1=c.FromArgb(255,240,240,240),this._SolidGauge_backgroundColor2=c.FromArgb(255,200,200,200),this._SolidGauge_thickness=25,this._SolidGauge_maxSpeed=1,this._annotationPanels0=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.BOTTOM,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this._annotationPanels1=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.BOTTOM,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this.initFromXmlData(e),this.PropagateDataSourceChange()}PropagateDataSourceChange(){this.ownerForm.SourceChanged(this._DataSource_source,0);let e=de.getAllProperties(this).byName,t;for(t in e)t.startsWith("DataSource_AlarmSection")&&this[t].setDataSource(this._DataSource_source)}get ATTR_DataSource_source__DisplayName(){return"Sensor"}get ATTR_DataSource_source__CategoryAttribute(){return"Data source"}get ATTR_DataSource_source__ParamCategorySummaryAttribute(){return"sensorDescription"}get ATTR_DataSource_source__PreExpandedCategoryAttribute(){return!0}get ATTR_DataSource_source__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_DataSource_source__DescriptionAttribute(){return"Yoctopuce sensor feeding the gauge. "}get DataSource_source(){return this._DataSource_source}set DataSource_source(e){let t=this._DataSource_source;this._DataSource_source=e,this.PropagateDataSourceChange(),this._DataSource_source!=t&&(S.edited=!0)}get sensorDescription(){return this._DataSource_source instanceof Ae?"none":this._DataSource_source.get_friendlyName()}get isSensorReadOnly(){return this._DataSource_source.isReadOnly}get ATTR_DataSource_freq__DisplayName(){return"Sensor freq"}get ATTR_DataSource_freq__CategoryAttribute(){return"Data source"}get ATTR_DataSource_freq__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_freq__IsReadonlyCallAttribute(){return this.isSensorReadOnly}get ATTR_DataSource_freq__AllowedValues(){return er.AllowedValues}get ATTR_DataSource_freq__DescriptionAttribute(){return"Sensor data acquisition frequency."+vt.DevConfAffected}get DataSource_freq(){return this._DataSource_source.get_frequency()}set DataSource_freq(e){this._DataSource_source.set_frequency(e)}get ATTR_DataSource_precision__DisplayName(){return"Precision"}get ATTR_DataSource_precision__CategoryAttribute(){return"Data source"}get ATTR_DataSource_precision__DescriptionAttribute(){return"How many digits shown after the decimal point"}get ATTR_DataSource_precision__AllowedValues(){return Ur.AllowedValues}get DataSource_precision(){return this._DataSource_precision}set DataSource_precision(e){this._DataSource_precision=e}get ATTR_DataSource_AlarmSection0__DisplayName(){return"Sensor value alarm 1"}get ATTR_DataSource_AlarmSection0__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection0__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection0__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection0__DescriptionAttribute(){return"Alarm 1 for this data source, expand for more."}get DataSource_AlarmSection0(){return this._DataSource_AlarmSection0}set DataSource_AlarmSection0(e){this._DataSource_AlarmSection0=e}get ATTR_DataSource_AlarmSection1__DisplayName(){return"Sensor value alarm 2"}get ATTR_DataSource_AlarmSection1__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection1__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection1__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection1__DescriptionAttribute(){return"Alarm 2 for this data source, expand for more."}get DataSource_AlarmSection1(){return this._DataSource_AlarmSection1}set DataSource_AlarmSection1(e){this._DataSource_AlarmSection1=e}get ATTR_SolidGauge_min__DisplayName(){return"Minimum value"}get ATTR_SolidGauge_min__CategoryAttribute(){return"Values range"}get ATTR_SolidGauge_min__DescriptionAttribute(){return"Minimum value displayable by the gauge."}get SolidGauge_min(){return this._SolidGauge_min}set SolidGauge_min(e){this._SolidGauge_min=e}get ATTR_SolidGauge_max__DisplayName(){return"Maximum value"}get ATTR_SolidGauge_max__CategoryAttribute(){return"Values range"}get ATTR_SolidGauge_max__DescriptionAttribute(){return"Maximum value displayable by the gauge."}get SolidGauge_max(){return this._SolidGauge_max}set SolidGauge_max(e){this._SolidGauge_max=e}get ATTR_SolidGauge_showMinMax__DisplayName(){return"show  min/max"}get ATTR_SolidGauge_showMinMax__CategoryAttribute(){return"Values range"}get ATTR_SolidGauge_showMinMax__DescriptionAttribute(){return"Show the min / max values."}get SolidGauge_showMinMax(){return this._SolidGauge_showMinMax}set SolidGauge_showMinMax(e){this._SolidGauge_showMinMax=e}get ATTR_SolidGauge_color1__DisplayName(){return"Min Color"}get ATTR_SolidGauge_color1__CategoryAttribute(){return"Values range"}get ATTR_SolidGauge_color1__DescriptionAttribute(){return"Color for minimum value."}get SolidGauge_color1(){return this._SolidGauge_color1}set SolidGauge_color1(e){this._SolidGauge_color1=e}get ATTR_SolidGauge_color2__DisplayName(){return"Max Color"}get ATTR_SolidGauge_color2__CategoryAttribute(){return"Values range"}get ATTR_SolidGauge_color2__DescriptionAttribute(){return"Color for maximum value."}get SolidGauge_color2(){return this._SolidGauge_color2}set SolidGauge_color2(e){this._SolidGauge_color2=e}get ATTR_SolidGauge_font__DisplayName(){return"Unit  Font"}get ATTR_SolidGauge_font__CategoryAttribute(){return"Fonts"}get ATTR_SolidGauge_font__ReadOnlyAttribute(){return!0}get ATTR_SolidGauge_font__DescriptionAttribute(){return"Font for displaying the value/status indicator"}get SolidGauge_font(){return this._SolidGauge_font}set SolidGauge_font(e){this._SolidGauge_font=e}get ATTR_SolidGauge_minMaxFont__DisplayName(){return"Min Max  Font"}get ATTR_SolidGauge_minMaxFont__CategoryAttribute(){return"Fonts"}get ATTR_SolidGauge_minMaxFont__ReadOnlyAttribute(){return!0}get ATTR_SolidGauge_minMaxFont__DescriptionAttribute(){return"Font for displaying min/max values"}get SolidGauge_minMaxFont(){return this._SolidGauge_minMaxFont}set SolidGauge_minMaxFont(e){this._SolidGauge_minMaxFont=e}get ATTR_SolidGauge_displayMode__DisplayName(){return"Display mode"}get ATTR_SolidGauge_displayMode__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_displayMode__DescriptionAttribute(){return"Dial general shape"}get SolidGauge_displayMode(){return this._SolidGauge_displayMode}set SolidGauge_displayMode(e){this._SolidGauge_displayMode=e}get ATTR_SolidGauge_borderColor__DisplayName(){return"Border color"}get ATTR_SolidGauge_borderColor__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_borderColor__DescriptionAttribute(){return"Dial border color."}get SolidGauge_borderColor(){return this._SolidGauge_borderColor}set SolidGauge_borderColor(e){this._SolidGauge_borderColor=e}get ATTR_SolidGauge_borderThickness__DisplayName(){return"Border thickness "}get ATTR_SolidGauge_borderThickness__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_borderThickness__DescriptionAttribute(){return"Thickness of the dial border"}get SolidGauge_borderThickness(){return this._SolidGauge_borderThickness}set SolidGauge_borderThickness(e){this._SolidGauge_borderThickness=e}get ATTR_SolidGauge_backgroundColor1__DisplayName(){return"Background color 1"}get ATTR_SolidGauge_backgroundColor1__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_backgroundColor1__DescriptionAttribute(){return"Dial background gradient color 1."}get SolidGauge_backgroundColor1(){return this._SolidGauge_backgroundColor1}set SolidGauge_backgroundColor1(e){this._SolidGauge_backgroundColor1=e}get ATTR_SolidGauge_backgroundColor2__DisplayName(){return"Background color 2"}get ATTR_SolidGauge_backgroundColor2__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_backgroundColor2__DescriptionAttribute(){return"Dial background gradient color 2."}get SolidGauge_backgroundColor2(){return this._SolidGauge_backgroundColor2}set SolidGauge_backgroundColor2(e){this._SolidGauge_backgroundColor2=e}get ATTR_SolidGauge_thickness__DisplayName(){return"Dial thickness (%) "}get ATTR_SolidGauge_thickness__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_thickness__DescriptionAttribute(){return"Thickness of the dial, in percentage relative to radius"}get SolidGauge_thickness(){return this._SolidGauge_thickness}set SolidGauge_thickness(e){this._SolidGauge_thickness=e}get ATTR_SolidGauge_maxSpeed__DisplayName(){return"Max speed (%) "}get ATTR_SolidGauge_maxSpeed__CategoryAttribute(){return"Dial"}get ATTR_SolidGauge_maxSpeed__DescriptionAttribute(){return'Maximum speed of the dial in percentage relative to Max-Min. This is meant to limit "teleporting" effects.'}get SolidGauge_maxSpeed(){return this._SolidGauge_maxSpeed}set SolidGauge_maxSpeed(e){this._SolidGauge_maxSpeed=e}IsDataSourceAssigned(){return!(this._DataSource_source instanceof Ae)}get ATTR_SolidGauge_annotationPanels0__DisplayName(){return"Annotation 1"}get ATTR_SolidGauge_annotationPanels0__CategoryAttribute(){return"Annotations"}get ATTR_SolidGauge_annotationPanels0__ReadOnlyAttribute(){return!0}get ATTR_SolidGauge_annotationPanels0__DescriptionAttribute(){return"Customizable text panels"}get SolidGauge_annotationPanels0(){return this._annotationPanels0}set SolidGauge_annotationPanels0(e){this._annotationPanels0=e}get ATTR_SolidGauge_annotationPanels1__DisplayName(){return"Annotation 2"}get ATTR_SolidGauge_annotationPanels1__CategoryAttribute(){return"Annotations"}get ATTR_SolidGauge_annotationPanels1__ReadOnlyAttribute(){return!0}get ATTR_SolidGauge_annotationPanels1__DescriptionAttribute(){return"Customizable text panels"}get SolidGauge_annotationPanels1(){return this._annotationPanels1}set SolidGauge_annotationPanels1(e){this._annotationPanels1=e}};m(La,"GaugeFormProperties");var Ps=La,Ya=class Ya extends de{constructor(e,t){super(t),this._DataSource_source=oe.getNullSensor(),this._DataSource_AlarmSection0=new Jt(0),this._DataSource_AlarmSection1=new Jt(1),this._AngularGauge_min=0,this._AngularGauge_max=100,this._AngularGauge_unitFactor=1,this._AngularGauge_graduation=10,this._AngularGauge_graduationSize=10,this._AngularGauge_graduationOuterRadiusSize=98,this._AngularGauge_graduationThickness=2,this._AngularGauge_graduationColor=c.Black,this._AngularGauge_graduationFont=new Et("Arial",20,c.Black,!1,!0),this._AngularGauge_subgraduationCount=5,this._AngularGauge_subgraduationSize=5,this._AngularGauge_subgraduationThickness=1,this._AngularGauge_subgraduationColor=c.Black,this._AngularGauge_needleColor=c.Red,this._AngularGauge_needleContourColor=c.DarkRed,this._AngularGauge_needleContourThickness=1,this._AngularGauge_needleLength1=90,this._AngularGauge_needleLength2=15,this._AngularGauge_needleWidth=5,this._AngularGauge_needleMaxSpeed=.5,this._AngularGauge_unitFont=new Et("Arial",24,c.DarkGray,!1,!0),this._AngularGauge_statusFont=new Et("Arial",24,c.DarkGray,!1,!0),this._AngularGauge_borderColor=c.Black,this._AngularGauge_borderThickness=5,this._AngularGauge_backgroundColor1=c.FromArgb(255,240,240,240),this._AngularGauge_backgroundColor2=c.FromArgb(255,200,200,200),this._AngularGauge_zones0=new Or(0,50,c.LightGreen),this._AngularGauge_zones1=new Or(50,80,c.Yellow),this._AngularGauge_zones2=new Or(80,100,c.Red),this._annotationPanels0=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.CENTER,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this._annotationPanels1=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.BOTTOM,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this.initFromXmlData(e),this.PropagateDataSourceChange()}PropagateDataSourceChange(){this.ownerForm.SourceChanged(this._DataSource_source,0);let e=de.getAllProperties(this).byName,t;for(t in e)t.startsWith("DataSource_AlarmSection")&&this[t].setDataSource(this._DataSource_source)}IsDataSourceAssigned(){return!(this._DataSource_source instanceof Ae)}get ATTR_DataSource_source__DisplayName(){return"Sensor"}get ATTR_DataSource_source__CategoryAttribute(){return"Data source"}get ATTR_DataSource_source__ParamCategorySummaryAttribute(){return"sensorDescription"}get ATTR_DataSource_source__PreExpandedCategoryAttribute(){return!0}get ATTR_DataSource_source__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_DataSource_source__DescriptionAttribute(){return"Yoctopuce sensor feeding the gauge. "+vt.CheckSensor}get DataSource_source(){return this._DataSource_source}set DataSource_source(e){let t=this._DataSource_source;this._DataSource_source=e,this.PropagateDataSourceChange(),this._DataSource_source!=t&&(S.edited=!0)}get sensorDescription(){return this._DataSource_source instanceof Ae?"none":this._DataSource_source.get_friendlyName()}get isSensorReadOnly(){return this._DataSource_source.isReadOnly}get ATTR_DataSource_freq__DisplayName(){return"Sensor freq"}get ATTR_DataSource_freq__CategoryAttribute(){return"Data source"}get ATTR_DataSource_freq__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_freq__IsReadonlyCallAttribute(){return"isSensorReadOnly"}get ATTR_DataSource_freq__DescriptionAttribute(){return"Sensor data acquisition frequency."+vt.DevConfAffected}get ATTR_DataSource_freq__AllowedValues(){return er.AllowedValues}get DataSource_freq(){return this._DataSource_source.get_frequency()}set DataSource_freq(e){this._DataSource_source.set_frequency(e)}get ATTR_DataSource_AlarmSection0__DisplayName(){return"Sensor value alarm 1"}get ATTR_DataSource_AlarmSection0__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection0__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection0__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection0__DescriptionAttribute(){return"Alarm 1 for this data source, expand for more."}get DataSource_AlarmSection0(){return this._DataSource_AlarmSection0}set DataSource_AlarmSection0(e){this._DataSource_AlarmSection0=e}get ATTR_DataSource_AlarmSection1__DisplayName(){return"Sensor value alarm 2"}get ATTR_DataSource_AlarmSection1__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection1__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection1__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection1__DescriptionAttribute(){return"Alarm 2 for this data source, expand for more."}get DataSource_AlarmSection1(){return this._DataSource_AlarmSection1}set DataSource_AlarmSection1(e){this._DataSource_AlarmSection1=e}get ATTR_AngularGauge_min__DisplayName(){return"Minimum value"}get ATTR_AngularGauge_min__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_min__DescriptionAttribute(){return"Minimum value displayable by the gauge."}get AngularGauge_min(){return this._AngularGauge_min}set AngularGauge_min(e){this._AngularGauge_min=e}get ATTR_AngularGauge_max__DisplayName(){return"Maximum value"}get ATTR_AngularGauge_max__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_max__DescriptionAttribute(){return"Maximum value displayable by the gauge."}get AngularGauge_max(){return this._AngularGauge_max}set AngularGauge_max(e){this._AngularGauge_max=e}get ATTR_AngularGauge_unitFactor__DisplayName(){return"Unit factor"}get ATTR_AngularGauge_unitFactor__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_unitFactor__DescriptionAttribute(){return"Data  will be divided by this value before being displayed, this allows simpler gradation marks."}get AngularGauge_unitFactor(){return this._AngularGauge_unitFactor}set AngularGauge_unitFactor(e){this._AngularGauge_unitFactor=e}get ATTR_AngularGauge_graduation__DisplayName(){return"Main gradation steps"}get ATTR_AngularGauge_graduation__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduation__DescriptionAttribute(){return"Difference between two consecutive main gradation marks"}get AngularGauge_graduation(){return this._AngularGauge_graduation}set AngularGauge_graduation(e){this._AngularGauge_graduation=e}get ATTR_AngularGauge_graduationSize__DisplayName(){return"Main gradation size (%)"}get ATTR_AngularGauge_graduationSize__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduationSize__DescriptionAttribute(){return"Main gradation marks size in percent, relative to dial radius"}get AngularGauge_graduationSize(){return this._AngularGauge_graduationSize}set AngularGauge_graduationSize(e){this._AngularGauge_graduationSize=e}get ATTR_AngularGauge_graduationOuterRadiusSize__DisplayName(){return"Main gradation radius (%)"}get ATTR_AngularGauge_graduationOuterRadiusSize__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduationOuterRadiusSize__DescriptionAttribute(){return"Main gradation marks outer radius in percent, relative to dial radius"}get AngularGauge_graduationOuterRadiusSize(){return this._AngularGauge_graduationOuterRadiusSize}set AngularGauge_graduationOuterRadiusSize(e){this._AngularGauge_graduationOuterRadiusSize=e}get ATTR_AngularGauge_graduationThickness__DisplayName(){return"Main gradation thickness"}get ATTR_AngularGauge_graduationThickness__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduationThickness__DescriptionAttribute(){return"Main gradation marks thickness"}get AngularGauge_graduationThickness(){return this._AngularGauge_graduationThickness}set AngularGauge_graduationThickness(e){this._AngularGauge_graduationThickness=e}get ATTR_AngularGauge_graduationColor__DisplayName(){return"Main gradation color"}get ATTR_AngularGauge_graduationColor__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduationColor__DescriptionAttribute(){return"Main gradation marks color."}get AngularGauge_graduationColor(){return this._AngularGauge_graduationColor}set AngularGauge_graduationColor(e){this._AngularGauge_graduationColor=e}get ATTR_AngularGauge_graduationFont__DisplayName(){return"Main gradation font"}get ATTR_AngularGauge_graduationFont__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_graduationFont__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_graduationFont__DescriptionAttribute(){return"Font used for gradation labels"}get AngularGauge_graduationFont(){return this._AngularGauge_graduationFont}set AngularGauge_graduationFont(e){this._AngularGauge_graduationFont=e}get ATTR_AngularGauge_subgraduationCount__DisplayName(){return"Sub-gradation count"}get ATTR_AngularGauge_subgraduationCount__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_subgraduationCount__DescriptionAttribute(){return"How many sub-gradation (+1) marks between two consecutive main graduation marks"}get AngularGauge_subgraduationCount(){return this._AngularGauge_subgraduationCount}set AngularGauge_subgraduationCount(e){this._AngularGauge_subgraduationCount=e}get ATTR_AngularGauge_subgraduationSize__DisplayName(){return"Sub-gradation size (%)"}get ATTR_AngularGauge_subgraduationSize__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_subgraduationSize__DescriptionAttribute(){return"Sub-gradation marks size in percent, relative to dial radius"}get AngularGauge_subgraduationSize(){return this._AngularGauge_subgraduationSize}set AngularGauge_subgraduationSize(e){this._AngularGauge_subgraduationSize=e}get ATTR_AngularGauge_subgraduationThickness__DisplayName(){return"Sub-gradation thickness"}get ATTR_AngularGauge_subgraduationThickness__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_subgraduationThickness__DescriptionAttribute(){return"Sub-gradation marks thickness"}get AngularGauge_subgraduationThickness(){return this._AngularGauge_subgraduationThickness}set AngularGauge_subgraduationThickness(e){this._AngularGauge_subgraduationThickness=e}get ATTR_AngularGauge_subgraduationColor__DisplayName(){return"Sub-gradation color"}get ATTR_AngularGauge_subgraduationColor__CategoryAttribute(){return"Gauge gradations"}get ATTR_AngularGauge_subgraduationColor__DescriptionAttribute(){return"Sub-gradation marks color."}get AngularGauge_subgraduationColor(){return this._AngularGauge_subgraduationColor}set AngularGauge_subgraduationColor(e){this._AngularGauge_subgraduationColor=e}get ATTR_AngularGauge_needleColor__DisplayName(){return"Needle color"}get ATTR_AngularGauge_needleColor__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleColor__DescriptionAttribute(){return"Needle filling color."}get AngularGauge_needleColor(){return this._AngularGauge_needleColor}set AngularGauge_needleColor(e){this._AngularGauge_needleColor=e}get ATTR_AngularGauge_needleContourColor__DisplayName(){return"Needle contour color"}get ATTR_AngularGauge_needleContourColor__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleContourColor__DescriptionAttribute(){return"Needle contour color."}get AngularGauge_needleContourColor(){return this._AngularGauge_needleContourColor}set AngularGauge_needleContourColor(e){this._AngularGauge_needleContourColor=e}get ATTR_AngularGauge_needleContourThickness__DisplayName(){return"Needle contour thickness"}get ATTR_AngularGauge_needleContourThickness__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleContourThickness__DescriptionAttribute(){return"Thickness of the needle contour"}get AngularGauge_needleContourThickness(){return this._AngularGauge_needleContourThickness}set AngularGauge_needleContourThickness(e){this._AngularGauge_needleContourThickness=e}get ATTR_AngularGauge_needleLength1__DisplayName(){return"Needle main size (%)"}get ATTR_AngularGauge_needleLength1__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleLength1__DescriptionAttribute(){return"Length of the needle part pointing to gradations, in % relative to radius"}get AngularGauge_needleLength1(){return this._AngularGauge_needleLength1}set AngularGauge_needleLength1(e){this._AngularGauge_needleLength1=e}get ATTR_AngularGauge_needleLength2__DisplayName(){return"Needle foot size (%)"}get ATTR_AngularGauge_needleLength2__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleLength2__DescriptionAttribute(){return"Length of the needle part not pointing to gradations, in % relative to radius"}get AngularGauge_needleLength2(){return this._AngularGauge_needleLength2}set AngularGauge_needleLength2(e){this._AngularGauge_needleLength2=e}get ATTR_AngularGauge_needleWidth__DisplayName(){return"Needle width (%)"}get ATTR_AngularGauge_needleWidth__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleWidth__DescriptionAttribute(){return"Width of the needle, in % relative to radius"}get AngularGauge_needleWidth(){return this._AngularGauge_needleWidth}set AngularGauge_needleWidth(e){this._AngularGauge_needleWidth=e}get ATTR_AngularGauge_needleMaxSpeed__DisplayName(){return"Needle max speed (%)"}get ATTR_AngularGauge_needleMaxSpeed__CategoryAttribute(){return"Needle"}get ATTR_AngularGauge_needleMaxSpeed__DescriptionAttribute(){return'Needle Maximum speed, in % relative to (max-min). This is meant to limit "teleporting" effects.'}get AngularGauge_needleMaxSpeed(){return this._AngularGauge_needleMaxSpeed}set AngularGauge_needleMaxSpeed(e){this._AngularGauge_needleMaxSpeed=e}get ATTR_AngularGauge_unitFont__DisplayName(){return"Unit Line Font"}get ATTR_AngularGauge_unitFont__CategoryAttribute(){return"Text lines"}get ATTR_AngularGauge_unitFont__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_unitFont__DescriptionAttribute(){return"Font used in the text line describing unit"}get AngularGauge_unitFont(){return this._AngularGauge_unitFont}set AngularGauge_unitFont(e){this._AngularGauge_unitFont=e}get ATTR_AngularGauge_statusFont__DisplayName(){return"Status Line Font"}get ATTR_AngularGauge_statusFont__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_statusFont__CategoryAttribute(){return"Text lines"}get ATTR_AngularGauge_statusFont__DescriptionAttribute(){return"Font used in the text line gauge status"}get AngularGauge_statusFont(){return this._AngularGauge_statusFont}set AngularGauge_statusFont(e){this._AngularGauge_statusFont=e}get ATTR_AngularGauge_borderColor__DisplayName(){return"Border color"}get ATTR_AngularGauge_borderColor__CategoryAttribute(){return"Dial"}get ATTR_AngularGauge_borderColor__DescriptionAttribute(){return"Dial border color."}get AngularGauge_borderColor(){return this._AngularGauge_borderColor}set AngularGauge_borderColor(e){this._AngularGauge_borderColor=e}get ATTR_AngularGauge_borderThickness__DisplayName(){return"Border thickness "}get ATTR_AngularGauge_borderThickness__CategoryAttribute(){return"Dial"}get ATTR_AngularGauge_borderThickness__DescriptionAttribute(){return"Thickness of the dial border"}get AngularGauge_borderThickness(){return this._AngularGauge_borderThickness}set AngularGauge_borderThickness(e){this._AngularGauge_borderThickness=e}get ATTR_AngularGauge_backgroundColor1__DisplayName(){return"Background color 1"}get ATTR_AngularGauge_backgroundColor1__CategoryAttribute(){return"Dial"}get ATTR_AngularGauge_backgroundColor1__DescriptionAttribute(){return"Dial background gradient color 1."}get AngularGauge_backgroundColor1(){return this._AngularGauge_backgroundColor1}set AngularGauge_backgroundColor1(e){this._AngularGauge_backgroundColor1=e}get ATTR_AngularGauge_backgroundColor2__DisplayName(){return"Background color 2"}get ATTR_AngularGauge_backgroundColor2__CategoryAttribute(){return"Dial"}get ATTR_AngularGauge_backgroundColor2__DescriptionAttribute(){return"Dial background gradient color 2."}get AngularGauge_backgroundColor2(){return this._AngularGauge_backgroundColor2}set AngularGauge_backgroundColor2(e){this._AngularGauge_backgroundColor2=e}get ATTR_AngularGauge_zones0__DisplayName(){return"Zone 1"}get ATTR_AngularGauge_zones0__CategoryAttribute(){return"Zones"}get ATTR_AngularGauge_zones0__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_zones0__DescriptionAttribute(){return"Zone 1 parameters"}get AngularGauge_zones0(){return this._AngularGauge_zones0}set AngularGauge_zones0(e){this._AngularGauge_zones0=e}get ATTR_AngularGauge_zones1__DisplayName(){return"Zone 2"}get ATTR_AngularGauge_zones1__CategoryAttribute(){return"Zones"}get ATTR_AngularGauge_zones1__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_zones1__DescriptionAttribute(){return"Zone 2 parameters"}get AngularGauge_zones1(){return this._AngularGauge_zones1}set AngularGauge_zones1(e){this._AngularGauge_zones1=e}get ATTR_AngularGauge_zones2__DisplayName(){return"Zone 2"}get ATTR_AngularGauge_zones2__CategoryAttribute(){return"Zones"}get ATTR_AngularGauge_zones2__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_zones2__DescriptionAttribute(){return"Zone 2 parameters"}get AngularGauge_zones2(){return this._AngularGauge_zones2}set AngularGauge_zones2(e){this._AngularGauge_zones2=e}get ATTR_AngularGauge_annotationPanels0__DisplayName(){return"Annotation 1"}get ATTR_AngularGauge_annotationPanels0__CategoryAttribute(){return"Annotations"}get ATTR_AngularGauge_annotationPanels0__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_annotationPanels0__DescriptionAttribute(){return"Customizable text panels"}get AngularGauge_annotationPanels0(){return this._annotationPanels0}set AngularGauge_annotationPanels0(e){this._annotationPanels0=e}get ATTR_AngularGauge_annotationPanels1__DisplayName(){return"Annotation 2"}get ATTR_AngularGauge_annotationPanels1__CategoryAttribute(){return"Annotations"}get ATTR_AngularGauge_annotationPanels1__ReadOnlyAttribute(){return!0}get ATTR_AngularGauge_annotationPanels1__DescriptionAttribute(){return"Customizable text panels"}get AngularGauge_annotationPanels1(){return this._annotationPanels1}set AngularGauge_annotationPanels1(e){this._annotationPanels1=e}};m(Ya,"AngularGaugeFormProperties");var Ns=Ya,Ma=class Ma{constructor(e,t,i){this._visible=!1,this._min=e,this._max=t,this._color=i}get summary(){return this._visible?this._min.toString()+".."+this._max.toString():"Disabled"}get ATTR_visible__DisplayName(){return"Visible"}get ATTR_visible__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_visible__DescriptionAttribute(){return"Zone visibility."}get visible(){return this._visible}set visible(e){this._visible=e}get ATTR_min__DisplayName(){return"Minimum value"}get ATTR_min__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_min__DescriptionAttribute(){return"Zone minimum value"}get min(){return this._min}set min(e){this._min=e}get ATTR_max__DisplayName(){return"Maximum value"}get ATTR_max__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_max__DescriptionAttribute(){return"Zone maximum value"}get max(){return this._max}set max(e){this._max=e}get ATTR_color__DisplayName(){return"Color"}get ATTR_color__DescriptionAttribute(){return"Zone color"}get color(){return this._color}set color(e){this._color=e}};m(Ma,"ZoneDescription");var zr=Ma,Fa=class Fa{constructor(e,t,i){this._width=5,this._outerRadius=98,this._visible=!1,this._min=e,this._max=t,this._color=i}get summary(){return this._visible?this._min.toString()+".."+this._max.toString():"Disabled"}get ATTR_visible__DisplayName(){return"Visible"}get ATTR_visible__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_visible__DescriptionAttribute(){return"Zone visibility."}get visible(){return this._visible}set visible(e){this._visible=e}get ATTR_min__DisplayName(){return"Minimum value"}get ATTR_min__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_min__DescriptionAttribute(){return"Zone minimum value"}get min(){return this._min}set min(e){this._min=e}get ATTR_max__DisplayName(){return"Maximum value"}get ATTR_max__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_max__DescriptionAttribute(){return"Zone maximum value"}get max(){return this._max}set max(e){this._max=e}get ATTR_color__DisplayName(){return"Color"}get ATTR_color__DescriptionAttribute(){return"Zone color"}get color(){return this._color}set color(e){this._color=e}get ATTR_outerRadius__DisplayName(){return"Outer radius (%)"}get ATTR_outerRadius__DescriptionAttribute(){return"Zone outer radius, in percentage relative to dial radius "}get outerRadius(){return this._outerRadius}set outerRadius(e){this._outerRadius=e}get ATTR_width__DisplayName(){return"Width (%)"}get ATTR_width__DescriptionAttribute(){return"Zone  width, in percentage relative to dial radius "}get width(){return this._width}set width(e){this._width=e}};m(Fa,"AngularZoneDescription");var Or=Fa,Va=class Va{constructor(e,t,i,r,s){this._name=e,this._size=t,this._color=i,this._italic=r,this._bold=s}ToString(){return this._name+" "+this._size.toString()}get summary(){return this._name+" "+this._size.toString()}get ATTR_name__DisplayName(){return"Font name"}get ATTR_name__AllowedValues(){return zs.AllowedValues}get ATTR_name__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_name__DescriptionAttribute(){return"Name of the font"}get name(){return this._name}set name(e){this._name=e}get ATTR_size__DisplayName(){return"Font size"}get ATTR_size__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_size__DescriptionAttribute(){return"Size of the font"}get size(){return this._size}set size(e){this._size=Math.round(100*e)/100}get ATTR_color__DisplayName(){return"Font color"}get ATTR_color__DescriptionAttribute(){return"Color of the font."}get color(){return this._color}set color(e){this._color=e}get ATTR_italic__DisplayName(){return"Italic"}get ATTR_italic__DescriptionAttribute(){return"Is the font style italic?."}get italic(){return this._italic}set italic(e){this._italic=e}get ATTR_bold__DisplayName(){return"Bold"}get ATTR_bold__DescriptionAttribute(){return"Is the font style bold?."}get bold(){return this._bold}set bold(e){this._bold=e}};m(Va,"FontDescription");var Et=Va,za=class za extends de{constructor(e,t){super(t),this._DataSource_source=oe.getNullSensor(),this._DataSource_precision="0.1",this._DataSource_AlarmSection0=new Jt(0),this._DataSource_AlarmSection1=new Jt(1),this._font=new Et("Arial",48,c.LightGreen,!1,!0),this._display_backgroundColor1=c.Black,this._display_backgroundColor2=c.Black,this._hrzAlignment=di.HrzAlignment.RIGHT,this._hrzAlignmentOfset=5,this._outOfRangeMin=new et(Number.NaN),this._outOfRangeMax=new et(Number.NaN),this._outOfRangeColor=c.Red,this._annotationPanels0=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.CENTER,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this._annotationPanels1=new Ei(Se.HorizontalAlignPos.CENTER,Se.VerticalAlignPos.BOTTOM,0,!1,"$NAME$",c.FromArgb(0,127,127,127),c.FromArgb(0,127,127,127),10,c.FromArgb(255,0,0,0)),this.initFromXmlData(e),this.PropagateDataSourceChange()}PropagateDataSourceChange(){this.ownerForm.SourceChanged(this._DataSource_source,0);let e=de.getAllProperties(this).byName,t;for(t in e)t.startsWith("DataSource_AlarmSection")&&this[t].setDataSource(this._DataSource_source)}IsDataSourceAssigned(){return!(this._DataSource_source instanceof Ae)}get ATTR_DataSource_source__DisplayName(){return"Sensor"}get ATTR_DataSource_source__CategoryAttribute(){return"Data source"}get ATTR_DataSource_source__ParamCategorySummaryAttribute(){return"sensorDescription"}get ATTR_DataSource_source__PreExpandedCategoryAttribute(){return!0}get ATTR_DataSource_source__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_DataSource_source__DescriptionAttribute(){return"Yoctopuce sensor feeding the display. "+vt.CheckSensor}get DataSource_source(){return this._DataSource_source}set DataSource_source(e){let t=this._DataSource_source;this._DataSource_source=e,this.PropagateDataSourceChange(),this._DataSource_source!=t&&(S.edited=!0)}get isSensorReadOnly(){return this._DataSource_source.isReadOnly}get sensorDescription(){return this._DataSource_source instanceof Ae?"none":this._DataSource_source.get_friendlyName()}get ATTR_DataSource_freq__DisplayName(){return"Sensor freq"}get ATTR_DataSource_freq__CategoryAttribute(){return"Data source"}get ATTR_DataSource_freq__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_freq__IsReadonlyCallAttribute(){return"isSensorReadOnly"}get ATTR_DataSource_freq__DescriptionAttribute(){return"Sensor data acquisition frequency."+vt.DevConfAffected}get ATTR_DataSource_freq__AllowedValues(){return er.AllowedValues}get DataSource_freq(){return this._DataSource_source.get_frequency()}set DataSource_freq(e){this._DataSource_source.set_frequency(e)}get ATTR_DataSource_precision__DisplayName(){return"Precision"}get ATTR_DataSource_precision__CategoryAttribute(){return"Data source"}get ATTR_DataSource_precision__DescriptionAttribute(){return"How many digits shown after the decimal point."}get ATTR_DataSource_precision__AllowedValues(){return Ur.AllowedValues}get DataSource_precision(){return this._DataSource_precision}set DataSource_precision(e){this._DataSource_precision=e}get ATTR_DataSource_AlarmSection0__DisplayName(){return"Sensor value alarm 1"}get ATTR_DataSource_AlarmSection0__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection0__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection0__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection0__DescriptionAttribute(){return"Alarm 1 for this data source, expand for more."}get DataSource_AlarmSection0(){return this._DataSource_AlarmSection0}set DataSource_AlarmSection0(e){this._DataSource_AlarmSection0=e}get ATTR_DataSource_AlarmSection1__DisplayName(){return"Sensor value alarm 2"}get ATTR_DataSource_AlarmSection1__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection1__ReadOnlyAttribute(){return!0}get ATTR_DataSource_AlarmSection1__CategoryAttribute(){return"Data source"}get ATTR_DataSource_AlarmSection1__DescriptionAttribute(){return"Alarm 2 for this data source, expand for more."}get DataSource_AlarmSection1(){return this._DataSource_AlarmSection1}set DataSource_AlarmSection1(e){this._DataSource_AlarmSection1=e}get ATTR_display_font__DisplayName(){return"Font"}get ATTR_display_font__CategoryAttribute(){return"Display"}get ATTR_display_font__ReadOnlyAttribute(){return!0}get ATTR_display_font__DescriptionAttribute(){return"Display font"}get display_font(){return this._font}set display_font(e){this._font=e}get ATTR_display_backgroundColor1__DisplayName(){return"Background color 1"}get ATTR_display_backgroundColor1__CategoryAttribute(){return"Display"}get ATTR_display_backgroundColor1__DescriptionAttribute(){return"Display background gradient color 1."}get display_backgroundColor1(){return this._display_backgroundColor1}set display_backgroundColor1(e){this._display_backgroundColor1=e}get ATTR_display_backgroundColor2__DisplayName(){return"Background color 2"}get ATTR_display_backgroundColor2__CategoryAttribute(){return"Display"}get ATTR_display_backgroundColor2__DescriptionAttribute(){return"Display background gradient color 2."}get display_backgroundColor2(){return this._display_backgroundColor2}set display_backgroundColor2(e){this._display_backgroundColor2=e}get ATTR_display_hrzAlignment__DisplayName(){return"Hrz alignment method"}get ATTR_display_hrzAlignment__CategoryAttribute(){return"Display"}get ATTR_display_hrzAlignment__DescriptionAttribute(){return"Horizontal alignment method"}get display_hrzAlignment(){return this._hrzAlignment}set display_hrzAlignment(e){this._hrzAlignment=e}get ATTR_display_hrzAlignmentOfset__DisplayName(){return"Hrz alignment offset"}get ATTR_display_hrzAlignmentOfset__CategoryAttribute(){return"Display"}get ATTR_display_hrzAlignmentOfset__DescriptionAttribute(){return"Horizontal alignment offset in percentage. No effect when chosen horizontal alignment is CENTER"}get display_hrzAlignmentOfset(){return this._hrzAlignmentOfset}set display_hrzAlignmentOfset(e){this._hrzAlignmentOfset=e}get ATTR_display_outOfRangeMin__DisplayName(){return"Minimum value"}get ATTR_display_outOfRangeMin__CategoryAttribute(){return"Range Control"}get ATTR_display_outOfRangeMin__DescriptionAttribute(){return`Regular range minimum value. if value goes  outside regular  range, color will turn to "Out of range Color".Leave blank if you don't want to define such a range. `}get display_outOfRangeMin(){return this._outOfRangeMin}set display_outOfRangeMin(e){this._outOfRangeMin=e}get ATTR_display_outOfRangeMax__DisplayName(){return"Maximum value"}get ATTR_display_outOfRangeMax__CategoryAttribute(){return"Range Control"}get ATTR_display_outOfRangeMax__DescriptionAttribute(){return`Regular range minimum value. if value goes  outside regular  range, color will turn to "Out of range Color".Leave blank if you don't want to define such a range. `}get display_outOfRangeMax(){return this._outOfRangeMax}set display_outOfRangeMax(e){this._outOfRangeMax=e}get ATTR_display_outOfRangeColor__DisplayName(){return"Out of range Color"}get ATTR_display_outOfRangeColor__CategoryAttribute(){return"Range Control"}get ATTR_display_outOfRangeColor__DescriptionAttribute(){return"Digits color when value is out of range."}get display_outOfRangeColor(){return this._outOfRangeColor}set display_outOfRangeColor(e){this._outOfRangeColor=e}get ATTR_display_annotationPanels0__DisplayName(){return"Annotation 1"}get ATTR_display_annotationPanels0__CategoryAttribute(){return"Annotations"}get ATTR_display_annotationPanels0__ReadOnlyAttribute(){return!0}get ATTR_display_annotationPanels0__DescriptionAttribute(){return"Customizable text panels"}get display_annotationPanels0(){return this._annotationPanels0}set display_annotationPanels0(e){this._annotationPanels0=e}get ATTR_display_annotationPanels1__DisplayName(){return"Annotation 2"}get ATTR_display_annotationPanels1__CategoryAttribute(){return"Annotations"}get ATTR_display_annotationPanels1__ReadOnlyAttribute(){return!0}get ATTR_display_annotationPanels1__DescriptionAttribute(){return"Customizable text panels"}get display_annotationPanels1(){return this._annotationPanels1}set display_annotationPanels1(e){this._annotationPanels1=e}};m(za,"digitalDisplayFormProperties");var Ls=za,Oa=class Oa{get summary(){return this._sensor.getAlarmCondition(this._index)==0?"Disabled":"Enabled"}constructor(e){this._sensor=oe.getNullSensor(),this._index=0,this._index=e}get ATTR_source__DisplayName(){return"Data source type"}get ATTR_source__NotSavedInXMLAttribute(){return!0}get ATTR_source__AllowedValues(){return Br.AllowedValues}get ATTR_source__DescriptionAttribute(){return"Alarm sensor data source (Average, minimum or maximum value during last interval)"}get source(){return this._sensor.getAlarmSource(this._index)}set source(e){this._sensor.setAlarmSource(this._index,e)}get ATTR_condition__DisplayName(){return"Test Condition"}get ATTR_condition__NotSavedInXMLAttribute(){return!0}get ATTR_condition__AllowedValues(){return Vs.AllowedValues}get ATTR_condition__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_condition__DescriptionAttribute(){return"Alarm trigger condition"}get condition(){return this._sensor.getAlarmCondition(this._index)}set condition(e){this._sensor.setAlarmCondition(this._index,e)}setDataSource(e){this._sensor=e}get ATTR_value__DisplayName(){return"Test Value"}get ATTR_value__NotSavedInXMLAttribute(){return!0}get ATTR_value__DescriptionAttribute(){return"Value for the Alarm trigger"}get value(){return this._sensor.getAlarmValue(this._index)}set value(e){this._sensor.setAlarmValue(this._index,e)}get ATTR_commandLine__DisplayName(){return"Trigger action"}get ATTR_commandLine__NotSavedInXMLAttribute(){return!0}get ATTR_commandLine__DescriptionAttribute(){return"Javascript snippet executed in your browser each time the alarm is triggered, you can use the following variables: $SENSORVALUE$, $UNIT$, $HWDID$, $NAME$, $CONDITION$, $TRIGGER$, $DATATYPE$, $NOW$. Example : <tt>alarm('Warning $NAME$ = $SENSORVALUE$!');</tt>. You can check logs to find out if your alarm code works."}get commandLine(){return this._sensor.getAlarmCommandline(this._index)}set commandLine(e){this._sensor.setAlarmCommandline(this._index,e)}get ATTR_delay__DisplayName(){return"Trigger delay"}get ATTR_delay__NotSavedInXMLAttribute(){return!0}get ATTR_delay__DescriptionAttribute(){return"Minimum delay, in seconds, between two alarms. Think carefully and make sure you won't create alarm storms."}get delay(){return this._sensor.getAlarmDelay(this._index)}set delay(e){this._sensor.setAlarmDelay(this._index,e)}};m(Oa,"AlarmSection");var Jt=Oa,Ua=class Ua{constructor(e){this.ownerForm=null,this.index=-1,this.dataloggerAlreadyLoaded=!1,this._DataSource_source=oe.getNullSensor(),this._DataType=0,this._thickness=2,this._legend="",this._color=c.Red,this._yAxisIndex=0,this._DataSource_AlarmSection0=new Jt(0),this._DataSource_AlarmSection1=new Jt(1),this._color=e}get summary(){return this._DataSource_source instanceof Ae?"none":this._DataSource_source.get_friendlyName()+(this._DataSource_source.isOnline()?"":" - OFFLINE")}Init(e,t){this.ownerForm=e,this.index=t,this.PropagateDataSourceChange(this._DataSource_source)}PropagateDataSourceChange(e){this.ownerForm.SourceChanged(this._DataSource_source,this.index);let t=de.getAllProperties(this).byName,i;for(i in t)i.startsWith("DataSource_AlarmSection")&&this[i].setDataSource(this._DataSource_source)}get ATTR_DataSource_source__DisplayName(){return"Sensor"}get ATTR_DataSource_source__CopyToTarget(){return!1}get ATTR_DataSource_source__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_DataSource_source__DescriptionAttribute(){return"Yoctopuce sensor feeding the graph. "+vt.CheckSensor}get DataSource_source(){return this._DataSource_source}set DataSource_source(e){let t=this._DataSource_source;this._DataSource_source=e,this._DataSource_source!=t&&(S.edited=!0),this.ownerForm!=null&&this.PropagateDataSourceChange(this._DataSource_source)}get isSensorReadOnly(){return this._DataSource_source.isReadOnly}get ATTR_DataSource_freq__DisplayName(){return"Sensor frequency"}get ATTR_DataSource_freq__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_freq__CopyToTarget(){return!1}get ATTR_DataSource_freq__IsReadonlyCallAttribute(){return"isSensorReadOnly"}get ATTR_DataSource_freq__DescriptionAttribute(){return"Sensor data acquisition frequency."+vt.DevConfAffected}get ATTR_DataSource_freq__AllowedValues(){return er.AllowedValues}get DataSource_freq(){return this._DataSource_source.get_frequency()}set DataSource_freq(e){this._DataSource_source.set_frequency(e)}get ATTR_DataSource_datatype__DisplayName(){return"Sensor data"}get ATTR_DataSource_datatype__AllowedValues(){return Br.AllowedValues}get ATTR_DataSource_datatype__CopyToTarget(){return!1}get ATTR_DataSource_datatype__DescriptionAttribute(){return"Which data for sensor are displayed on the graph. Min and Max are available only for frequencies <1Hz"}get DataSource_datatype(){return this._DataType}set DataSource_datatype(e){this._DataType=e,this.ownerForm!=null&&this.ownerForm.SourceChanged(this._DataSource_source,this.index)}get ATTR_DataSource_recording__DisplayName(){return"Sensor recording"}get ATTR_DataSource_recording__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_recording__IsReadonlyCallAttribute(){return"isSensorReadOnly"}get ATTR_DataSource_recording__CopyToTarget(){return!1}get ATTR_DataSource_recording__DescriptionAttribute(){return"Enable/ disable sensor data recording in the device on-board datalogger."+vt.DevConfAffected}get DataSource_recording(){return this._DataSource_source.get_recording()}set DataSource_recording(e){this._DataSource_source.set_recording(e)}get ATTR_thickness__DisplayName(){return"Thickness"}get ATTR_thickness__DescriptionAttribute(){return"Line thickness."}get thickness(){return this._thickness}set thickness(e){this._thickness=e}get ATTR_legend__DisplayName(){return"Legend"}get ATTR_legend__DescriptionAttribute(){return"Short description of the series."}get legend(){return this._legend}set legend(e){this._legend=e}get ATTR_color__DisplayName(){return"Color"}get ATTR_color__DescriptionAttribute(){return"Line color."}get color(){return this._color}set color(e){this._color=e}get ATTR_yAxisIndex__AllowedValues(){return Fs.AllowedValues}get ATTR_yAxisIndex__DisplayName(){return"Y axis"}get ATTR_yAxisIndex__DescriptionAttribute(){return"Choose which Y axis the data with be scaled to."}get yAxisIndex(){return this._yAxisIndex}set yAxisIndex(e){this._yAxisIndex=e}get ATTR_DataSource_AlarmSection0__DisplayName(){return"Sensor value alarm 1"}get ATTR_DataSource_AlarmSection0__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection0__DescriptionAttribute(){return"Alarm 1 for this data source, expand for more."}get DataSource_AlarmSection0(){return this._DataSource_AlarmSection0}set DataSource_AlarmSection0(e){this._DataSource_AlarmSection0=e}get ATTR_DataSource_AlarmSection1__DisplayName(){return"Sensor value alarm 2"}get ATTR_DataSource_AlarmSection1__NotSavedInXMLAttribute(){return!0}get ATTR_DataSource_AlarmSection1__DescriptionAttribute(){return"Alarm 2 for this data source, expand for more."}get DataSource_AlarmSection1(){return this._DataSource_AlarmSection1}set DataSource_AlarmSection1(e){this._DataSource_AlarmSection1=e}};m(Ua,"ChartSerie");var br=Ua,Ba=class Ba{constructor(){this._enabled=!1,this._overlap=!1,this._position=St.Position.RIGHT,this._font=new Et("Arial",7,c.FromArgb(255,32,32,32),!1,!0),this._bgColor=c.FromArgb(200,255,255,255),this._borderColor=c.Black,this._borderthickness=1,this._padding=10,this._verticalMargin=10,this._horizontalMargin=10,this._traceWidthFactor=1}get summary(){return this._enabled?"Enabled":"Disabled"}get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should the legend panel be shown or not"}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_overlap__DisplayName(){return"Overlap"}get ATTR_overlap__DescriptionAttribute(){return"Can the panel overlap the graph data, or should we explicitly make space for it?"}get overlap(){return this._overlap}set overlap(e){this._overlap=e}get ATTR_position__DisplayName(){return"Position"}get ATTR_position__DescriptionAttribute(){return"Position of the legend panel"}get position(){return this._position}set position(e){this._position=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Legend panel contents fonts"}get font(){return this._font}set font(e){this._font=e}get ATTR_bgColor__DisplayName(){return"Background color "}get ATTR_bgColor__DescriptionAttribute(){return"Legend panel background color."}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get ATTR_borderColor__DisplayName(){return"Border color "}get ATTR_borderColor__DescriptionAttribute(){return"Legend panel border color."}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get ATTR_borderthickness__DisplayName(){return"Border thickness "}get ATTR_borderthickness__DescriptionAttribute(){return"Legend panel border thickness"}get borderthickness(){return this._borderthickness}set borderthickness(e){this._borderthickness=e}get ATTR_padding__DisplayName(){return"Padding "}get ATTR_padding__DescriptionAttribute(){return"Distance between the panel border and the panel contents"}get padding(){return this._padding}set padding(e){this._padding=e}get ATTR_verticalMargin__DisplayName(){return"Vertical margin "}get ATTR_verticalMargin__DescriptionAttribute(){return"Vertical distance between the panel border and its surroundings"}get verticalMargin(){return this._verticalMargin}set verticalMargin(e){this._verticalMargin=e}get ATTR_horizontalMargin__DisplayName(){return"Horizontal margin "}get ATTR_horizontalMargin__DescriptionAttribute(){return"Distance between the panel border and its surroundings"}get horizontalMargin(){return this._horizontalMargin}set horizontalMargin(e){this._horizontalMargin=e}get ATTR_traceWidthFactor__DisplayName(){return"Color Indicator Factor"}get ATTR_traceWidthFactor__DescriptionAttribute(){return"Factor used to enlarge series color indicators shown in the legend panel"}get traceWidthFactor(){return this._traceWidthFactor}set traceWidthFactor(e){this._traceWidthFactor=e}};m(Ba,"LegendPanelDescription");var wa=Ba,Ha=class Ha{get summary(){return this._enabled?"Enabled":"Disabled"}get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should the annotation panel be shown or not"}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_overlap__DisplayName(){return"Overlap"}get ATTR_overlap__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_overlap__DescriptionAttribute(){return"Can the annotation panel overlap the display zone, or should the display zone be squeezed to make space for the panel?"}get overlap(){return this._overlap}set overlap(e){this._overlap=e}get ATTR_text__DisplayName(){return"Text "}get ATTR_text__DescriptionAttribute(){return vt.Annotation}get text(){return this._text}set text(e){this._text=e}get ATTR_panelTextAlign__DisplayName(){return"Text Alignment"}get ATTR_panelTextAlign__DescriptionAttribute(){return"How text is aligned, makes sense on multi-lines text only."}get panelTextAlign(){return this._panelTextAlign}set panelTextAlign(e){this._panelTextAlign=e}get ATTR_panelHrzAlign__DisplayName(){return"X Position"}get ATTR_panelHrzAlign__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_panelHrzAlign__DescriptionAttribute(){return"Annotation panel X position"}get panelHrzAlign(){return this._panelHrzAlign}set panelHrzAlign(e){this._panelHrzAlign=e}get ATTR_positionOffsetX__DisplayName(){return"X Offset"}get ATTR_positionOffsetX__DescriptionAttribute(){return"X Position offset, in %  (overlap mode only)"}get positionOffsetX(){return this._positionOffsetX}set positionOffsetX(e){this._positionOffsetX=e}get ATTR_panelVrtAlign__DisplayName(){return"Y Position"}get ATTR_panelVrtAlign__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_panelVrtAlign__DescriptionAttribute(){return"Annotation panel Y position"}get panelVrtAlign(){return this._panelVrtAlign}set panelVrtAlign(e){this._panelVrtAlign=e}get ATTR_positionOffsetY__DisplayName(){return"Y Offset"}get ATTR_positionOffsetY__DescriptionAttribute(){return"Y Position offset, in %  (overlap mode only)"}get positionOffsetY(){return this._positionOffsetY}set positionOffsetY(e){this._positionOffsetY=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Panel font"}get font(){return this._font}set font(e){this._font=e}get ATTR_bgColor__DisplayName(){return"Background color "}get ATTR_bgColor__DescriptionAttribute(){return"Legend panel background color."}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get ATTR_borderColor__DisplayName(){return"Border color "}get ATTR_borderColor__DescriptionAttribute(){return"Legend panel border color."}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get ATTR_borderthickness__DisplayName(){return"Border thickness "}get ATTR_borderthickness__DescriptionAttribute(){return"Panel border thickness"}get borderthickness(){return this._borderthickness}set borderthickness(e){this._borderthickness=e}get ATTR_padding__DisplayName(){return"Padding "}get ATTR_padding__DescriptionAttribute(){return"Distance between the panel border and the panel contents"}get padding(){return this._padding}set padding(e){this._padding=e}constructor(e,t,i,r,s,n,o,a,l){this._enabled=!1,this._overlap=!1,this._text="Date: $DAY$/$MONTH$/$YEAR$",this._panelTextAlign=Se.TextAlign.CENTER,this._panelHrzAlign=Se.HorizontalAlignPos.CENTER,this._positionOffsetX=0,this._panelVrtAlign=Se.VerticalAlignPos.TOP,this._positionOffsetY=0,this._font=new Et("Arial",12,c.FromArgb(255,32,32,32),!1,!1),this._bgColor=c.FromArgb(200,255,255,255),this._borderColor=c.Black,this._borderthickness=1,this._padding=5,typeof s!="undefined"&&(this._text=s),typeof i!="undefined"&&(this._positionOffsetY=i),typeof r!="undefined"&&(this._overlap=r),typeof n!="undefined"&&(this._bgColor=n),typeof o!="undefined"&&(this._borderColor=o),typeof a!="undefined"&&(this._font.size=a),typeof l!="undefined"&&(this._font.color=l),typeof t!="undefined"&&(this._panelVrtAlign=t),typeof e!="undefined"&&(this._panelHrzAlign=e)}};m(Ha,"AnnotationPanelDescription");var Ei=Ha,Ga=class Ga extends Ei{get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should the annotation panel be shown or not"}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_overlap__DisplayName(){return"Overlap"}get ATTR_overlap__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_overlap__DescriptionAttribute(){return"Can the annotation panel overlap the graph, or should the graph be squeezed to make space for the panel?"}get overlap(){return this._overlap}set overlap(e){this._overlap=e}get ATTR_text__DisplayName(){return"Text "}get ATTR_text__DescriptionAttribute(){return vt.AnnotationGraph}get text(){return this._text}set text(e){this._text=e}};m(Ga,"AnnotationPanelDescriptionGraph");var Os=Ga,Bs=class Bs{constructor(){this._enabled=!1,this._showSerieName=!1,this._showTimeStamp=!1,this._dataPrecision=Bs.DataPrecision.PRECISION_NOLIMIT,this._diameter=5,this._handleLength=25,this._font=new Et("Arial",7,c.FromArgb(255,32,32,32),!1,!1),this._bgColor=c.FromArgb(200,255,255,255),this._borderColor=c.Black,this._borderthickness=1,this._padding=5,this._detectionDistance=50}get summary(){return this._enabled?"Enabled":"Disabled"}get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should the data tracker be shown or not."}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_showSerieName__DisplayName(){return"Show Series legend"}get ATTR_showSerieName__DescriptionAttribute(){return"Should the data tracker show the value's series legend."}get showSerieName(){return this._showSerieName}set showSerieName(e){this._showSerieName=e}get ATTR_showTimeStamp__DisplayName(){return"Show Timestamp"}get ATTR_showTimeStamp__DescriptionAttribute(){return"Should the data tracker show the value's timestamp."}get showTimeStamp(){return this._showTimeStamp}set showTimeStamp(e){this._showTimeStamp=e}get ATTR_dataPrecision__DisplayName(){return"Precision"}get ATTR_dataPrecision__DescriptionAttribute(){return"A way to limit data precision to meaningful digits in the data tracker."}get dataPrecision(){return this._dataPrecision}set dataPrecision(e){this._dataPrecision=e}get ATTR_diameter__DisplayName(){return"Point Diameter"}get ATTR_diameter__DescriptionAttribute(){return"Data point diameter, in pixels"}get diameter(){return this._diameter}set diameter(e){this._diameter=e}get ATTR_handleLength__DisplayName(){return"Handle size"}get ATTR_handleLength__DescriptionAttribute(){return"size of the handle between the data point and the value panel"}get handleLength(){return this._handleLength}set handleLength(e){this._handleLength=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Data tracker label fonts"}get font(){return this._font}set font(e){this._font=e}get ATTR_bgColor__DisplayName(){return"Background color"}get ATTR_bgColor__DescriptionAttribute(){return"Value panel ground color."}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get ATTR_borderColor__DisplayName(){return"Border color"}get ATTR_borderColor__DescriptionAttribute(){return"Value panel border and handle  color."}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get ATTR_borderthickness__DisplayName(){return"Border thickness "}get ATTR_borderthickness__DescriptionAttribute(){return"Value panel border and handle  thickness"}get borderthickness(){return this._borderthickness}set borderthickness(e){this._borderthickness=e}get ATTR_padding__DisplayName(){return"Padding"}get ATTR_padding__DescriptionAttribute(){return"Distance between the panel border and its contents "}get padding(){return this._padding}set padding(e){this._padding=e}get ATTR_detectionDistance__DisplayName(){return"Detection distance"}get ATTR_detectionDistance__DescriptionAttribute(){return"Maximum distance, in pixels, between the mouse and a data point for data tracker to show. Use zero for infinite distance"}get detectionDistance(){return this._detectionDistance}set detectionDistance(e){this._detectionDistance=e}};m(Bs,"DataTrackerDescription");var Hr=Bs;(function(D){let i=class i extends De{constructor(n,o,a){super(n,o,t)}};m(i,"DataPrecisionEnumItem");let e=i;D.DataPrecisionEnumItem=e;let r=class r extends Le{};m(r,"DataPrecision");let t=r;t.PRECISION_NOLIMIT=new e("PRECISION_NOLIMIT","As is"),t.PRECISION_1=new e("PRECISION_1","1"),t.PRECISION_01=new e("PRECISION_01","0.1"),t.PRECISION_001=new e("PRECISION_001","0.01"),t.PRECISION_0001=new e("PRECISION_0001","0.001"),D.DataPrecision=t})(Hr||(Hr={}));var Wa=class Wa{get summary(){return this._enabled?"Enabled":"Disabled"}constructor(){this._enabled=!1,this._bgColor1=c.FromArgb(255,225,225,225),this._bgColor2=c.FromArgb(255,225,225,225),this._borderThickness=1,this._borderColor=c.Black,this._cursorColor=c.FromArgb(25,0,255,0),this._cursorBorderColor=c.FromArgb(255,96,96,96),this._yAxisHandling=Vi.YAxisHandling.AUTO,this._xAxisThickness=1,this._xAxisColor=c.Black,this._font=new Et("Arial",10,c.FromArgb(255,32,32,32),!1,!1)}get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should the navigator be shown or not."}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_bgColor1__DisplayName(){return"Background color 1"}get ATTR_bgColor1__DescriptionAttribute(){return"Navigator background gradient color 1."}get bgColor1(){return this._bgColor1}set bgColor1(e){this._bgColor1=e}get ATTR_bgColor2__DisplayName(){return"Background color 2"}get ATTR_bgColor2__DescriptionAttribute(){return"Navigator background gradient color 2."}get bgColor2(){return this._bgColor2}set bgColor2(e){this._bgColor2=e}get ATTR_borderThickness__DisplayName(){return"Border thickness"}get ATTR_borderThickness__DescriptionAttribute(){return"Navigator"}get borderThickness(){return this._borderThickness}set borderThickness(e){this._borderThickness=e}get ATTR_borderColor__DisplayName(){return"Border color"}get ATTR_borderColor__DescriptionAttribute(){return"Navigator Border color."}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get ATTR_cursorColor__DisplayName(){return"Navigator cursor fill color"}get ATTR_cursorColor__DescriptionAttribute(){return"Navigator"}get cursorColor(){return this._cursorColor}set cursorColor(e){this._cursorColor=e}get ATTR_cursorBorderColor__DisplayName(){return"Navigator cursor left/right border color."}get ATTR_cursorBorderColor__DescriptionAttribute(){return"Navigator"}get cursorBorderColor(){return this._cursorBorderColor}set cursorBorderColor(e){this._cursorBorderColor=e}get ATTR_yAxisHandling__DisplayName(){return"Y axis range"}get ATTR_yAxisHandling__DescriptionAttribute(){return"Is navigator Y axis zoom automatic or inherited from main view settings?"}get yAxisHandling(){return this._yAxisHandling}set yAxisHandling(e){this._yAxisHandling=e}get ATTR_xAxisThickness__DisplayName(){return"X axis thickness"}get ATTR_xAxisThickness__DescriptionAttribute(){return"Navigator"}get xAxisThickness(){return this._xAxisThickness}set xAxisThickness(e){this._xAxisThickness=e}get ATTR_xAxisColor__DisplayName(){return"X axis color"}get ATTR_xAxisColor__DescriptionAttribute(){return"Navigator X axis color."}get xAxisColor(){return this._xAxisColor}set xAxisColor(e){this._xAxisColor=e}get ATTR_font__DisplayName(){return"X-Axis Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Navigator X axis font"}get font(){return this._font}set font(e){this._font=e}};m(Wa,"NavigatorDescription");var Ra=Wa,Xa=class Xa{constructor(){this._title="",this._font=new Et("Arial",12,c.Black,!1,!0)}get ATTR_title__DisplayName(){return"Text"}get ATTR_title__DescriptionAttribute(){return"Legend text"}get title(){return this._title}set title(e){this._title=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Legend font"}get font(){return this._font}set font(e){this._font=e}};m(Xa,"LegendDescription");var Us=Xa,Za=class Za{constructor(e,t){this._visible=!1,this._position=Nt.HrzPosition.LEFT,this._min=new et(Number.NaN),this._max=new et(Number.NaN),this._step=new et(Number.NaN),this._color=c.FromArgb(255,127,127,127),this._thickness=1,this._showGrid=!1,this._gridColor=c.FromArgb(255,210,210,210),this._gridThickness=1,this._font=new Et("Arial",10,c.Black,!1,!1),this._legend=new Us,this._zones0=new zr(0,50,c.LightGreen),this._zones1=new zr(50,80,c.Yellow),this._zones2=new zr(80,100,c.Red),this._visible=t,this._showGrid=e==0,this._position=e==0?Nt.HrzPosition.LEFT:Nt.HrzPosition.RIGHT}get summary(){return this._visible?"Enabled":"Disabled"}get ATTR_visible__DisplayName(){return"Visible"}get ATTR_visible__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_visible__DescriptionAttribute(){return"Should that YAxis be shown?."}get visible(){return this._visible}set visible(e){this._visible=e}get ATTR_position__DisplayName(){return"Position"}get ATTR_position__DescriptionAttribute(){return"Y Axis position (left / right)"}get position(){return this._position}set position(e){this._position=e}get ATTR_min__DisplayName(){return"Minimum value"}get ATTR_min__DescriptionAttribute(){return"YAxis minimum value, leave blank for automatic behavior."}get min(){return this._min}set min(e){this._min=e}get ATTR_max__DisplayName(){return"Maximum value"}get ATTR_max__DescriptionAttribute(){return"YAxis maximum value, leave blank for automatic behavior."}get max(){return this._max}set max(e){this._max=e}get ATTR_step__DisplayName(){return"Steps"}get ATTR_step__DescriptionAttribute(){return"YAxis step size, leave blank for automatic behavior."}get step(){return this._step}set step(e){this._step=e}get ATTR_color__DisplayName(){return"Color"}get ATTR_color__DescriptionAttribute(){return"Y Axis Color."}get color(){return this._color}set color(e){this._color=e}get ATTR_thickness__DisplayName(){return"Thickness"}get ATTR_thickness__DescriptionAttribute(){return"Axis thickness"}get thickness(){return this._thickness}set thickness(e){this._thickness=e}get ATTR_showGrid__DisplayName(){return"Show Grid"}get ATTR_showGrid__DescriptionAttribute(){return"Show grid horizontal lines, or not."}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e}get ATTR_gridColor__DisplayName(){return"Grid Color"}get ATTR_gridColor__DescriptionAttribute(){return"Grid horizontal lines color."}get gridColor(){return this._gridColor}set gridColor(e){this._gridColor=e}get ATTR_gridThickness__DisplayName(){return"Grid thickness"}get ATTR_gridThickness__DescriptionAttribute(){return"Grid horizontal lines thickness"}get gridThickness(){return this._gridThickness}set gridThickness(e){this._gridThickness=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Axis font"}get font(){return this._font}set font(e){this._font=e}get ATTR_legend__DisplayName(){return"Legend"}get ATTR_legend__DescriptionAttribute(){return"Axis legend"}get legend(){return this._legend}set legend(e){this._legend=e}get ATTR_zones0__DisplayName(){return"Zone 1"}get ATTR_zones0__CategoryAttribute(){return"Zones"}get ATTR_zones0__ReadOnlyAttribute(){return!0}get ATTR_zones0__DescriptionAttribute(){return"Zone 1 parameters"}get zones0(){return this._zones0}set zones0(e){this._zones0=e}get ATTR_zones1__DisplayName(){return"Zone 2"}get ATTR_zones1__CategoryAttribute(){return"Zones"}get ATTR_zones1__ReadOnlyAttribute(){return!0}get ATTR_zones1__DescriptionAttribute(){return"Zone 2 parameters"}get zones1(){return this._zones1}set zones1(e){this._zones1=e}get ATTR_zones2__DisplayName(){return"Zone 3"}get ATTR_zones2__CategoryAttribute(){return"Zones"}get ATTR_zones2__ReadOnlyAttribute(){return!0}get ATTR_zones2__DescriptionAttribute(){return"Zone 3 parameters"}get zones2(){return this._zones2}set zones2(e){this._zones2=e}};m(Za,"YaxisDescription");var Ji=Za,Ka=class Ka{constructor(e){this._enabled=!1,this._text="",this._textAlign=Di.TextAlign.CENTER,this._timereference=he.TimeReference.ABSOLUTE,this._positionOnXAxis=new _t(he.ToUnixTime(new Date),!1),this._yposition=95,this._bgColor=c.FromArgb(200,255,255,192),this._borderColor=c.DarkRed,this._borderthickness=1,this._padding=5,this._font=new Et("Arial",7,c.Black,!1,!1),this._text=e}get summary(){return this._enabled?"Enabled":"Disabled"}get ATTR_enabled__DisplayName(){return"Enabled"}get ATTR_enabled__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_enabled__DescriptionAttribute(){return"Should that marker be shown?."}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get ATTR_text__DisplayName(){return"Text"}get ATTR_text__DescriptionAttribute(){return"Marker text. Use \\n for multi-line text. Some variables are allowed such as $MARKERTIME$, $LEGEND1$, $VALUE1$, $UNIT1$, $LEGEND1$, $VALUE2$ etc.. Extensive use of marker variables migh make the graph rendering significantly slower."}get text(){return this._text}set text(e){this._text=e}get ATTR_textAlign__DisplayName(){return"Text Alignment"}get ATTR_textAlign__DescriptionAttribute(){return"How text is aligned, makes sense on multi-lines text only."}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get ATTR_timereference__DisplayName(){return"Time reference"}get ATTR_timereference__ChangeCausesParentRefreshAttribute(){return!0}get ATTR_timereference__NotSavedInXMLAttribute(){return!0}get ATTR_timereference__DescriptionAttribute(){return"Should the marker time position be absolute or relative to first data timestamp? Note: relative markers won't be drawn until there is actual data."}get timereference(){return this._timereference}set timereference(e){this._timereference=e,this._positionOnXAxis.relative=e==he.TimeReference.RELATIVE}get ATTR_positionOnXAxis__DisplayName(){return"Time position"}get ATTR_positionOnXAxis__DescriptionAttribute(){return"Marker position on X axis."}get positionOnXAxis(){return this._positionOnXAxis}set positionOnXAxis(e){this._positionOnXAxis=e,this.timereference=e.relative?he.TimeReference.RELATIVE:he.TimeReference.ABSOLUTE}get ATTR_yposition__DisplayName(){return"Vrt position (%)"}get ATTR_yposition__DescriptionAttribute(){return"Vertical position of the marker label in % of available space. Zero is bottom"}get yposition(){return this._yposition}set yposition(e){this._yposition=e}get ATTR_bgColor__DisplayName(){return"Background color "}get ATTR_bgColor__DescriptionAttribute(){return"Marker  background color."}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get ATTR_borderColor__DisplayName(){return"Border color "}get ATTR_borderColor__DescriptionAttribute(){return"Marker border color."}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get ATTR_borderthickness__DisplayName(){return"Border thickness "}get ATTR_borderthickness__DescriptionAttribute(){return"Marker border thickness, in pixels."}get borderthickness(){return this._borderthickness}set borderthickness(e){this._borderthickness=e}get ATTR_padding__DisplayName(){return"Padding "}get ATTR_padding__DescriptionAttribute(){return"Distance between the marker border and the marker contents, in pixels."}get padding(){return this._padding}set padding(e){this._padding=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Marker Font"}get font(){return this._font}set font(e){this._font=e}};m(Ka,"MarkerDescription");var bi=Ka,ja=class ja{constructor(){this._initialZoom=60,this._initialOffset=0,this._position=ct.VrtPosition.BOTTOM,this._timeReference=he.TimeReference.ABSOLUTE,this._overflowHandling=ct.OverflowHandling.SCROLL,this._color=c.FromArgb(255,127,127,127),this._thickness=1,this._showGrid=!1,this._gridColor=c.FromArgb(50,0,0,0),this._gridThickness=1,this._font=new Et("Arial",10,c.Black,!1,!1),this._legend=new Us,this._markers0=new bi("Marker 1"),this._markers1=new bi("Marker 2"),this._markers2=new bi("Marker 3"),this._markers3=new bi("Marker 4"),this._markers4=new bi("Marker 5"),this._markers5=new bi("Marker 6"),this._markers6=new bi("Marker 7"),this._markers7=new bi("Marker 8")}get ATTR_initialZoom__DisplayName(){return"Initial Zoom"}get ATTR_initialZoom__DescriptionAttribute(){return"Zoom level at application startup, i.e. width of the view-port in seconds."}get initialZoom(){return this._initialZoom}set initialZoom(e){this._initialZoom=e}get ATTR_initialOffset__DisplayName(){return"Initial Offset"}get ATTR_initialOffset__DescriptionAttribute(){return"Offset of the first data point in percentage of the viewport width. For instance a 50% value will put the first point in the middle of the viewport. This can be used to give some room for datalogger contents."}get initialOffset(){return this._initialOffset}set initialOffset(e){this._initialOffset=e}get ATTR_position__DisplayName(){return"Position"}get ATTR_position__DescriptionAttribute(){return"X Axis position (top / bottom)"}get position(){return this._position}set position(e){this._position=e}get ATTR_timeReference__DisplayName(){return"Time reference"}get ATTR_timeReference__DescriptionAttribute(){return"Are gradation timestamps absolute or relative to experiment start time? "}get timeReference(){return this._timeReference}set timeReference(e){this._timeReference=e}get ATTR_overflowHandling__DisplayName(){return"Overflow Handling"}get ATTR_overflowHandling__DescriptionAttribute(){return"What to do when new data are about to reach the graph right border"}get overflowHandling(){return this._overflowHandling}set overflowHandling(e){this._overflowHandling=e}get ATTR_color__DisplayName(){return"Color"}get ATTR_color__DescriptionAttribute(){return"X Axis Color."}get color(){return this._color}set color(e){this._color=e}get ATTR_thickness__DisplayName(){return"Thickness"}get ATTR_thickness__DescriptionAttribute(){return"Axis thickness"}get thickness(){return this._thickness}set thickness(e){this._thickness=e}get ATTR_showGrid__DisplayName(){return"Show Grid"}get ATTR_showGrid__DescriptionAttribute(){return"Show grid vertical lines, or not."}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e}get ATTR_gridColor__DisplayName(){return"Grid Color"}get ATTR_gridColor__DescriptionAttribute(){return"Grid vertical lines color."}get gridColor(){return this._gridColor}set gridColor(e){this._gridColor=e}get ATTR_gridThickness__DisplayName(){return"Grid thickness"}get ATTR_gridThickness__DescriptionAttribute(){return"Grid vertical lines thickness"}get gridThickness(){return this._gridThickness}set gridThickness(e){this._gridThickness=e}get ATTR_font__DisplayName(){return"Font"}get ATTR_font__ReadOnlyAttribute(){return!0}get ATTR_font__DescriptionAttribute(){return"Axis font"}get font(){return this._font}set font(e){this._font=e}get ATTR_legend__DisplayName(){return"Legend"}get ATTR_legend__ReadOnlyAttribute(){return!0}get ATTR_legend__DescriptionAttribute(){return"X Axis legend"}get legend(){return this._legend}set legend(e){this._legend=e}get ATTR_markers0__DisplayName(){return"Marker 1"}get ATTR_markers0__ReadOnlyAttribute(){return!0}get ATTR_markers0__CategoryAttribute(){return"Markers"}get ATTR_markers0__DescriptionAttribute(){return"First marker parameters"}get markers0(){return this._markers0}set markers0(e){this._markers0=e}get ATTR_markers1__DisplayName(){return"Marker 2"}get ATTR_markers1__ReadOnlyAttribute(){return!0}get ATTR_markers1__CategoryAttribute(){return"Markers"}get ATTR_markers1__DescriptionAttribute(){return"Second marker parameters"}get markers1(){return this._markers1}set markers1(e){this._markers1=e}get ATTR_markers2__DisplayName(){return"Marker 3"}get ATTR_markers2__ReadOnlyAttribute(){return!0}get ATTR_markers2__CategoryAttribute(){return"Markers"}get ATTR_markers2__DescriptionAttribute(){return"Third marker parameters"}get markers2(){return this._markers2}set markers2(e){this._markers2=e}get ATTR_markers3__DisplayName(){return"Marker 4"}get ATTR_markers3__ReadOnlyAttribute(){return!0}get ATTR_markers3__CategoryAttribute(){return"Markers"}get ATTR_markers3__DescriptionAttribute(){return"Fourth marker parameters"}get markers3(){return this._markers3}set markers3(e){this._markers3=e}get ATTR_markers4__DisplayName(){return"Marker 5"}get ATTR_markers4__ReadOnlyAttribute(){return!0}get ATTR_markers4__CategoryAttribute(){return"Markers"}get ATTR_markers4__DescriptionAttribute(){return"Fith marker parameters"}get markers4(){return this._markers4}set markers4(e){this._markers4=e}get ATTR_markers5__DisplayName(){return"Marker 6"}get ATTR_markers5__ReadOnlyAttribute(){return!0}get ATTR_markers5__CategoryAttribute(){return"Markers"}get ATTR_markers5__DescriptionAttribute(){return"Sixth marker parameters"}get markers5(){return this._markers5}set markers5(e){this._markers5=e}get ATTR_markers6__DisplayName(){return"Marker 7"}get ATTR_markers6__ReadOnlyAttribute(){return!0}get ATTR_markers6__CategoryAttribute(){return"Markers"}get ATTR_markers6__DescriptionAttribute(){return"Seventh marker parameters"}get markers6(){return this._markers6}set markers6(e){this._markers6=e}get ATTR_markers7__DisplayName(){return"Marker 8"}get ATTR_markers7__ReadOnlyAttribute(){return!0}get ATTR_markers7__CategoryAttribute(){return"Markers"}get ATTR_markers7__DescriptionAttribute(){return"Height marker parameters"}get markers7(){return this._markers7}set markers7(e){this._markers7=e}};m(ja,"XaxisDescription");var Qi=ja,qa=class qa extends de{constructor(e,t){super(t),this._Graph_series0=new br(c.Tomato),this._Graph_series1=new br(c.DodgerBlue),this._Graph_series2=new br(c.SeaGreen),this._Graph_series3=new br(c.Gold),this._Graph_showRecordedData=!1,this._Graph_borderColor=c.LightGray,this._Graph_borderThickness=1,this._Graph_bgColor1=c.FromArgb(255,220,220,220),this._Graph_bgColor2=c.FromArgb(55,240,240,240),this._Graph_resizeRule=Be.ResizeRule.FIXED,this._Graph_xAxis=new Qi,this._Graph_yAxes0=new Ji(0,!0),this._Graph_yAxes1=new Ji(1,!1),this._Graph_yAxes2=new Ji(2,!1),this._Graph_legendPanel=new wa,this._Graph_dataTracker=new Hr,this._Graph_navigator=new Ra,this._annotationPanels0=new Os,this._annotationPanels1=new Os,this.initFromXmlData(e)}IsDataSourceAssigned(){return Object.getOwnPropertyNames(this).forEach(t=>{if(t.startsWith("Graphs_series")&&!(this[t].GetValue(this,null).DataSource_source instanceof Ae))return!0}),!1}get ATTR_Graph_series0__DisplayName(){return"Series 1"}get ATTR_Graph_series0__CategoryAttribute(){return"Data Sources"}get ATTR_Graph_series0__PreExpandedCategoryAttribute(){return!0}get ATTR_Graph_series0__PreExpandedAttribute(){return!0}get ATTR_Graph_series0__ReadOnlyAttribute(){return!0}get ATTR_Graph_series0__DescriptionAttribute(){return"First data series, expand for more."}get Graph_series0(){return this._Graph_series0}set Graph_series0(e){this._Graph_series0=e}get ATTR_Graph_series1__DisplayName(){return"Series 2"}get ATTR_Graph_series1__CategoryAttribute(){return"Data Sources"}get ATTR_Graph_series1__ReadOnlyAttribute(){return!0}get ATTR_Graph_series1__DescriptionAttribute(){return"Second data series, expand for more."}get Graph_series1(){return this._Graph_series1}set Graph_series1(e){this._Graph_series1=e}get ATTR_Graph_series2__DisplayName(){return"Series 3"}get ATTR_Graph_series2__CategoryAttribute(){return"Data Sources"}get ATTR_Graph_series2__ReadOnlyAttribute(){return!0}get ATTR_Graph_series2__DescriptionAttribute(){return"Third data series, expand for more."}get Graph_series2(){return this._Graph_series2}set Graph_series2(e){this._Graph_series2=e}get ATTR_Graph_series3__DisplayName(){return"Series 4"}get ATTR_Graph_series3__CategoryAttribute(){return"Data Sources"}get ATTR_Graph_series3__ReadOnlyAttribute(){return!0}get ATTR_Graph_series3__DescriptionAttribute(){return"Fourth data series, expand for more."}get Graph_series3(){return this._Graph_series3}set Graph_series3(e){this._Graph_series3=e}get ATTR_Graph_showRecordedData__DisplayName(){return"Use datalogger data"}get ATTR_Graph_showRecordedData__CategoryAttribute(){return"Graph"}get ATTR_Graph_showRecordedData__CopyToTarget(){return!1}get ATTR_Graph_showRecordedData__DescriptionAttribute(){return"Makes the graph load the sensors datalogger contents. After disabling this feature, you may want to reset the dataview with the right-click context menu."}get Graph_showRecordedData(){return this._Graph_showRecordedData}set Graph_showRecordedData(e){this._Graph_showRecordedData!=e&&(this._Graph_showRecordedData=e,this.ownerForm!=null&&(this._Graph_showRecordedData?this.ownerForm.loadRecordedDataIfNeeded():this.ownerForm.removeDataloggerData()))}get ATTR_Graph_borderColor__DisplayName(){return"Border color"}get ATTR_Graph_borderColor__CategoryAttribute(){return"Graph"}get ATTR_Graph_borderColor__DescriptionAttribute(){return"Canvas borders color."}get Graph_borderColor(){return this._Graph_borderColor}set Graph_borderColor(e){this._Graph_borderColor=e}get ATTR_Graph_borderThickness__DisplayName(){return"Border thickness"}get ATTR_Graph_borderThickness__CategoryAttribute(){return"Graph"}get ATTR_Graph_borderThickness__DescriptionAttribute(){return"Canvas borders thickness."}get Graph_borderThickness(){return this._Graph_borderThickness}set Graph_borderThickness(e){this._Graph_borderThickness=e}get ATTR_Graph_bgColor1__DisplayName(){return"Background color 1"}get ATTR_Graph_bgColor1__CategoryAttribute(){return"Graph"}get ATTR_Graph_bgColor1__DescriptionAttribute(){return"Background gradient color 1."}get Graph_bgColor1(){return this._Graph_bgColor1}set Graph_bgColor1(e){this._Graph_bgColor1=e}get ATTR_Graph_bgColor2__DisplayName(){return"Background color 2"}get ATTR_Graph_bgColor2__CategoryAttribute(){return"Graph"}get ATTR_Graph_bgColor2__DescriptionAttribute(){return"Background gradient color 2."}get Graph_bgColor2(){return this._Graph_bgColor2}set Graph_bgColor2(e){this._Graph_bgColor2=e}get ATTR_Graph_resizeRule__DisplayName(){return"Font sizes"}get ATTR_Graph_resizeRule__CategoryAttribute(){return"Graph"}get ATTR_Graph_resizeRule__DescriptionAttribute(){return"Are font sizes fixed or do they change when window is resized?"}get Graph_resizeRule(){return this._Graph_resizeRule}set Graph_resizeRule(e){this._Graph_resizeRule=e}get ATTR_Graph_xAxis__DisplayName(){return"X Axis"}get ATTR_Graph_xAxis__CategoryAttribute(){return"X/Y Axes"}get ATTR_Graph_xAxis__ReadOnlyAttribute(){return!0}get ATTR_Graph_xAxis__DescriptionAttribute(){return"X-Axis, expand for more"}get Graph_xAxis(){return this._Graph_xAxis}set Graph_xAxis(e){this._Graph_xAxis=e}get ATTR_Graph_yAxes0__DisplayName(){return"YAxis 1"}get ATTR_Graph_yAxes0__ReadOnlyAttribute(){return!0}get ATTR_Graph_yAxes0__CategoryAttribute(){return"X/Y Axes"}get ATTR_Graph_yAxes0__DescriptionAttribute(){return"First Y Axis, expand for more."}get Graph_yAxes0(){return this._Graph_yAxes0}set Graph_yAxes0(e){this._Graph_yAxes0=e}get ATTR_Graph_yAxes1__DisplayName(){return"YAxis 2"}get ATTR_Graph_yAxes1__ReadOnlyAttribute(){return!0}get ATTR_Graph_yAxes1__CategoryAttribute(){return"X/Y Axes"}get ATTR_Graph_yAxes1__DescriptionAttribute(){return"Second Y Axis, expand for more."}get Graph_yAxes1(){return this._Graph_yAxes1}set Graph_yAxes1(e){this._Graph_yAxes1=e}get ATTR_Graph_yAxes2__DisplayName(){return"YAxis 3"}get ATTR_Graph_yAxes2__ReadOnlyAttribute(){return!0}get ATTR_Graph_yAxes2__CategoryAttribute(){return"X/Y Axes"}get ATTR_Graph_yAxes2__DescriptionAttribute(){return"Third Y Axis, expand for more."}get Graph_yAxes2(){return this._Graph_yAxes2}set Graph_yAxes2(e){this._Graph_yAxes2=e}get ATTR_Graph_legendPanel__DisplayName(){return"Legend Panel"}get ATTR_Graph_legendPanel__ReadOnlyAttribute(){return!0}get ATTR_Graph_legendPanel__CategoryAttribute(){return"Graph"}get ATTR_Graph_legendPanel__DescriptionAttribute(){return"Panel containing a description of all data series. Expand for more."}get Graph_legendPanel(){return this._Graph_legendPanel}set Graph_legendPanel(e){this._Graph_legendPanel=e}get ATTR_Graph_dataTracker__DisplayName(){return"Data tracker"}get ATTR_Graph_dataTracker__ReadOnlyAttribute(){return!0}get ATTR_Graph_dataTracker__CategoryAttribute(){return"Graph"}get ATTR_Graph_dataTracker__DescriptionAttribute(){return"Show dynamic value labels while the mouse is moving over the graph. Expand for more."}get Graph_dataTracker(){return this._Graph_dataTracker}set Graph_dataTracker(e){this._Graph_dataTracker=e}get ATTR_Graph_navigator__DisplayName(){return"Navigator"}get ATTR_Graph_navigator__CategoryAttribute(){return"Graph"}get ATTR_Graph_navigator__ReadOnlyAttribute(){return!0}get ATTR_Graph_navigator__DescriptionAttribute(){return"Small additional graph showing the whole data set and allowing to quickly navigate among data. Expand for more."}get Graph_navigator(){return this._Graph_navigator}set Graph_navigator(e){this._Graph_navigator=e}get ATTR_Graph_annotationPanels0__DisplayName(){return"Annotation 1"}get ATTR_Graph_annotationPanels0__CategoryAttribute(){return"Annotations"}get ATTR_Graph_annotationPanels0__ReadOnlyAttribute(){return!0}get ATTR_Graph_annotationPanels0__DescriptionAttribute(){return"Customizable text panel 1"}get Graph_annotationPanels0(){return this._annotationPanels0}set Graph_annotationPanels0(e){this._annotationPanels0=e}get ATTR_Graph_annotationPanels1__DisplayName(){return"Annotation 2"}get ATTR_Graph_annotationPanels1__CategoryAttribute(){return"Annotations"}get ATTR_Graph_annotationPanels1__ReadOnlyAttribute(){return!0}get ATTR_Graph_annotationPanels1__DescriptionAttribute(){return"Customizable text panel 2"}get Graph_annotationPanels1(){return this._annotationPanels1}set Graph_annotationPanels1(e){this._annotationPanels1=e}};m(qa,"GraphFormProperties");var Fr=qa;var Qa=class Qa{constructor(){this.TR=document.createElement("TR"),this.TR.objectData=this,this.TR.className=tt.SEPARATOR_MARKER,this.TD_caption=document.createElement("TD"),this.TD_caption.style.backgroundColor=tt.iconBGColor,this.TD_caption.style.paddingLeft="3px",this.TD_caption.style.paddingRight="3px";let e=document.createElement("HR");this.TD_caption.colSpan=2,this.TD_caption.appendChild(e),this.TD_icon=document.createElement("TD"),this.TD_icon.style.backgroundColor=tt.captionBgColor,this.TR.appendChild(this.TD_icon),this.TR.appendChild(this.TD_caption)}toString(){return"Separator"}get focusable(){return!1}parentMenuisClosing(){}get domData(){return this.TR}};m(Qa,"ContextMenuSeparator");var $a=Qa,eo=class eo{get userdata(){return this._userdata}set userdata(e){this._userdata=e}constructor(e,t,i){this._clickHidesMenu=!0,this._userdata=null,this._menu=e,this.TR=document.createElement("TR"),this.TR.objectData=this,this.TD_caption=document.createElement("TD"),this.TD_caption.style.backgroundColor=tt.iconBGColor,this.TD_caption.style.paddingLeft="3px",this.TD_caption.style.paddingRight="3px",this.TD_caption.style.whiteSpace="nowrap",this.TD_icon=document.createElement("TD"),t!=null&&(this.TD_icon.innerHTML=t),this.TD_icon.style.backgroundColor=tt.captionBgColor,this.A_caption=document.createElement("A"),this.A_caption.innerHTML=i,this.TR.style.cursor="pointer",this.TR.tabIndex=0,this.TR.style.outline="none",this._TR_keydown=r=>{r.preventDefault(),this.keydown(r)},this._TR_mouseover=r=>{this.mouserOver(r)},this._TR_mouseout=r=>{this.mouserOut(r)},this._A_mouseover=r=>{this.mouserOver(r)},this._A_mouseout=r=>{this.mouserOut(r)},this._A_click=r=>{this.activate()},this._TR_focusin=()=>{this.focusIn()},this._TR_focusout=()=>{this.focusOut()},this.TR.addEventListener("mouseover",this._TR_mouseover),this.TR.addEventListener("mouseout",this._TR_mouseout),this.TR.addEventListener("click",this._A_click),this.TR.addEventListener("keydown",this._TR_keydown),this.A_caption.addEventListener("mouseover",this._A_mouseover),this.A_caption.addEventListener("mouseout",this._A_mouseout),this.TD_caption.appendChild(this.A_caption),this.TR.appendChild(this.TD_icon),this.TR.appendChild(this.TD_caption),this.TR.addEventListener("focusin",this._TR_focusin),this.TR.addEventListener("focusout",this._TR_focusout)}toString(){return this.TD_caption.innerText}get focusable(){return this.visible}activate(){}focus(){this.TR.focus(),this._menu.closeSubmenus()}focusIn(){this.TD_caption.style.backgroundColor==tt.iconBGColor&&this._menu.closeSubmenus(),this.TD_caption.style.backgroundColor=tt.ActiveColor,this.TD_icon.style.backgroundColor=tt.ActiveColor}focusOut(){this.TD_caption.style.backgroundColor=tt.iconBGColor,this.TD_icon.style.backgroundColor=tt.captionBgColor}removeAndDestroy(){this.TR.parentNode!=null&&this.TR.parentNode.removeChild(this.TR),this.TR.removeEventListener("keydown",this._TR_keydown),this.TR.removeEventListener("mouseover",this._TR_mouseover),this.TR.removeEventListener("mouseout",this._TR_mouseout),this.A_caption.removeEventListener("mouseover",this._A_mouseover),this.A_caption.removeEventListener("mouseout",this._A_mouseout),this.A_caption.removeEventListener("click",this._A_click),this.TR.removeEventListener("focusin",this._TR_focusin),this.TR.removeEventListener("focusout",this._TR_focusout)}set caption(e){this.A_caption.innerHTML=e}get caption(){return this.A_caption.innerHTML}keydown(e){e.code=="ArrowDown"&&this._menu.activateNext(this),e.code=="ArrowUp"&&this._menu.activatePrevious(this),e.code=="Enter"&&this.activate(),e.code=="Escape"&&(this._menu.close(),this._menu.parentMenuItem!=null&&this._menu.parentMenuItem.focus()),e.code=="ArrowLeft"&&this._menu.parentMenuItem!=null&&(this._menu.close(),this._menu.parentMenuItem.focus())}mouserOver(e){this.TD_caption.style.backgroundColor=tt.ActiveColor,this.TD_icon.style.backgroundColor=tt.ActiveColor,this._menu.closeSubmenus()}mouserOut(e){this.TD_caption.style.backgroundColor=tt.iconBGColor,this.TD_icon.style.backgroundColor=tt.captionBgColor}get domData(){return this.TR}get visible(){return this.TR.style.display!="none"}set visible(e){this.TR.style.display=e?"":"none"}parentMenuisClosing(){}closeMenu(e){e?this._menu.closeAll():this._menu.close()}};m(eo,"ContextMenuItemBase");var Ja=eo,to=class to extends Ja{activate(){this._clickHidesMenu&&this.closeMenu(!0),this._callback!=null&&this._callback()}constructor(e,t,i,r){super(e,t,i),this._callback=r,this.TD_caption.colSpan=2}};m(to,"ContextMenuItem");var Hs=to,io=class io extends Hs{constructor(e,t,i,r){super(e,t,i,null),this.TD_caption.colSpan=1,this._submenu=r,this._submenu.parentMenuItem=this,this._parentmenu=e,this._clickHidesMenu=!1,this.TD_arrow=document.createElement("TD"),this.TD_arrow.style.backgroundColor=tt.iconBGColor,this.TD_arrow.style.textAlign="right",this.TD_arrow.style.paddingRight="3px",this.TD_arrow.innerHTML="&#9654;",this.TR.appendChild(this.TD_arrow),this.A_caption.addEventListener("click",s=>{this.showSubmenu()}),this.A_caption.addEventListener("touchstart",s=>{s.touches.length==1&&this.activate()}),this._submenu.zIndex=this._parentmenu.zIndex+1}keydown(e){super.keydown(e),e.code=="ArrowRight"&&(this.activate(),this._submenu.focusFirst())}removeAndDestroy(){this._submenu.close(),this._submenu.destroy(),super.removeAndDestroy()}activate(){this.showSubmenu()}get submenu(){return this._submenu}showSubmenu(){this._submenu.zIndex=this._parentmenu.zIndex+1;let e=0,t=0,i=this.TR;do e+=i.offsetLeft||0,t+=i.offsetTop||0,i=i.offsetParent;while(i);this._submenu.showContextMenu(e+this._parentmenu.width-15,t+5)}focusIn(){super.focusIn(),this.TD_arrow.style.backgroundColor=tt.ActiveColor}focusOut(){super.focusOut(),this.TD_arrow.style.backgroundColor=tt.iconBGColor}parentMenuisClosing(){this._submenu.close()}mouserOver(e){this.focusIn(),this._parentmenu.setDelayedAction(()=>{this.visible&&this.showSubmenu()})}mouserOut(e){this._parentmenu.cancelDelayedAction(),this.focusOut()}};m(io,"ContextMenuItemSubMenuEntry");var Gr=io,ro=class ro{get parentMenuItem(){return this._parentMenuItem}set parentMenuItem(e){this._parentMenuItem=e}get userdata(){return this._userdata}set userdata(e){this._userdata=e}constructor(e,t,i){this._visible=!1,this._zIndex=100002,this._parentmenu=null,this._parentMenuItem=null,this._userdata=null,this._openCallback=t,this.Menutable=document.createElement("TABLE"),this.Menutable.style.position="absolute",this.Menutable.style.border="1px solid #808080",typeof i!="undefined"&&(this.Menutable.style.fontFamily=i),this.Menutable.style.fontSize=(2*e/3).toFixed(1)+"px",this.Menutable.style.borderSpacing="0",this.Menutable.style.boxShadow=" 4px 4px 4px 1px rgba(0,0,0,0.05)",this.Menutable.style.zIndex=this._zIndex.toString(),this._timer=null,this.visible=!1}closeAll(){this.close(),this._parentmenu!=null&&this._parentmenu.closeAll()}cancelDelayedAction(){this._timer!=null&&(clearTimeout(this._timer),this._timer=null)}setDelayedAction(e){this.cancelDelayedAction(),this._timer=setTimeout(()=>{e()},500)}get parentMenu(){return this._parentmenu}destroy(){for(let e=0;e<this.Menutable.childNodes.length;e++)this.Menutable.childNodes[e].objectData.removeAndDestroy();this.Menutable.parentNode!=null&&this.Menutable.parentNode.removeChild(this.Menutable)}focusFirst(){for(let e=0;e<this.Menutable.childNodes.length;e++){let t=this.Menutable.childNodes[e].objectData;if(t.focusable){t.focus();return}}}toString(){let e="";for(let t=0;t<this.Menutable.childNodes.length;t++){let i=this.Menutable.childNodes[t].objectData;e=e+i.caption+""}return e}isXYOnMenu(e,t){if(!this.visible)return!1;if(e>=this.Menutable.offsetLeft&&e<=this.Menutable.offsetLeft+this.Menutable.offsetWidth&&t>=this.Menutable.offsetTop&&t<=this.Menutable.offsetTop+this.Menutable.offsetHeight)return!0;for(let i=0;i<this.Menutable.childNodes.length;i++){let r=this.Menutable.childNodes[i].objectData;if(r instanceof Gr&&r.submenu.isXYOnMenu(e,t))return!0}return!1}activateNext(e){let t=!1;for(let i=0;i<this.Menutable.childNodes.length;i++){let r=this.Menutable.childNodes[i].objectData;if(r==e)t=!0;else if(t&&r.focusable){r.focus();return}}}activatePrevious(e){let t=null;for(let i=0;i<this.Menutable.childNodes.length;i++){let r=this.Menutable.childNodes[i].objectData;if(r==e){t!=null&&t.focus();return}r.focusable&&(t=r)}}get width(){return this.Menutable.offsetWidth}closeSubmenus(){this.closeSubMenusExcept(null)}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e,this.Menutable.style.zIndex=this._zIndex.toString()}get visible(){return this.Menutable.style.display!="none"}set visible(e){this.Menutable.style.display=e?"":"none"}close(){this.cancelDelayedAction();for(let e=0;e<this.Menutable.childNodes.length;e++)this.Menutable.childNodes[e].objectData.parentMenuisClosing();this.visible=!1,this.closeSubmenus()}refresh(){let e=!1;for(let t=0;t<this.Menutable.childNodes.length;t++){let i=this.Menutable.childNodes[t];i.className==tt.SEPARATOR_MARKER?(i.style.display=e?"":"none",e=!1):i.style.display==""&&(e=!0)}}addMenuItem(e,t,i){let r=new Hs(this,e,t,i);return this.Menutable.appendChild(r.domData),r}get menuItemsCount(){return this.Menutable.childNodes.length}closeSubMenusExcept(e){for(let t=0;t<this.Menutable.childNodes.length;t++){let i=this.Menutable.childNodes[t].objectData;i instanceof Gr&&i.submenu!=e&&i.submenu.close()}}subMenuisOpening(e){this.closeSubMenusExcept(e)}addSubMenuItem(e,t,i){i.zIndex=this.zIndex+1;let r=new Gr(this,e,t,i);return this.Menutable.appendChild(r.domData),r}clearAllContents(){for(;this.Menutable.childNodes.length>0;)this.Menutable.childNodes[0].objectData.removeAndDestroy()}AddSeparator(){let e=new $a;return this.Menutable.appendChild(e.domData),e}showContextMenu(e,t){}};m(ro,"ContextMenuBase");var Wi=ro;Wi.SEPARATOR_MARKER="separator";Wi.iconBGColor="#fdfdfd";Wi.captionBgColor="#f1f1f1";Wi.ActiveColor="#c4e1ff";var so=class so extends Wi{constructor(e,t,i,r){super(e,i,r),this._parentmenu=t,document.body.appendChild(this.Menutable)}showContextMenu(e,t){this._parentmenu!=null&&this._parentmenu.subMenuisOpening(this),this._openCallback!=null&&this._openCallback(e,t),this.Menutable.style.left=e.toString()+"px",this.Menutable.style.top=t.toString()+"px",this.visible=!0;let i=this.Menutable.offsetLeft-this.Menutable.scrollLeft+this.Menutable.offsetWidth,r=this.Menutable.offsetTop-this.Menutable.scrollTop+this.Menutable.offsetHeight;i>window.innerWidth&&(this.Menutable.style.left=(e-(i-window.innerWidth)).toString()+"px"),r>window.innerHeight&&(this.Menutable.style.top=(t-(r-window.innerHeight)).toString()+"px")}};m(so,"ContextSubMenu");var Ar=so,no=class no extends Wi{constructor(e,t,i){super(e,t,i),document.addEventListener("contextmenu",r=>{let s="";r.target!=null&&S.RunningOnAndroid&&(s=r.target.tagName),s!="INPUT"&&(r.preventDefault(),this.showContextMenu(r.pageX,r.pageY))}),document.addEventListener("dblclick",r=>{S.dbleClickBringsUpContextMenu&&this.showContextMenu(r.pageX,r.pageY)}),document.addEventListener("click",r=>{this.click(r)}),document.body.appendChild(this.Menutable)}click(e){this.visible&&(this.isXYOnMenu(e.pageX,e.pageY)||this.close())}showContextMenu(e,t){let i=nt.ConTextMenuBestZindex;if(i<0)return;this.zIndex=i,this.Menutable.style.left=e.toString()+"px",this.Menutable.style.top=t.toString()+"px",this.visible=!0;let r=this.Menutable.offsetLeft-this.Menutable.scrollLeft+this.Menutable.offsetWidth,s=this.Menutable.offsetTop-this.Menutable.scrollTop+this.Menutable.offsetHeight;r>window.innerWidth&&(this.Menutable.style.left=Math.max(0,e-(r-window.innerWidth)).toString()+"px"),s>window.innerHeight&&(this.Menutable.style.top=Math.max(0,t-(s-window.innerHeight)).toString()+"px"),this._openCallback!=null&&this._openCallback(e,t),e<=5&&t<=5&&this.focusFirst()}};m(no,"ContextMenu");var tt=no;var xe=class xe{static SVGheader(e,t,i){let r='<svg  xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+e+'" viewBox="0 0 128  128">';return typeof i!="undefined"&&(r=r+"<title>"+i+"</title>"),t&&(r=r+'<defs><filter id="f1" x="0" y="0"><feGaussianBlur in="SourceGraphic" stdDeviation="2" /></filter></defs>'),r=r+'<g transform="translate(0,128)"><g transform="scale(1,-1)">',r}static SVGFooter(){return"</g></g></svg>"}static addIconTransparency(){return'<g opacity="0.5">'}static addIconSrcCode(){return'<path d="m 8 24 L 8 40 L 24 40 L 24 56 L 40 56 L 40 40 L 56 40 L 56 24 L 40 24 L 40 8 L 24 8 L 24 24   Z" fill="#40ff40" stroke="black" stroke-width="8" stroke-linecap="round"/>'}static deleteIconSrcCode(){return'<path d="m 15 4 L 4 15 L 19 29 L 4 43 L 15 55 L 29 40 L 43 55 L 55 43 L 40 29 L 55 15 L 44 4 L 29 18 Z" fill="#ff4040" stroke="black" stroke-width="8" stroke-linecap="round">'}static IconSourceCode(e,t,i,r,s,n,o,a){let l=xe.SVGheader(e,t,a);return t&&(l=l+'<g transform="translate(6,-6)">'+n+"</g>"),i&&(l=l+xe.addIconTransparency()),l=l+o,i&&(l=l+"</g>"),r&&(l=l+xe.addIconSrcCode()),s&&(l=l+xe.deleteIconSrcCode()),l=l+xe.SVGFooter(),l}static GraphIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 12 24 L 103 24 L 103 107 L 12 107 z" fill="lightgray" filter="url(#f1)" /><path d="m 112 24 L 12 24 L 12 113"  style="fill:none; stroke:lightgray; stroke-width:4px; stroke-linejoin:round;stroke-linecap:round;" filter="url(#f1)"/>','<path d="m 12 24 L 103 24 L 103 107 L 12 107 z" fill="#ffffe9" /><line x1="43" y1="24" x2="43" y2="107" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><line x1="43" y1="24" x2="43" y2="107" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><line x1="73" y1="24" x2="73" y2="107" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><line x1="12" y1="51" x2="103" y2="51" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><line x1="12" y1="79" x2="103" y2="79" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><line x1="12" y1="107" x2="103" y2="107" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><path d="m 12 77 L 34 65 L 55 85 L 70 77 L 100 93" fill="none" stroke="#FF0000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><line x1="103" y1="24" x2="103" y2="107" stroke="#e3e3e3" stroke-width="2" stroke-linecap="round" /><path d="m 112 24 L 12 24 L 12 113"  style="fill:none; stroke:black; stroke-width:4px; stroke-linejoin:round;stroke-linecap:round;"/>')}static SolidGaugeIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="M 34 40 L 14 40 14 52 A 50 50 0 0 0 114 52 L  114 40 L 94 40 L 94 52 A 30 30 0 1 1  34 52 Z" style="fill:lightgray;fill-opacity=0.4;" filter="url(#f1)"/><text x="43" y="-30" fill="black" transform="scale(1,-1)" style="font: bold 24px sans-serif;fill:lightgray;fill-opacity=0.4;" filter="url(#f1)">123</text>','<path d="M 34 40 L 14 40 14 52 A 50 50 0 0 0 114 52 L  114 40 L 94 40 L 94 52 A 30 30 0 1 1  34 52 Z" style="fill:#ffffe9; stroke:none; "/><path d="M 34 40 L 14 40 14 52 A 50 50 0 0 0 29 88 L  43 72.5   A 30 30 0 0 1  34 52 Z" style="fill:red; stroke:none;"/><path d="M 34 40 L 14 40 14 52 A 50 50 0 0 0 114 52 L  114 40 L 94 40 L 94 52 A 30 30 0 1 1  34 52 Z" style="fill:none; stroke:black; stroke-width:4px; stroke-linejoin:round;stroke-linecap:round;"/><text x="43" y="-30" fill="black" transform="scale(1,-1)" style="font: bold 24px sans-serif;">123</text>')}static RawDataIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 16 27 L 107 27 L 107 107 L 16 107 z" fill="lightgray" filter="url(#f1)" />','<path d="m 16 27 L 107 27 L 107 107 L 16 107 z" style="fill:#ffffe9;" /><line x1="47" y1="27" x2="47" y2="107" stroke="#e3e3e3" stroke-width="2"  /><line x1="76" y1="27" x2="76" y2="107" stroke="#e3e3e3" stroke-width="2"  /><line x1="16" y1="44" x2="107" y2="44" stroke="#e3e3e3" stroke-width="2"  /><line x1="16" y1="60" x2="107" y2="60" stroke="#e3e3e3" stroke-width="2"  /><line x1="16" y1="76" x2="107" y2="76" stroke="#e3e3e3" stroke-width="2"  /><path d="m 16 27 L 107 27 L 107 107 L 16 107 z" style="fill:none;stroke:black; stroke-width:4px; stroke-linejoin:round;" /><path d="m 19 91 L 104 91 L 104 104 L 19 104 z" style="fill:#b2b2b2; stroke:#6f6f6f; stroke-width:4px; stroke-linejoin:round;" /><line x1="47" y1="91" x2="47" y2="104" stroke="#6f6f6f" stroke-width="2"  /><line x1="76" y1="91" x2="76" y2="104" stroke="#6f6f6f" stroke-width="2"  />')}static ConfigureIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="M85 85 L 102 80 L 113 91 A  41 100 45 0 0  86 71 L 37 21 A  5 11 45 1 0  21 37 L 71 86  A  41 100 45 0 0  91 113 L 80 102 Z" style="fill:lightgray;fill-opacity=0.4;" filter="url(#f1)"/>','<path d="M85 85 L 102 80 L 113 91 A  41 100 45 0 0  86 71 L 37 21 A  5 11 45 1 0  21 37 L 71 86  A  41 100 45 0 0  91 113 L 80 102 Z" style="fill:grey; stroke:black; stroke-width:4px; stroke-linejoin:round;stroke-linecap:round;"/>')}static DigitalDisplayIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 12 45 L 111 45 L 111 89 L 12 89 z" fill="lightgray" filter="url(#f1)" />','<path d="m 12 45 L 111 45 L 111 89 L 12 89 z" style="fill:#ffffe9; stroke:black; stroke-width:4px; stroke-linejoin:round;" /><text x="29" y="-52" fill="black" transform="scale(1,-1)" style="font: bold 40px sans-serif;">123</text> ')}static AngularGaugeIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<circle  cx="64" cy="64" r="40" fill="lightgray" filter="url(#f1)" />','<circle  cx="64" cy="64" r="40" stroke="black" stroke-width="4" fill="#ffffe9" /><line x1="64" y1="104" x2="64" y2="94" stroke="black" stroke-width="2"   stroke-linecap="round" /><line x1="29" y1="84" x2="38" y2="79" stroke="black" stroke-width="2"   stroke-linecap="round" /><line x1="29" y1="44" x2="38" y2="48" stroke="black" stroke-width="2"   stroke-linecap="round" /><line x1="98" y1="84" x2="91" y2="79" stroke="black" stroke-width="2"   stroke-linecap="round" /><line x1="98" y1="44" x2="91" y2="48" stroke="black" stroke-width="2"   stroke-linecap="round" /><g transform="translate(64,64)"><g transform="rotate(-70,0,0)"><path d="m 5 0 L 0 5 L -25 0 L 0 -5 z" style="fill:black;stroke:black; stroke-width:2px; stroke-linejoin:round;"/></g></g>')}static EditIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 16 48 L 108 48 L 108 88 L 16 88 z" fill="lightgray" filter="url(#f1)" /><path d="m 87 24 L 75 40 L 67 31 L 62 64 L 93 50 L 82 44  L 94 29 z" fill="lightgray" filter="url(#f1)" />','<path d="m 16 48 L 108 48 L 108 88 L 16 88 z" style="fill:#ffffe9; stroke:black; stroke-width:4px; stroke-linejoin:round;" /><path d="m 87 24 L 75 40 L 67 31 L 62 64 L 93 50 L 82 44  L 94 29 z" style="fill:white; stroke:black; stroke-width:2px; stroke-linejoin:round;" /> ')}static AllIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 60 108 L 46 74 L 8 72 L 38 48 L 28 12 L 60 32 L 92 12  L 82 48 L 112 70  L 74 74  z" fill="lightgray" filter="url(#f1)" />','<path d="m 60 108 L 46 74 L 8 72 L 38 48 L 28 12 L 60 32 L 92 12  L 82 48 L 112 70  L 74 74  z" style="fill:#fee403; stroke:#918201; stroke-width:4px; stroke-linejoin:round;" />')}static TrashIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 33 12 L 24 94 L 104 94 L 95 12 z" fill="lightgray" filter="url(#f1)" /><g transform="translate(70,105)"><g transform="rotate(-10,0,0)"><path d="m -40 0 L -30 5 L 30 5 L 40 0 z" fill="lightgray" filter="url(#f1)" /><path d="m -9 5 L -9 12 L 9 12 L 9 5" stroke="lightgray" filter="url(#f1)"/> </g></g>','<path d="m 33 12 L 24 94 L 104 94 L 95 12 z" style="fill:#f8f8f8; stroke:black; stroke-width:4px; stroke-linejoin:round;" /><Line x1="43" y1="82" x2="48" y2="21" style=" stroke:black; stroke-width:4px; stroke-linecap:round;" /><Line x1="64" y1="82" x2="64" y2="21" style=" stroke:black; stroke-width:4px; stroke-linecap:round;" /><Line x1="86" y1="82" x2="80" y2="21" style=" stroke:black; stroke-width:4px; stroke-linecap:round;" /><g transform="translate(70,105)"><g transform="rotate(-10,0,0)"><path d="m -40 0 L -30 5 L 30 5 L 40 0 z" style="fill:#f8f8f8; stroke:black; stroke-width:4px; stroke-linejoin:round;" /><path d="m -9 5 L -9 12 L 9 12 L 9 5" style="fill:none; stroke:black; stroke-width:4px; stroke-linejoin:round;" /></g></g>')}static SaveIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 20 12 A 4 4 0 0 0 16 16 L 16 106  A 4 4 0 0 0 20 110 L 24 110 L 24 108 L 97 108 L 97 110 L 104 110  A 4 4 0 0 0 108 106 L 108 16   A 4 4 0 0 0 104 12  z" fill="lightgray" filter="url(#f1)" />','<path d="m 20 12 A 4 4 0 0 0 16 16 L 16 106  A 4 4 0 0 0 20 110 L 24 110 L 24 108 L 97 108 L 97 110 L 104 110  A 4 4 0 0 0 108 106 L 108 16   A 4 4 0 0 0 104 12  z" style="fill:#3583dd; stroke:#226fc8; stroke-width:4px; stroke-linejoin:round;" /><path d="m 24 11 L 24 65  A 5 5 0 0 0 29 70 L 95 70  A 5 5 0 0 0 100 65 L 100 11  z" style="fill:#f7f7f7; stroke:#c6c6c6; stroke-width:2px; stroke-linejoin:round;"/><path d="m 36 111 L 90 111 L 90 80 A 4 4 0 0 0 86 76 L 40 76 A 4 4 0 0 0 36 80 z"  style="fill:#e5e5e5; stroke:#c6c6c6; stroke-width:2px; stroke-linejoin:round;" /><rect x="67" y="79" width="14" height ="28"     style="fill:#3583dd; stroke:#c6c6c6; stroke-width:2px; stroke-linejoin:round;"')}static SaveNeededIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 8 16 L 64 110 L 120 16 z " style="fill:lightgray; stroke:lightgray; stroke-width:10px; stroke-linejoin:round;filter:url(#f1)" />','<path d="m 8 16 L 64 110 L 120 16 z" style="fill:#FAE701; stroke:#FAE701; stroke-width:10px; stroke-linejoin:round;" /><path d="m 8 16 L 64 110 L 120 16 z" style="fill:none; stroke:black; stroke-width:2px; stroke-linejoin:round;" /><g transform="translate(-64,-64) scale(0.4 0.4) translate(260,215)"><path d="m 20 12 A 4 4 0 0 0 16 16 L 16 106  A 4 4 0 0 0 20 110 L 24 110 L 24 108 L 97 108 L 97 110 L 104 110  A 4 4 0 0 0 108 106 L 108 16   A 4 4 0 0 0 104 12  z" style="fill:black; stroke:black; stroke-width:4px; stroke-linejoin:round;" /><path d="m 24 11 L 24 65  A 5 5 0 0 0 29 70 L 95 70  A 5 5 0 0 0 100 65 L 100 11  z" style="fill:#FAE701; stroke:black; stroke-width:2px; stroke-linejoin:round;"/><path d="m 36 111 L 90 111 L 90 80 A 4 4 0 0 0 86 76 L 40 76 A 4 4 0 0 0 36 80 z"  style="fill:#FAE701; stroke:black; stroke-width:2px; stroke-linejoin:round;" /><rect x="67" y="79" width="14" height ="28"     style="fill:#FAE701; stroke:black; stroke-width:2px; stroke-linejoin:round;"</g>',"Don't forget to save.")}static snapshotIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 16 32  L 16 78 A 6 6 0 0 0 22 84 L 46 84 L 48 94 A 5.75 3.25 30 0 0 54 100 L 78 100 A 3.25 5.75  30 0 0 84 94  L 86 84 L 104 84  A 6 6 0 0 0 110 78  L 110 32 A 6 6 0 0 0 104 26 L 22 26 A 6 6 0 0 0 16 32 z"  fill="lightgray" filter="url(#f1)" />','<path d="m 16 32  L 16 78 A 6 6 0 0 0 22 84 L 46 84 L 48 94 A 5.75 3.25 30 0 0 54 100 L 78 100 A 3.25 5.75  30 0 0 84 94  L 86 84 L 104 84  A 6 6 0 0 0 110 78  L 110 32 A 6 6 0 0 0 104 26 L 22 26 A 6 6 0 0 0 16 32 z" style="fill:#707070; stroke:#464646; stroke-width:4px; stroke-linejoin:round;" /><Circle cx="65" cy="55" r="26"   style="fill:#895e96; stroke:#464646; stroke-width:6px; stroke-linejoin:round;" />')}static CloseIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 21.6 38.6 L 47.1 64.3 L 22 89.5 L 38.4 106.2 L 64 81 L 89.3 106.2 L 105.8 89.5 L 80.6 64 L 105.8 38.9 L 89.3 22.2 L 64 47.5  L 38.3 22.1 z"  fill="lightgray" filter="url(#f1)" />','<path d="m 21.6 38.6 L 47.1 64.3 L 22 89.5 L 38.4 106.2 L 64 81 L 89.3 106.2 L 105.8 89.5 L 80.6 64 L 105.8 38.9 L 89.3 22.2 L 64 47.5  L 38.3 22.1 z" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" />',n)}static MoveToRightIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<rect x="12" y="52" width="4"  height="24" fill="lightgray" filter="url(#f1)" /><rect x="20" y="52" width="8"  height="24" fill="lightgray" filter="url(#f1)" /><rect x="56" y="16" width="16"  height="96" fill="lightgray" filter="url(#f1)" /><path d="m  32 52 L 32 76 L 56 76 L 56 96 L 88 64 L 56 32 L 56 52 z" fill="lightgray" filter="url(#f1)" />','<rect x="12" y="52" width="4"  height="24" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><rect x="20" y="52" width="8"  height="24" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><rect x="96" y="16" width="16"  height="96" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><path d="m  32 52 L 32 76 L 56 76 L 56 96 L 88 64 L 56 32 L 56 52 z" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" />',n)}static MoveToLeftIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<rect x="112" y="52" width="4"  height="24" fill="lightgray" filter="url(#f1)" /><rect x="100" y="52" width="8"  height="24" fill="lightgray" filter="url(#f1)" /><rect x="16" y="16" width="16"  height="96" fill="lightgray" filter="url(#f1)" /><path d="m  96 52 L 96 76 L 72 76 L 72 96 L 40 64 L 72 32 L 72 52 z" fill="lightgray" filter="url(#f1)" />','<rect x="112" y="52" width="4"  height="24" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><rect x="100" y="52" width="8"  height="24" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><rect x="16" y="16" width="16"  height="96" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" /><path d="m  96 52 L 96 76 L 72 76 L 72 96 L 40 64 L 72 32 L 72 52 z" style="fill:#ffffff; stroke:#004a82; stroke-width:4px; stroke-linejoin:round;" />',n)}static ExpandIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<path d="m  24 56 L 24 72 L 56 72 L 56 104 L 72 104 L 72 72 L 104 72 L 104 56 L 72 56 L 72 24 L 56 24 L 56 56 z"  fill="lightgray" filter="url(#f1)" />','<path d="m 24 56 L 24 72 L 56 72 L 56 104 L 72 104 L 72 72 L 104 72 L 104 56 L 72 56 L 72 24 L 56 24 L 56 56  z" style="fill:black; " />',n)}static OkIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<circle cx="64" cy="64" r="56"   fill="lightgray" filter="url(#f1)" />','<circle cx="64" cy="64" r="56" fill="#00b20f"/><path d="m 19 72 L 34 87 L 60 62 L 94 96 L 109 81 L 60 32  z" style="fill:white; " />',n)}static FailedIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<circle cx="64" cy="64" r="56"   fill="lightgray" filter="url(#f1)" />','<circle cx="64" cy="64" r="56" fill="#ff101e"/><path d="m 43 99 L 64 79 L 85 99 L 100 85 L 79 64 L 100 43 L 85 28 L 64 49 L 43 28 L 28  43 L 49 64 L  28 85   z" style="fill:white; " />',n)}static DontKnowIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<circle cx="64" cy="64" r="56"   fill="lightgray" filter="url(#f1)" />','<circle cx="64" cy="64" r="56" fill="#f1ba00"/><text x="35" y="-30" fill="white" transform="scale(1,-1)" style="font: bold 96px sans-serif;">?</text> ',n)}static infoIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<circle cx="64" cy="64" r="56"   fill="lightgray" filter="url(#f1)" />','<circle cx="64" cy="64" r="56" fill="DodgerBlue"/><text x="50" y="-30" fill="white" transform="scale(1,-1)" style="font: bold 96px sans-serif;">i</text> ',n)}static ColapseIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,'<path d="m 24 56 L 24 72 L 104 72 L 104 56 z"  fill="lightgray" filter="url(#f1)" />','<path d="m 24 56 L 24 72 L 104 72 L 104 56 z" style="fill:black; " />',n)}static AddMarkerIcon(e,t){return xe.IconSourceCode(e,!1,!1,!1,!1,"",'<circle  cx="64" cy="64"  r="50"   style="fill:lightyellow;" stroke-width="8" stroke="darkred" /><text x="46" y="-40" fill="black" transform="scale(1,-1)" style="font: bold 64px sans-serif;">'+t.toString()+"</text>")}static AddMarker(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,"",'<line x1="80" y1="8" x2="80" y2="128" stroke="darkred" stroke-width="8" stroke-linecap="round" /><path d="m 60 64 L 100 64 L 80 20 z" style="fill:darkred; " /><rect x="40" y="56" width="80" height="32" style="fill:lightYellow" stroke="darkred" stroke-width="8" />')}static EraseDatalogger(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,"",'<g transform="rotate(-35,0,0)"><g transform="translate(-56,24)"><path d="m 108 24 L 108 46 L 60 46  A 22 22 0 1 0 60 90 L 108 90  L 108 112 L 60 112 A 44 44 0 1 1 60 24 z" style="fill:#808080; " /><rect x="88" y="24" width="20" height="22" style="fill:red" stroke="none"  /><rect x="88" y="90" width="20" height="22" style="fill:blue" stroke="none"  /><path d="m 108 24 L 108 46 L 60 46  A 22 22 0 1 0 60 90 L 108 90  L 108 112 L 60 112 A 44 44 0 1 1 60 24 z"  style="fill:none" stroke="black"  stroke-width="4" stroke-linejoin="round"/></g></g>')}static resetViewPort(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,"",'<line x1="116" y1="52" x2="116" y2="12"  stroke="black"  stroke-width="4"/><line x1="12" y1="52" x2="12" y2="12"  stroke="black"  stroke-width="4"/><path d="m 100 36 L 28 36 L 28 48 L 12 32  L 28 16 L 28 28 L 100 28 L 100 16 L 116 32 L 100 48z" style="fill:white" stroke="black"  stroke-width="4" stroke-linejoin="round" /><path d="m 7.3 97.7 L 20 107.4 L 51.6 114.7 L 78.5 112.2 L 101.6 103.3 L 114.4 91.7  L 117.7 81.7 L 104.3 66.9 L 80.9 61.2 L49.9 65 L 25 76.3 L 12.6 87.5 Z " style="fill:white" stroke="none" /><circle  cx="64" cy="88" r="27" style="fill:#6cc87b" stroke="none"  /> <path d="m 37.2 84.8 A 27 27 0 0 0 46.5 108.8 L 64 88 z" style="fill:#8ed698" stroke="none" /> <circle  cx="64" cy="88" r="16" style="fill:black" stroke="none"  /> <path d="m 6 97 A 59 34 -4 0 0 119 80" style="fill:none" stroke="black"  stroke-width="4"  stroke-linecap="round"/> <path d="m 113 79 A 56 31 -16 0 0 9 93 " style="fill:none" stroke="black"  stroke-width="4"  stroke-linecap="round" /> ')}static DeleteMarker(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,"",'<line x1="80" y1="8" x2="80" y2="128" stroke="darkred" stroke-width="8" stroke-linecap="round" /><path d="m 60 64 L 100 64 L 80 20 z" style="fill:darkred; " /><rect x="40" y="56" width="80" height="32" style="fill:lightYellow" stroke="darkred" stroke-width="8" />')}static targetIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,"",'<circle  cx="64" cy="64"  r="42"   style="fill:none;" stroke-width="8" stroke="black" /><line  x1="0"   y1="64"  x2="42"  y2="64"  style="fill:none;" stroke-width="8" stroke="black" /><line  x1="128" y1="64"  x2="86"  y2="64"  style="fill:none;" stroke-width="8" stroke="black" /><line  y1="0"   x1="64"  y2="42"  x2="64"  style="fill:none;" stroke-width="8" stroke="black" /><line  y1="128" x1="64"  y2="86"  x2="64"  style="fill:none;" stroke-width="8" stroke="black" />',n)}static DotDotDotIcon(e,t,i,r,s,n){return xe.IconSourceCode(e,t,i,r,s,"",'<rect x="18" y="36" width="18" height="18" style="fill:black" /><rect x="54" y="36" width="18" height="18" style="fill:black" /><rect x="90" y="36" width="18" height="18" style="fill:black" />',n)}static LogFileIcon(e,t,i,r,s){return xe.IconSourceCode(e,t,i,r,s,"",'<line x1="4" y1="24" x2="30" y2="24"     style=" stroke:black; stroke-width:8px;" /><line x1="34" y1="24" x2="56" y2="24"    style=" stroke:black; stroke-width:8px; " /><line x1="64" y1="24" x2="74" y2="24"    style=" stroke:black; stroke-width:8px; " /><line x1="80" y1="24" x2="88" y2="24"    style=" stroke:black; stroke-width:8px; " /><line x1="4" y1="40" x2="30" y2="40"     style=" stroke:black; stroke-width:8px;" /><line x1="34" y1="40" x2="56" y2="40"    style=" stroke:black; stroke-width:8px; " /><line x1="61" y1="40" x2="90" y2="40"    style=" stroke:black; stroke-width:8px; " /><line x1="94" y1="40" x2="110" y2="40"    style=" stroke:black; stroke-width:8px; " /><line x1="4" y1="56" x2="30" y2="56"     style=" stroke:black; stroke-width:8px;" /><line x1="34" y1="56" x2="56" y2="56"    style=" stroke:black; stroke-width:8px; " /><line x1="61" y1="56" x2="86" y2="56"    style=" stroke:black; stroke-width:8px; " /><line x1="4" y1="72" x2="30" y2="72"     style=" stroke:black; stroke-width:8px;" /><line x1="34" y1="72" x2="50" y2="72"    style=" stroke:black; stroke-width:8px; " /><line x1="56" y1="72" x2="100" y2="72"    style=" stroke:black; stroke-width:8px; " /><line x1="4" y1="88" x2="30" y2="88"     style=" stroke:black; stroke-width:8px;" /><line x1="34" y1="88" x2="56" y2="88"    style=" stroke:black; stroke-width:8px; " /><line x1="61" y1="88" x2="72" y2="88"    style=" stroke:black; stroke-width:8px; " /><line x1="78" y1="88" x2="106" y2="88"    style=" stroke:black; stroke-width:8px; " />')}};m(xe,"ressources");var J=xe;var Ne=class Ne{static show(){if(Ne._window==null){let e=new ut;e.positionType=0,e.width=8*window.innerWidth/10>>0,e.height=6*window.innerHeight/10>>0,e.left=1*window.innerWidth/10>>0,e.top=2*window.innerHeight/10>>0,e.title="LogFile",Ne._window=new nt(e),Ne._contents=Ne._window.innerContentDiv,Ne._contents.style.fontFamily="courrier",Ne._contents.style.fontSize=(10*S.generalSizeCoef).toString()+"px",Ne._contents.style.overflow="auto";for(let t=0;t<Ne._lines.length;t++)Ne.addLine(Ne._lines[t])}Ne._window.show()}static addLine(e){let t=document.createElement("PRE");for(t.style.marginTop="0",t.style.marginBottom="0",t.innerText=e,Ne._contents.appendChild(t);Ne._contents.childElementCount>1e3;)Ne._contents.removeChild(Ne._contents.firstChild)}static padStart(e,t){for(;e.length<t;)e="0"+e;return e}static dateToString(e){return e.getFullYear().toString()+"-"+Ne.padStart((e.getMonth()+1).toString(),2)+"-"+Ne.padStart(e.getDate().toString(),2)+" "+Ne.padStart(e.getHours().toString(),2)+":"+Ne.padStart(e.getMinutes().toString(),2)+":"+Ne.padStart((e.getSeconds()+e.getMilliseconds()/1e3).toFixed(3),6)}static log(e){Ne.logNOTS(Ne.dateToString(new Date)+" "+e)}static logNOTS(e){Ne._lines.push(e),Ne._lines.length>1e3&&Ne._lines.splice(0,Ne._lines.length-1e3),Ne._window!=null&&Ne.addLine(e)}};m(Ne,"logForm");var Z=Ne;Z._lines=[];var k=class k{static hide(){k._window!=null&&(k._window.visible=!1)}static show(){if(k._window==null){let e=new ut;e.positionType=1,e.width=9*window.innerWidth/10>>0,e.height=8*window.innerHeight/10>>0,e.title="Raw data",k._window=new nt(e),k._contents=k._window.innerContentDiv,k._statusline=document.createElement("DIV"),k._statusline.style.position="absolute",k._statusline.style.left=S.WindowPadding.toString()+"px",k._statusline.style.right=S.WindowPadding.toString()+"px",k._statusline.style.height=(k.STATUSLINEHEIGHT*S.generalSizeCoef).toString()+"px",k._statusline.style.bottom=S.WindowPadding.toString()+"px",k._statusline.style.paddingTop=Math.round(5*S.generalSizeCoef).toString()+"px",k._statusline.style.paddingLeft="5px",k._statusline.style.paddingRight="5px",k._statusline.style.overflowX="auto",k._statusline.style.paddingRight="5px",k._contents.append(k._statusline),k._sensorsList=document.createElement("DIV"),k._sensorsList.style.position="absolute",k._sensorsList.style.left=S.WindowPadding.toString()+"px",k._sensorsList.style.right=(k.sensorListWidth*S.generalSizeCoef+8*S.WindowPadding).toString()+"px",k._sensorsList.style.top="2px",k._sensorsList.style.overflowY="auto",k._sensorsList.style.height=(k.topMargin*S.generalSizeCoef).toString()+"px",k._sensorsList.style.paddingLeft="5px",k._sensorsList.style.paddingRight="5px",k._sensorsList.style.border=S.WindowInnerBorder,k._sensorsList.style.backgroundColor=S.WindowInnerBackgroundColor,k._contents.append(k._sensorsList),k._optionsList=document.createElement("DIV"),k._optionsList.style.position="absolute",k._optionsList.style.width=(k.sensorListWidth*S.generalSizeCoef).toString()+"px",k._optionsList.style.right=S.WindowPadding.toString()+"px",k._optionsList.style.top="0px",k._optionsList.style.height=(k.topMargin*S.generalSizeCoef).toString()+"px",k._optionsList.style.paddingLeft="5px",k._optionsList.style.paddingRight="5px",k._optionsList.style.border="1px solid transparent",k._contents.append(k._optionsList);let t;k._optionMIN=document.createElement("INPUT"),k._optionMIN.type="input",k._optionMIN.checked=!1,k._optionMIN.style.display="inline",k._optionMIN.type="checkbox",k._optionMIN.style.transform="scale("+S.generalSizeCoef.toString()+")",k._optionMIN.style.marginRight=Math.round(5*S.generalSizeCoef).toString()+"px",k._optionMIN.addEventListener("change",()=>{k.refresh()}),k._optionsList.append(k._optionMIN);let i;i=document.createElement("SPAN"),i.innerText="Include minimum values",k._optionsList.append(i),t=document.createElement("BR"),k._optionsList.append(t),k._optionAVG=document.createElement("INPUT"),k._optionAVG.type="input",k._optionAVG.checked=!0,k._optionAVG.style.display="inline",k._optionAVG.type="checkbox",k._optionAVG.style.transform="scale("+S.generalSizeCoef.toString()+")",k._optionAVG.style.marginRight=Math.round(5*S.generalSizeCoef).toString()+"px",k._optionAVG.addEventListener("change",()=>{k.refresh()}),k._optionsList.append(k._optionAVG),i=document.createElement("SPAN"),i.innerText="Include average values",k._optionsList.append(i),t=document.createElement("BR"),k._optionsList.append(t),k._optionMAX=document.createElement("INPUT"),k._optionMAX.type="input",k._optionMAX.checked=!1,k._optionMAX.style.display="inline",k._optionMAX.type="checkbox",k._optionMAX.style.transform="scale("+S.generalSizeCoef.toString()+")",k._optionMAX.style.marginRight=Math.round(5*S.generalSizeCoef).toString()+"px",k._optionMAX.addEventListener("change",()=>{k.refresh()}),k._optionsList.append(k._optionMAX),i=document.createElement("SPAN"),i.innerText="Include maximum values",k._optionsList.append(i),k._optionsList.append(document.createElement("BR")),k._optionsList.append(document.createElement("BR"));let r=document.createElement("P");r.style.textAlign="center";let s=new ft("refresh",()=>{k.refresh()});r.appendChild(s.Element);let n=new ft("export",()=>{k.export()});r.appendChild(n.Element),k._optionsList.append(r),k._datacontents=document.createElement("DIV"),k._datacontents.style.position="absolute",k._datacontents.style.left=S.WindowPadding.toString()+"px",k._datacontents.style.right=S.WindowPadding.toString()+"px",k._datacontents.style.top=(k.topMargin*S.generalSizeCoef+5*S.WindowPadding).toString()+"px",k._datacontents.style.bottom=(4*S.WindowPadding+k.STATUSLINEHEIGHT*S.generalSizeCoef).toString()+"px",k._datacontents.style.paddingLeft="5px",k._datacontents.style.paddingRight="5px",k._datacontents.style.overflowX="auto",k._datacontents.style.paddingRight="5px",k._contents.append(k._datacontents),k._dataTable=document.createElement("TABLE"),k._dataTable.style.position="absolute",k._dataTable.style.overflow="auto",k._dataTable.style.left="0px",k._dataTable.style.width="100%",k._dataTable.style.top="0px",k._dataTable.style.bottom="0px",k._dataTable.style.fontSize=S.generalFontSize.toString()+"px",k._dataTable.style.borderCollapse="colapse",k._dataTable.style.borderSpacing="0px",k._dataTable.style.fontFamily="sans-serif",k._datacontents.appendChild(k._dataTable)}k._window.show(),k.refresh()}static refresh(){let e=[];for(let t=0;t<oe.sensorList.length;t++)oe.sensorList[t]instanceof Ae||e.push(oe.sensorList[t]);k._selection=[];for(let t=0;t<e.length;t++){let i,r,s;t>=k._sensorsList.childNodes.length?(i=document.createElement("SPAN"),s=document.createElement("INPUT"),s.type="input",s.checked=!1,s.style.display="inline",s.type="checkbox",s.style.transform="scale("+S.generalSizeCoef.toString()+")",s.style.marginRight=Math.round(5*S.generalSizeCoef).toString()+"px",s.addEventListener("change",()=>{k.refresh()}),i.appendChild(s),r=document.createElement("SPAN"),i.appendChild(r),k._sensorsList.appendChild(i),i.appendChild(document.createElement("BR"))):(i=k._sensorsList.childNodes[t],s=i.childNodes[0],r=i.childNodes[1]),s.checked&&k._selection.push(e[t]),s.id=e[t].get_hardwareId(),r.innerText=e[t].get_friendlyName()}for(;k._sensorsList.childNodes.length>e.length;)k._sensorsList.removeChild(k._sensorsList.lastChild);k.RefreshContents(k._selection)}static padStart(e,t){for(;e.length<t;)e="0"+e;return e}static UnixTimeStampTostring(e){let t=new Date(Date.UTC(1970,0,1));return t.setUTCSeconds(e>>0,1e3*(e%1)),t.getFullYear().toString()+"-"+k.padStart((t.getMonth()+1).toString(),2)+"-"+k.padStart(t.getDate().toString(),2)+" "+k.padStart(t.getHours().toString(),2)+":"+k.padStart(t.getMinutes().toString(),2)+":"+k.padStart((t.getSeconds()+t.getMilliseconds()/1e3).toFixed(3),6)}static RefreshContents(e){let t=document.createElement("THEAD"),i=document.createElement("TBODY"),r=document.createElement("TR"),s=document.createElement("TR"),n=[];for(let p=0;p<e.length;p++)n.push(e[p].curData.length-1);for(;k._dataTable.childNodes.length>0;)k._dataTable.removeChild(k._dataTable.lastChild);k._dataTable.appendChild(t),k._dataTable.appendChild(i);let o=!1,a=!1,l=!1,h=0;k._optionMIN.checked&&(o=!0,h++),k._optionAVG.checked&&(l=!0,h++),k._optionMAX.checked&&(a=!0,h++),t.appendChild(r),t.appendChild(s);let u=document.createElement("TH");r.appendChild(u),u=document.createElement("TH"),s.appendChild(u);for(let p=0;p<e.length;p++)u=document.createElement("TH"),u.innerText=e[p].get_friendlyName(),u.colSpan=Math.max(1,h),u.style.backgroundColor="#f0f0f0",u.style.borderLeft=S.WindowInnerBorder,u.style.borderRight=S.WindowInnerBorder,u.style.borderTop=S.WindowInnerBorder,r.appendChild(u),o&&(u=document.createElement("TH"),u.innerText="Min",u.style.borderLeft=S.WindowInnerBorder,u.style.borderRight=l||a?"":S.WindowInnerBorder,u.style.backgroundColor="#f0f0f0",u.style.textAlign="right",s.appendChild(u)),l&&(u=document.createElement("TH"),u.innerText="Avg",u.style.borderLeft=o?"":S.WindowInnerBorder,u.style.borderRight=a?"":S.WindowInnerBorder,u.style.backgroundColor="#f0f0f0",u.style.textAlign="right",s.appendChild(u)),a&&(u=document.createElement("TH"),u.innerText="Max",u.style.borderLeft=l||o?"":S.WindowInnerBorder,u.style.borderRight=S.WindowInnerBorder,u.style.backgroundColor="#f0f0f0",u.style.textAlign="right",s.appendChild(u));let _=e.length*h,d=0;for(let p=0;p<e.length;p++)n[p]>=0&&d<e[p].curData[n[p]].DateTime&&(d=e[p].curData[n[p]].DateTime);let g=0,y=null;for(;d>0&&g<k.MAXRAWDATAROWS;){let p=new Array(_),x=0;for(let w=0;w<e.length;w++){let f=!1;if(n[w]>=0){if(e[w].curData[n[w]].DateTime==d){let T=0;o&&(p[T+w*h]=e[w].minData[n[w]].value.toString(),T++),l&&(p[T+w*h]=e[w].curData[n[w]].value.toString(),T++),a&&(p[T+w*h]=e[w].maxData[n[w]].value.toString(),T++),f=!0,n[w]--}n[w]>=0&&e[w].curData[n[w]].DateTime>x&&(x=e[w].curData[n[w]].DateTime)}if(!f){let T=0;o&&(p[T+w*h]="",T++),l&&(p[T+w*h]="",T++),a&&(p[T+w*h]="",T++)}}if(_>0&&h>0){y=document.createElement("TR");let w=document.createElement("TD");w.innerText=k.UnixTimeStampTostring(d).toLocaleString(),w.style.borderLeft=S.WindowInnerBorder,w.style.borderTop=g==0?S.WindowInnerBorder:"",w.style.backgroundColor="#f0f0f0",y.style.backgroundColor=(g&1)==0?"white":"#f0f0f0",y.appendChild(w);for(let f=0;f<p.length;f++)w=document.createElement("TD"),w.innerText=p[f],w.style.textAlign="right",w.style.borderLeft=f%h==0?S.WindowInnerBorder:"",w.style.borderRight=(f+1)%h==0?S.WindowInnerBorder:"",w.style.fontFamily="monospace",y.appendChild(w);i.appendChild(y),g++}d=x}if(y!=null)for(let p=0;p<y.childNodes.length;p++)y.childNodes[p].style.borderBottom=S.WindowInnerBorder;h==0?(k._statusline.style.backgroundColor="#FF8080",k._statusline.innerText="No data shown, select at least Min, Avg or Max options in the top-right checkboxes"):g==0?(k._statusline.style.backgroundColor="#FF8080",k._statusline.innerText="No data shown, select at least one sensor in the list above."):(k._statusline.style.backgroundColor=S.WindowBackgroundColor,g<k.MAXRAWDATAROWS?k._statusline.innerText="These are the last "+g.toString()+" data rows.":k._statusline.innerText="These are the last "+g.toString()+" data rows.  Use the export feature to get the whole data set.")}static getCvsdata(e,t,i,r){let s=0,n=[];for(let u=0;u<e.length;u++)n.push(0);t&&s++,i&&s++,r&&s++;let o,a="Timestamp";for(let u=0;u<e.length;u++){let _=e[u].toString();t&&(a+=";"+_+"(min)"),i&&(a+=";"+_+"(avg)"),r&&(a+=";"+_+"(max)")}o=a+`\r
`;let l=e.length*s,h=Number.POSITIVE_INFINITY;for(let u=0;u<e.length;u++)n[u]<e[u].curData.length&&h>e[u].curData[n[u]].DateTime&&(h=e[u].curData[n[u]].DateTime);for(;h<Number.POSITIVE_INFINITY;){let u="",_=Number.POSITIVE_INFINITY;for(let d=0;d<e.length;d++){let g=!1;n[d]<e[d].curData.length&&(e[d].curData[n[d]].DateTime==h&&(t&&(u+=";"+e[d].minData[n[d]].value.toString()),i&&(u+=";"+e[d].curData[n[d]].value.toString()),r&&(u+=";"+e[d].maxData[n[d]].value.toString()),g=!0,n[d]++),n[d]<e[d].curData.length&&e[d].curData[n[d]].DateTime<_&&(_=e[d].curData[n[d]].DateTime)),g||(t&&(u+=" ; "),i&&(u+=" ; "),r&&(u+=" ; "))}l>0&&(u=k.UnixTimeStampTostring(h)+u),o+=u+`\r
`,h=_}return o}static export(){let e=document.createElement("a"),t="data:text/csv;charset=utf-8,"+encodeURI(k.getCvsdata(k._selection,k._optionMIN.checked,k._optionAVG.checked,k._optionMAX.checked));e.setAttribute("href",t),e.setAttribute("download","rawdata.csv"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}};m(k,"rawDataForm");var Xt=k;Xt._lines=[];Xt.topMargin=100;Xt.sensorListWidth=200;Xt.MAXRAWDATAROWS=100;Xt.STATUSLINEHEIGHT=20;Xt._selection=[];var ao=class ao{constructor(e,t,i){this._enabled=!0,this._visible=!0,this._caption="",this._caption=e,this._action=t;let r=S.generalSizeCoef;typeof i!="undefined"&&(r=i),this._link=document.createElement("A"),this._link.innerText=this._caption,this._link.style.cursor="pointer",this._link.style.display="inlineblock";let s=Math.round(5*r).toString()+"px",n=Math.round(3*r).toString()+"px";this._link.tabIndex=0,this._link.style.padding=s+" "+s+" "+s+" "+s,this._link.style.margin=n+" "+n+" "+n+" "+n,this._link.style.borderColor="#808080",this._link.style.backgroundColor="#f0f0f0",this._link.style.fontFamily=S.generalFontFamily,this._link.style.fontSize=(16*r).toString()+"px",this._link.style.cursor="pointer",this._link.style.border=S.WindowInnerBorder,this._link.addEventListener("mouseover",()=>{this._enabled&&(this._link.style.backgroundColor="white")}),this._link.addEventListener("mouseout",()=>{this._enabled&&(this._link.style.backgroundColor="#f0f0f0")}),this._link.addEventListener("click",()=>{this._enabled&&this._action(this)}),this._link.addEventListener("keypress",o=>{this._enabled&&(o.key=="Enter"||o.key==" ")&&this._action(this)})}get Element(){return this._link}set tabIndex(e){this._link.tabIndex=e}focus(){this._link.focus()}get visible(){return this._visible}set visible(e){this._visible=e,this._link.style.display=this._visible?"":"none"}get enabled(){return this._enabled}set enabled(e){this.enable(e)}performAction(){this._enabled&&this._action(this)}showShortcut(e){this._enabled||(e=!1),e?this._link.innerHTML="<u>"+this._caption.substring(0,1)+"</u>"+this._caption.substring(1):this._link.innerText=this._caption}enable(e){e!=this._enabled&&(this._enabled=e,this._link.tabIndex=e?0:-1,this._enabled?(this._link.style.cursor="pointer",this._link.style.backgroundColor="#f0f0f0",this._link.style.color="black"):(this._link.style.backgroundColor="#e0e0e0",this._link.style.cursor="default",this._link.style.color="#A0A0A0"))}};m(ao,"button");var ft=ao,Ws=class Ws{get GUICoef(){return this._GUICoef}constructor(e){this.createNow=!1,this.left=100,this.top=100,this.positionType=0,this.width=400,this.height=300,this.isModal=!1,this.showShadow=!0,this.showContainerBorders=!0,this.showHeader=!0,this.title="new Window",this.closeIcon=!0,this.headerBgColor="",this.bottomKeepClear=0,this.contentsDefaultFontSize=S.generalFontSize,this.contentsDefaultFontFamily=S.generalFontFamily,this.closingCallBack=null,this.WindowBackgroundColor="#f0f0f0",this.WindowBorder="1px solid #808080",this.WindowPadding=2,this.WindowInnerBorderColor=" #A0A0A0",this.WindowInnerBackgroundColor="#fAfAfA",this.WindowInnerBorder="1px solid "+this.WindowInnerBorderColor,this.WindowHeaderBackgroundColor="#0072ca",this.WindowHeaderColor="white",this.WindowHeaderBorder="1px solid #0072ca",this._GUICoef=S.generalSizeCoef,this.WindowHeaderHeight=Math.round(20*S.generalSizeCoef),this.WindowHeaderFontSize=16*S.generalSizeCoef,this.WindowHeaderFontFamily=S.generalFontFamily,this.buttons=[],typeof e!="undefined"&&(this.WindowHeaderHeight=20*e,this.WindowHeaderFontSize=16*e,this._GUICoef=e)}clone(){let e=new Ws,t=Object.keys(this);for(let i=0;i<t.length;i++)t[i]!="buttons"&&(e[t[i]]=this[t[i]]);for(let i=0;i<this.buttons.length;i++)e.buttons.push(this.buttons[i]);return e}};m(Ws,"newWindowParam");var ut=Ws,Zt=class Zt{static get ConTextMenuBestZindex(){for(let e=0;e<Zt.windowList.length;e++)if(Zt.windowList[e].isModal())return-1;return 1e5+2*Zt.windowList.length}constructor(e){this._div=null,this._titleSpan=null,this._ModalDivShield=null,this._switchSideDiv=null,this._buttonsContainer=null,this._params=e.clone(),Zt.windowList.push(this),this._contents=document.createElement("DIV"),e.createNow&&this.allocate()}get innerContentDiv(){return this._contents}get bottomKeepClear(){return this._params.bottomKeepClear}set bottomKeepClear(e){this._params.bottomKeepClear=e,this._contents!=null&&(this._contents.style.bottom=(this._params.WindowPadding+this._params.bottomKeepClear).toString()+"px")}get outterContentDiv(){return this._div}isModal(){return this._div==null?!1:this._div.style.display==""&&this._params.isModal}get visible(){return this._div==null?!1:this._div.style.display==""}set visible(e){e?this.show():this.hide()}show(e){this._div==null&&this.allocate(),this._div.style.display="",this._ModalDivShield!=null&&(this._ModalDivShield.style.display=""),this.brintToFront(),typeof e!="undefined"&&this._params.positionType==2&&(this._div.style.width=e.toString()+"px")}allocate(){if(this._div!=null)return;switch(this._params.isModal&&(this._ModalDivShield=document.createElement("DIV"),this._ModalDivShield.style.position="fixed",this._ModalDivShield.style.left="0px",this._ModalDivShield.style.top="0px",this._ModalDivShield.style.right="0px",this._ModalDivShield.style.bottom="0px",this._ModalDivShield.style.backgroundColor="rgba(255,255,255,0.85) ",document.body.appendChild(this._ModalDivShield)),this._div=document.createElement("DIV"),this._div.style.display="none",this._params.positionType){case 0:this._div.style.position="absolute",this._div.style.left=this._params.left.toString()+"px",this._div.style.top=this._params.top.toString()+"px",this._div.style.width=this._params.width.toString()+"px",this._div.style.height=this._params.height.toString()+"px";break;case 1:this._div.style.position="absolute",this._div.style.left="50%",this._div.style.top="50%",this._div.style.transform="translate(-50%, -50%)",this._div.style.width=this._params.width.toString()+"px",this._div.style.height=this._params.height.toString()+"px";break;case 2:this._div.style.position="fixed",this._div.style.top="5px",this._div.style.right="5px",this._div.style.bottom="5px",this._div.style.width=this._params.width.toString()+"px";break}this._div.style.border=this._params.WindowBorder,this._div.style.backgroundColor=this._params.WindowBackgroundColor,this._params.showShadow&&(this._div.style.boxShadow=" 4px 4px 4px 1px rgba(0,0,0,0.05)");let e=this._params.WindowPadding;if(this._params.showHeader){e=this._params.WindowHeaderHeight+3*this._params.WindowPadding;let t=document.createElement("DIV");if(t.style.position="absolute",t.style.left=this._params.WindowPadding.toString()+"px",t.style.top=this._params.WindowPadding.toString()+"px",t.style.right=this._params.WindowPadding.toString()+"px",t.style.height=this._params.WindowHeaderHeight.toString()+"px",t.style.border=this._params.WindowHeaderBorder,t.style.backgroundColor=this._params.WindowHeaderBackgroundColor,t.style.fontFamily=this._params.WindowHeaderFontFamily,t.style.color=this._params.WindowHeaderColor,t.style.fontSize=this._params.WindowHeaderFontSize.toString()+"px",t.style.paddingLeft="5px",t.style.whiteSpace="nowrap",t.addEventListener("click",()=>{this.brintToFront()}),this._titleSpan=document.createElement("SPAN"),this._titleSpan.innerText=this._params.title,t.appendChild(this._titleSpan),this._params.closeIcon){let i=document.createElement("DIV");i.style.position="absolute",i.style.right="0px",i.style.top="0px",i.style.width=Math.round(this._params.WindowHeaderHeight+5).toString()+"px",i.style.height=this._params.WindowHeaderHeight.toString()+"px",i.style.overflow="hide",i.style.paddingLeft="5px",i.tabIndex=0,i.style.cursor="pointer",i.style.backgroundColor=this._params.WindowHeaderBackgroundColor,i.innerHTML=J.CloseIcon(this._params.WindowHeaderHeight.toString(),!1,!1,!1,!1,"Click to close this window"),i.addEventListener("click",()=>{this.hide()}),i.addEventListener("keypress",r=>{r.key=="Enter"&&this.hide()}),t.appendChild(i)}this._params.positionType==2&&(this._switchSideDiv=document.createElement("DIV"),this._switchSideDiv.style.position="absolute",this._switchSideDiv.style.width=Math.round(this._params.WindowHeaderHeight+5).toString()+"px",this._switchSideDiv.style.right=Math.round(this._params.WindowHeaderHeight+5)+"px",this._switchSideDiv.style.height=this._params.WindowHeaderHeight.toString()+"px",this._switchSideDiv.style.overflow="hide",this._switchSideDiv.style.paddingLeft="5px",this._switchSideDiv.style.top="0px",this._switchSideDiv.style.cursor="pointer",this._switchSideDiv.style.backgroundColor=this._params.WindowHeaderBackgroundColor,this._switchSideDiv.innerHTML=J.MoveToLeftIcon(this._params.WindowHeaderHeight.toString(),!1,!1,!1,!1,"Click to move editor on left side"),this._switchSideDiv.addEventListener("click",()=>{this.switchSide()}),t.appendChild(this._switchSideDiv)),this._div.appendChild(t)}if(this._params.buttons.length>0){this._buttonsContainer=document.createElement("DIV"),this._buttonsContainer.style.position="absolute",this._buttonsContainer.style.bottom=Math.round(this._params.WindowPadding).toString()+"px",this._buttonsContainer.style.right=Math.round(this._params.WindowPadding).toString()+"px",this._buttonsContainer.style.textAlign="right";for(let t=0;t<this._params.buttons.length;t++)this._buttonsContainer.appendChild(this._params.buttons[t].Element);this._div.appendChild(this._buttonsContainer),this._buttonsContainer.style.height=(25*this._params.GUICoef).toString()+"px",this._params.bottomKeepClear+=Math.round(35*this._params.GUICoef)}this._contents.style.position="absolute",this._contents.style.left=this._params.WindowPadding.toString()+"px",this._contents.style.right=this._params.WindowPadding.toString()+"px",this._contents.style.top=e.toString()+"px",this._contents.style.bottom=(this._params.WindowPadding+this._params.bottomKeepClear).toString()+"px",this._contents.style.paddingLeft="5px",this._contents.style.paddingRight="5px",this._contents.style.fontSize==""&&(this._contents.style.fontSize=this._params.contentsDefaultFontSize.toString()+"px"),this._contents.style.fontFamily==""&&(this._contents.style.fontFamily=this._params.contentsDefaultFontFamily),this._params.showContainerBorders?(this._contents.style.border=this._params.WindowInnerBorder,this._contents.style.backgroundColor=this._params.WindowInnerBackgroundColor):(this._contents.style.border="1px solid rgba(0, 0, 0, 0)",this._contents.style.backgroundColor=""),this._contents.style.overflow="hide",this._div.append(this._contents),document.body.appendChild(this._div)}hide(){this._div!=null&&(this._div.style.display="none",this._ModalDivShield!=null&&(this._ModalDivShield.style.display="none"),this._params.closingCallBack!=null&&this._params.closingCallBack(this))}set title(e){this._params.title=e,this._titleSpan!=null&&(this._titleSpan.innerText=e)}brintToFront(){let e=-1;for(let t=0;t<Zt.windowList.length;t++)Zt.windowList[t]==this&&(e=t);if(!(e<0)){Zt.windowList.splice(e,1),Zt.windowList.push(this);for(let t=0;t<Zt.windowList.length;t++)Zt.windowList[t].zIndex=t}}set zIndex(e){this._div!=null&&(this._div.style.zIndex=(100001+2*e).toString(),this._params.isModal&&(this._ModalDivShield.style.zIndex=(1e5+2*e).toString()))}switchSide(){this._div.style.left==""?(this._div.style.left="5px",this._div.style.right="",this._switchSideDiv.innerHTML=J.MoveToRightIcon(Math.round(20*this._params.GUICoef).toString(),!1,!1,!1,!1,"Click to move editor on right side")):(this._div.style.left="",this._div.style.right="5px",this._switchSideDiv.innerHTML=J.MoveToLeftIcon(Math.round(20*this._params.GUICoef).toString(),!1,!1,!1,!1,"Click to move editor on left side"))}};m(Zt,"YWindow");var nt=Zt;nt.windowList=[];var ki=class ki{static ask(e,t,i,r){let s=new ut;s.positionType=1,s.width=Math.min(Math.round(400*S.generalSizeCoef),Math.round(screen.width*.9)),s.height=Math.min(Math.round(160*S.generalSizeCoef),Math.round(screen.height*.7)),s.isModal=!0,s.showHeader=!1,s.showContainerBorders=!1;let n=new ft("Yes",()=>{ki._window.hide(),t!=null&&t(r)}),o=new ft("No",()=>{ki._window.hide(),i!=null&&i(r)});s.buttons.push(n),s.buttons.push(o),ki._window=new nt(s);let a=ki._window.innerContentDiv,l=document.createElement("TABLE");l.style.width="100%";let h=document.createElement("TR"),u=document.createElement("TD");return u.style.width="10",u.innerHTML=J.DontKnowIcon(Math.round(80*S.generalSizeCoef).toString(),!0,!1,!1,!1,""),h.appendChild(u),u=document.createElement("TD"),u.style.paddingLeft="20px",u.style.fontFamily=S.generalFontFamily,u.style.fontSize=S.generalFontSize.toString()+"px",u.style.textAlign="justify",u.innerText=e,h.appendChild(u),l.appendChild(h),a.appendChild(l),ki._window.show(),ki._window}};m(ki,"confirm");var pi=ki,oo=class oo{static show(e,t){let i=new ut;i.positionType=1,i.width=Math.min(Math.round(400*S.generalSizeCoef),screen.width),i.height=Math.min(Math.round(160*S.generalSizeCoef),screen.height),i.isModal=!0,i.showHeader=!1,i.showContainerBorders=!1;let r=new ft("OK",()=>{yi._window.hide()});i.buttons.push(r),yi._window=new nt(i);let s=yi._window.innerContentDiv,n=document.createElement("TABLE");n.style.width="100%";let o=document.createElement("TR"),a=document.createElement("TD");return a.style.width="10",a.innerHTML=e,o.appendChild(a),a=document.createElement("TD"),a.style.paddingLeft="20px",a.style.fontFamily=S.generalFontFamily,a.style.fontSize=S.generalFontSize.toString()+"px",a.style.textAlign="justify",a.innerText=t,o.appendChild(a),n.appendChild(o),s.appendChild(n),yi._window.show(),yi._window}};m(oo,"notififaction");var Gs=oo,lo=class lo extends Gs{static show(e){return super.show(J.FailedIcon(Math.round(80*S.generalSizeCoef).toString(),!0,!1,!1,!1,""),e)}};m(lo,"alert");var yi=lo,ho=class ho extends Gs{static show(e){return super.show(J.OkIcon(Math.round(80*S.generalSizeCoef).toString(),!0,!1,!1,!1,""),e)}};m(ho,"info");var ml=ho;var Pi=class Pi{constructor(){this.GUIcoef=1;let e=new ut;e.positionType=1,this.GUIcoef=S.generalSizeCoef,Pi.REFWIDH*this.GUIcoef>screen.width&&(this.GUIcoef=screen.width/Pi.REFWIDH),Pi.REFHEIGHT*this.GUIcoef>screen.height&&(this.GUIcoef=screen.height/Pi.REFHEIGHT),e.width=Math.round(Pi.REFWIDH*this.GUIcoef),e.height=Math.round(Pi.REFHEIGHT*this.GUIcoef),e.showHeader=!1,e.showContainerBorders=!1,this._window=new nt(e);let t=this._window.innerContentDiv,i=document.createElement("p");i.style.paddingTop="0px",i.style.marginTop=4*this.GUIcoef+"px",i.style.fontSize=16*this.GUIcoef+"px",i.innerText="Hello, welcome to Yocto-Visualization, what would you like to do?",i.style.textAlign="center",t.appendChild(i);let r=document.createElement("TABLE");r.style.position="absolute",r.style.top="0px",r.style.fontFamily=S.generalFontFamily,r.style.tableLayout="fixed",r.style.paddingLeft=Math.round(10*this.GUIcoef).toString()+"px",r.style.paddingRight=Math.round(10*this.GUIcoef).toString()+"px",r.style.paddingTop=Math.round(30*this.GUIcoef).toString()+"px",r.style.paddingBottom=Math.round(15*this.GUIcoef).toString()+"px",r.style.width="100%",r.style.height="100%",r.style.borderSpacing=Math.round(5*this.GUIcoef).toString()+"px";let s=document.createElement("TR");r.appendChild(s);let n=document.createElement("TD");s.appendChild(n);let o=document.createElement("TD");s.appendChild(o);let a=document.createElement("TD");s.appendChild(a);let l=document.createElement("TR");r.appendChild(l);let h=document.createElement("TD");l.appendChild(h);let u=document.createElement("TD");l.appendChild(u);let _=document.createElement("TD");l.appendChild(_),t.appendChild(r);let d=document.createElement("p");d.style.position="absolute",d.style.right="0px",d.style.bottom="0px",d.style.marginBottom="0px",d.style.paddingBottom="0px",d.style.marginRight="2px",d.style.fontSize=(8*this.GUIcoef).toString()+"px",d.innerText=S.buildVersion,d.style.color="grey",d.style.textAlign="right",t.appendChild(d);let g=(128*this.GUIcoef).toString();this.createButton(n,"Configure global parameters",J.ConfigureIcon(g,!0,!1,!1,!1),()=>{this.openConfig()}),this.createButton(o,"Create a new solid gauge",J.SolidGaugeIcon(g,!0,!1,!1,!1),()=>{O.newGaugeWidget()}),this.createButton(a,"Create a new graph",J.GraphIcon(g,!0,!1,!1,!1),()=>{O.newGraphWidget()}),this.createButton(h,"Get Raw data",J.RawDataIcon(g,!0,!1,!1,!1),()=>{this.openRawData()}),this.createButton(u,"Create a new digital display",J.DigitalDisplayIcon(g,!0,!1,!1,!1),()=>{O.newDigitalDisplayWidget()}),this.createButton(_,"Create a new angular gauge",J.AngularGaugeIcon(g,!0,!1,!1,!1),()=>{O.newAngularGaugeWidget()})}hide(){this._window.hide()}show(){this._window.show()}createButton(e,t,i,r){e.style.border="1px solid black",e.style.textAlign="center",e.style.fontSize=(10*this.GUIcoef).toString()+"px",e.style.paddingBottom="3px",e.style.borderColor="#808080",e.style.backgroundColor="#f0f0f0",e.style.cursor="pointer",e.addEventListener("mouseover",function(){e.style.backgroundColor="white"}),e.addEventListener("mouseout",function(){e.style.backgroundColor="#f0f0f0"});let s=document.createElement("a");s.style.outline="none",s.innerHTML=i+"<br>"+t,s.addEventListener("click",r),s.tabIndex=0,s.addEventListener("focusin",()=>{e.style.backgroundColor="white"}),s.addEventListener("focusout",()=>{e.style.backgroundColor="f0f0f0"}),s.addEventListener("keypress",n=>{n.key=="Enter"&&r()}),e.appendChild(s)}openConfig(){ye.show()}openRawData(){Xt.show()}};m(Pi,"mainForm");var Sr=Pi;Sr.REFWIDH=500;Sr.REFHEIGHT=360;var go=class go{constructor(e,t){this._htmlchilds=[],this._source=e,this._root=t,this._htmlchilds=[]}storeChilds(e){this._htmlchilds=[];for(let t=0;t<e.length;t++)this._htmlchilds.push(e.item(t))}getStoredChilds(){return this._htmlchilds}get root(){return this._root}refresh(){this._root!=null&&this._root.refresh()}};m(go,"EditedDataSource");var uo=go,fo=class fo{constructor(e,t){this.key=e,this.data=t}};m(fo,"keyDataObject");var co=fo,po=class po{constructor(){this.list=[]}isInlist(e){for(let t=0;t<this.list.length;t++)if(e==this.list[t].key)return!0;return!1}find(e){for(let t=0;t<this.list.length;t++)if(e==this.list[t].key)return this.list[t].data;return null}insert(e,t){for(let i=0;i<this.list.length;i++)if(e==this.list[i].key){this.list[i].data=t;return}this.list.push(new co(e,t))}};m(po,"objectDictionnary");var _o=po,mo=class mo{refresh(){}get panel(){return null}get expanded(){return!0}AllocateControls(){}};m(mo,"EditorBaseDef");var Wr=mo,hi=class hi extends Wr{get visible(){return this._window.visible}set visible(e){e?this.show():this.hide()}get text(){return this._text}set text(e){this._text=e,this._window.title=this._text}get help(){return this._helpText}set help(e){this._helpText=e,this._helpPanel.innerHTML=this._helpText}addTest(e){hi.testid++;let t=document.createElement("DIV");t.style.position="relative",t.style.display="inline-block;",t.style.left="0px",t.style.padding="2px 2px 2px 2px",t.style.right="5px",t.style.border="1px solid black",t.style.marginTop="2px",t.style.backgroundColor="yellow",e!=null?e.appendChild(t):this._container.appendChild(t);let i=document.createElement("ANCHOR");i.innerText="[+]",t.appendChild(i);let r=document.createElement("SPAN");r.innerText="Pouet "+hi.testid.toString(),t.appendChild(r);let s=document.createElement("DIV");return s.style.position="relative",s.style.display="inline-block;",s.style.left="5px",s.style.padding="2px 2px 2px 2px",s.style.right="5px",s.style.marginTop="2px",s.style.backgroundColor="lightgray",s.innerText="sub elements",e!=null?e.appendChild(s):this._container.appendChild(s),s}editorIsClosing(e){this._editorClosedCallback!=null&&this._editorClosedCallback()}bestWidth(){let e=window.innerWidth/4>>0,t=275*S.guiDPIFactor;return e<t&&(e=t),e>window.innerWidth-10&&(e=window.innerWidth-10),e}constructor(){super(),this._hostWindow=null,this._editorClosedCallback=null,this.currentEditedDataSource=null,this._changeCallback=null,this._getvalueCallback=null,this._text="Properties editor",this._helpText="Properties editor",this.EditedDataSourceList=new _o;let e=new ut;e.positionType=2,e.width=this.bestWidth(),e.createNow=!0,e.closingCallBack=t=>{this.editorIsClosing(t)},e.bottomKeepClear=hi.HelpHeight+3*S.WindowPadding,e.title=this._text,this._window=new nt(e),this._container=this._window.innerContentDiv,this._helpPanel=document.createElement("DIV"),this._helpPanel.style.position="absolute",this._helpPanel.style.left=S.WindowPadding.toString()+"px",this._helpPanel.style.bottom=S.WindowPadding.toString()+"px",this._helpPanel.style.right=S.WindowPadding.toString()+"px",this._helpPanel.style.height=hi.HelpHeight.toString()+"px",this._helpPanel.style.paddingLeft="5px",this._helpPanel.style.paddingTop="5px",this._helpPanel.style.overflowY="auto",this._helpPanel.style.border=S.WindowInnerBorder,this._helpPanel.style.backgroundColor=S.WindowInnerBackgroundColor,this._helpPanel.style.fontFamily=S.generalFontFamily,this._helpPanel.style.fontSize=S.generalFontSize.toString()+"px",this._helpPanel.style.color="black",this._helpPanel.style.display="",this._helpPanel.innerHTML="Help panel. Editor is loading, please wait....",this._window.outterContentDiv.appendChild(this._helpPanel),this._container.style.overflowY="scroll",this._container.style.overflowX="hidden",this._container.style.backgroundColor=S.WindowInnerBackgroundColor,window.addEventListener("resize",()=>{this.windowResized()})}windowResized(){this._window.innerContentDiv!=null&&(this._window.innerContentDiv.offsetHeight<hi.MinHeightforShowingHelp&&this._helpPanel.style.display==""?(this._helpPanel.style.display="none",this._window.bottomKeepClear=0):this._window.innerContentDiv.offsetHeight>=hi.MinHeightforShowingHelp+hi.HelpHeight&&this._helpPanel.style.display!=""&&(this._helpPanel.style.display="",this._window.bottomKeepClear=hi.HelpHeight))}show(){this._window.show(this.bestWidth()),this.windowResized()}hide(){Tt.stopEdition(),this._window.hide()}get panel(){return this._container}refresh(){this.visible&&this.currentEditedDataSource!=null&&this.currentEditedDataSource.refresh()}refreshBanner(){this._hostWindow!=null&&(this.text="Properties of "+this._hostWindow.Text)}showWindow(e,t,i,r,s){this._hostWindow=e,this._changeCallback=i,this._getvalueCallback=r,this.text="Properties editor",this.show(),this.refreshBanner(),this.EditObject(t,i,r,s)}EditObject(e,t,i,r){this._editorClosedCallback=r;let s="This is the property editor. Change any parameter you want. All changes are applied in real time.";if(!this.visible)return;if(this.help="Please wait....",this.EditedDataSourceList.isInlist(e)&&this.EditedDataSourceList.find(e)==this.currentEditedDataSource){this.help=s;return}if(this.currentEditedDataSource!=null)for(this.currentEditedDataSource.root.stopEdit(),this.currentEditedDataSource.storeChilds(this._container.childNodes);this._container.firstChild;)this._container.removeChild(this._container.lastChild);let n;if(this.EditedDataSourceList.isInlist(e)){this.currentEditedDataSource=this.EditedDataSourceList.find(e);let o=this.currentEditedDataSource.getStoredChilds();for(let a=0;a<o.length;a++)this._container.appendChild(o[a]);this.currentEditedDataSource.refresh()}else{let o=new Cr(this._helpPanel,this,null,"root","Root","root node","");n=new Ie(o),n.rootEditor=this,this.currentEditedDataSource=new uo(e,n),this.EditedDataSourceList.insert(e,this.currentEditedDataSource),n.showLabel=!1,n.expandable=!0,n.ProcessNewType(e),n.expanded=!0}this.currentEditedDataSource.root.startEdit(t,i),this.currentEditedDataSource.root.resizeAll(),this.help=s}getConfigData(){let e=this._window.outterContentDiv.getBoundingClientRect();return`<PropertiesForm>
<location x='`+e.left.toString()+"' y='"+e.top.toString()+`'/>
<size     w='`+e.width.toString()+"' h='"+e.width.toString()+`'/>
</PropertiesForm>
`}Form1_SizeChanged(e){this.currentEditedDataSource!=null&&this.currentEditedDataSource.root!=null&&this.currentEditedDataSource.root.resizeAll()}valuechange(e){let t="",i="",r="";this._changeCallback!=null&&this._changeCallback(e)}};m(hi,"PropertiesForm2");var tr=hi;tr.HelpHeight=Math.round(75*S.generalSizeCoef);tr.MinHeightforShowingHelp=175;tr.testid=0;var Ro=class Ro{constructor(e,t,i,r,s,n,o){this.expandable=!1,this.isReadonlyCall="",this.summary=null,this.structRoot=null,this.HelpZoneLabel=e,this.parentNode=t,this.RootNode=i,this.internalname=r,this.label=s,this.description=n,this.changeCausesParentRefresh=!1,this.preExpanded=!1,this.isReadonlyCall=o}};m(Ro,"UIElementBaseParams");var Cr=Ro,Do=class Do{constructor(){this.OriginalPropName="",this.fullpropname="",this.propType=""}};m(Do,"PropPathinfo");var li=Do,Io=class Io{constructor(e){this.available=!0,this.displayName="unknown",this.category="",this.displayDescription="Not documented",this.prefinedValues=null,this.changeCausesParentRefresh=!1,this.PreExpandedCategory=!1,this.PreExpanded=!1,this.summaryPropertyName="",this.isReadOnlyCall="",this.NotSavedInXML=!1,this.ReadOnly=!1,this.ParamCategorySummary="","OnlyAvailableon"in e.Attributes&&(this.available=e.Attributes.OnlyAvailableon),"DisplayName"in e.Attributes&&(this.displayName=e.Attributes.DisplayName),"CategoryAttribute"in e.Attributes&&(this.category=e.Attributes.CategoryAttribute),"DescriptionAttribute"in e.Attributes&&(this.displayDescription=e.Attributes.DescriptionAttribute),"AllowedValues"in e.Attributes&&(this.prefinedValues=e.Attributes.AllowedValues),"ChangeCausesParentRefreshAttribute"in e.Attributes&&(this.changeCausesParentRefresh=e.Attributes.ChangeCausesParentRefreshAttribute),"PreExpandedCategoryAttribute"in e.Attributes&&(this.PreExpandedCategory=e.Attributes.PreExpandedCategoryAttribute),"PreExpandedAttribute"in e.Attributes&&(this.PreExpanded=e.Attributes.PreExpandedAttribute),"ParamCategorySummaryAttribute"in e.Attributes&&(this.summaryPropertyName=e.Attributes.ParamCategorySummaryAttribute),"IsReadonlyCallAttribute"in e.Attributes&&(this.isReadOnlyCall=e.Attributes.IsReadonlyCallAttribute),"NotSavedInXMLAttribute"in e.Attributes&&(this.NotSavedInXML=e.Attributes.NotSavedInXMLAttribute),"ReadOnlyAttribute "in e.Attributes&&(this.ReadOnly=e.Attributes["ReadOnlyAttribute "]),"ParamCategorySummaryAttribute "in e.Attributes&&(this.ParamCategorySummary=e.Attributes["ParamCategorySummaryAttribute "])}};m(Io,"CustomAttributesExtractor");var bo=Io,xt=class xt extends Wr{get parentNode(){return this._parentNode}get targetFullName(){return this._targetFullName}get expandIcon(){return J.ExpandIcon(xt.defaultFontSize.toString(),!1,!1,!1,!1,"Click to expand")}get colapseIcon(){return J.ColapseIcon(xt.defaultFontSize.toString(),!1,!1,!1,!1,"Click to colapse")}removeFromEditor(){}get panel(){return this.subElementPanel}get editorHelpText(){return""}get isRootElement(){return this._rootNode==this}addToEditor(){if(this.mainlabel!=null){for(let e=0;e<this._parentPanel.children.length;e++)if(this._parentPanel.children[e]==this.mainlabel)return;this._parentPanel.appendChild(this.mainlabel),this._parentPanel.appendChild(this.subElementPanel)}}refresh(){this.mainText!=null&&(this.mainText.innerText=this.name+this.getSummary());for(let e=0;e<this.subElements.length;e++)this.subElements[e].refresh();this._rootNode!=null&&this._rootNode.rootEditor!=null&&this._rootNode.rootEditor.refreshBanner()}tabReOrder(e){return this._expandable&&this.expandCtrl!=null&&(this.expandCtrl.tabIndex=e++),this.subElements.forEach(t=>{e=t.tabReOrder(e)}),e}triggerValueChangeCallback(){this._valueChangeCallback!=null&&this._valueChangeCallback(this)}scrollToMakeVisible(){this.mainlabel!=null&&this._parentPanel!=null&&this.mainlabel.scrollIntoView()}control_GotFocus(e){let t=this.editorHelpText;t!=""&&(t=" "+t),this._helpZoneLabel.innerHTML=this._description+t}control_LostFocus(e){this._helpZoneLabel.innerHTML=""}preExpandIfNeeded(){this._parentNode!=null&&this._parentNode.expanded&&(this.AllocateControls(),this.expandable&&this.initExpandButton(),this.initMainLabel()),this.initExpandButton()}constructor(e){super(),this.name="NoName",this._targetFullName="unknowTargetName",this.ExpandableDepth=0,this._expanded=!1,this._expandButtonSide=0,this._rootEditor=null,this._description="",this.expandCtrl=null,this.mainlabel=null,this.mainText=null,this.subElementPanel=null,this._rootNode=null,this._parentNode=null,this._parentPanel=null,this._changeCausesParentRefresh=!1,this._isReadOnlyCall="",this._controlsAllocated=!1,this.expandButtonInitDone=!1,this.mainLabelInitDone=!1,this.subElements=[],this._valueChangeCallback=null,this._getValueCallback=null,this._shown=!0,this._summaryCallback=null,this._showLabel=!1,this._expandable=!1,this._preExpanded=!1,this.name=e.label,this._targetFullName=e.internalname,this._helpZoneLabel=e.HelpZoneLabel,this._description=e.description,this._changeCausesParentRefresh=e.changeCausesParentRefresh,this._expandable=e.expandable,this._preExpanded=e.preExpanded,this._structRoot=e.structRoot,this._isReadOnlyCall=e.isReadonlyCall,this._summaryProperty=e.summary,xt.baseheight==0&&(xt.baseheight=12,xt.expandableShift=xt.baseheight+2,xt.scrollBarWidth=20),this._parentNode=e.parentNode,this._rootNode=e.RootNode==null?this:e.RootNode}set rootEditor(e){this._rootEditor=e}get rootEditor(){return this._rootEditor}initMainLabel(){if(this.mainlabel==null||this.mainLabelInitDone)return;this.ExpandableDepth=0;let e=this;for(;e!=null;)e.expandable&&this.ExpandableDepth++,e=e.parentNode;if(this.mainText.innerText=this.name+this.getSummary(),this.expandable&&this._expandButtonSide==0)switch(this.ExpandableDepth){case 1:this.mainlabel.style.backgroundColor="Blue",this.mainText.style.color="black";break;case 2:this.mainlabel.style.backgroundColor="rgb(7,141,255)",this.mainText.style.color="white";break;case 3:this.mainlabel.style.backgroundColor="rgb(120,196,255)";break;case 4:this.mainlabel.style.backgroundColor="rgb(213,237,255)";break;case 5:this.mainlabel.style.backgroundColor="rgb(237,246,253)";break;default:this.mainlabel.style.backgroundColor="rgb(246,251,255)";break}else this.mainlabel.style.backgroundColor="rgba( 0, 0, 0,0)";this.mainLabelInitDone=!0}AllocateControls(){if(!this._controlsAllocated){if(this.isRootElement||this.parentNode.AllocateControls(),this._parentPanel=this.parentNode.panel,this.mainlabel==null){if(this.mainlabel=document.createElement("DIV"),this.mainlabel.style.position="relative",this.mainlabel.style.display="inline-block;",this.mainlabel.style.left="0px",this.mainlabel.style.padding="2px 2px 2px 2px",this.mainlabel.style.overflow="hidden",this.mainlabel.style.fontFamily=xt.defaultFontFamily,this.mainlabel.style.fontSize=xt.defaultFontSize.toString()+"px",this.mainlabel.style.right="5px",this.mainlabel.style.whiteSpace="nowrap",this.mainlabel.style.marginTop="2px",this.mainlabel.style.backgroundColor="yellow",this.mainText=document.createElement("SPAN"),this.mainText.innerText="Pouet",this.mainlabel.appendChild(this.mainText),this.mainlabel.style.display=this.isRootElement?"none":"",this.initMainLabel(),this._parentPanel==null)debugger;this._parentPanel.appendChild(this.mainlabel)}this._expandable&&this.expandCtrl==null&&(this.expandCtrl=document.createElement("ANCHOR"),this._expandButtonSide==0&&this.mainlabel.insertBefore(this.expandCtrl,this.mainText),this.initExpandButton(),this.subElementPanel=document.createElement("DIV"),this.subElementPanel.style.position="relative",this.subElementPanel.style.display="inline-block;",this.subElementPanel.style.left=this.isRootElement?"0px":"5px",this.subElementPanel.style.padding="2px 2px 2px 2px",this.subElementPanel.style.right="5px",this.subElementPanel.style.display="none",this.subElementPanel.style.marginTop="2px",this.subElementPanel.style.marginRight="2px",this._parentPanel.appendChild(this.subElementPanel)),this._controlsAllocated=!0}}initExpandButton(){this.expandCtrl!=null&&(this.expandButtonInitDone||(this.expandCtrl.innerHTML=this.expandIcon,this.expandCtrl.style.top="0px",this.expandCtrl.style.left="0px",this.expandCtrl.style.cursor="pointer",this.expandCtrl.style.backgroundColor="white",this.expandCtrl.style.marginRight="3px",this.expandCtrl.style.paddingLeft="0px",this.expandCtrl.style.paddingRight="0px",this.expandCtrl.style.paddingTop="1px",this.expandCtrl.style.marginTop="0px",this.expandCtrl.style.marginBottom="0px",this.expandCtrl.style.paddingBottom="0px",this.expandCtrl.style.paddingRight="0px",this.expandCtrl.addEventListener("click",()=>{this.ToggleExpand()}),this.expandCtrl.addEventListener("keyup",e=>{(e.key==="Enter"||e.key===" ")&&this.ToggleExpand()}),this.expandCtrl.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.expandCtrl.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.expandButtonInitDone=!0))}get rowHeight(){return xt.baseheight}ExtractPropPath(e){let t=-1,i=[],r=this;e.OriginalPropName=r.targetFullName;do if(e.fullpropname=r.targetFullName,t=e.fullpropname.indexOf("_"),t<0&&(e.fullpropname!=xt.ARTIFICIALSECTIONNAME&&i.splice(0,0,e.fullpropname),r=r.parentNode,r==null))throw"invalid Property name";while(t<0);e.propType=e.fullpropname.substring(0,t);let s=e.fullpropname.substring(t+1);return i.splice(0,0,s),i}startEdit(e,t){this.addToEditor(),this._valueChangeCallback=e,this._getValueCallback=t,this.subElements.forEach(i=>{i.startEdit(e,t)})}stopEdit(){this.removeFromEditor(),this._valueChangeCallback=null,this._getValueCallback=null,this.subElements.forEach(e=>{e.stopEdit()})}expand(){this.subElements.forEach(e=>{e.AllocateControls(),e.show()}),this._rootNode.tabReOrder(0),this._expanded=!0,this.subElementPanel.style.display="",this.expandCtrl.innerHTML=this.colapseIcon}colapse(){this.subElementPanel.style.display="none",this.expandCtrl.innerHTML=this.expandIcon}get expanded(){return this._expanded}set expanded(e){this._expanded=e,this._expanded?this.expand():this.colapse(),this._rootNode.resizeAll()}ToggleExpand(){this.expanded=!this.expanded}getSummary(){return this._summaryProperty!=null?" ("+Reflect.get(this._structRoot,this._summaryProperty.name)+")":""}sensorList(){let e=[];return oe.sensorList.forEach(t=>{e.push(t)}),e}ProcessNewType(e){let t={};this._structRoot=e;let i=[],r=de.getAllProperties(e);for(let s=0;s<r.byIndex.length;s++){let n=r.byIndex[s];if(n.isWritable){let o=new bo(n);if(o.available){let a=this;if(o.category!="")if(o.category in t)a=t[o.category];else{let d=new Cr(this._helpZoneLabel,this,this._rootNode,xt.ARTIFICIALSECTIONNAME,o.category,o.category+" section, expand for more...","");d.preExpanded=o.PreExpandedCategory,d.expandable=!0,d.structRoot=e,o.summaryPropertyName!=""&&(d.summary=n),a=new xt(d),o.PreExpandedCategory&&i.push(a),a.showLabel=!0,t[o.category]=a,this.addSubElement(a)}let l=new Cr(this._helpZoneLabel,a,this._rootNode,n.name,o.displayName,o.displayDescription,o.isReadOnlyCall);l.preExpanded=o.PreExpanded,l.changeCausesParentRefresh=o.changeCausesParentRefresh;let h=this._targetFullName,u="",_=h.indexOf("_");if(_>=0&&(u=h.substring(0,_),h=h.substring(_+1)),n.isEnum){let d=new To(l,e,n);a.addSubElement(d)}else switch(n.type){case"number":if(o.prefinedValues==null){let w=new Ao(l,e,n);a.addSubElement(w)}else{let w=new Xr(l,e,n,()=>o.prefinedValues);a.addSubElement(w)}break;case"boolean":let d=new So(l,e,n);a.addSubElement(d);break;case et.name:let g=new Co(l,e,n);a.addSubElement(g);break;case Ae.name:case st.name:let y=new Xr(l,e,n,()=>this.sensorList());a.addSubElement(y);break;case c.name:let p=new xo(l,e,n);a.addSubElement(p);break;case _t.name:let x=new wo(l,e,n);a.addSubElement(x);break;case"string":if(o.prefinedValues==null){let w=new yo(l,e,n);a.addSubElement(w)}else{let w=new Xr(l,e,n,()=>o.prefinedValues);a.addSubElement(w)}break;default:{l.expandable=!0,l.preExpanded=o.PreExpanded;let w=new xt(l);o.PreExpanded&&i.push(w),w.showLabel=!0,a.addSubElement(w),w.ProcessNewType(e[n.name])}break}}}else n.name=="summary"&&(this._summaryProperty=n)}this._summaryProperty!=null&&this.refresh(),i.forEach(s=>{s.expand()})}show(){this._shown=!0,this.mainlabel!=null&&(this.mainlabel.style.display=""),this.expandCtrl!=null&&(this.expandCtrl.style.display=this._expandable?"":"hidden"),this.expanded&&this.subElements.forEach(e=>{e.show()})}hide(){this._shown=!1,this.mainlabel!=null&&(this.mainlabel.style.display="hidden"),this.expandCtrl!=null&&(this.expandCtrl.style.display=this._expandable?"hidden":""),this.subElements.forEach(e=>{e.hide()})}ExpandCtrl_Click_expand(e){this.expanded=!this._expanded}resizeAll(){this.resize(0,0,0,0),this.expanded&&this.subElements.forEach(e=>{e.resizeAll()})}get showLabel(){return this._showLabel}set showLabel(e){this._showLabel=e,this.expandCtrl!=null&&(this.expandCtrl.style.display=e&&this._expandable?"":"hidden")}get expandable(){return this._expandable}set expandable(e){this._expandable=e,e&&(this.expandCtrl==null&&(this.AllocateControls(),this.initExpandButton()),this.expandCtrl.style.display=e&&this._showLabel?"":"hidden")}addSubElement(e){this.subElements.push(e)}computeHeight(){return 0}resize(e,t,i,r){return 0}};m(xt,"UIElement");var Ie=xt;Ie.defaultFontFamily=S.generalFontFamily;Ie.defaultFontSize=S.generalFontSize;Ie.ARTIFICIALSECTIONNAME="-ignore-";Ie.baseheight=0;Ie.indentation=16;Ie.expandableShift=0;Ie.scrollBarWidth=0;Ie.expandableVerticalOffset=2;var vo=class vo extends Ie{constructor(e,t,i){super(e),this.input=null,this.select=null,this._prop=i,this._dataContainer=t,this._showLabel=!0,this._preExpanded&&this.AllocateControls(),this._expandable&&this._preExpanded&&this.expand()}removeFromEditor(){super.removeFromEditor()}tabReOrder(e){return this.input!=null&&(this.input.tabIndex=e++),this.subElements.forEach(t=>{e=t.tabReOrder(e)}),e}addToEditor(){super.addToEditor()}show(){super.show(),this.input!=null&&(this.input.style.visibility="")}checkForReadOnly(){if(!(this.input==null&&this.select==null)&&this._isReadOnlyCall!=""){let e=Reflect.get(this._dataContainer,this._isReadOnlyCall);this.input!=null&&(this.input.disabled=e),this.select!=null&&(this.select.disabled=e)}}hide(){this.input!=null&&(this.input.style.visibility="hidden"),super.hide()}resize(e,t,i,r){return 0}};m(vo,"UIElementGeneric");var Ai=vo,Eo=class Eo extends Ai{constructor(e,t,i){super(e,t,i),this._value="",this.preExpandIfNeeded()}AllocateControls(){super.AllocateControls(),this.input==null&&(this.input=document.createElement("INPUT"),this.input.type="input",this.input.value=Reflect.get(this._dataContainer,this._prop.name),this.input.style.position="absolute",this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.style.fontFamily=Ie.defaultFontFamily,this.input.style.fontSize=Ie.defaultFontSize.toString()+"px",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",this.input.style.top="0px",this.input.style.right="3px",this.input.style.width="50%",this.mainlabel.appendChild(this.input),new wt(this.input,0,!0,Number.NaN,Number.NaN,()=>{this.Text_TextChanged(null)}),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly())}refresh(){if(this.input==null||this._getValueCallback==null)return;let e=this._getValueCallback(this);if(e==null)return;let t=e.toString();this.input!=null&&t!=this.input.value&&(this.input.value=t),this.checkForReadOnly()}Text_TextChanged(e){this.input!=null&&(this._value=this.input.value,Reflect.set(this._dataContainer,this._prop.name,this._value),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}get value(){return this._value}set value(e){this._value=e,this.input.value=e}resize(e,t,i,r){return this.mainlabel.style.height=this.input.offsetHeight.toString()+"px",0}};m(Eo,"UIElementString");var yo=Eo,ko=class ko extends Ai{constructor(e,t,i){super(e,t,i),this._value=0,this.preExpandIfNeeded()}AllocateControls(){super.AllocateControls(),this.input==null&&(this.input=document.createElement("INPUT"),this.input.type="input",this.input.value=Reflect.get(this._dataContainer,this._prop.name),this.input.style.textAlign="right",this.input.style.position="absolute",this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.style.fontFamily=Ie.defaultFontFamily,this.input.style.fontSize=Ie.defaultFontSize.toString()+"px",this.input.type="number",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",this.input.style.top="0px",this.input.style.right="3px",this.input.style.width="50%",this.mainlabel.appendChild(this.input),new wt(this.input,4,!1,Number.NaN,Number.NaN,()=>{this.Text_TextChanged(null)}),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly())}refresh(){if(this.input==null||this._getValueCallback==null)return;let e=this._getValueCallback(this);e!=null&&(this.input!=null&&e!=parseFloat(this.input.value)&&(this.input.value=e.toString()),this.checkForReadOnly())}Text_TextChanged(e){this.input!=null&&(this._value=parseFloat(this.input.value),Reflect.set(this._dataContainer,this._prop.name,this._value),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}get value(){return this._value}set value(e){this._value=e,this.input.value=e.toString()}resize(e,t,i,r){return this.mainlabel.style.height=this.input.offsetHeight.toString()+"px",0}};m(ko,"UIElementNumber");var Ao=ko,Po=class Po extends Ai{constructor(e,t,i){super(e,t,i),this._text=null,this._value=!1,this.preExpandIfNeeded()}AllocateControls(){if(super.AllocateControls(),this.input==null){let e=document.createElement("SPAN");e.style.position="absolute",e.style.display="inline-block",e.style.width="50%",e.style.right="0px",this.mainlabel.appendChild(e),this.input=document.createElement("INPUT"),this.input.type="input",this.input.checked=Reflect.get(this._dataContainer,this._prop.name),this.input.style.textAlign="right",this.input.style.display="inline",this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.type="checkbox",this.input.style.transform="scale("+S.generalSizeCoef.toString()+")",this.input.style.marginRight=Math.round(5*S.generalSizeCoef).toString()+"px",this.input.style.top="0px",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",e.appendChild(this.input),this.input.addEventListener("keyup",t=>{t.key===" "&&this.value_TextChanged(null)}),this.input.addEventListener("change",()=>{this.value_TextChanged(null)}),this._text=document.createElement("SPAN"),this._text.style.display="inline",this._text.style.fontFamily=Ie.defaultFontFamily,this._text.style.fontSize=Ie.defaultFontSize.toString()+"px",e.appendChild(this._text),this.updateText(),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly()}}updateText(){this._text.innerText=this.input.checked?"Enabled":"Disabled"}refresh(){if(this.input==null||(this.checkForReadOnly(),this._getValueCallback==null))return;let e=this._getValueCallback(this);if(e==null)return;let t=e;this.input!=null&&(this.input.checked=t.valueOf(),this.updateText())}value_TextChanged(e){this.input!=null&&(this._value=this.input.checked,this.updateText(),Reflect.set(this._dataContainer,this._prop.name,this._value),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}get value(){return this._value}set value(e){this._value=e,this.input.checked=e,this.updateText()}resize(e,t,i,r){return 0}};m(Po,"UIElementBoolean");var So=Po,No=class No extends Ai{constructor(e,t,i){super(e,t,i),this._value=0,this.preExpandIfNeeded()}AllocateControls(){super.AllocateControls(),this.input==null&&(this.input=document.createElement("INPUT"),this.input.type="input",this.input.value=Reflect.get(this._dataContainer,this._prop.name).toString(),this.input.style.textAlign="right",this.input.style.position="absolute",this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.style.fontFamily=Ie.defaultFontFamily,this.input.style.fontSize=Ie.defaultFontSize.toString()+"px",this.input.type="number",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",this.input.style.top="0px",this.input.style.right="3px",this.input.style.width="50%",this.mainlabel.appendChild(this.input),new wt(this.input,4,!0,Number.NaN,Number.NaN,()=>{this.Text_TextChanged(null)}),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly())}refresh(){if(this.input==null||this._getValueCallback==null)return;let e=this._getValueCallback(this).toString();this.input!=null&&e!=this.input.value&&(this.input.value=e),this.checkForReadOnly()}Text_TextChanged(e){this.input!=null&&(this._value=this.input.value==""?Number.NaN:parseFloat(this.input.value),Reflect.set(this._dataContainer,this._prop.name,new et(this._value)),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}get value(){return new et(this._value)}set value(e){this._value=e.value,this.input.value=e.toString()}resize(e,t,i,r){return this.mainlabel.style.height=this.input.offsetHeight.toString()+"px",0}};m(No,"UIElementDoubleNan");var Co=No,Lo=class Lo extends Ai{constructor(e,t,i){super(e,t,i),this.allValues=[],this._value="",this.preExpandIfNeeded()}AllocateControls(){if(super.AllocateControls(),this.select==null){this.select=document.createElement("SELECT");let e=Reflect.get(this._dataContainer,this._prop.name);this.allValues=e.sibblings;for(let t=0;t<this.allValues.length;t++){let i=document.createElement("OPTION");i.text=this.allValues[t].description,i.value=this.allValues[t].toString,this.select.add(i,null)}this.select.value=e.toString,this.select.style.position="absolute",this.select.style.marginTop="0px",this.select.style.marginBottom="0px",this.select.style.fontFamily=Ie.defaultFontFamily,this.select.style.fontSize=Ie.defaultFontSize.toString()+"px",this.select.style.top="0px",this.select.style.right="3px",this.select.style.width="50%",this.mainlabel.appendChild(this.select),this.select.addEventListener("change",()=>{this.valueChanged(null)}),this.select.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.select.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly()}}refresh(){if(this.select==null||this._getValueCallback==null)return;let t=this._getValueCallback(this).toString;this.select!=null&&t!=this.select.value&&(this.select.value=t),this.checkForReadOnly()}valueChanged(e){if(this.select!=null){this._value=this.select.value;let t=null;for(let i=0;i<this.allValues.length;i++)this.allValues[i].toString==this._value&&(t=this.allValues[i]);t!=null&&Reflect.set(this._dataContainer,this._prop.name,t),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh()}}tabReOrder(e){return this.select!=null&&(this.select.tabIndex=e++),e}get value(){return this._value}set value(e){this._value=e,this.select.value=e}resize(e,t,i,r){return this.mainlabel.style.height=this.select.offsetHeight.toString()+"px",0}};m(Lo,"UIElementEnum");var To=Lo,Yo=class Yo extends Ai{constructor(e,t,i,r){super(e,t,i),this._refreshCallback=null,this._indexedValue=!0,this.allValues=[],this.valueType="",this._value="",this._refreshCallback=r,this.preExpandIfNeeded()}AllocateControls(){if(super.AllocateControls(),this.select==null){this.allValues=this._refreshCallback(),this.select=document.createElement("SELECT");let e=Reflect.get(this._dataContainer,this._prop.name);this.valueType=typeof e,this._indexedValue=typeof e=="number"&&typeof this.allValues[0]!="number";let t=!1,i=null;for(let r=0;r<this.allValues.length;r++){let s=document.createElement("OPTION");r==0&&(i=s),s.text=this.allValues[r].toString(),s.value=this._indexedValue?r:this.allValues[r],this.select.add(s,null),s.value.toString()==e.toString()&&(t=!0)}if(!t&&!this._indexedValue){let r=document.createElement("OPTION");r.text=e.toString(),r.value=e,this.select.add(r,i)}this.select.value=e,this.select.style.position="absolute",this.select.style.marginTop="0px",this.select.style.marginBottom="0px",this.select.style.fontFamily=Ie.defaultFontFamily,this.select.style.fontSize=Ie.defaultFontSize.toString()+"px",this.select.style.top="0px",this.select.style.right="3px",this.select.style.width="50%",this.mainlabel.appendChild(this.select),this.select.addEventListener("change",()=>{this.valueChanged(null)}),this.select.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.select.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly()}}refresh(){if(this.select==null||this._getValueCallback==null)return;this.allValues=this._refreshCallback();for(let t=0;t<this.allValues.length;t++){let i=t<this.select.options.length?this.select.options[t]:document.createElement("OPTION");i.text=this.allValues[t].toString(),i.value=this._indexedValue?t:this.allValues[t],t>=this.select.options.length&&this.select.add(i,null)}for(;this.allValues.length<this.select.options.length;)this.select.options[this.select.options.length-1].remove();let e=Reflect.get(this._dataContainer,this._prop.name);if(e!=null){if(this._indexedValue){let t=Number(e).toString();this.select.value!=t&&(this.select.value=t)}else{let t=e.toString();this.select.value!=t&&(this.select.value=t)}this.checkForReadOnly()}}valueChanged(e){if(this.select!=null){if(this._value=this.select.value,this.valueType=="number"){let t=parseInt(this._value);t>=0&&Reflect.set(this._dataContainer,this._prop.name,t)}else{let t="";for(let i=0;i<this.allValues.length;i++)this.allValues[i]==this._value&&(t=this.allValues[i]);t!=""&&Reflect.set(this._dataContainer,this._prop.name,t)}this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh()}}tabReOrder(e){return this.select!=null&&(this.select.tabIndex=e++),e}get value(){return this._value}set value(e){this._value=e,this.select.value=e}resize(e,t,i,r){return this.mainlabel.style.height=this.select.offsetHeight.toString()+"px",0}};m(Yo,"UIElementList");var Xr=Yo,Mo=class Mo extends Ai{constructor(e,t,i){super(e,t,i),this.colorSample=null,this.colorEditor=null,this.colorPreview=null,this.currentColor=null,this._value="",this.preExpandIfNeeded()}get expandIcon(){return J.DotDotDotIcon(Ie.defaultFontSize.toString(),!1,!1,!1,!1,"Click to open color chooser")}get colapseIcon(){return J.DotDotDotIcon(Ie.defaultFontSize.toString(),!1,!1,!1,!1,"Click to close color chooser")}AllocateControls(){if(this._expandable=!0,this._expandButtonSide=1,super.AllocateControls(),this.input==null){let e=document.createElement("TABLE");e.style.position="absolute",e.style.top="0px",e.style.right="3px",e.style.width="50%",e.style.borderCollapse="collapse";let t=document.createElement("TR");e.appendChild(t);let i=document.createElement("TD");t.appendChild(i),this.colorSample=document.createElement("Div"),this.colorSample.style.display="inline-block",this.colorSample.style.border="1px solid black",this.colorSample.style.marginRight="1px",this.colorSample.style.marginTop="0px",this.colorSample.style.width="16px",this.colorSample.style.height="16px",this.colorSample.style.top="0px",this.colorSample.style.bottom="0px",this.colorPreview=new Xi(this.colorSample,null),i.appendChild(this.colorSample);let r=document.createElement("TD");r.style.width="100%",t.appendChild(r),this.input=document.createElement("INPUT"),this.input.type="input",this.currentColor=Reflect.get(this._dataContainer,this._prop.name),this.colorPreview.color=this.currentColor,this.input.value=this.currentColor.toString(),this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.style.width="100%",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",this.input.style.fontFamily=Ie.defaultFontFamily,this.input.style.fontSize=Ie.defaultFontSize.toString()+"px",r.appendChild(this.input);let s=document.createElement("TD");s.style.paddingLeft="5px",t.appendChild(s),s.appendChild(this.expandCtrl),this.mainlabel.appendChild(e),new wt(this.input,7,!1,Number.NaN,Number.NaN,(n,o)=>{this.Text_TextChanged(n,o)}),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly()}}expand(){this.colorEditor==null&&(this.subElementPanel.style.marginLeft="20px",this.colorEditor=new ni(this.subElementPanel,Ie.defaultFontSize,this.currentColor,e=>{this.coloredited(e)})),this._rootNode.tabReOrder(0),this._expanded=!0,this.subElementPanel.style.display="",this.expandCtrl.innerHTML=this.colapseIcon}colapse(){this.subElementPanel.style.display="none",this.expandCtrl.innerHTML=this.expandIcon}coloredited(e){this.currentColor=e.clone(),this.colorPreview.color=this.currentColor,this.input.value=this.currentColor.toString(),Reflect.set(this._dataContainer,this._prop.name,this.currentColor),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh()}refresh(){if(this.input==null||this._getValueCallback==null)return;let e=this._getValueCallback(this);if(e!=null&&(this.colorPreview!=null&&(this.colorPreview.color=e),this.input!=null)){let t=e.toString();t!=this.input.value&&(this.input.value=t)}this.checkForReadOnly()}Text_TextChanged(e,t){if(this.input!=null){this._value=this.input.value;let i=c.FromString(this._value);i!=null&&(this.colorPreview.color=i,this.currentColor=i,this.colorEditor!=null&&(this.colorEditor.color=i),Reflect.set(this._dataContainer,this._prop.name,i),t&&(this.input.value=i.toString()),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}}get value(){return this._value}set value(e){this._value=e,this.input.value=e}resize(e,t,i,r){let s=this.input.offsetHeight;return this.mainlabel.style.height=s.toString()+"px",0}};m(Mo,"UIElementColor");var xo=Mo,Zr=class Zr extends Ai{constructor(e,t,i){super(e,t,i),this._cachedValue=null,this._value="",this.preExpandIfNeeded()}static expandIconSVG(e){return J.targetIcon(e.toString(),!1,!1,!1,!1,"Click to place marker on graph")}get expandIcon(){return Zr.expandIconSVG(Ie.defaultFontSize)}get colapseIcon(){return Zr.expandIconSVG(Ie.defaultFontSize)}AllocateControls(){if(this._expandable=!0,this._expandButtonSide=1,super.AllocateControls(),this.input==null){let e=document.createElement("TABLE");e.style.position="absolute",e.style.top="0px",e.style.right="3px",e.style.width="50%",e.style.borderCollapse="collapse";let t=document.createElement("TR");e.appendChild(t);let i=document.createElement("TD");i.style.width="100%",t.appendChild(i),this.input=document.createElement("INPUT"),this.input.type="input",this._cachedValue=Reflect.get(this._dataContainer,this._prop.name),this.input.value=this._cachedValue.toString(),this.input.style.marginTop="0px",this.input.style.marginBottom="0px",this.input.style.textAlign="right",this.input.style.width="100%",this.input.style.border="1px solid grey",this.input.style.borderRadius="1px",this.input.style.fontFamily=Ie.defaultFontFamily,this.input.style.fontSize=Ie.defaultFontSize.toString()+"px",this.input.addEventListener("keyup",()=>{this.Text_TextChanged(null,!0)}),this.input.addEventListener("change",()=>{this.Text_TextChanged(null,!1)}),i.appendChild(this.input);let r=document.createElement("TD");r.style.paddingLeft="5px",t.appendChild(r),r.appendChild(this.expandCtrl),this.mainlabel.appendChild(e),this.input.addEventListener("focusin",()=>{this.control_GotFocus(this)}),this.input.addEventListener("focusout",()=>{this.control_LostFocus(this)}),this.checkForReadOnly()}}expand(){let e=Reflect.get(this._dataContainer,this._prop.name);this.expanded=!1,e.capture=!0,Reflect.set(this._dataContainer,this._prop.name,e),this._valueChangeCallback!=null&&this._valueChangeCallback(this)}colapse(){}refresh(){this.input!=null&&this._getValueCallback!=null&&(this._cachedValue=this._getValueCallback(this),this.input!=null&&(this.input.value=this._cachedValue.toString()),this.checkForReadOnly())}Text_TextChanged(e,t){let i=this._cachedValue.TryParse(this.input.value);i.success&&(this._cachedValue.value=i.result,Reflect.set(this._dataContainer,this._prop.name,this._cachedValue),this._valueChangeCallback!=null&&this._valueChangeCallback(this),this._changeCausesParentRefresh&&this.parentNode.refresh())}get value(){return this._value}set value(e){this._value=e,this.input.value=e}resize(e,t,i,r){let s=this.input.offsetHeight;return this.mainlabel.style.height=s.toString()+"px",0}};m(Zr,"UIElementMarkerPos");var wo=Zr,Fo=class Fo{static nullCallback(e){}constructor(e,t,i,r,s,n){this._allowEmpty=!1,this._min=Number.NaN,this._max=Number.NaN,this._callback=null,this._input=e,this._type=t,this._allowEmpty=i,this._min=r,this._max=s,this._callback=n,this.checkData(),this._input.addEventListener("keyup",()=>{this.InputChange(this._input,!0)}),this._input.addEventListener("change",()=>{this.InputChange(this._input,!1)})}showError(e){this._input.title=e}clearError(){this._input.title=""}backGroundColorFeedback(e,t){t?this.clearError():this.showError(e);let i=this._input.style.backgroundColor;return t&&i!="white"&&(this._input.style.backgroundColor="white"),!t&&i!="pink"&&(this._input.style.backgroundColor="pink"),t}checkData(){let e=0,t=0;if(this._input.disabled)return!0;let i=this._input.value;if(i=="")return this.backGroundColorFeedback("This field can't be empty",this._allowEmpty);switch(this._type){case 0:break;case 1:if(e=parseInt(i),t=parseFloat(i),Number.isNaN(e)||e!=t)return this.backGroundColorFeedback("Integer value expected",!1);if(!Number.isNaN(this._min)&&e<this._min)return this.backGroundColorFeedback("Integer value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&e>this._max)return this.backGroundColorFeedback("Integer value lower or equal to  "+this._min.toString()+" expected",!1);break;case 2:if(e=parseInt(i),t=parseFloat(i),Number.isNaN(e)||e!=t)return this.backGroundColorFeedback("Positive integer  expected",!1);if(e<0)return this.backGroundColorFeedback("Positive integer value  expected",!1);if(!Number.isNaN(this._min)&&e<this._min)return this.backGroundColorFeedback("Positive integer value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&e>this._max)return this.backGroundColorFeedback("Positive integer value lower or equal to  "+this._min.toString()+" expected",!1);break;case 3:if(e=parseInt(i),t=parseFloat(i),Number.isNaN(e)||e!=t)return this.backGroundColorFeedback("Strictly positive Integer value expected",!1);if(e<=0)return this.backGroundColorFeedback("Strictly positive integer value  expected",!1);if(!Number.isNaN(this._min)&&e<this._min)return this.backGroundColorFeedback("Positive integer value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&e>this._max)return this.backGroundColorFeedback("Positive integer value lower or equal to  "+this._min.toString()+" expected",!1);break;case 4:if(t=parseFloat(i),Number.isNaN(e))return this.backGroundColorFeedback("Floating point value expected",!1);if(!Number.isNaN(this._min)&&t<this._min)return this.backGroundColorFeedback("Floating point value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&t>this._max)return this.backGroundColorFeedback("Floating point value lower or equal to  "+this._min.toString()+" expected",!1);break;case 5:if(t=parseFloat(i),Number.isNaN(t))return this.backGroundColorFeedback("Positive floating point value expected",!1);if(t<0)return this.backGroundColorFeedback("Positive floating point value expected",!1);if(!Number.isNaN(this._min)&&t<this._min)return this.backGroundColorFeedback("Floating point value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&t>this._max)return this.backGroundColorFeedback("Floating point value lower or equal to  "+this._min.toString()+" expected",!1);break;case 6:if(t=parseFloat(i),Number.isNaN(t))return this.backGroundColorFeedback("Strictly positive floating point value expected",!1);if(t<=0)return this.backGroundColorFeedback("Strictly positive floating point value expected",!1);if(!Number.isNaN(this._min)&&t<this._min)return this.backGroundColorFeedback("Floating point value greater or equal to "+this._min.toString()+" expected",!1);if(!Number.isNaN(this._max)&&t>this._max)return this.backGroundColorFeedback("Floating point value greater or equal to "+this._min.toString()+" expected",!1);break;case 7:if(c.FromString(i)==null)return this.backGroundColorFeedback("Value color name/definition expected",!1);break}return this.backGroundColorFeedback("",!0)}InputChange(e,t){if(this.checkData())try{this._callback!=null&&this._callback(e,t)}catch(i){this.backGroundColorFeedback(i.message,!1)}}};m(Fo,"InputFieldManager");var wt=Fo;var Vo=class Vo{constructor(e,t,i){this._realTab=!1,this._div=null,this._tabLabel=null,this._td=document.createElement("TD"),this._editor=e,t!=""?(this._div=document.createElement("DIV"),this._div.style.display="none",this._td.style.paddingTop="4px",this._td.style.fontSize=i.toString()+"px",this._td.style.paddingBottom="2px",this._td.style.borderLeft="1px solid "+this._editor.inactiveBorderColor,this._td.style.borderRight="1px solid "+this._editor.inactiveBorderColor,this._td.style.borderTop="1px solid "+this._editor.inactiveBorderColor,this._td.style.borderBottom="1px solid "+this._editor.activeBorderColor,this._td.style.color=this._editor.inactiveColor,this._td.style.backgroundColor=this._editor.inactiveBackgroundColor,this._td.style.borderTopLeftRadius="3px",this._td.style.borderTopRightRadius="3px",this._td.style.paddingLeft="5px",this._td.style.paddingRight="5px",this._realTab=!0,this._tabLabel=document.createElement("ANCHOR"),this._tabLabel.innerText=t,this._tabLabel.addEventListener("click",()=>{this._editor.tabSelected(this)}),this._tabLabel.addEventListener("keyup",r=>{(r.key==="Enter"||r.key===" ")&&this._editor.tabSelected(this)}),this._tabLabel.style.cursor="pointer",this._td.appendChild(this._tabLabel)):(this._td.style.borderBottom="1px solid "+this._editor.activeBorderColor,this._td.innerHTML="<span>&nbsp;</span>")}setTabIndex(e){return this._tabLabel.tabIndex=e++,e}set active(e){this._realTab&&(this._td.style.borderLeftColor=e?this._editor.activeBorderColor:this._editor.inactiveBorderColor,this._td.style.borderTopColor=e?this._editor.activeBorderColor:this._editor.inactiveBorderColor,this._td.style.borderRightColor=e?this._editor.activeBorderColor:this._editor.inactiveBorderColor,this._td.style.borderBottomColor=e?"rgba(0, 0, 0, 0)":this._editor.activeBorderColor,this._td.style.color=e?this._editor.activeColor:this._editor.inactiveColor,this._td.style.backgroundColor=e?this._editor.activeBackgroundColor:this._editor.inactiveBackgroundColor,this._div.style.display=e?"":"none")}get active(){return this._div.style.display==""}get tabElement(){return this._td}get divElement(){return this._div}};m(Vo,"ColorEditorTab");var Tr=Vo,ir=class ir{setTabIndex(e){return this._anchor.tabIndex=e++,this._input.tabIndex=e++,e}constructor(e,t,i,r,s,n,o){this._value=0,this._colorCallback=r,this._changeCallBack=s,this._value=o,this._div=e;let a=ir.scrollHeight;n&&(this._div.style.background="url('data:image/svg+xml;utf8,"+Xi.checkerboardImage(a,a)+"')"),this._anchor=t,this._input=i,this._input.size=3,this._input.maxLength=3,this._input.type="number",this._input.min="0",this._input.max="255",this._input.style.fontSize=(12*S.guiDPIFactor).toString()+"px",this._input.style.textAlign="right",this._input.value=this._value.toString(),this._input.style.marginLeft="10px",this._div.style.width="100%",this._div.style.position="relative",this._div.style.height=ir.scrollHeight.toString()+"px",this._div.style.border="1px solid black",this._canvasBg=document.createElement("CANVAS"),this._div.appendChild(this._canvasBg),this._canvasBg.style.left="0px",this._canvasBg.style.top="0px",this._canvasBg.style.width="100%",this._canvasBg.style.height="100%",this._canvasBg.width=256,this._canvasBg.height=ir.scrollHeight,this._canvasCursor=document.createElement("CANVAS"),this._div.appendChild(this._canvasCursor),this._canvasCursor.style.position="absolute",this._canvasCursor.style.width="100%",this._canvasCursor.style.height="100%",this._canvasCursor.style.left="0px",this._canvasCursor.style.top="0px",this._canvasCursor.style.display="block",this._div.addEventListener("mousedown",l=>{this.MouseDown(this._div,l)}),this._div.addEventListener("mousemove",l=>{this.MouseMove(this._div,l)}),this._anchor.addEventListener("wheel",l=>{this.mouseWheelEvent(this._div,l)}),this._anchor.addEventListener("keydown",l=>{this.KeyDown(this._div,l)}),this._input.addEventListener("keyup",l=>{this.inputKeyUp()}),this._input.addEventListener("change",l=>{this.inputKeyUp()}),this._anchor.tabIndex=4}get value(){return this._value}set value(e){e<0&&(e=0),e>255&&(e=255),this._value=e,this._input.value=this._value.toString()}inputKeyUp(){let e=parseInt(this._input.value);isNaN(e)||(e<0&&(e=0),e>255&&(e=255),this._value=e,this.refresh(),this._changeCallBack(this))}TouchStart(e,t){t.touches.length==1&&this.handleMouseStartCapture(e,t.touches[0].clientX,t.touches[0].clientY)}TouchCaptureRun(e,t){t.touches.length==1&&this.handleMouseRun(e,t.touches[0].clientX,t.touches[0].clientY)}TouchCaptureEnd(e,t){}MouseDown(e,t){t.buttons==1&&this.handleMouseStartCapture(e,t.clientX,t.clientY)}handleMouseStartCapture(e,t,i){let r=e.getBoundingClientRect(),s=Math.round(t-r.left),n=Math.round(256*s/this._div.offsetWidth)>>0;n<0&&(n=0),n>255&&(n=255),this._value=n,this._input.value=n.toString(),this.refresh(),this._changeCallBack(this)}MouseMove(e,t){t.buttons==1&&this.handleMouseRun(e,t.clientX,t.clientY)}handleMouseRun(e,t,i){let r=e.getBoundingClientRect(),s=Math.round(t-r.left),n=Math.round(256*s/this._div.offsetWidth)>>0;n<0&&(n=0),n>255&&(n=255),this._value=n,this._input.value=n.toString(),this.refresh(),this._changeCallBack(this)}mouseWheelEvent(e,t){this._value+=t.deltaY>0?-1:1,this._value<0?this._value=0:this._value>255?this._value=255:t.preventDefault(),this._input.value=this._value.toString(),this.refresh(),this._changeCallBack(this)}KeyDown(e,t){t.code=="ArrowRight"&&(this._value++,this._value>255&&(this._value=255)),t.code=="ArrowLeft"&&(this._value--,this._value<0&&(this._value=0)),this._input.value=this._value.toString(),this.refresh(),this._changeCallBack(this)}refresh(){let e=this._colorCallback(this),t=this._canvasBg.getContext("2d");t.clearRect(0,0,this._canvasBg.width,this._canvasBg.height);for(let s=0;s<256;s++)t.beginPath(),t.moveTo(s+.5,0),t.lineTo(s+.5,ir.scrollHeight),t.strokeStyle=e[s],t.stroke();this._canvasCursor.width=this._div.offsetWidth,this._canvasCursor.height=this._div.offsetHeight,t=this._canvasCursor.getContext("2d");let i=.5+this._value/255*this._canvasCursor.width;t.beginPath();let r=.5;t.moveTo(i,r+5),t.lineTo(i+3,r),t.lineTo(i-3,r),t.fillStyle="black",t.strokeStyle="white",t.closePath(),t.fill(),t.stroke(),r=this._canvasCursor.height-.5,t.beginPath(),t.moveTo(i,r-5),t.lineTo(i+3,r),t.lineTo(i-3,r),t.fillStyle="black",t.strokeStyle="white",t.closePath(),t.fill(),t.stroke()}};m(ir,"ColorEditorSroll");var Xs=ir;Xs.scrollHeight=26*S.guiDPIFactor;var Zs=class Zs{setTabIndex(e){return this._colorDiv.tabIndex=e++,e}static checkerboardImage(e,t){let i=e>>1,r=t>>1;return'<svg xmlns="http://www.w3.org/2000/svg"   viewbox="0 0 '+e+" "+t+'" width="'+e+'px"  height="'+t+'px" ><rect x="0" y="0" width="'+e+'" height="'+t+'" style="fill:white"/><rect x="0" y="0" width="'+i+'" height="'+r+'" style="fill:black"/><rect x="'+i+'" y="'+r+'" width="'+i+'" height="'+r+'" style="fill:black"/></svg>'}constructor(e,t){this._containerDiv=e,this._selectCallback=t,this._containerDiv.style.border="1px solid grey",this._containerDiv.style.background="url('data:image/svg+xml;utf8,"+Zs.checkerboardImage(100,100)+"')",this._containerDiv.style.backgroundSize="cover",this._containerDiv.style.backgroundPosition="center",this._containerDiv.style.backgroundRepeat="no-repeat",this._color=c.Transparent,this._colorDiv=document.createElement("DIV"),this._colorDiv.style.display="display-block",this._colorDiv.style.position="relative",this._colorDiv.style.width="100%",this._colorDiv.style.height="100%",this._colorDiv.style.backgroundColor="rgba(0,0,0,0)",this._containerDiv.appendChild(this._colorDiv),this._selectCallback!=null&&(this._colorDiv.addEventListener("click",()=>{this._selectCallback(this.color)}),this._colorDiv.addEventListener("keyup",i=>{(i.key==="Enter"||i.key===" ")&&this._selectCallback(this.color)}),this._colorDiv.style.cursor="pointer")}set color(e){this._color=e.clone(),this._colorDiv.style.backgroundColor=this._color.htmlCode}get color(){return this._color.clone()}};m(Zs,"ColorSampler");var Xi=Zs,dt=class dt{static AddColorToHistory(e){for(let t=0;t<dt._colorHistory.length;t++)if(e.equal(dt._colorHistory[t]))return;dt._colorHistory.splice(dt._colorHistory.length-1,1),dt._colorHistory.splice(0,0,e);for(let t=dt._editorsList.length-1;t>=0;t--)dt._editorsList[t].refreshColorHistory()}static get colorHistory(){return dt._colorHistory}get activeBorderColor(){return"#767676"}get inactiveBorderColor(){return"#b0b0b0"}get activeColor(){return"black"}get inactiveColor(){return"grey"}get activeBackgroundColor(){return"white"}get inactiveBackgroundColor(){return"#f8f8f8"}tabSelected(e){e==this._tabRGB?(this._tabRGB.active=!0,this._rgb_R_editor.refresh(),this._rgb_G_editor.refresh(),this._rgb_B_editor.refresh(),this._rgb_T_editor.refresh()):this._tabRGB.active=!1,e==this._tabHSL?(this._tabHSL.active=!0,this._hsl_H_editor.refresh(),this._hsl_S_editor.refresh(),this._hsl_L_editor.refresh(),this._hsl_T_editor.refresh()):this._tabHSL.active=!1,this._tabPredef.active=e==this._tabPredef}HueScrollBg(){let e=100,t=50,i=this._hsl_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="hsl("+(360*s/256).toString()+","+e.toString()+"%,"+t.toString()+"%)";return r}SaturationScrollBg(){let e=360*this._hsl_H_editor.value/256,t=100*this._hsl_L_editor.value/255,i=this._hsl_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="hsl("+e.toString()+","+(100*s/255).toString()+"%,"+t.toString()+"%)";return r}LuminosityScrollBg(){let e=360*this._hsl_H_editor.value/256,t=100*this._hsl_S_editor.value/255,i=this._hsl_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="hsl("+e.toString()+","+t.toString()+"%,"+(100*s/255).toString()+"%)";return r}HSLTranspScrollBg(){let e=360*this._hsl_H_editor.value/256,t=100*this._hsl_S_editor.value/255,i=100*this._hsl_L_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="hsla("+e.toString()+","+i.toString()+"%,"+t.toString()+"%,"+(s/255).toString()+")";return r}RedScrollBg(){let e=this._rgb_G_editor.value,t=this._rgb_B_editor.value,i=this._rgb_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="rgb("+s.toString()+","+e.toString()+","+t.toString()+")";return r}GreenScrollBg(){let e=this._rgb_R_editor.value,t=this._rgb_B_editor.value,i=this._rgb_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="rgb("+e.toString()+","+s.toString()+","+t.toString()+")";return r}BlueScrollBg(){let e=this._rgb_R_editor.value,t=this._rgb_G_editor.value,i=this._rgb_T_editor.value/255,r=new Array(256);for(let s=0;s<256;s++)r[s]="rgb("+e.toString()+","+t.toString()+","+s.toString()+")";return r}RGBTranspScrollBg(){let e=this._rgb_R_editor.value,t=this._rgb_G_editor.value,i=this._rgb_B_editor.value,r=new Array(256);for(let s=0;s<256;s++)r[s]="rgba("+e.toString()+","+t.toString()+","+i.toString()+","+(s/255).toString()+")";return r}static defaultColorHistory(){let e=[];return e.push(c.FromAhsl(100,0,0,0)),e.push(c.FromAhsl(100,0,0,51)),e.push(c.FromAhsl(100,0,0,102)),e.push(c.FromAhsl(100,0,0,153)),e.push(c.FromAhsl(100,0,0,204)),e.push(c.FromAhsl(100,0,0,255)),e.push(c.FromAhsl(100,0,255,127)),e.push(c.FromAhsl(100,42,255,127)),e.push(c.FromAhsl(100,85,255,127)),e.push(c.FromAhsl(100,96,255,127)),e.push(c.FromAhsl(100,127,255,127)),e.push(c.FromAhsl(100,170,255,127)),e.push(c.FromAhsl(100,192,255,127)),e.push(c.FromAhsl(100,212,255,127)),e.push(c.FromAhsl(255,226,217,214)),e}destroy(){for(let e=dt._editorsList.length-1;e>=0;e--)dt._editorsList[e]==this&&dt._editorsList.splice(e,1)}refreshColorHistory(){for(let e=0;e<this._samples.length;e++)e<dt._colorHistory.length&&(this._samples[e].color=dt._colorHistory[e].clone())}constructor(e,t,i,r){this._firstTabIndex=0,this._memorizeTimer=null,dt._editorsList.push(this),this._colorChangeCallback=r,this._container=e,this._table=document.createElement("TABLE"),this._table.style.width="100%",this._table.style.borderSpacing="0",this._table.style.paddingLeft="5px",this._table.style.paddingTop="5px",this._table.style.paddingRight="5px",this._table.style.borderCollapse="separate",this._tr1=document.createElement("TR"),this._tr2=document.createElement("TR"),this._tabRGB=new Tr(this,"RGB",t),this._tabHSL=new Tr(this,"HSL",t),this._tabPredef=new Tr(this,"Predefined",t),this._tabStub=new Tr(this,"",t),this._contents=document.createElement("TD"),this._contents.colSpan=4,this._contents.style.borderLeft="1px solid "+this.activeBorderColor,this._contents.style.borderRight="1px solid "+this.activeBorderColor,this._contents.style.borderBottom="1px solid "+this.activeBorderColor,this._contents.style.backgroundColor=this.activeBackgroundColor,this._tr1.appendChild(this._tabRGB.tabElement),this._tr1.appendChild(this._tabHSL.tabElement),this._tr1.appendChild(this._tabPredef.tabElement),this._tr1.appendChild(this._tabStub.tabElement),this._tr2.appendChild(this._contents),this._table.appendChild(this._tr1),this._table.appendChild(this._tr2),this._contents.appendChild(this._tabRGB.divElement),this._contents.appendChild(this._tabHSL.divElement),this._contents.appendChild(this._tabPredef.divElement);let s=document.createElement("TABLE");s.style.width="100%",s.style.borderSpacing="1",this._tabRGB.divElement.appendChild(s);let n=document.createElement("TABLE");n.style.width="100%",n.style.borderSpacing="1",this._tabHSL.divElement.appendChild(n);let o=document.createElement("TABLE");this._tabPredef.divElement.appendChild(o),o.style.width="100%",o.style.borderSpacing="1",o.style.tableLayout="fixed",this._container.appendChild(this._table),this._rgb_R_editor=this.AddColorScroll(s,"R",()=>this.RedScrollBg(),T=>{this.RgbColorChangeCallBack(T)},!1,1),this._rgb_G_editor=this.AddColorScroll(s,"G",()=>this.GreenScrollBg(),T=>{this.RgbColorChangeCallBack(T)},!1,2),this._rgb_B_editor=this.AddColorScroll(s,"B",()=>this.BlueScrollBg(),T=>{this.RgbColorChangeCallBack(T)},!1,3),this._rgb_T_editor=this.AddColorScroll(s,"T",()=>this.RGBTranspScrollBg(),T=>{this.RgbColorChangeCallBack(T)},!0,3),this._rgb_R_editor.value=i.red,this._rgb_G_editor.value=i.green,this._rgb_B_editor.value=i.blue,this._rgb_T_editor.value=i.alpha,this._rgb_R_editor.refresh(),this._rgb_G_editor.refresh(),this._rgb_B_editor.refresh(),this._rgb_T_editor.refresh(),this._hsl_H_editor=this.AddColorScroll(n,"H",()=>this.HueScrollBg(),T=>{this.HslColorChangeCallBack(T)},!1,1),this._hsl_S_editor=this.AddColorScroll(n,"S",()=>this.SaturationScrollBg(),T=>{this.HslColorChangeCallBack(T)},!1,2),this._hsl_L_editor=this.AddColorScroll(n,"L",()=>this.LuminosityScrollBg(),T=>{this.HslColorChangeCallBack(T)},!1,3),this._hsl_T_editor=this.AddColorScroll(n,"T",()=>this.HSLTranspScrollBg(),T=>{this.HslColorChangeCallBack(T)},!0,3),this._hsl_H_editor.value=i.hue,this._hsl_S_editor.value=i.saturation,this._hsl_L_editor.value=i.luminosity,this._hsl_T_editor.value=i.alpha,this._hsl_H_editor.refresh(),this._hsl_S_editor.refresh(),this._hsl_L_editor.refresh(),this._hsl_T_editor.refresh();let a=document.createElement("TABLE");a.style.position="relative",a.style.width="100%",a.style.paddingLeft="3px",a.style.paddingRight="3px",a.style.paddingTop="10px",a.style.bottom="3px",a.style.tableLayout="fixed";let l=[],h=null,u=30,_=document.createElement("TR");_.style.height=u.toString()+"px";for(let T=0;T<6;T++){let R=document.createElement("TD");T==5?(R.colSpan=2,R.rowSpan=3,h=R):l.push(R),_.appendChild(R)}a.appendChild(_);let d=document.createElement("TR");d.style.height=u.toString()+"px";for(let T=0;T<5;T++){let R=document.createElement("TD");l.push(R),d.appendChild(R)}a.appendChild(d);let g=document.createElement("TR");g.style.height=u.toString()+"px";for(let T=0;T<5;T++){let R=document.createElement("TD");l.push(R),g.appendChild(R)}a.appendChild(g),this._container.appendChild(a),this._samples=[];for(let T=0;T<l.length;T++){let R=document.createElement("DIV");R.style.position="relative",R.style.width="100%",R.style.height=(u-4).toString()+"px",R.style.display="inline-block",R.title="Color history",l[T].appendChild(R);let P=new Xi(R,I=>{this.sampleWasSelectedCallback(I)});P.color=dt._colorHistory[T],this._samples.push(P)}let y=c.predefinedColors,p=[],x=Object.keys(y);for(let T=0;T<x.length;T++)p.push(y[x[T]]);p.sort((T,R)=>T.alpha<R.alpha?1:T.alpha>R.alpha?-1:T.luminosity<R.luminosity?1:T.luminosity>R.luminosity?-1:T.saturation<R.saturation?1:T.saturation>R.saturation?-1:T.hue<R.hue?1:T.hue>R.hue?-1:0);let w=null;this._prefedDivs=[];for(let T=0;T<p.length;T++){let R=p[T];T%16==0&&(w=document.createElement("TR"),o.appendChild(w));let P=document.createElement("TD");w.appendChild(P);let I=document.createElement("DIV");this._prefedDivs.push(I),I.style.position="relative",I.style.width="100%",I.style.height=Math.round(10*S.guiDPIFactor).toString()+"px",I.style.display="inline-block",I.title=R.name,P.appendChild(I);let F=new Xi(I,z=>{this.sampleWasSelectedCallback(z)});F.color=R}let f=document.createElement("DIV");f.style.position="relative",f.style.width="100%",f.style.height=(3*u).toString()+"px",f.style.display="inline-block",f.title="Color preview",h.appendChild(f),this._preview=new Xi(f,null),this._preview.color=i,this.selectApropriateTab(i)}selectApropriateTab(e){e.isPredefined?(this._tabPredef.active=!0,this.tabSelected(this._tabPredef)):(this._tabPredef.active=!1,e.isRGB?(this._tabRGB.active=!0,this._tabHSL.active=!1,this.tabSelected(this._tabRGB)):(this._tabRGB.active=!1,this._tabHSL.active=!0,this.tabSelected(this._tabHSL)))}sampleWasSelectedCallback(e){this._rgb_R_editor.value=e.red,this._rgb_G_editor.value=e.green,this._rgb_B_editor.value=e.blue,this._rgb_T_editor.value=e.alpha,this._hsl_H_editor.value=e.hue,this._hsl_S_editor.value=e.saturation,this._hsl_L_editor.value=e.luminosity,this._hsl_T_editor.value=e.alpha,this._preview.color=e,this._rgb_R_editor.refresh(),this._rgb_G_editor.refresh(),this._rgb_B_editor.refresh(),this._rgb_T_editor.refresh(),this._hsl_H_editor.refresh(),this._hsl_S_editor.refresh(),this._hsl_L_editor.refresh(),this._hsl_T_editor.refresh(),this.initColorMemorization(e),this._colorChangeCallback!=null&&this._colorChangeCallback(e)}initColorMemorization(e){this._memorizeTimer!=null&&clearTimeout(this._memorizeTimer),this._memorizeTimer=setTimeout(()=>{this._memorizeTimer=null,dt.AddColorToHistory(e)},2e3)}RgbColorChangeCallBack(e){e!=this._rgb_R_editor&&this._rgb_R_editor.refresh(),e!=this._rgb_G_editor&&this._rgb_G_editor.refresh(),e!=this._rgb_B_editor&&this._rgb_B_editor.refresh(),e!=this._rgb_T_editor&&this._rgb_T_editor.refresh();let t=c.FromArgb(this._rgb_T_editor.value,this._rgb_R_editor.value,this._rgb_G_editor.value,this._rgb_B_editor.value);this._preview.color=t,this.initColorMemorization(t),this._colorChangeCallback!=null&&this._colorChangeCallback(t)}HslColorChangeCallBack(e){e!=this._hsl_H_editor&&this._hsl_H_editor.refresh(),e!=this._hsl_S_editor&&this._hsl_S_editor.refresh(),e!=this._hsl_L_editor&&this._hsl_L_editor.refresh(),e!=this._hsl_T_editor&&this._hsl_T_editor.refresh();let t=c.FromAhsl(this._hsl_T_editor.value,this._hsl_H_editor.value,this._hsl_S_editor.value,this._hsl_L_editor.value);this._preview.color=t,this.initColorMemorization(t),this._colorChangeCallback!=null&&this._colorChangeCallback(t)}set color(e){this._preview.color=e,this._hsl_H_editor.value=e.hue,this._hsl_S_editor.value=e.saturation,this._hsl_L_editor.value=e.luminosity,this._hsl_T_editor.value=e.alpha,this._rgb_R_editor.value=e.red,this._rgb_G_editor.value=e.green,this._rgb_B_editor.value=e.blue,this._rgb_T_editor.value=e.alpha,this._hsl_H_editor.refresh(),this._hsl_S_editor.refresh(),this._hsl_L_editor.refresh(),this._hsl_T_editor.refresh(),this._rgb_R_editor.refresh(),this._rgb_G_editor.refresh(),this._rgb_B_editor.refresh(),this._rgb_T_editor.refresh(),this.selectApropriateTab(e)}AddColorScroll(e,t,i,r,s,n){let o=document.createElement("TR"),a=document.createElement("TD");a.innerHTML="&nbsp;"+t+"&nbsp;";let l=document.createElement("TD"),h=document.createElement("ANCHOR");l.appendChild(h);let u=document.createElement("DIV");l.style.width="100%",h.appendChild(u);let _=document.createElement("TD"),d=document.createElement("INPUT");return _.appendChild(d),o.appendChild(a),o.appendChild(l),o.appendChild(_),e.appendChild(o),new Xs(u,h,d,i,r,s,n)}setTabIndex(e){if(this._firstTabIndex=e,e=this._tabRGB.setTabIndex(e),e=this._tabHSL.setTabIndex(e),e=this._tabPredef.setTabIndex(e),this._tabRGB.active)e=this._rgb_R_editor.setTabIndex(e),e=this._rgb_G_editor.setTabIndex(e),e=this._rgb_B_editor.setTabIndex(e),e=this._rgb_T_editor.setTabIndex(e);else if(this._tabHSL.active)e=this._hsl_H_editor.setTabIndex(e),e=this._hsl_S_editor.setTabIndex(e),e=this._hsl_L_editor.setTabIndex(e),e=this._hsl_T_editor.setTabIndex(e);else for(let t=0;t<this._prefedDivs.length;t++)this._prefedDivs[t].tabIndex=e++;for(let t=0;t<this._samples.length;t++)e=this._samples[t].setTabIndex(e);return e}};m(dt,"colorEditor");var ni=dt;ni._colorHistory=ni.defaultColorHistory();ni._editorsList=[];var bl=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},zo=class zo{constructor(e,t,i,r){if(this._realTab=!1,this._div=null,this._tabLabel=null,this._td=document.createElement("TD"),t!=""){this._div=document.createElement("DIV"),this._div.style.display="none";let s=Math.round(5*r).toString()+"px";this._div.style.padding=s+" "+s+" "+s+" "+s,this._td.style.paddingTop=Math.round(4*r).toString()+"px",this._td.style.fontSize=i.toString()+"px",this._td.style.paddingBottom=Math.round(2*r).toString()+"px",this._td.tabIndex=0,this._td.style.borderLeft="1px solid "+ye.inactiveBorderColor,this._td.style.borderRight="1px solid "+ye.inactiveBorderColor,this._td.style.borderTop="1px solid "+ye.inactiveBorderColor,this._td.style.borderBottom="1px solid "+ye.activeBorderColor,this._td.style.color=ye.inactiveColor,this._td.style.backgroundColor=ye.inactiveBackgroundColor,this._td.style.borderTopLeftRadius=Math.round(3*r).toString()+"px",this._td.style.borderTopRightRadius=Math.round(3*r).toString()+"px",this._td.style.paddingLeft="5px",this._td.style.paddingRight="5px",this._realTab=!0,this._tabLabel=document.createElement("ANCHOR"),this._tabLabel.innerText=t,this._tabLabel.addEventListener("click",()=>{ye.tabSelected(this)}),this._tabLabel.addEventListener("keyup",n=>{(n.key==="Enter"||n.key===" ")&&ye.tabSelected(this)}),this._tabLabel.style.cursor="pointer",this._td.appendChild(this._tabLabel)}else this._td.style.borderBottom="1px solid "+ye.activeBorderColor,this._td.innerHTML="<span>&nbsp;</span>"}setTabIndex(e){return this._tabLabel.tabIndex=e++,e}set active(e){this._realTab&&(this._td.style.borderLeftColor=e?ye.activeBorderColor:ye.inactiveBorderColor,this._td.style.borderTopColor=e?ye.activeBorderColor:ye.inactiveBorderColor,this._td.style.borderRightColor=e?ye.activeBorderColor:ye.inactiveBorderColor,this._td.style.borderBottomColor=e?"rgba(0, 0, 0, 0)":ye.activeBorderColor,this._td.style.color=e?ye.activeColor:ye.inactiveColor,this._td.style.backgroundColor=e?ye.activeBackgroundColor:ye.inactiveBackgroundColor,this._div.style.display=e?"":"none")}get tabElement(){return this._td}get divElement(){return this._div}};m(zo,"configEditorTab");var Zi=zo,b=class b{static get activeBorderColor(){return S.WindowInnerBorderColor}static get inactiveBorderColor(){return"#b0b0b0"}static get activeColor(){return"black"}static get inactiveColor(){return"grey"}static get activeBackgroundColor(){return S.WindowInnerBackgroundColor}static get inactiveBackgroundColor(){return S.WindowBackgroundColor}static hubStateChanged(e){return bl(this,void 0,void 0,function*(){if(b._Hubtable==null)return;let t=e.removable?"":" (server)";for(let i=1;i<b._Hubtable.childElementCount;i++)if(b._Hubtable.childNodes[i].YHUB==e)switch(b._Hubtable.childNodes[i].childNodes[2].innerText=(yield e.ConnectionDescription())+t,yield e.ConnectionState()){case 2:b._Hubtable.childNodes[i].childNodes[0].innerHTML=J.OkIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ");break;case 3:b._Hubtable.childNodes[i].childNodes[0].innerHTML=J.FailedIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ");break;default:b._Hubtable.childNodes[i].childNodes[0].innerHTML=J.DontKnowIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ");break}})}static RefreshUI(e){for(let t=1;t<b._Hubtable.childElementCount;t++)b._Hubtable.childNodes[t].YHUB==e&&(b._Hubtable.childNodes[t].childNodes[1].innerText=e.toString(),b._Hubtable.childNodes[t].childNodes[2].innerText="...")}static HublineSelected(e){b._selectedHub=null;for(let t=1;t<b._Hubtable.childElementCount;t++)b._Hubtable.childNodes[t]==e?(b._selectedHub=b._Hubtable.childNodes[t].YHUB,b._Hubtable.childNodes[t].style.backgroundColor="#2fa5ff",b._Hubtable.childNodes[t].childNodes[0].style.color="white",b._Hubtable.childNodes[t].childNodes[1].style.color="white",b._Hubtable.childNodes[t].childNodes[2].style.color="white"):(b._Hubtable.childNodes[t].style.backgroundColor="white",b._Hubtable.childNodes[t].childNodes[0].style.color="black",b._Hubtable.childNodes[t].childNodes[1].style.color="black",b._Hubtable.childNodes[t].childNodes[2].style.color="black");b._editButton.enabled=b._selectedHub!=null,b._deleteButton.enabled=b._selectedHub!=null,this._editButton.showShortcut(b._selectedHub!=null),this._deleteButton.showShortcut(b._selectedHub!=null)}static newHub(){ui.newHub(()=>{b._window.show()})}static AddHubToUI(e){return bl(this,void 0,void 0,function*(){let t=document.createElement("TR");t.style.fontSize=b.fontSize.toString()+"px",t.YHUB=e,t.style.backgroundColor="white",t.style.cursor="pointer",t.tabIndex=0,t.addEventListener("keypress",r=>{switch(r.key.toUpperCase()){case"D":this._deleteButton.performAction();break;case"E":this._editButton.performAction();break}}),t.style.outline="none",t.addEventListener("click",()=>{b.HublineSelected(t)}),t.addEventListener("focusin",()=>{b.HublineSelected(t)});let i=document.createElement("TD");switch(yield e.ConnectionState()){case 2:i.innerHTML=J.OkIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ");break;case 3:i.innerHTML=J.FailedIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ");break;case 1:default:i.innerHTML=J.DontKnowIcon((1.2*b.fontSize).toString(),!0,!1,!1,!1," ")}i.style.width=(2*b.fontSize).toString()+"px",i.style.verticalAlign="center",i.style.borderBottom="1px solid "+b.inactiveBorderColor,i.style.paddingLeft="5px",t.appendChild(i),i=document.createElement("TD"),i.innerText=e.toString(),i.style.borderBottom="1px solid "+b.inactiveBorderColor,i.style.verticalAlign="center",i.style.height=(2*b.fontSize).toString()+"px",t.appendChild(i),i=document.createElement("TD"),i.style.verticalAlign="center",i.style.whiteSpace="nowrap",i.innerText=(yield e.ConnectionDescription())+(e.removable?"":" (server)"),i.style.borderBottom="1px solid "+b.inactiveBorderColor,t.appendChild(i),b._Hubtable.appendChild(t)})}static editSelectedHub(){b._selectedHub!=null&&ui.editHub(b._selectedHub,()=>{b._window.show()})}static deleteSelectedHub(){if(b._selectedHub==null)return;let e=b._selectedHub.removable?"":`

This one is also the one serving the Yocto-Visualization software. If you remove it, you won't be able to save later on.`;pi.ask("Do you really want to remove connection "+b._selectedHub.toString()+" ?"+e,()=>{if(b._selectedHub!=null){b._selectedHub.Disconnect().then(t=>{});for(let t=b._Hubtable.childElementCount-1;t>0;t--)b._Hubtable.childNodes[t].YHUB==b._selectedHub&&b._Hubtable.removeChild(b._Hubtable.childNodes[t]);oe.hubWasremoved(b._selectedHub),b._selectedHub=null,b._editButton.enabled=!1,b._deleteButton.enabled=!1,S.edited=!0}},null,null)}static hide(){b._window!=null&&(b._window.visible=!1)}static show(){if(b._window==null){b.GUIcoef=S.generalSizeCoef,b.REFWIDH*b.GUIcoef>screen.width&&(b.GUIcoef=screen.width/b.REFWIDH),b.REFHEIGHT*b.GUIcoef>screen.height&&(b.GUIcoef=screen.height/b.REFHEIGHT),b.fontSize*=b.GUIcoef/S.generalSizeCoef;let e=new ut(b.GUIcoef);e.positionType=1,e.width=Math.round(b.REFWIDH*this.GUIcoef),e.height=Math.round(b.REFHEIGHT*this.GUIcoef),e.showContainerBorders=!1,e.title="Global configuration",b._window=new nt(e),b._contents=b._window.innerContentDiv,b._table=document.createElement("TABLE"),b._contents.appendChild(b._table),b._table.style.position="absolute",b._table.style.left="0px",b._table.style.right="0px",b._table.style.width="100%",b._table.style.height="100%",b._table.style.borderSpacing="0",b._table.style.paddingLeft=(5*this.GUIcoef).toString()+"px",b._table.style.paddingTop=(5*this.GUIcoef).toString()+"px",b._table.style.paddingRight=(5*this.GUIcoef).toString()+"px",b._table.style.borderCollapse="separate",b._tr1=document.createElement("TR"),b._tr2=document.createElement("TR"),b._tr1.style.height=(2*b.fontSize).toString()+"px",b._tabNetwork=new Zi(b,"Network",b.fontSize,b.GUIcoef),b._tabCapture=new Zi(b,"Screen capture",b.fontSize,b.GUIcoef),b._tabResources=new Zi(b,"Ressources",b.fontSize,b.GUIcoef),b._tabUI=new Zi(b,"User interface",b.fontSize,b.GUIcoef),b._tabExport=new Zi(b,"Updates & XML",b.fontSize,b.GUIcoef),b._tabStub=new Zi(b,"",b.fontSize,b.GUIcoef),this._tabPanelContents=document.createElement("TD"),this._tabPanelContents.colSpan=6,this._tabPanelContents.style.borderLeft="1px solid "+this.activeBorderColor,this._tabPanelContents.style.borderRight="1px solid "+this.activeBorderColor,this._tabPanelContents.style.borderBottom="1px solid "+this.activeBorderColor,this._tabPanelContents.style.backgroundColor=this.activeBackgroundColor,b._tr1.appendChild(this._tabNetwork.tabElement),b._tr1.appendChild(this._tabCapture.tabElement),b._tr1.appendChild(this._tabResources.tabElement),b._tr1.appendChild(this._tabUI.tabElement),b._tr1.appendChild(this._tabExport.tabElement),b._tr1.appendChild(this._tabStub.tabElement),b._tr2.appendChild(this._tabPanelContents),b._tr2.childNodes[0].style.verticalAlign="top",b._table.appendChild(this._tr1),b._table.appendChild(this._tr2);let t=document.createElement("P");t.style.textAlign="justify",t.style.fontSize=b.fontSize.toString()+"px",t.style.paddingTop="0px",t.style.marginTop=Math.round(3*this.GUIcoef).toString()+"px",t.innerText="Enter the list of VirtualHub or YoctoHub this page can connect to",this._tabNetwork.divElement.appendChild(t),b._Hubtable=document.createElement("TABLE"),b._Hubtable.style.position="absolute",b._Hubtable.style.display="block",b._Hubtable.style.left=Math.round(20*this.GUIcoef).toString()+"px",b._Hubtable.style.right=Math.round(20*this.GUIcoef).toString()+"px",b._Hubtable.style.tableLayout="auto",b._Hubtable.style.top=Math.round(80*this.GUIcoef).toString()+"px",b._Hubtable.style.bottom=Math.round(40*this.GUIcoef).toString()+"px",b._Hubtable.style.borderCollapse="colapse",b._Hubtable.style.borderSpacing="0px",b._Hubtable.style.border="1px solid "+b.activeBorderColor;let i=document.createElement("TR");i.style.fontSize=b.fontSize.toString()+"px";let r=document.createElement("TH");r.colSpan=2,r.innerText="Address",r.style.borderBottom="1px solid "+b.activeBorderColor,r.style.width=Math.round(400*this.GUIcoef).toString()+"px",i.appendChild(r),r=document.createElement("TH"),r.innerText="Status",r.style.width="40%",r.style.borderBottom="1px solid "+b.activeBorderColor,r.style.borderLeft="1px solid "+b.activeBorderColor,i.appendChild(r),b._Hubtable.appendChild(i);let s=oe.hubList;for(let z=0;z<s.length;z++)b.AddHubToUI(s[z]);let n=document.createElement("DIV");n.style.position="absolute",n.style.bottom="0px",n.style.right=Math.round(20*b.GUIcoef).toString()+"px",n.style.height=Math.round(30*b.GUIcoef).toString()+"px",n.style.textAlign="right",n.style.verticalAlign="center",b._newButton=new ft("New",()=>{b._window.hide(),b.newHub()},b.GUIcoef),n.appendChild(b._newButton.Element),b._editButton=new ft("Edit",()=>{b._window.hide(),b.editSelectedHub()},b.GUIcoef),b._editButton.enabled=!1,n.appendChild(b._editButton.Element),b._deleteButton=new ft("Delete",()=>{b.deleteSelectedHub()},b.GUIcoef),b._deleteButton.enabled=!1,n.appendChild(b._deleteButton.Element),this._tabNetwork.divElement.appendChild(n),this._tabNetwork.divElement.appendChild(b._Hubtable),t=document.createElement("P"),t.innerHTML="Widgets content can be captured at anytime thought the <i>Snapshop</i> option available in right-click contextual menu",t.style.textAlign="justify",t.style.fontSize=b.fontSize.toString()+"px",this._tabCapture.divElement.appendChild(t);let o=document.createElement("TABLE");o.style.fontSize=b.fontSize.toString()+"px";let a=document.createElement("TR"),l=document.createElement("TD");l.style.fontSize=b.fontSize.toString()+"px",l.innerText="ImageType",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.style.verticalAlign="center",b.inputPNG=document.createElement("INPUT"),b.inputSVG=document.createElement("INPUT"),b.inputPNG.checked=S.captureType==W.CaptureType.PNG,b.inputPNG.style.display="inline",b.inputPNG.type="checkbox",b.inputPNG.style.transform="scale("+this.GUIcoef.toString()+")",b.inputPNG.style.marginRight=Math.round(5*this.GUIcoef).toString()+"px",b.inputPNG.style.marginLeft=Math.round(5*this.GUIcoef).toString()+"px",b.inputPNG.addEventListener("change",()=>{b.captureFormatChange(b.inputPNG)}),l.append(b.inputPNG);let h;h=document.createElement("SPAN"),h.innerText=W.CaptureType.PNG.description,l.append(h),b.inputSVG=document.createElement("INPUT"),b.inputSVG.checked=S.captureType==W.CaptureType.SVG,b.inputSVG.style.display="inline",b.inputSVG.type="checkbox",b.inputSVG.style.transform="scale("+this.GUIcoef.toString()+")",b.inputSVG.style.marginRight=Math.round(5*this.GUIcoef).toString()+"px",b.inputSVG.style.marginLeft=Math.round(5*this.GUIcoef).toString()+"px",b.inputSVG.addEventListener("change",()=>{b.captureFormatChange(b.inputSVG)}),l.append(b.inputSVG),h=document.createElement("SPAN"),h.innerText=W.CaptureType.SVG.description,l.append(h),a.appendChild(l),o.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="Resolution:",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",b.inputResolution=document.createElement("INPUT"),b.inputResolution.style.fontFamily=S.generalFontFamily,b.inputResolution.style.fontSize=S.generalFontSize.toString()+"px",b.inputResolution.style.border="1px solid grey",b.inputResolution.type="number",b.inputResolution.style.textAlign="right",b.inputResolution.style.marginRight="5px",b.inputResolution.style.width="60px",b.inputResolution.value=S.captureDPI.toString(),b.inputResolution.style.display="inline",new wt(b.inputResolution,6,!1,Number.NaN,Number.NaN,(z,U)=>{b.captureDPIChange(b.inputResolution)}),l.append(b.inputResolution),h=document.createElement("SPAN"),h.innerText="DPI",l.append(h),a.appendChild(l),o.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="Size:",l.style.verticalAlign="top",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",b.inputSizeSelect=document.createElement("SELECT"),b.inputSizeSelect.style.border="1px solid grey",b.inputSizeSelect.style.fontFamily=S.generalFontFamily,b.inputSizeSelect.style.fontSize=S.generalFontSize.toString()+"px";let u=W.CaptureFormats.Keep.sibblings;for(let z=0;z<u.length;z++){let U=document.createElement("OPTION");U.text=u[z].description,U.value=u[z].toString,b.inputSizeSelect.add(U,null)}b.inputSizeSelect.value=S.captureSizePolicy.toString,b.inputSizeSelect.addEventListener("change",()=>{b.captureSizeSelectChange(b.inputSizeSelect)}),l.append(b.inputSizeSelect),a.appendChild(l),o.appendChild(a);let _=document.createElement("TABLE");b.captureWidthTR=document.createElement("TR");let d=document.createElement("TD");d.style.fontSize=b.fontSize.toString()+"px",d.innerText="Width:",b.captureWidthTR.appendChild(d),d=document.createElement("TD"),d.style.fontSize=b.fontSize.toString()+"px",b.inputCaptureWidth=document.createElement("INPUT"),b.inputCaptureWidth.style.border="1px solid grey",b.inputCaptureWidth.style.fontFamily=S.generalFontFamily,b.inputCaptureWidth.style.fontSize=S.generalFontSize.toString()+"px",b.inputCaptureWidth.type="number",b.inputCaptureWidth.style.textAlign="right",b.inputCaptureWidth.style.marginRight="5px",b.inputCaptureWidth.style.width="60px",b.inputCaptureWidth.value=S.captureWidth.toString(),b.inputCaptureWidth.style.display="inline",new wt(b.inputCaptureWidth,3,!1,Number.NaN,Number.NaN,(z,U)=>{b.captureWidthChange(b.inputCaptureWidth)}),d.append(b.inputCaptureWidth),b.inputCaptureWidthInfo=document.createElement("SPAN"),b.inputCaptureWidthInfo.innerText="pixels",d.append(b.inputCaptureWidthInfo),b.captureWidthTR.appendChild(d),_.appendChild(b.captureWidthTR),b.captureHeightTR=document.createElement("TR"),d=document.createElement("TD"),d.style.fontSize=b.fontSize.toString()+"px",d.innerText="Height:",b.captureHeightTR.appendChild(d),d=document.createElement("TD"),d.style.fontSize=b.fontSize.toString()+"px",b.inputCaptureHeight=document.createElement("INPUT"),b.inputCaptureHeight.style.border="1px solid grey",b.inputCaptureHeight.style.fontFamily=S.generalFontFamily,b.inputCaptureHeight.style.fontSize=S.generalFontSize.toString()+"px",b.inputCaptureHeight.type="number",b.inputCaptureHeight.style.textAlign="right",b.inputCaptureHeight.style.marginRight="5px",b.inputCaptureHeight.style.width="60px",b.inputCaptureHeight.value=S.captureHeight.toString(),b.inputCaptureHeight.style.display="inline",new wt(b.inputCaptureHeight,3,!1,Number.NaN,Number.NaN,(z,U)=>{b.captureHeightChange(b.inputCaptureHeight)}),d.append(b.inputCaptureHeight),b.inputCaptureHeightInfo=document.createElement("SPAN"),b.inputCaptureHeightInfo.innerText="pixels",d.append(b.inputCaptureHeightInfo),b.captureHeightTR.appendChild(d),_.appendChild(b.captureHeightTR),l.appendChild(_),b._tabCapture.divElement.appendChild(o);let g=document.createElement("TABLE");a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="If you plan to use YoctoVisualization continuously for an extended period of time (i.e. several weeks),  or if you are running it on a computer with limited resources, you may want to limit the application memory consumption.",l.colSpan=2,l.style.textAlign="justify",a.appendChild(l),g.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="Max count of sensors data records:",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px";let y=document.createElement("INPUT");y.style.border="1px solid grey",y.style.fontFamily=S.generalFontFamily,y.style.fontSize=S.generalFontSize.toString()+"px",y.type="number",y.style.textAlign="right",y.style.marginRight="5px",y.style.marginLeft="5px",y.style.width="60px",y.value=S.maxDataRecordsPerSensor.toString(),y.style.display="inline",new wt(y,2,!1,Number.NaN,Number.NaN,(z,U)=>{b.maxSensorRecsChange(y)}),l.append(y),h=document.createElement("SPAN"),h.innerText="(0 = unlimited)",l.append(h),a.appendChild(l),g.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="Max count of graph series data points:",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px";let p=document.createElement("INPUT");p.style.border="1px solid grey",p.style.fontFamily=S.generalFontFamily,p.style.fontSize=S.generalFontSize.toString()+"px",p.type="number",p.style.textAlign="right",p.style.marginRight="5px",p.style.marginLeft="5px",p.style.width="60px",p.value=S.maxPointsPerGraphSerie.toString(),p.style.display="inline",new wt(p,2,!1,Number.NaN,Number.NaN,(z,U)=>{b.maxSeriesRecsChange(p)}),l.append(p),h=document.createElement("SPAN"),h.innerText="(0 = unlimited)",l.append(h),a.appendChild(l),g.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText=`
Yocto-Visualization automatically loads datalogger contents for all connected devices.  If you are using networked devices featuring  billable data transfers (GSM) you may want to limit or even disable that feature.`,l.colSpan=2,l.style.textAlign="justify",a.appendChild(l),g.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="Max data points/series loaded from dataloggers:",a.appendChild(l),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px";let x=document.createElement("INPUT");x.style.border="1px solid grey",x.style.fontFamily=S.generalFontFamily,x.style.fontSize=S.generalFontSize.toString()+"px",x.type="number",x.style.textAlign="right",x.style.marginRight="5px",x.style.marginLeft="5px",x.style.width="60px",x.value=S.maxPointsPerDataloggerSerie.toString(),x.style.display="inline",new wt(x,1,!1,-1,Number.NaN,(z,U)=>{b.maxDataLogRecsChange(x)}),l.append(x),h=document.createElement("SPAN"),h.innerText=`(0 = unlimited,
-1 = disabled)`,l.append(h),a.appendChild(l),g.appendChild(a),a=document.createElement("TR"),l=document.createElement("TD"),l.style.fontSize=b.fontSize.toString()+"px",l.innerText="After a  limit increase, you'll have to restart the application to get your old data back.",l.colSpan=2,l.style.textAlign="justify",a.appendChild(l),g.appendChild(a),b._tabResources.divElement.appendChild(g),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.innerText="You can alter user interface behavior according to your hardware capabilities.",this._tabUI.divElement.appendChild(t);let w=document.createElement("INPUT");w.style.fontFamily=S.generalFontFamily,w.style.fontSize=S.generalFontSize.toString()+"px",w.style.display="inline",w.type="checkbox",w.style.transform="scale("+this.GUIcoef.toString()+")",w.style.marginRight=Math.round(5*this.GUIcoef).toString()+"px",w.checked=S.dbleClickBringsUpContextMenu,w.addEventListener("change",()=>{b.dbleClickBringsUpContextMenuChange(w)}),this._tabUI.divElement.appendChild(w),h=document.createElement("SPAN"),h.style.fontSize=b.fontSize.toString()+"px",h.innerText=`Double click/tap  brings up context menu
`,this._tabUI.divElement.appendChild(h);let f=document.createElement("INPUT");f.style.display="inline",f.type="checkbox",f.style.transform="scale("+this.GUIcoef.toString()+")",f.style.marginRight=Math.round(5*this.GUIcoef).toString()+"px",f.checked=Rt.verticalDragZoomEnabled,f.addEventListener("change",()=>{b.verticalDragZoomChange(f)}),this._tabUI.divElement.appendChild(f),h=document.createElement("SPAN"),h.style.fontSize=b.fontSize.toString()+"px",h.innerText=`Graphs zoom can be driven by vertical drag
`,this._tabUI.divElement.appendChild(h),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.innerText="Yocto-Visualization tries to ajust UI size to screen resolution the best it can through a DPI based zoom factor. Unfortunately not all devices can properly report their screen resolution. That's why you can manually override that factor.",this._tabUI.divElement.appendChild(t);let T=document.createElement("INPUT"),R=document.createElement("INPUT");R.style.display="inline",R.type="checkbox",R.style.transform="scale("+this.GUIcoef.toString()+")",R.style.marginRight=Math.round(5*this.GUIcoef).toString()+"px",R.checked=S.guiDPIFactorIsOverriden,R.addEventListener("change",()=>{b.DPIoverrideChange(R,T)}),this._tabUI.divElement.appendChild(R),h=document.createElement("SPAN"),h.style.fontSize=b.fontSize.toString()+"px",h.innerText="Override zoom factor to ",this._tabUI.divElement.appendChild(h),T.style.border="1px solid grey",T.style.fontFamily=S.generalFontFamily,T.style.fontSize=S.generalFontSize.toString()+"px",T.disabled=!S.guiDPIFactorIsOverriden,T.type="number",T.style.textAlign="right",T.style.marginRight="5px",T.style.marginLeft="5px",T.style.width="60px",T.value=S.guiDPIFactorOverrideValue.toString(),T.style.display="inline",new wt(T,5,!1,Number.NaN,Number.NaN,(z,U)=>{b.DPIoverrideChange(R,T)}),this._tabUI.divElement.appendChild(T),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.innerText="This setting is stored in your browser cookies. So it is specific to this device, browser and server.You will have to reload this page for this setting to take effect",this._tabUI.divElement.appendChild(t),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.style.textAlign="justify",t.innerText="As long as your web browser can reach www.yoctopuce.com, the read/write edition of Yocto-Visualization (for web) can automatically check for new version. If you find this feature anoying, feel free to disable it. ",this._tabExport.divElement.appendChild(t);let P=document.createElement("INPUT");P.style.display="inline",P.type="checkbox",P.style.transform="scale("+this.GUIcoef.toString()+")",P.style.marginLeft=Math.round(25*this.GUIcoef).toString()+"px",P.checked=S.mustCheckForUpdate,P.addEventListener("change",()=>{b.mustCheckForUpdateChange(P)}),this._tabExport.divElement.appendChild(P),h=document.createElement("SPAN"),h.style.fontSize=b.fontSize.toString()+"px",h.innerText="Automatically check for updates";let I=document.createElement("A");I.innerText="Check now",I.style.paddingLeft="25px",I.style.cursor="pointer",I.style.color="#0000EE",I.style.textDecoration="underline",I.addEventListener("click",()=>{O.CheckForNewVersion(!0)}),h.appendChild(I),this._tabExport.divElement.appendChild(h),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.style.textAlign="justify",t.innerText="Yocto-Visualization (for web) stores its configuration in a XML file. This file can be used to create a static web page running Yocto-Visualization (for web) or it can be used in the Yocto-Visualization (for web) installer to create a pre-configured install. Also, it is mostly compatible with the native version of Yocto-Visualization: you can use it instead of the original config.xml file. Just click on the link below to export/download your current configuration.",this._tabExport.divElement.appendChild(t),t=document.createElement("P"),t.style.fontSize=b.fontSize.toString()+"px",t.style.textAlign="right";let F=document.createElement("A");F.innerText="Export current configuration",F.style.cursor="pointer",F.style.color="#0000EE",F.style.textDecoration="underline",F.addEventListener("click",()=>{b.downloadCurrentConfig()}),t.appendChild(F),this._tabExport.divElement.appendChild(t),b._tabPanelContents.appendChild(this._tabNetwork.divElement),b._tabPanelContents.appendChild(this._tabCapture.divElement),b._tabPanelContents.appendChild(this._tabResources.divElement),b._tabPanelContents.appendChild(this._tabUI.divElement),b._tabPanelContents.appendChild(this._tabExport.divElement),b.tabSelected(this._tabNetwork),b.refreshSizeParams()}b._window.show()}static DPIoverrideChange(e,t){let i=parseFloat(t.value);t.disabled=!e.checked,e.checked&&i>0?S.overrideGuiDPIFactor(!0,i):S.overrideGuiDPIFactor(!1)}static hubWasAdded(e){oe.newHubCreated(e)&&(b.AddHubToUI(e),S.edited=!0,e.Connect().then(t=>{}))}static hubGotEdited(e){b.RefreshUI(e),S.edited=!0,e.Disconnect().then(t=>{E.Sleep(1),e.Connect()})}static dbleClickBringsUpContextMenuChange(e){let t=S.dbleClickBringsUpContextMenu;S.dbleClickBringsUpContextMenu=e.checked,t!=S.dbleClickBringsUpContextMenu&&(S.edited=!0)}static verticalDragZoomChange(e){let t=Rt.verticalDragZoomEnabled;Rt.verticalDragZoomEnabled=e.checked,t!=Rt.verticalDragZoomEnabled&&(S.edited=!0)}static mustCheckForUpdateChange(e){let t=S.mustCheckForUpdate;S.mustCheckForUpdate=e.checked,t!=S.mustCheckForUpdate&&(S.edited=!0)}static maxDataLogRecsChange(e){let t=parseInt(e.value);(t!=S.maxPointsPerDataloggerSerie||t!=st.MaxLoggerRecords)&&(S.maxPointsPerDataloggerSerie=t,st.MaxLoggerRecords=t,S.edited=!0)}static maxSeriesRecsChange(e){let t=parseInt(e.value);(t!=S.maxPointsPerGraphSerie||t!=Ri.MaxPointsPerSeries)&&(S.maxPointsPerGraphSerie=t,Ri.MaxPointsPerSeries=t,S.edited=!0)}static maxSensorRecsChange(e){let t=parseInt(e.value);(t!=S.maxDataRecordsPerSensor||t!=st.MaxDataRecords)&&(S.maxDataRecordsPerSensor=t,st.MaxDataRecords=t,S.edited=!0)}static captureDPIChange(e){let t=S.captureDPI;S.captureDPI=parseInt(e.value),S.captureDPI!=t&&(S.edited=!0),b.refreshSizeParams()}static captureWidthChange(e){let t=S.captureWidth;S.captureWidth=parseInt(e.value),S.captureWidth!=t&&(S.edited=!0),b.refreshSizeParams()}static captureHeightChange(e){let t=S.captureHeight;S.captureHeight=parseInt(e.value),S.captureHeight!=t&&(S.edited=!0),b.refreshSizeParams()}static captureSizeSelectChange(e){let t=S.captureSizePolicy;S.captureSizePolicy=W.CaptureFormats.fromString(W.CaptureFormats,e.value),S.captureSizePolicy!=t&&(S.edited=!0),b.refreshSizeParams()}static refreshSizeParams(){let e=W.CaptureFormats.fromString(W.CaptureFormats,b.inputSizeSelect.value);e==W.CaptureFormats.Keep?(b.captureWidthTR.style.display="none",b.captureHeightTR.style.display="none"):e==W.CaptureFormats.FixedWidth?(b.captureWidthTR.style.display="",b.captureHeightTR.style.display="none"):e==W.CaptureFormats.FixedHeight&&(b.captureWidthTR.style.display="none",b.captureHeightTR.style.display=""),e==W.CaptureFormats.Fixed&&(b.captureWidthTR.style.display="",b.captureHeightTR.style.display="");let t=25.4*parseInt(b.inputCaptureWidth.value)/parseInt(b.inputResolution.value);b.inputCaptureWidthInfo.innerText="Pixels  ("+t.toFixed(1)+"mm)";let i=25.4*parseInt(b.inputCaptureHeight.value)/parseInt(b.inputResolution.value);b.inputCaptureHeightInfo.innerText="Pixels  ("+i.toFixed(1)+"mm)"}static downloadCurrentConfig(){let e=document.createElement("a"),t="data:text/xml;base64,"+btoa(O.get_XmlData());e.setAttribute("href",t),e.setAttribute("download","config.xml"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}static captureFormatChange(e){e==b.inputPNG&&(b.inputSVG.checked=!e.checked),e==b.inputSVG&&(b.inputPNG.checked=!e.checked);let t=S.captureType;S.captureType=b.inputPNG.checked?W.CaptureType.PNG:W.CaptureType.SVG,S.captureType!=t&&(S.edited=!0)}static tabSelected(e){this._tabNetwork.active=e==this._tabNetwork,this._tabCapture.active=e==this._tabCapture,this._tabResources.active=e==this._tabResources,this._tabUI.active=e==this._tabUI,this._tabExport.active=e==this._tabExport}};m(b,"configForm");var ye=b;ye.GUIcoef=1;ye.REFWIDH=520;ye.REFHEIGHT=300;ye.fontSize=S.generalFontSize;var V=class V{static get activeBorderColor(){return S.WindowInnerBorderColor}static get inactiveBorderColor(){return"#b0b0b0"}static get activeColor(){return"black"}static get inactiveColor(){return"grey"}static get activeBackgroundColor(){return S.WindowInnerBackgroundColor}static get inactiveBackgroundColor(){return S.WindowBackgroundColor}static newHub(e){V._currenthub=new oi(2,"ws","","",!0,"","",""),V.show(V._currenthub),V._window.title="New Connection",V._thisIsEditing=!1,V._whenDone=e}static editHub(e,t){V._currenthub=e,V.show(V._currenthub),V._window.title="Edit Connection",V._thisIsEditing=!0,V._whenDone=t}static show(e){if(V._window==null){V._okButton=new ft("Ok",()=>{V.okClicked()}),V._cancelButton=new ft("Cancel",()=>{V.hide()});let t=new ut;t.positionType=1,t.width=Math.round(450*S.generalSizeCoef),t.height=Math.round(280*S.generalSizeCoef),t.isModal=!0,t.closeIcon=!1,t.title="...",t.buttons.push(V._okButton),t.buttons.push(V._cancelButton),V._window=new nt(t),V._contents=V._window.innerContentDiv;let i=document.createElement("P");i.style.paddingTop="0px",i.style.marginTop=Math.round(3*S.generalSizeCoef).toString()+"px",i.style.lineHeight=Math.round(12*S.generalSizeCoef).toString()+"px",i.innerText="Enter the hub connection parameter, The only mandatory parameter is the address, just leave the other fields empty if you want to use default values",i.style.textAlign="justify",V._contents.appendChild(i),i.appendChild(document.createElement("BR")),i.appendChild(document.createElement("BR"));let r=document.createElement("SPAN");r.innerText="Protocol:",r.style.marginLeft="20px",i.appendChild(r),V._protocolSelect=document.createElement("SELECT"),V._protocolSelect.style.border="1px solid grey",V._protocolSelect.style.fontFamily=S.generalFontFamily,V._protocolSelect.style.fontSize=S.generalFontSize.toString()+"px";let s=document.createElement("OPTION");s.text="http",s.value="http",V._protocolSelect.appendChild(s);let n=document.createElement("OPTION");n.text="https",n.value="https",V._protocolSelect.appendChild(n);let o=document.createElement("OPTION");o.text="ws",o.value="ws",V._protocolSelect.appendChild(o);let a=document.createElement("OPTION");a.text="wss",a.value="wss",V._protocolSelect.appendChild(a),i.appendChild(V._protocolSelect),r=document.createElement("SPAN"),r.style.marginLeft="20px",r.innerText="Address:",i.appendChild(r),V._addressInput=document.createElement("INPUT"),V._addressInput.style.border="1px solid grey",V._addressInput.style.fontFamily=S.generalFontFamily,V._addressInput.style.fontSize=S.generalFontSize.toString()+"px",V._addressInput.maxLength=512,V._addressInput.size=15,V._addressInput.value=e.addr,new wt(V._addressInput,0,!1,Number.NaN,Number.NaN,null),i.appendChild(V._addressInput),r=document.createElement("SPAN"),r.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",r.innerText="Port:",i.appendChild(r),V._portInput=document.createElement("INPUT"),V._portInput.style.border="1px solid grey",V._portInput.style.fontFamily=S.generalFontFamily,V._portInput.style.fontSize=S.generalFontSize.toString()+"px",V._portInput.style.textAlign="right",V._portInput.maxLength=5,V._portInput.size=5,new wt(V._portInput,3,!0,Number.NaN,Number.NaN,null),i.appendChild(V._portInput),i.appendChild(document.createElement("BR")),i.appendChild(document.createElement("BR")),r=document.createElement("SPAN"),r.innerText="Path:",r.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",i.appendChild(r),V._pathInput=document.createElement("INPUT"),V._pathInput.style.border="1px solid grey",V._pathInput.style.fontFamily=S.generalFontFamily,V._pathInput.style.fontSize=S.generalFontSize.toString()+"px",V._pathInput.size=45,i.appendChild(V._pathInput),i.appendChild(document.createElement("BR")),i.appendChild(document.createElement("BR")),r=document.createElement("SPAN"),r.innerText="Username:",r.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",i.appendChild(r),V._usernameInput=document.createElement("INPUT"),V._usernameInput.style.border="1px solid grey",V._usernameInput.style.fontFamily=S.generalFontFamily,V._usernameInput.style.fontSize=S.generalFontSize.toString()+"px",V._usernameInput.size=15,i.appendChild(V._usernameInput),r=document.createElement("SPAN"),r.innerText="Password:",r.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",i.appendChild(r),V._passwordInput=document.createElement("INPUT"),V._passwordInput.type="password",V._passwordInput.style.border="1px solid grey",V._passwordInput.style.fontFamily=S.generalFontFamily,V._passwordInput.style.fontSize=S.generalFontSize.toString()+"px",V._passwordInput.size=15,i.appendChild(V._passwordInput),i=document.createElement("P"),i.style.paddingTop="0px",i.style.marginTop=Math.round(3*S.generalSizeCoef).toString()+"px",i.style.lineHeight=Math.round(12*S.generalSizeCoef).toString()+"px",i.innerText="Important note: credentials are saved in the configuration file wich is easily accessible. Therefore, if hub is write-protected, it might be wise to use ReadOnly credentials here. When installed on a Yoctopuce hub, Yocto-Visualization (for web) will automatically ask for read/write credentials at save time if neccessary.",i.style.textAlign="justify",V._contents.appendChild(i)}V._protocolSelect.value=e.protocol,V._addressInput.value=e.addr,V._portInput.value=e.port,V._pathInput.value=e.path,V._usernameInput.value=e.user,V._passwordInput.value=e.encryptedPassword!=""?V.FakePassword:"",V._window.show()}static hide(){V._window!=null&&(V._window.hide(),V._passwordInput.value="",V._whenDone!=null&&V._whenDone())}static okClicked(){V._currenthub.protocol=V._protocolSelect.value,V._currenthub.addr=V._addressInput.value,V._currenthub.port=V._portInput.value,V._currenthub.path=V._pathInput.value,V._currenthub.user=V._usernameInput.value,V._currenthub.user!=""?V._passwordInput.value!=V.FakePassword&&(V._currenthub.encryptedPassword=oi.Encrypt(V._passwordInput.value,oi.loginCypherPassword)):V._currenthub.encryptedPassword="",V._thisIsEditing?ye.hubGotEdited(V._currenthub):ye.hubWasAdded(V._currenthub),V.hide(),V._whenDone!=null&&V._whenDone()}};m(V,"HubEdit");var ui=V;ui.FakePassword="******";ui._thisIsEditing=!1;ui._whenDone=null;ui.fontSize=S.generalFontSize;var ge=class ge{static get activeBorderColor(){return S.WindowInnerBorderColor}static get inactiveBorderColor(){return"#b0b0b0"}static get activeColor(){return"black"}static get inactiveColor(){return"grey"}static get activeBackgroundColor(){return S.WindowInnerBackgroundColor}static get inactiveBackgroundColor(){return S.WindowBackgroundColor}static get username(){return this._username}static get password(){return this._password}static show(e,t){if(ge._window==null){ge._okButton=new ft("Ok",()=>{ge.okClicked()}),ge._cancelButton=new ft("Cancel",()=>{ge.hide()});let i=new ut;i.positionType=1,i.width=Math.round(450*S.generalSizeCoef),i.height=Math.round(175*S.generalSizeCoef),i.isModal=!0,i.closeIcon=!1,i.title="Some credentials are required",i.buttons.push(ge._okButton),i.buttons.push(ge._cancelButton),ge._window=new nt(i),ge._contents=ge._window.innerContentDiv;let r=document.createElement("P");r.style.paddingTop="10px",r.style.marginTop=Math.round(5*S.generalSizeCoef).toString()+"px",r.style.lineHeight=Math.round(15*S.generalSizeCoef).toString()+"px",r.innerText="Saving configuration on "+e+" requires  read/write credentials.",r.style.textAlign="justify",ge._contents.appendChild(r),r.appendChild(document.createElement("BR")),r.appendChild(document.createElement("BR"));let s=document.createElement("SPAN");s=document.createElement("SPAN"),s.innerText="Username:",s.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",r.appendChild(s),ge._usernameInput=document.createElement("INPUT"),ge._usernameInput.style.border="1px solid grey",ge._usernameInput.style.fontFamily=S.generalFontFamily,ge._usernameInput.style.fontSize=S.generalFontSize.toString()+"px",ge._usernameInput.size=15,r.appendChild(ge._usernameInput),s=document.createElement("SPAN"),s.innerText="Password:",s.style.marginLeft=Math.round(20*S.generalSizeCoef).toString()+"px",r.appendChild(s),ge._passwordInput=document.createElement("INPUT"),ge._passwordInput.type="password",ge._passwordInput.style.border="1px solid grey",ge._passwordInput.style.fontFamily=S.generalFontFamily,ge._passwordInput.style.fontSize=S.generalFontSize.toString()+"px",ge._passwordInput.size=15,ge._passwordInput.addEventListener("keypress",n=>{n.key=="Enter"&&this.okClicked()}),r.appendChild(ge._passwordInput)}ge._window.show(),ge._usernameInput.focus(),ge._whenDone=t}static hide(){ge._window!=null&&(ge._window.hide(),ge._passwordInput.value="")}static okClicked(){ge._username=ge._usernameInput.value,ge._password=ge._passwordInput.value,ge.hide(),ge._whenDone!=null&&ge._whenDone(ge._usernameInput.value,ge._passwordInput.value)}};m(ge,"CredentialsPrompt");var Si=ge;Si._whenDone=null;Si.fontSize=S.generalFontSize;Si._username="";Si._password="";var Oo=class Oo{static flattenChunks(e){let t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].length;let i=new Uint8Array(t);for(let r=0,s=0,n=e.length;r<n;r++){let o=e[r];i.set(o,s),s+=o.length}return i}};m(Oo,"utils_common");var Kr=Oo;var Ci=class Ci{static _init(){try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ci.STR_APPLY_UIA_OK=!1}for(let e=0;e<256;e++)Ci._utf8len[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;return Ci._utf8len[254]=Ci._utf8len[254]=1,!0}static string2buf(e){let t,i,r,s,n,o=e.length,a=0;for(s=0;s<o;s++)i=e.charCodeAt(s),(i&64512)===55296&&s+1<o&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),s++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),n=0,s=0;n<a;s++)i=e.charCodeAt(s),(i&64512)===55296&&s+1<o&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(i=65536+(i-55296<<10)+(r-56320),s++)),i<128?t[n++]=i:i<2048?(t[n++]=192|i>>>6,t[n++]=128|i&63):i<65536?(t[n++]=224|i>>>12,t[n++]=128|i>>>6&63,t[n++]=128|i&63):(t[n++]=240|i>>>18,t[n++]=128|i>>>12&63,t[n++]=128|i>>>6&63,t[n++]=128|i&63);return t}static buf2binstring(e,t){let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i}static buf2string(e,t){let i,r,s=t||e.length,n=new Array(s*2);for(r=0,i=0;i<s;){let o=e[i++];if(o<128){n[r++]=o;continue}let a=Ci._utf8len[o];if(a>4){n[r++]=65533,i+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&i<s;)o=o<<6|e[i++]&63,a--;if(a>1){n[r++]=65533;continue}o<65536?n[r++]=o:(o-=65536,n[r++]=55296|o>>10&1023,n[r++]=56320|o&1023)}return Ci.buf2binstring(n,r)}static utf8border(e,t){t=t||e.length,t>e.length&&(t=e.length);let i=t-1;for(;i>=0&&(e[i]&192)===128;)i--;return i<0||i===0?t:i+Ci._utf8len[e[i]]>t?i:t}};m(Ci,"Pako_strings");var Ti=Ci;Ti.STR_APPLY_UIA_OK=!0;Ti._utf8len=new Uint8Array(256);Ti.initDone=Ti._init();var js=class js{constructor(e){this.level=L.Z_DEFAULT_COMPRESSION,this.method=L.Z_DEFLATED,this.chunkSize=16384,this.windowBits=15,this.memLevel=8,this.strategy=L.Z_DEFAULT_STRATEGY,this.raw=!1,this.gzip=!1,this.header=null,this.dictionary=null,this.ignore_os=!1,js.ApplyCustomOptions(this,e)}static ApplyCustomOptions(e,t){if(typeof t!="undefined"){let i=Object.keys(e),r=Object.keys(t);for(let s=0;s<r.length;s++){if(i.indexOf(r[s])<0){debugger;throw"Invalid Pako option name '"+r[s]+"', check Pako_deflate_option class"}let n=typeof Reflect.get(t,r[s]),o=typeof Reflect.get(e,r[s]);if(n!=o)throw"Invalid Pako type for option '"+r[s]+"' (expected '"+o+"', got '"+n+"')";Reflect.set(e,r[s],Reflect.get(t,r[s]))}}}};m(js,"Pako_deflate_option");var Uo=js,xr=class xr{constructor(e){this._dict_set=!1,this.result=null,this.options=new Uo(e);let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jr,this.strm.avail_out=0;let i=X.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==L.Z_OK)throw new Error(Ni.msg(i));if(t.header&&X.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=Ti.string2buf(t.dictionary):toString.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,i=X.deflateSetDictionary(this.strm,r),i!==L.Z_OK)throw new Error(Ni.msg(i));this._dict_set=!0}}push(e,t){let i=this.strm,r=this.options.chunkSize,s,n;if(this.ended)return!1;for(t===~~t?n=t:n=t===!0?L.Z_FINISH:L.Z_NO_FLUSH,typeof e=="string"?i.input=Ti.string2buf(e):toString.call(e)==="[object ArrayBuffer]"?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(n===L.Z_SYNC_FLUSH||n===L.Z_FULL_FLUSH)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(s=X.deflate(i,n),s===L.Z_STREAM_END)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=X.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===L.Z_OK;if(i.avail_out===0){this.onData(i.output);continue}if(n>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return!0}onData(e){this.chunks.push(e)}onEnd(e){e===L.Z_OK&&(this.result=Kr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg}static deflate(e,t){let i=new xr(t);if(i.push(e,!0),i.err)throw i.msg||Ni.msg(i.err);return i.result}static deflateRaw(e,t){return t.raw=!0,xr.deflate(e,t)}static gzip(e,t){return typeof t=="undefined"&&(t={}),t.gzip=!0,xr.deflate(e,t)}};m(xr,"Pako_Deflate");var Ks=xr;var Ho=class Ho{static adler32(e,t,i,r){let s=e&65535|0,n=e>>>16&65535|0,o=0;for(;i!==0;){o=i>2e3?2e3:i,i-=o;do s=s+t[r++]|0,n=n+s|0;while(--o);s%=65521,n%=65521}return s|n<<16|0}};m(Ho,"zlib_adler32");var xi=Ho;var Go=class Go{};m(Go,"zlib_constants");var L=Go;L.Z_NO_FLUSH=0;L.Z_PARTIAL_FLUSH=1;L.Z_SYNC_FLUSH=2;L.Z_FULL_FLUSH=3;L.Z_FINISH=4;L.Z_BLOCK=5;L.Z_TREES=6;L.Z_OK=0;L.Z_STREAM_END=1;L.Z_NEED_DICT=2;L.Z_ERRNO=-1;L.Z_STREAM_ERROR=-2;L.Z_DATA_ERROR=-3;L.Z_MEM_ERROR=-4;L.Z_BUF_ERROR=-5;L.Z_NO_COMPRESSION=0;L.Z_BEST_SPEED=1;L.Z_BEST_COMPRESSION=9;L.Z_DEFAULT_COMPRESSION=-1;L.Z_FILTERED=1;L.Z_HUFFMAN_ONLY=2;L.Z_RLE=3;L.Z_FIXED=4;L.Z_DEFAULT_STRATEGY=0;L.Z_BINARY=0;L.Z_TEXT=1;L.Z_UNKNOWN=2;L.Z_DEFLATED=8;var qs=class qs{static makeTable(){let e,t=new Int32Array(256);for(let i=0;i<256;i++){e=i;for(let r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[i]=e}return t}static crc32(e,t,i,r){let s=qs.crcTable,n=r+i;e^=-1;for(let o=r;o<n;o++)e=e>>>8^s[(e^t[o])&255];return e^-1}};m(qs,"zlib_crc32");var He=qs;He.crcTable=He.makeTable();var Xo=class Xo{constructor(e,t,i,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=s}};m(Xo,"zlib_config");var Qt=Xo,Zo=class Zo{constructor(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=L.Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(M.HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*M.D_CODES+1)*2),this.bl_tree=new Uint16Array((2*M.BL_CODES+1)*2),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(M.MAX_BITS+1),this.heap=new Uint16Array(2*M.L_CODES+1),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*M.L_CODES+1),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0,M.zero(this.dyn_ltree),M.zero(this.dyn_dtree),M.zero(this.bl_tree),M.zero(this.heap),M.zero(this.depth)}};m(Zo,"zlib_DeflateState");var Wo=Zo,v=class v{static err(e,t){return e.msg=Ni.msg(t),t}static rank(e){return(e<<1)-(e>4?9:0)}zero(e){let t=e.length;for(;--t>=0;)e[t]=0}static HASH_ZLIB(e,t,i){return(t<<e.hash_shift^i)&e.hash_mask}static HASH(e,t,i){return(t<<e.hash_shift^i)&e.hash_mask}static flush_pending(e){let t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),i!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,t.pending===0&&(t.pending_out=0))}static flush_block_only(e,t){M._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,v.flush_pending(e.strm)}static put_byte(e,t){e.pending_buf[e.pending++]=t}static putShortMSB(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255}static read_buf(e,t,i,r){let s=e.avail_in;return s>r&&(s=r),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),i),e.state.wrap===1?e.adler=xi.adler32(e.adler,t,s,i):e.state.wrap===2&&(e.adler=He.crc32(e.adler,t,s,i)),e.next_in+=s,e.total_in+=s,s)}static longest_match(e,t){let i=e.max_chain_length,r=e.strstart,s,n,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-v.MIN_LOOKAHEAD?e.strstart-(e.w_size-v.MIN_LOOKAHEAD):0,h=e.window,u=e.w_mask,_=e.prev,d=e.strstart+M.MAX_MATCH,g=h[r+o-1],y=h[r+o];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do if(s=t,!(h[s+o]!==y||h[s+o-1]!==g||h[s]!==h[r]||h[++s]!==h[r+1])){r+=2,s++;do;while(h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&h[++r]===h[++s]&&r<d);if(n=M.MAX_MATCH-(d-r),r=d-M.MAX_MATCH,n>o){if(e.match_start=t,o=n,n>=a)break;g=h[r+o-1],y=h[r+o]}}while((t=_[t&u])>l&&--i!==0);return o<=e.lookahead?o:e.lookahead}static fill_window(e){let t=e.w_size,i,r,s,n,o;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-v.MIN_LOOKAHEAD)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,i=r;do s=e.head[--i],e.head[i]=s>=t?s-t:0;while(--r);r=t,i=r;do s=e.prev[--i],e.prev[i]=s>=t?s-t:0;while(--r);n+=t}if(e.strm.avail_in===0)break;if(r=v.read_buf(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=M.MIN_MATCH)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=v.HASH(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=v.HASH(e,e.ins_h,e.window[o+M.MIN_MATCH-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<M.MIN_MATCH)););}while(e.lookahead<v.MIN_LOOKAHEAD&&e.strm.avail_in!==0)}static deflate_stored(e,t){let i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v.fill_window(e),e.lookahead===0&&t===L.Z_NO_FLUSH)return v.BS_NEED_MORE;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;let r=e.block_start+i;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,v.flush_block_only(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-v.MIN_LOOKAHEAD&&(v.flush_block_only(e,!1),e.strm.avail_out===0))return v.BS_NEED_MORE}return e.insert=0,t===L.Z_FINISH?(v.flush_block_only(e,!0),e.strm.avail_out===0?v.BS_FINISH_STARTED:v.BS_FINISH_DONE):(e.strstart>e.block_start&&(v.flush_block_only(e,!1),e.strm.avail_out===0),v.BS_NEED_MORE)}static deflate_slow(e,t){let i,r,s;for(;;){if(e.lookahead<v.MIN_LOOKAHEAD){if(v.fill_window(e),e.lookahead<v.MIN_LOOKAHEAD&&t===L.Z_NO_FLUSH)return v.BS_NEED_MORE;if(e.lookahead===0)break}if(i=0,e.lookahead>=M.MIN_MATCH&&(e.ins_h=v.HASH(e,e.ins_h,e.window[e.strstart+M.MIN_MATCH-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=M.MIN_MATCH-1,i!==0&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-v.MIN_LOOKAHEAD&&(e.match_length=v.longest_match(e,i),e.match_length<=5&&(e.strategy===L.Z_FILTERED||e.match_length===M.MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=M.MIN_MATCH-1)),e.prev_length>=M.MIN_MATCH&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-M.MIN_MATCH,r=M._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-M.MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=v.HASH(e,e.ins_h,e.window[e.strstart+M.MIN_MATCH-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=M.MIN_MATCH-1,e.strstart++,r&&(v.flush_block_only(e,!1),e.strm.avail_out===0))return v.BS_NEED_MORE}else if(e.match_available){if(r=M._tr_tally(e,0,e.window[e.strstart-1]),r&&v.flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return v.BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=M._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<M.MIN_MATCH-1?e.strstart:M.MIN_MATCH-1,t===L.Z_FINISH?(v.flush_block_only(e,!0),e.strm.avail_out===0?v.BS_FINISH_STARTED:v.BS_FINISH_DONE):e.last_lit&&(v.flush_block_only(e,!1),e.strm.avail_out===0)?v.BS_NEED_MORE:v.BS_BLOCK_DONE}static deflate_rle(e,t){let i,r,s,n,o=e.window;for(;;){if(e.lookahead<=M.MAX_MATCH){if(v.fill_window(e),e.lookahead<=M.MAX_MATCH&&t===L.Z_NO_FLUSH)return v.BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=M.MIN_MATCH&&e.strstart>0&&(s=e.strstart-1,r=o[s],r===o[++s]&&r===o[++s]&&r===o[++s])){n=e.strstart+M.MAX_MATCH;do;while(r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&s<n);e.match_length=M.MAX_MATCH-(n-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=M.MIN_MATCH?(i=M._tr_tally(e,1,e.match_length-M.MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=M._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(v.flush_block_only(e,!1),e.strm.avail_out===0))return v.BS_NEED_MORE}return e.insert=0,t===L.Z_FINISH?(v.flush_block_only(e,!0),e.strm.avail_out===0?v.BS_FINISH_STARTED:v.BS_FINISH_DONE):e.last_lit&&(v.flush_block_only(e,!1),e.strm.avail_out===0)?v.BS_NEED_MORE:v.BS_BLOCK_DONE}static deflate_huff(e,t){let i;for(;;){if(e.lookahead===0&&(v.fill_window(e),e.lookahead===0)){if(t===L.Z_NO_FLUSH)return v.BS_NEED_MORE;break}if(e.match_length=0,i=M._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(v.flush_block_only(e,!1),e.strm.avail_out===0))return v.BS_NEED_MORE}return e.insert=0,t===L.Z_FINISH?(v.flush_block_only(e,!0),e.strm.avail_out===0?v.BS_FINISH_STARTED:v.BS_FINISH_DONE):e.last_lit&&(v.flush_block_only(e,!1),e.strm.avail_out===0)?v.BS_NEED_MORE:v.BS_BLOCK_DONE}static lm_init(e){e.window_size=2*e.w_size,M.zero(e.head),e.max_lazy_match=v.configuration_table[e.level].max_lazy,e.good_match=v.configuration_table[e.level].good_length,e.nice_match=v.configuration_table[e.level].nice_length,e.max_chain_length=v.configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=M.MIN_MATCH-1,e.match_available=0,e.ins_h=0}static deflateResetKeep(e){if(!e||!e.state)return v.err(e,L.Z_STREAM_ERROR);e.total_in=e.total_out=0,e.data_type=L.Z_UNKNOWN;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?v.INIT_STATE:v.BUSY_STATE,e.adler=t.wrap===2?0:1,t.last_flush=L.Z_NO_FLUSH,M._tr_init(t),L.Z_OK}static deflateReset(e){let t=v.deflateResetKeep(e);return t===L.Z_OK&&v.lm_init(e.state),t}static deflateSetHeader(e,t){return!e||!e.state?L.Z_STREAM_ERROR:e.state.wrap!==2?L.Z_STREAM_ERROR:(e.state.gzhead=t,L.Z_OK)}static deflateInit2(e,t,i,r,s,n){if(!e)return L.Z_STREAM_ERROR;let o=1;if(t===L.Z_DEFAULT_COMPRESSION&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),s<1||s>v.MAX_MEM_LEVEL||i!==L.Z_DEFLATED||r<8||r>15||t<0||t>9||n<0||n>L.Z_FIXED)return v.err(e,L.Z_STREAM_ERROR);r===8&&(r=9);let a=new Wo;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+M.MIN_MATCH-1)/M.MIN_MATCH),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=n,a.method=i,v.deflateReset(e)}static deflateInit(e,t){return v.deflateInit2(e,t,L.Z_DEFLATED,v.MAX_WBITS,v.DEF_MEM_LEVEL,L.Z_DEFAULT_STRATEGY)}static deflate(e,t){let i,r;if(!e||!e.state||t>L.Z_BLOCK||t<0)return e?v.err(e,L.Z_STREAM_ERROR):L.Z_STREAM_ERROR;let s=e.state;if(!e.output||!e.input&&e.avail_in!==0||s.status===v.FINISH_STATE&&t!==L.Z_FINISH)return v.err(e,e.avail_out===0?L.Z_BUF_ERROR:L.Z_STREAM_ERROR);s.strm=e;let n=s.last_flush;if(s.last_flush=t,s.status===v.INIT_STATE)if(s.wrap===2)e.adler=0,v.put_byte(s,31),v.put_byte(s,139),v.put_byte(s,8),s.gzhead?(v.put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),v.put_byte(s,s.gzhead.time&255),v.put_byte(s,s.gzhead.time>>8&255),v.put_byte(s,s.gzhead.time>>16&255),v.put_byte(s,s.gzhead.time>>24&255),v.put_byte(s,s.level===9?2:s.strategy>=L.Z_HUFFMAN_ONLY||s.level<2?4:0),v.put_byte(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(v.put_byte(s,s.gzhead.extra.length&255),v.put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=v.EXTRA_STATE):(v.put_byte(s,0),v.put_byte(s,0),v.put_byte(s,0),v.put_byte(s,0),v.put_byte(s,0),v.put_byte(s,s.level===9?2:s.strategy>=L.Z_HUFFMAN_ONLY||s.level<2?4:0),v.put_byte(s,v.OS_CODE),s.status=v.BUSY_STATE);else{let o=L.Z_DEFLATED+(s.w_bits-8<<4)<<8,a=-1;s.strategy>=L.Z_HUFFMAN_ONLY||s.level<2?a=0:s.level<6?a=1:s.level===6?a=2:a=3,o|=a<<6,s.strstart!==0&&(o|=v.PRESET_DICT),o+=31-o%31,s.status=v.BUSY_STATE,v.putShortMSB(s,o),s.strstart!==0&&(v.putShortMSB(s,e.adler>>>16),v.putShortMSB(s,e.adler&65535)),e.adler=1}if(s.status===v.EXTRA_STATE)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),v.flush_pending(e),i=s.pending,s.pending===s.pending_buf_size));)v.put_byte(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=v.NAME_STATE)}else s.status=v.NAME_STATE;if(s.status===v.NAME_STATE)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),v.flush_pending(e),i=s.pending,s.pending===s.pending_buf_size)){r=1;break}s.gzindex<s.gzhead.name.length?r=s.gzhead.name.charCodeAt(s.gzindex++)&255:r=0,v.put_byte(s,r)}while(r!==0);s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),r===0&&(s.gzindex=0,s.status=v.COMMENT_STATE)}else s.status=v.COMMENT_STATE;if(s.status===v.COMMENT_STATE)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),v.flush_pending(e),i=s.pending,s.pending===s.pending_buf_size)){r=1;break}s.gzindex<s.gzhead.comment.length?r=s.gzhead.comment.charCodeAt(s.gzindex++)&255:r=0,v.put_byte(s,r)}while(r!==0);s.gzhead.hcrc&&s.pending>i&&(e.adler=He.crc32(e.adler,s.pending_buf,s.pending-i,i)),r===0&&(s.status=v.HCRC_STATE)}else s.status=v.HCRC_STATE;if(s.status===v.HCRC_STATE&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&v.flush_pending(e),s.pending+2<=s.pending_buf_size&&(v.put_byte(s,e.adler&255),v.put_byte(s,e.adler>>8&255),e.adler=0,s.status=v.BUSY_STATE)):s.status=v.BUSY_STATE),s.pending!==0){if(v.flush_pending(e),e.avail_out===0)return s.last_flush=-1,L.Z_OK}else if(e.avail_in===0&&v.rank(t)<=v.rank(n)&&t!==L.Z_FINISH)return v.err(e,L.Z_BUF_ERROR);if(s.status===v.FINISH_STATE&&e.avail_in!==0)return v.err(e,L.Z_BUF_ERROR);if(e.avail_in!==0||s.lookahead!==0||t!==L.Z_NO_FLUSH&&s.status!==v.FINISH_STATE){let o=s.strategy===L.Z_HUFFMAN_ONLY?v.deflate_huff(s,t):s.strategy===L.Z_RLE?v.deflate_rle(s,t):v.configuration_table[s.level].func(s,t);if((o===v.BS_FINISH_STARTED||o===v.BS_FINISH_DONE)&&(s.status=v.FINISH_STATE),o===v.BS_NEED_MORE||o===v.BS_FINISH_STARTED)return e.avail_out===0&&(s.last_flush=-1),L.Z_OK;if(o===v.BS_BLOCK_DONE&&(t===L.Z_PARTIAL_FLUSH?M._tr_align(s):t!==L.Z_BLOCK&&(M._tr_stored_block(s,0,0,!1),t===L.Z_FULL_FLUSH&&(M.zero(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),v.flush_pending(e),e.avail_out===0))return s.last_flush=-1,L.Z_OK}return t!==L.Z_FINISH?L.Z_OK:s.wrap<=0?L.Z_STREAM_END:(s.wrap===2?(v.put_byte(s,e.adler&255),v.put_byte(s,e.adler>>8&255),v.put_byte(s,e.adler>>16&255),v.put_byte(s,e.adler>>24&255),v.put_byte(s,e.total_in&255),v.put_byte(s,e.total_in>>8&255),v.put_byte(s,e.total_in>>16&255),v.put_byte(s,e.total_in>>24&255)):(v.putShortMSB(s,e.adler>>>16),v.putShortMSB(s,e.adler&65535)),v.flush_pending(e),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?L.Z_OK:L.Z_STREAM_END)}static deflateEnd(e){if(!e||!e.state)return L.Z_STREAM_ERROR;let t=e.state.status;return t!==v.INIT_STATE&&t!==v.EXTRA_STATE&&t!==v.NAME_STATE&&t!==v.COMMENT_STATE&&t!==v.HCRC_STATE&&t!==v.BUSY_STATE&&t!==v.FINISH_STATE?v.err(e,L.Z_STREAM_ERROR):(e.state=null,t===v.BUSY_STATE?v.err(e,L.Z_DATA_ERROR):L.Z_OK)}static deflateSetDictionary(e,t){let i=t.length;if(!e||!e.state)return L.Z_STREAM_ERROR;let r=e.state,s=r.wrap;if(s===2||s===1&&r.status!==v.INIT_STATE||r.lookahead)return L.Z_STREAM_ERROR;if(s===1&&(e.adler=xi.adler32(e.adler,t,i,0)),r.wrap=0,i>=r.w_size){s===0&&(M.zero(r.head),r.strstart=0,r.block_start=0,r.insert=0);let l=new Uint8Array(r.w_size);l.set(t.subarray(i-r.w_size,i),0),t=l,i=r.w_size}let n=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,v.fill_window(r);r.lookahead>=M.MIN_MATCH;){let l=r.strstart,h=r.lookahead-(M.MIN_MATCH-1);do r.ins_h=v.HASH(r,r.ins_h,r.window[l+M.MIN_MATCH-1]),r.prev[l&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=l,l++;while(--h);r.strstart=l,r.lookahead=M.MIN_MATCH-1,v.fill_window(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=M.MIN_MATCH-1,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=n,r.wrap=s,L.Z_OK}};m(v,"zlib_deflate");var X=v;X.MAX_MEM_LEVEL=9;X.MAX_WBITS=15;X.DEF_MEM_LEVEL=8;X.LENGTH_CODES=29;X.LITERALS=256;X.L_CODES=X.LITERALS+1+X.LENGTH_CODES;X.D_CODES=30;X.BL_CODES=19;X.HEAP_SIZE=2*X.L_CODES+1;X.MAX_BITS=15;X.MIN_MATCH=3;X.MAX_MATCH=258;X.MIN_LOOKAHEAD=X.MAX_MATCH+X.MIN_MATCH+1;X.PRESET_DICT=32;X.INIT_STATE=42;X.EXTRA_STATE=69;X.NAME_STATE=73;X.COMMENT_STATE=91;X.HCRC_STATE=103;X.BUSY_STATE=113;X.FINISH_STATE=666;X.BS_NEED_MORE=1;X.BS_BLOCK_DONE=2;X.BS_FINISH_STARTED=3;X.BS_FINISH_DONE=4;X.OS_CODE=3;X.deflate_fast=(D,e)=>{let t,i;for(;;){if(D.lookahead<X.MIN_LOOKAHEAD){if(X.fill_window(D),D.lookahead<X.MIN_LOOKAHEAD&&e===L.Z_NO_FLUSH)return X.BS_NEED_MORE;if(D.lookahead===0)break}if(t=0,D.lookahead>=M.MIN_MATCH&&(D.ins_h=X.HASH(D,D.ins_h,D.window[D.strstart+M.MIN_MATCH-1]),t=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),t!==0&&D.strstart-t<=D.w_size-X.MIN_LOOKAHEAD&&(D.match_length=X.longest_match(D,t)),D.match_length>=M.MIN_MATCH)if(i=M._tr_tally(D,D.strstart-D.match_start,D.match_length-M.MIN_MATCH),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=M.MIN_MATCH){D.match_length--;do D.strstart++,D.ins_h=X.HASH(D,D.ins_h,D.window[D.strstart+M.MIN_MATCH-1]),t=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart;while(--D.match_length!==0);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=X.HASH(D,D.ins_h,D.window[D.strstart+1]);else i=M._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(i&&(X.flush_block_only(D,!1),D.strm.avail_out===0))return X.BS_NEED_MORE}return D.insert=D.strstart<M.MIN_MATCH-1?D.strstart:M.MIN_MATCH-1,e===L.Z_FINISH?(X.flush_block_only(D,!0),D.strm.avail_out===0?X.BS_FINISH_STARTED:X.BS_FINISH_DONE):D.last_lit&&(X.flush_block_only(D,!1),D.strm.avail_out===0)?X.BS_NEED_MORE:X.BS_BLOCK_DONE};X.configuration_table=[new Qt(0,0,0,0,X.deflate_stored),new Qt(4,4,8,4,X.deflate_fast),new Qt(4,5,16,8,X.deflate_fast),new Qt(4,6,32,32,X.deflate_fast),new Qt(4,4,16,16,X.deflate_slow),new Qt(8,16,32,32,X.deflate_slow),new Qt(8,16,128,128,X.deflate_slow),new Qt(8,32,128,256,X.deflate_slow),new Qt(32,128,258,1024,X.deflate_slow),new Qt(32,258,258,4096,X.deflate_slow)];var jo=class jo{constructor(e,t,i,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=s,this.has_stree=e!=null&&e.length>0}};m(jo,"zlib_StaticTreeDesc");var qr=jo,qo=class qo{constructor(e,t){this.max_code=0,this.dyn_tree=e,this.max_code=0,this.stat_desc=t}};m(qo,"zlib_TreeDesc");var $r=qo,N=class N{static zero(e){let t=e.length;for(;--t>=0;)e[t]=0}static Zeroinit(){return N.zero(N.static_ltree),N.zero(N.base_dist),N.zero(N.base_length),N.zero(N._length_code),N.zero(N._dist_code),N.zero(N.static_dtree),!0}static d_code(e){return e<256?N._dist_code[e]:N._dist_code[256+(e>>>7)]}static put_short(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}static send_code(e,t,i){N.send_bits(e,i[t*2],i[t*2+1])}static bi_reverse(e,t){let i=0;do i|=e&1,e>>>=1,i<<=1;while(--t>0);return i>>>1}static bi_flush(e){e.bi_valid===16?(N.put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}static gen_codes(e,t,i){let r=new Array(N.MAX_BITS+1),s=0,n,o;for(n=1;n<=N.MAX_BITS;n++)r[n]=s=s+i[n-1]<<1;for(o=0;o<=t;o++){let a=e[o*2+1];a!==0&&(e[o*2]=N.bi_reverse(r[a]++,a))}}static tr_static_init(){let e,t,i,r,s,n=new Uint16Array(N.MAX_BITS+1);for(i=0,r=0;r<N.LENGTH_CODES-1;r++)for(N.base_length[r]=i,e=0;e<1<<N.extra_lbits[r];e++)N._length_code[i++]=r;for(N._length_code[i-1]=r,s=0,r=0;r<16;r++)for(N.base_dist[r]=s,e=0;e<1<<N.extra_dbits[r];e++)N._dist_code[s++]=r;for(s>>=7;r<N.D_CODES;r++)for(N.base_dist[r]=s<<7,e=0;e<1<<N.extra_dbits[r]-7;e++)N._dist_code[256+s++]=r;for(t=0;t<=N.MAX_BITS;t++)n[t]=0;for(e=0;e<=143;)N.static_ltree[e*2+1]=8,e++,n[8]++;for(;e<=255;)N.static_ltree[e*2+1]=9,e++,n[9]++;for(;e<=279;)N.static_ltree[e*2+1]=7,e++,n[7]++;for(;e<=287;)N.static_ltree[e*2+1]=8,e++,n[8]++;for(N.gen_codes(N.static_ltree,N.L_CODES+1,n),e=0;e<N.D_CODES;e++)N.static_dtree[e*2+1]=5,N.static_dtree[e*2]=N.bi_reverse(e,5);N.static_l_desc=new qr(N.static_ltree,N.extra_lbits,N.LITERALS+1,N.L_CODES,N.MAX_BITS),N.static_d_desc=new qr(N.static_dtree,N.extra_dbits,0,N.D_CODES,N.MAX_BITS),N.static_bl_desc=new qr(new Uint16Array(0),N.extra_blbits,0,N.BL_CODES,N.MAX_BL_BITS)}static init_block(e){let t;for(t=0;t<N.L_CODES;t++)e.dyn_ltree[t*2]=0;for(t=0;t<N.D_CODES;t++)e.dyn_dtree[t*2]=0;for(t=0;t<N.BL_CODES;t++)e.bl_tree[t*2]=0;e.dyn_ltree[N.END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}static bi_windup(e){e.bi_valid>8?N.put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}static copy_block(e,t,i,r){N.bi_windup(e),r&&(N.put_short(e,i),N.put_short(e,~i)),e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i}static smaller(e,t,i,r){let s=t*2,n=i*2;return e[s]<e[n]||e[s]===e[n]&&r[t]<=r[i]}static pqdownheap(e,t,i){let r=e.heap[i],s=i<<1;for(;s<=e.heap_len&&(s<e.heap_len&&N.smaller(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!N.smaller(t,r,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=r}static compress_block(e,t,i){let r,s,n=0,o,a;if(e.last_lit!==0)do r=e.pending_buf[e.d_buf+n*2]<<8|e.pending_buf[e.d_buf+n*2+1],s=e.pending_buf[e.l_buf+n],n++,r===0?N.send_code(e,s,t):(o=N._length_code[s],N.send_code(e,o+N.LITERALS+1,t),a=N.extra_lbits[o],a!==0&&(s-=N.base_length[o],N.send_bits(e,s,a)),r--,o=N.d_code(r),N.send_code(e,o,i),a=N.extra_dbits[o],a!==0&&(r-=N.base_dist[o],N.send_bits(e,r,a)));while(n<e.last_lit);N.send_code(e,N.END_BLOCK,t)}static build_tree(e,t){let i=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,n=t.stat_desc.elems,o,a,l=-1,h;for(e.heap_len=0,e.heap_max=N.HEAP_SIZE,o=0;o<n;o++)i[o*2]!==0?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):i[o*2+1]=0;for(;e.heap_len<2;)h=e.heap[++e.heap_len]=l<2?++l:0,i[h*2]=1,e.depth[h]=0,e.opt_len--,s&&(e.static_len-=r[h*2+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)N.pqdownheap(e,i,o);h=n;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],N.pqdownheap(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,i[h*2]=i[o*2]+i[a*2],e.depth[h]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,i[o*2+1]=i[a*2+1]=h,e.heap[1]=h++,N.pqdownheap(e,i,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],N.gen_bitlen(e,t),N.gen_codes(i,l,e.bl_count)}static scan_tree(e,t,i){let r,s=-1,n,o=t[1],a=0,l=7,h=4;for(o===0&&(l=138,h=3),t[(i+1)*2+1]=65535,r=0;r<=i;r++)n=o,o=t[(r+1)*2+1],!(++a<l&&n===o)&&(a<h?e.bl_tree[n*2]+=a:n!==0?(n!==s&&e.bl_tree[n*2]++,e.bl_tree[N.REP_3_6*2]++):a<=10?e.bl_tree[N.REPZ_3_10*2]++:e.bl_tree[N.REPZ_11_138*2]++,a=0,s=n,o===0?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4))}static send_tree(e,t,i){let r,s=-1,n,o=t[1],a=0,l=7,h=4;for(o===0&&(l=138,h=3),r=0;r<=i;r++)if(n=o,o=t[(r+1)*2+1],!(++a<l&&n===o)){if(a<h)do N.send_code(e,n,e.bl_tree);while(--a!==0);else n!==0?(n!==s&&(N.send_code(e,n,e.bl_tree),a--),N.send_code(e,N.REP_3_6,e.bl_tree),N.send_bits(e,a-3,2)):a<=10?(N.send_code(e,N.REPZ_3_10,e.bl_tree),N.send_bits(e,a-3,3)):(N.send_code(e,N.REPZ_11_138,e.bl_tree),N.send_bits(e,a-11,7));a=0,s=n,o===0?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4)}}static build_bl_tree(e){let t;for(N.scan_tree(e,e.dyn_ltree,e.l_desc.max_code),N.scan_tree(e,e.dyn_dtree,e.d_desc.max_code),N.build_tree(e,e.bl_desc),t=N.BL_CODES-1;t>=3&&e.bl_tree[N.bl_order[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}static send_all_trees(e,t,i,r){let s;for(N.send_bits(e,t-257,5),N.send_bits(e,i-1,5),N.send_bits(e,r-4,4),s=0;s<r;s++)N.send_bits(e,e.bl_tree[N.bl_order[s]*2+1],3);N.send_tree(e,e.dyn_ltree,t-1),N.send_tree(e,e.dyn_dtree,i-1)}static detect_data_type(e){let t=4093624447,i;for(i=0;i<=31;i++,t>>>=1)if(t&1&&e.dyn_ltree[i*2]!==0)return L.Z_BINARY;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return L.Z_TEXT;for(i=32;i<N.LITERALS;i++)if(e.dyn_ltree[i*2]!==0)return L.Z_TEXT;return L.Z_BINARY}static _tr_init(e){N.static_init_done||(N.tr_static_init(),N.static_init_done=!0),e.l_desc=new $r(e.dyn_ltree,N.static_l_desc),e.d_desc=new $r(e.dyn_dtree,N.static_d_desc),e.bl_desc=new $r(e.bl_tree,N.static_bl_desc),e.bi_buf=0,e.bi_valid=0,N.init_block(e)}static _tr_stored_block(e,t,i,r){N.send_bits(e,(N.STORED_BLOCK<<1)+(r?1:0),3),N.copy_block(e,t,i,!0)}static _tr_align(e){N.send_bits(e,N.STATIC_TREES<<1,3),N.send_code(e,N.END_BLOCK,N.static_ltree),N.bi_flush(e)}static _tr_flush_block(e,t,i,r){let s,n,o=0;e.level>0?(e.strm.data_type===L.Z_UNKNOWN&&(e.strm.data_type=N.detect_data_type(e)),N.build_tree(e,e.l_desc),N.build_tree(e,e.d_desc),o=N.build_bl_tree(e),s=e.opt_len+3+7>>>3,n=e.static_len+3+7>>>3,n<=s&&(s=n)):s=n=i+5,i+4<=s&&t!==-1?N._tr_stored_block(e,t,i,r):e.strategy===L.Z_FIXED||n===s?(N.send_bits(e,(N.STATIC_TREES<<1)+(r?1:0),3),N.compress_block(e,N.static_ltree,N.static_dtree)):(N.send_bits(e,(N.DYN_TREES<<1)+(r?1:0),3),N.send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),N.compress_block(e,e.dyn_ltree,e.dyn_dtree)),N.init_block(e),r&&N.bi_windup(e)}static _tr_tally(e,t,i){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=i&255,e.last_lit++,t===0?e.dyn_ltree[i*2]++:(e.matches++,t--,e.dyn_ltree[(N._length_code[i]+N.LITERALS+1)*2]++,e.dyn_dtree[N.d_code(t)*2]++),e.last_lit===e.lit_bufsize-1}};m(N,"zlib_Pako_trees");var M=N;M.Z_FIXED=4;M.Z_BINARY=0;M.Z_TEXT=1;M.Z_UNKNOWN=2;M.STORED_BLOCK=0;M.STATIC_TREES=1;M.DYN_TREES=2;M.MIN_MATCH=3;M.MAX_MATCH=258;M.LENGTH_CODES=29;M.LITERALS=256;M.L_CODES=M.LITERALS+1+M.LENGTH_CODES;M.D_CODES=30;M.BL_CODES=19;M.HEAP_SIZE=2*M.L_CODES+1;M.MAX_BITS=15;M.Buf_size=16;M.MAX_BL_BITS=7;M.END_BLOCK=256;M.REP_3_6=16;M.REPZ_3_10=17;M.REPZ_11_138=18;M.extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]);M.extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);M.extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]);M.bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);M.DIST_CODE_LEN=512;M.static_ltree=new Uint16Array((M.L_CODES+2)*2);M.static_dtree=new Uint16Array(M.D_CODES*2);M._dist_code=new Uint16Array(M.DIST_CODE_LEN);M._length_code=new Uint16Array(M.MAX_MATCH-M.MIN_MATCH+1);M.base_length=new Uint16Array(M.LENGTH_CODES);M.base_dist=new Uint16Array(M.D_CODES);M.send_bits=(D,e,t)=>{D.bi_valid>M.Buf_size-t?(D.bi_buf|=e<<D.bi_valid&65535,M.put_short(D,D.bi_buf),D.bi_buf=e>>M.Buf_size-D.bi_valid,D.bi_valid+=t-M.Buf_size):(D.bi_buf|=e<<D.bi_valid&65535,D.bi_valid+=t)};M.gen_bitlen=(D,e)=>{let t=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,n=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,a=e.stat_desc.max_length,l,h,u,_,d,g,y=0;for(_=0;_<=M.MAX_BITS;_++)D.bl_count[_]=0;for(t[D.heap[D.heap_max]*2+1]=0,l=D.heap_max+1;l<M.HEAP_SIZE;l++)h=D.heap[l],_=t[t[h*2+1]*2+1]+1,_>a&&(_=a,y++),t[h*2+1]=_,!(h>i)&&(D.bl_count[_]++,d=0,h>=o&&(d=n[h-o]),g=t[h*2],D.opt_len+=g*(_+d),s&&(D.static_len+=g*(r[h*2+1]+d)));if(y!==0){do{for(_=a-1;D.bl_count[_]===0;)_--;D.bl_count[_]--,D.bl_count[_+1]+=2,D.bl_count[a]--,y-=2}while(y>0);for(_=a;_!==0;_--)for(h=D.bl_count[_];h!==0;)u=D.heap[--l],!(u>i)&&(t[u*2+1]!==_&&(D.opt_len+=(_-t[u*2+1])*t[u*2],t[u*2+1]=_),h--)}};M.static_init_done=!1;M.initDone=M.Zeroinit();var rr=class rr{static inflate_fast(e,t){let i,r,s,n,o,a,l,h,u,_,d,g,y,p,x,w,f,T,R,P,I,F,z,U=e.state;i=e.next_in,F=e.input,r=i+(e.avail_in-5),s=e.next_out,z=e.output,n=s-(t-e.avail_out),o=s+(e.avail_out-257),a=U.wsize,l=U.whave,h=U.wnext,u=U.window,_=U.hold,d=U.bits,g=U.lencode,y=U.distcode,p=(1<<U.lenbits)-1,x=(1<<U.distbits)-1;e:do{d<15&&(_+=F[i++]<<d,d+=8,_+=F[i++]<<d,d+=8),w=g[_&p];t:for(;;){if(f=w>>>24,_>>>=f,d-=f,f=w>>>16&255,f===0)z[s++]=w&65535;else if(f&16){T=w&65535,f&=15,f&&(d<f&&(_+=F[i++]<<d,d+=8),T+=_&(1<<f)-1,_>>>=f,d-=f),d<15&&(_+=F[i++]<<d,d+=8,_+=F[i++]<<d,d+=8),w=y[_&x];i:for(;;){if(f=w>>>24,_>>>=f,d-=f,f=w>>>16&255,f&16)if(R=w&65535,f&=15,d<f&&(_+=F[i++]<<d,d+=8,d<f&&(_+=F[i++]<<d,d+=8)),R+=_&(1<<f)-1,_>>>=f,d-=f,f=s-n,R>f){if(f=R-f,f>l&&U.sane){e.msg="invalid distance too far back",U.mode=rr.BAD;break e}if(P=0,I=u,h===0){if(P+=a-f,f<T){T-=f;do z[s++]=u[P++];while(--f);P=s-R,I=z}}else if(h<f){if(P+=a+h-f,f-=h,f<T){T-=f;do z[s++]=u[P++];while(--f);if(P=0,h<T){f=h,T-=f;do z[s++]=u[P++];while(--f);P=s-R,I=z}}}else if(P+=h-f,f<T){T-=f;do z[s++]=u[P++];while(--f);P=s-R,I=z}for(;T>2;)z[s++]=I[P++],z[s++]=I[P++],z[s++]=I[P++],T-=3;T&&(z[s++]=I[P++],T>1&&(z[s++]=I[P++]))}else{P=s-R;do z[s++]=z[P++],z[s++]=z[P++],z[s++]=z[P++],T-=3;while(T>2);T&&(z[s++]=z[P++],T>1&&(z[s++]=z[P++]))}else if((f&64)===0){w=y[(w&65535)+(_&(1<<f)-1)];continue i}else{e.msg="invalid distance code",U.mode=rr.BAD;break e}break}}else if((f&64)===0){w=g[(w&65535)+(_&(1<<f)-1)];continue t}else if(f&32){U.mode=rr.TYPE;break e}else{e.msg="invalid literal/length code",U.mode=rr.BAD;break e}break}}while(i<r&&s<o);T=d>>3,i-=T,d-=T<<3,_&=(1<<d)-1,e.next_in=i,e.next_out=s,e.avail_in=i<r?5+(r-i):5-(i-r),e.avail_out=s<o?257+(o-s):257-(s-o),U.hold=_,U.bits=d}};m(rr,"zlib_inffast");var wr=rr;wr.BAD=30;wr.TYPE=12;var Jo=class Jo{constructor(){this.mode=0,this.last=0,this.wrap=0,this.havedict=0,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}};m(Jo,"zlib_InflateState");var $o=Jo,Y=class Y{static zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}static inflateResetKeep(e){if(!e||!e.state)return L.Z_STREAM_ERROR;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Y.HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Y.ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(Y.ENOUGH_DISTS),t.sane=1,t.back=-1,L.Z_OK}static inflateReset(e){if(!e||!e.state)return L.Z_STREAM_ERROR;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Y.inflateResetKeep(e)}static inflateReset2(e,t){let i;if(!e||!e.state)return L.Z_STREAM_ERROR;let r=e.state;return t<0?(i=0,t=-t):(i=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?L.Z_STREAM_ERROR:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,Y.inflateReset(e))}static inflateInit2(e,t){if(!e)return L.Z_STREAM_ERROR;let i=new $o;e.state=i,i.window=null;let r=Y.inflateReset2(e,t);return r!==L.Z_OK&&(e.state=null),r}static inflateInit(e){return Y.inflateInit2(e,Y.DEF_WBITS)}static fixedtables(e){if(Y.virgin){Y.lenfix=new Int32Array(512),Y.distfix=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(pt.inflate_table(Y.LENS,e.lens,0,288,Y.lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;pt.inflate_table(Y.DISTS,e.lens,0,32,Y.distfix,0,e.work,{bits:5}),Y.virgin=!1}e.lencode=Y.lenfix,e.lenbits=9,e.distcode=Y.distfix,e.distbits=5}static updatewindow(e,t,i,r){let s,n=e.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),r>=n.wsize?(n.window.set(t.subarray(i-n.wsize,i),0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>r&&(s=r),n.window.set(t.subarray(i-r,i-r+s),n.wnext),r-=s,r?(n.window.set(t.subarray(i-r,i),0),n.wnext=r,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0}static inflate(e,t){let i,r,s,n,o,a,l,h,u,_,d,g,y,p,x=0,w,f,T,R,P,I,F,z,U=new Uint8Array(4),j,se,ne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return L.Z_STREAM_ERROR;i=e.state,i.mode===Y.TYPE&&(i.mode=Y.TYPEDO),o=e.next_out,s=e.output,l=e.avail_out,n=e.next_in,r=e.input,a=e.avail_in,h=i.hold,u=i.bits,_=a,d=l,z=L.Z_OK;e:for(;;)switch(i.mode){case Y.HEAD:if(i.wrap===0){i.mode=Y.TYPEDO;break}for(;u<16;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(i.wrap&2&&h===35615){i.check=0,U[0]=h&255,U[1]=h>>>8&255,i.check=He.crc32(i.check,U,2,0),h=0,u=0,i.mode=Y.FLAGS;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((h&255)<<8)+(h>>8))%31){e.msg="incorrect header check",i.mode=Y.BAD;break}if((h&15)!==L.Z_DEFLATED){e.msg="unknown compression method",i.mode=Y.BAD;break}if(h>>>=4,u-=4,F=(h&15)+8,i.wbits===0)i.wbits=F;else if(F>i.wbits){e.msg="invalid window size",i.mode=Y.BAD;break}i.dmax=1<<i.wbits,e.adler=i.check=1,i.mode=h&512?Y.DICTID:Y.TYPE,h=0,u=0;break;case Y.FLAGS:for(;u<16;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(i.flags=h,(i.flags&255)!==L.Z_DEFLATED){e.msg="unknown compression method",i.mode=Y.BAD;break}if(i.flags&57344){e.msg="unknown header flags set",i.mode=Y.BAD;break}i.head&&(i.head.text=h>>8&1),i.flags&512&&(U[0]=h&255,U[1]=h>>>8&255,i.check=He.crc32(i.check,U,2,0)),h=0,u=0,i.mode=Y.TIME;case Y.TIME:for(;u<32;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.head&&(i.head.time=h),i.flags&512&&(U[0]=h&255,U[1]=h>>>8&255,U[2]=h>>>16&255,U[3]=h>>>24&255,i.check=He.crc32(i.check,U,4,0)),h=0,u=0,i.mode=Y.OS;case Y.OS:for(;u<16;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.head&&(i.head.xflags=h&255,i.head.os=h>>8),i.flags&512&&(U[0]=h&255,U[1]=h>>>8&255,i.check=He.crc32(i.check,U,2,0)),h=0,u=0,i.mode=Y.EXLEN;case Y.EXLEN:if(i.flags&1024){for(;u<16;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.length=h,i.head&&(i.head.extra_len=h),i.flags&512&&(U[0]=h&255,U[1]=h>>>8&255,i.check=He.crc32(i.check,U,2,0)),h=0,u=0}else i.head&&(i.head.extra=null);i.mode=Y.EXTRA;case Y.EXTRA:if(i.flags&1024&&(g=i.length,g>a&&(g=a),g&&(i.head&&(F=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(n,n+g),F)),i.flags&512&&(i.check=He.crc32(i.check,r,g,n)),a-=g,n+=g,i.length-=g),i.length))break e;i.length=0,i.mode=Y.NAME;case Y.NAME:if(i.flags&2048){if(a===0)break e;g=0;do F=r[n+g++],i.head&&F&&i.length<65536&&(i.head.name+=String.fromCharCode(F));while(F&&g<a);if(i.flags&512&&(i.check=He.crc32(i.check,r,g,n)),a-=g,n+=g,F)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=Y.COMMENT;case Y.COMMENT:if(i.flags&4096){if(a===0)break e;g=0;do F=r[n+g++],i.head&&F&&i.length<65536&&(i.head.comment+=String.fromCharCode(F));while(F&&g<a);if(i.flags&512&&(i.check=He.crc32(i.check,r,g,n)),a-=g,n+=g,F)break e}else i.head&&(i.head.comment=null);i.mode=Y.HCRC;case Y.HCRC:if(i.flags&512){for(;u<16;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(h!==(i.check&65535)){e.msg="header crc mismatch",i.mode=Y.BAD;break}h=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Y.TYPE;break;case Y.DICTID:for(;u<32;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}e.adler=i.check=Y.zswap32(h),h=0,u=0,i.mode=Y.DICT;case Y.DICT:if(!i.havedict)return e.next_out=o,e.avail_out=l,e.next_in=n,e.avail_in=a,i.hold=h,i.bits=u,L.Z_NEED_DICT;e.adler=i.check=1,i.mode=Y.TYPE;case Y.TYPE:if(t===L.Z_BLOCK||t===L.Z_TREES)break e;case Y.TYPEDO:if(i.last){h>>>=u&7,u-=u&7,i.mode=Y.CHECK;break}for(;u<3;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}switch(i.last=h&1,h>>>=1,u-=1,h&3){case 0:i.mode=Y.STORED;break;case 1:if(Y.fixedtables(i),i.mode=Y.LEN_,t===L.Z_TREES){h>>>=2,u-=2;break e}break;case 2:i.mode=Y.TABLE;break;case 3:e.msg="invalid block type",i.mode=Y.BAD}h>>>=2,u-=2;break;case Y.STORED:for(h>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if((h&65535)!==(h>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Y.BAD;break}if(i.length=h&65535,h=0,u=0,i.mode=Y.COPY_,t===L.Z_TREES)break e;case Y.COPY_:i.mode=Y.COPY;case Y.COPY:if(g=i.length,g){if(g>a&&(g=a),g>l&&(g=l),g===0)break e;s.set(r.subarray(n,n+g),o),a-=g,n+=g,l-=g,o+=g,i.length-=g;break}i.mode=Y.TYPE;break;case Y.TABLE:for(;u<14;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(i.nlen=(h&31)+257,h>>>=5,u-=5,i.ndist=(h&31)+1,h>>>=5,u-=5,i.ncode=(h&15)+4,h>>>=4,u-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Y.BAD;break}i.have=0,i.mode=Y.LENLENS;case Y.LENLENS:for(;i.have<i.ncode;){for(;u<3;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.lens[ne[i.have++]]=h&7,h>>>=3,u-=3}for(;i.have<19;)i.lens[ne[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,j={bits:i.lenbits},z=pt.inflate_table(Y.CODES,i.lens,0,19,i.lencode,0,i.work,j),i.lenbits=j.bits,z){e.msg="invalid code lengths set",i.mode=Y.BAD;break}i.have=0,i.mode=Y.CODELENS;case Y.CODELENS:for(;i.have<i.nlen+i.ndist;){for(;x=i.lencode[h&(1<<i.lenbits)-1],w=x>>>24,f=x>>>16&255,T=x&65535,!(w<=u);){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(T<16)h>>>=w,u-=w,i.lens[i.have++]=T;else{if(T===16){for(se=w+2;u<se;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(h>>>=w,u-=w,i.have===0){e.msg="invalid bit length repeat",i.mode=Y.BAD;break}F=i.lens[i.have-1],g=3+(h&3),h>>>=2,u-=2}else if(T===17){for(se=w+3;u<se;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}h>>>=w,u-=w,F=0,g=3+(h&7),h>>>=3,u-=3}else{for(se=w+7;u<se;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}h>>>=w,u-=w,F=0,g=11+(h&127),h>>>=7,u-=7}if(i.have+g>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Y.BAD;break}for(;g--;)i.lens[i.have++]=F}}if(i.mode===Y.BAD)break;if(i.lens[256]===0){e.msg="invalid code -- missing end-of-block",i.mode=Y.BAD;break}if(i.lenbits=9,j={bits:i.lenbits},z=pt.inflate_table(Y.LENS,i.lens,0,i.nlen,i.lencode,0,i.work,j),i.lenbits=j.bits,z){e.msg="invalid literal/lengths set",i.mode=Y.BAD;break}if(i.distbits=6,i.distcode=i.distdyn,j={bits:i.distbits},z=pt.inflate_table(Y.DISTS,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,j),i.distbits=j.bits,z){e.msg="invalid distances set",i.mode=Y.BAD;break}if(i.mode=Y.LEN_,t===L.Z_TREES)break e;case Y.LEN_:i.mode=Y.LEN;case Y.LEN:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=n,e.avail_in=a,i.hold=h,i.bits=u,wr.inflate_fast(e,d),o=e.next_out,s=e.output,l=e.avail_out,n=e.next_in,r=e.input,a=e.avail_in,h=i.hold,u=i.bits,i.mode===Y.TYPE&&(i.back=-1);break}for(i.back=0;x=i.lencode[h&(1<<i.lenbits)-1],w=x>>>24,f=x>>>16&255,T=x&65535,!(w<=u);){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(f&&(f&240)===0){for(R=w,P=f,I=T;x=i.lencode[I+((h&(1<<R+P)-1)>>R)],w=x>>>24,f=x>>>16&255,T=x&65535,!(R+w<=u);){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}h>>>=R,u-=R,i.back+=R}if(h>>>=w,u-=w,i.back+=w,i.length=T,f===0){i.mode=Y.LIT;break}if(f&32){i.back=-1,i.mode=Y.TYPE;break}if(f&64){e.msg="invalid literal/length code",i.mode=Y.BAD;break}i.extra=f&15,i.mode=Y.LENEXT;case Y.LENEXT:if(i.extra){for(se=i.extra;u<se;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=Y.DIST;case Y.DIST:for(;x=i.distcode[h&(1<<i.distbits)-1],w=x>>>24,f=x>>>16&255,T=x&65535,!(w<=u);){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if((f&240)===0){for(R=w,P=f,I=T;x=i.distcode[I+((h&(1<<R+P)-1)>>R)],w=x>>>24,f=x>>>16&255,T=x&65535,!(R+w<=u);){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}h>>>=R,u-=R,i.back+=R}if(h>>>=w,u-=w,i.back+=w,f&64){e.msg="invalid distance code",i.mode=Y.BAD;break}i.offset=T,i.extra=f&15,i.mode=Y.DISTEXT;case Y.DISTEXT:if(i.extra){for(se=i.extra;u<se;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,u-=i.extra,i.back+=i.extra}i.mode=Y.MATCH;case Y.MATCH:if(l===0)break e;if(g=d-l,i.offset>g){if(g=i.offset-g,g>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Y.BAD;break}g>i.wnext?(g-=i.wnext,y=i.wsize-g):y=i.wnext-g,g>i.length&&(g=i.length),p=i.window}else p=s,y=o-i.offset,g=i.length;g>l&&(g=l),l-=g,i.length-=g;do s[o++]=p[y++];while(--g);i.length===0&&(i.mode=Y.LEN);break;case Y.LIT:if(l===0)break e;s[o++]=i.length,l--,i.mode=Y.LEN;break;case Y.CHECK:if(i.wrap){for(;u<32;){if(a===0)break e;a--,h|=r[n++]<<u,u+=8}if(d-=l,e.total_out+=d,i.total+=d,d&&(e.adler=i.check=i.flags?He.crc32(i.check,s,d,o-d):xi.adler32(i.check,s,d,o-d)),d=l,(i.flags?h:Y.zswap32(h))!==i.check){e.msg="incorrect data check",i.mode=Y.BAD;break}h=0,u=0}i.mode=Y.LENGTH;case Y.LENGTH:if(i.wrap&&i.flags){for(;u<32;){if(a===0)break e;a--,h+=r[n++]<<u,u+=8}if(h!==(i.total&4294967295)){e.msg="incorrect length check",i.mode=Y.BAD;break}h=0,u=0}i.mode=Y.DONE;case Y.DONE:z=L.Z_STREAM_END;break e;case Y.BAD:z=L.Z_DATA_ERROR;break e;case Y.MEM:return L.Z_MEM_ERROR;case Y.SYNC:default:return L.Z_STREAM_ERROR}return e.next_out=o,e.avail_out=l,e.next_in=n,e.avail_in=a,i.hold=h,i.bits=u,(i.wsize||d!==e.avail_out&&i.mode<Y.BAD&&(i.mode<Y.CHECK||t!==L.Z_FINISH))&&Y.updatewindow(e,e.output,e.next_out,d-e.avail_out)?(i.mode=Y.MEM,L.Z_MEM_ERROR):(_-=e.avail_in,d-=e.avail_out,e.total_in+=_,e.total_out+=d,i.total+=d,i.wrap&&d&&(e.adler=i.check=i.flags?He.crc32(i.check,s,d,e.next_out-d):xi.adler32(i.check,s,d,e.next_out-d)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Y.TYPE?128:0)+(i.mode===Y.LEN_||i.mode===Y.COPY_?256:0),(_===0&&d===0||t===L.Z_FINISH)&&z===L.Z_OK&&(z=L.Z_BUF_ERROR),z)}static inflateEnd(e){if(!e||!e.state)return L.Z_STREAM_ERROR;let t=e.state;return t.window&&(t.window=null),e.state=null,L.Z_OK}static inflateGetHeader(e,t){if(!e||!e.state)return L.Z_STREAM_ERROR;let i=e.state;return(i.wrap&2)===0?L.Z_STREAM_ERROR:(i.head=t,t.done=!1,L.Z_OK)}static inflateSetDictionary(e,t){let i=t.length,r,s,n;return!e||!e.state?L.Z_STREAM_ERROR:(r=e.state,r.wrap!==0&&r.mode!==Y.DICT?L.Z_STREAM_ERROR:r.mode===Y.DICT&&(s=1,s=xi.adler32(s,t,i,0),s!==r.check)?L.Z_DATA_ERROR:(n=Y.updatewindow(e,t,i,i),n?(r.mode=Y.MEM,L.Z_MEM_ERROR):(r.havedict=1,L.Z_OK)))}};m(Y,"zlib_inflate");var ce=Y;ce.CODES=0;ce.LENS=1;ce.DISTS=2;ce.HEAD=1;ce.FLAGS=2;ce.TIME=3;ce.OS=4;ce.EXLEN=5;ce.EXTRA=6;ce.NAME=7;ce.COMMENT=8;ce.HCRC=9;ce.DICTID=10;ce.DICT=11;ce.TYPE=12;ce.TYPEDO=13;ce.STORED=14;ce.COPY_=15;ce.COPY=16;ce.TABLE=17;ce.LENLENS=18;ce.CODELENS=19;ce.LEN_=20;ce.LEN=21;ce.LENEXT=22;ce.DIST=23;ce.DISTEXT=24;ce.MATCH=25;ce.LIT=26;ce.CHECK=27;ce.LENGTH=28;ce.DONE=29;ce.BAD=30;ce.MEM=31;ce.SYNC=32;ce.ENOUGH_LENS=852;ce.ENOUGH_DISTS=592;ce.MAX_WBITS=15;ce.DEF_WBITS=ce.MAX_WBITS;ce.virgin=!0;var Qo=class Qo{static msg(e){switch(e){case 2:return"need dictionary";case 1:return"stream end";case 0:return"";case-1:return"file error";case-2:return"stream error";case-3:return"data error";case-4:return"insufficient memory";case-5:return"buffer error";case-6:return"incompatible version";default:return"unknowwn error"}}};m(Qo,"zlib_messages");var Ni=Qo;var We=class We{static inflate_table(e,t,i,r,s,n,o,a){let l=a.bits,h,u,_=0,d,g,y=0,p=0,x=0,w=0,f=0,T,R,P,I,F,z,U=0,j,se=new Uint16Array(We.MAXBITS+1),ne=new Uint16Array(We.MAXBITS+1),ee,_e=0,te,pe,Xe;for(h=0;h<=We.MAXBITS;h++)se[h]=0;for(u=0;u<r;u++)se[t[i+u]]++;for(g=l,d=We.MAXBITS;d>=1&&se[d]===0;d--);if(g>d&&(g=d),d===0)return s[n++]=1<<24|64<<16|0,s[n++]=1<<24|64<<16|0,a.bits=1,0;for(_=1;_<d&&se[_]===0;_++);for(g<_&&(g=_),x=1,h=1;h<=We.MAXBITS;h++)if(x<<=1,x-=se[h],x<0)return-1;if(x>0&&(e===We.CODES||d!==1))return-1;for(ne[1]=0,h=1;h<We.MAXBITS;h++)ne[h+1]=ne[h]+se[h];for(u=0;u<r;u++)t[i+u]!==0&&(o[ne[t[i+u]]++]=u);if(e===We.CODES?(z=o,ee=new Uint8Array,j=19):e===We.LENS?(z=We.lbase,U-=257,ee=We.lext,_e-=257,j=256):(z=We.dbase,ee=We.dext,j=-1),f=0,u=0,h=_,F=n,y=g,p=0,P=-1,w=1<<g,I=w-1,e===We.LENS&&w>We.ENOUGH_LENS||e===We.DISTS&&w>We.ENOUGH_DISTS)return 1;for(;;){te=h-p,o[u]<j?(pe=0,Xe=o[u]):o[u]>j?(pe=ee[_e+o[u]],Xe=z[U+o[u]]):(pe=96,Xe=0),T=1<<h-p,R=1<<y,_=R;do R-=T,s[F+(f>>p)+R]=te<<24|pe<<16|Xe|0;while(R!==0);for(T=1<<h-1;f&T;)T>>=1;if(T!==0?(f&=T-1,f+=T):f=0,u++,--se[h]===0){if(h===d)break;h=t[i+o[u]]}if(h>g&&(f&I)!==P){for(p===0&&(p=g),F+=_,y=h-p,x=1<<y;y+p<d&&(x-=se[y+p],!(x<=0));)y++,x<<=1;if(w+=1<<y,e===We.LENS&&w>We.ENOUGH_LENS||e===We.DISTS&&w>We.ENOUGH_DISTS)return 1;P=f&I,s[P]=g<<24|y<<16|F-n|0}}return f!==0&&(s[F+f]=h-p<<24|64<<16|0),a.bits=g,0}};m(We,"zlib_inftrees");var pt=We;pt.MAXBITS=15;pt.ENOUGH_LENS=852;pt.ENOUGH_DISTS=592;pt.CODES=0;pt.LENS=1;pt.DISTS=2;pt.lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]);pt.lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]);pt.dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]);pt.dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var el=class el{constructor(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}};m(el,"zlib_ZStream");var jr=el;var kt=function(D,e,t,i){function r(s){return s instanceof t?s:new t(function(n){n(s)})}return m(r,"adopt"),new(t||(t=Promise))(function(s,n){function o(h){try{l(i.next(h))}catch(u){n(u)}}m(o,"fulfilled");function a(h){try{l(i.throw(h))}catch(u){n(u)}}m(a,"rejected");function l(h){h.done?s(h.value):r(h.value).then(o,a)}m(l,"step"),l((i=i.apply(D,e||[])).next())})},C=class C{edit(e){C.widgets[e].edit()}static get editMenuItem(){return C._editMenuItem}static get deleteMenuItem(){return C._deleteMenuItem}static get disableMarkerMenuItem(){return C._disableMarkerMenuItem}static get clearDataloggerMenuItem(){return C._clearDataloggerMenuItem}static get addMarkerMenuItem(){return C._addMarkerMenuItem}static get markersSubMenuItems(){return C._markersSubMenuItems}static get contextMarkerSubMenu(){return C._contextMarkerSubMenu}static get contextWidgetsSubMenu(){return C._contextWidgetsSubMenu}static get resetDataViewMenuItem(){return C._resetDataViewMenuItem}static get snapshotMenuItem(){return C._snapshotMenuItem}static applicationGlobalinit(){if(C._MarkerCountPerXaxis==0){let e=new Qi,t=de.getAllProperties(e);for(let i in t.byName)i.startsWith("markers")&&C._MarkerCountPerXaxis++}if(C.manager==null&&(C.manager=new oe),!C.readonly&&C._editor==null&&(C._editor=new tr),!C.readonly&&C._mainform==null&&(C._mainform=new Sr),C._contextMenu==null){C._contextMenu=new tt(C.baseSize,(e,t)=>{C.menuIsOpening(e,t)},S.generalFontFamily),C._contextMarkerSubMenu=new Ar(C.baseSize,C._contextMenu,null,S.generalFontFamily);for(let e=0;e<C._MarkerCountPerXaxis;e++)C._markersSubMenuItems.push(C._contextMarkerSubMenu.addMenuItem(J.AddMarkerIcon(C.baseSize.toString(),e+1),"Place marker "+(e+1).toString(),()=>{C._markersSubMenuItems[e].userdata.startMarkerCapture(e)}));C.readonly||(C._contextWidgetsSubMenu=new Ar(C.baseSize,C._contextMenu,(e,t)=>{C.WidgetsSubMenuIsOpening(e,t)},S.generalFontFamily),C._widgetsMenuItem=C._contextMenu.addSubMenuItem(J.AllIcon(C.baseSize.toString(),!1,!1,!1,!1),"All widgets",C._contextWidgetsSubMenu),C._editMenuItem=C._contextMenu.addMenuItem(J.EditIcon(C.baseSize.toString(),!1,!1,!1,!1),"Configure this widget",()=>{C.editWidget()}),C._deleteMenuItem=C._contextMenu.addMenuItem(J.TrashIcon(C.baseSize.toString(),!1,!1,!1,!1),"Delete this widget",()=>{C.deleteWidget()}),C._editMenuItem.visible=!1,C._deleteMenuItem.visible=!1),C._resetDataViewMenuItem=C._contextMenu.addMenuItem(J.resetViewPort(C.baseSize.toString(),!1,!1,!1,!1),"Reset dataview",()=>{C.resetDataView()}),C._resetDataViewMenuItem.visible=!1,C.readonly||(C._clearDataloggerMenuItem=C._contextMenu.addMenuItem(J.EraseDatalogger(C.baseSize.toString(),!1,!1,!1,!1),"Clear datalogger",()=>{C.clearDatalogger()}),C._resetDataViewMenuItem.visible=!1),C._contextMenu.AddSeparator(),C.readonly||(C._addMarkerMenuItem=C._contextMenu.addSubMenuItem(J.AddMarker(C.baseSize.toString(),!1,!0,!0,!1),"Place markers",C._contextMarkerSubMenu),C._disableMarkerMenuItem=C._contextMenu.addMenuItem(J.DeleteMarker(C.baseSize.toString(),!1,!0,!1,!0),"Disable Allmarkers",()=>{C.disableAllMarker()}),C._addMarkerMenuItem.visible=!1,C._disableMarkerMenuItem.visible=!1,C._contextMenu.AddSeparator(),C._contextMenu.addMenuItem(J.SolidGaugeIcon(C.baseSize.toString(),!1,!0,!0,!1),"Add a new Solid gauge",()=>{C.newGaugeWidget()}),C._contextMenu.addMenuItem(J.AngularGaugeIcon(C.baseSize.toString(),!1,!0,!0,!1),"Add a new Angular gauge",()=>{C.newAngularGaugeWidget()}),C._contextMenu.addMenuItem(J.DigitalDisplayIcon(C.baseSize.toString(),!1,!0,!0,!1),"Add a new Digital Display",()=>{C.newDigitalDisplayWidget()}),C._contextMenu.addMenuItem(J.GraphIcon(C.baseSize.toString(),!1,!0,!0,!1),"Add a new Graph",()=>{C.newGraphWidget()})),C._contextMenu.addMenuItem(J.RawDataIcon(C.baseSize.toString(),!1,!1,!1,!1),"Show raw data",()=>{Xt.show()}),C._snapshotMenuItem=C._contextMenu.addMenuItem(J.snapshotIcon(C.baseSize.toString(),!1,!1,!1,!1),"Snapshot",()=>{C.snapShot()}),C.readonly||(C._contextMenu.AddSeparator(),C._contextMenu.addMenuItem(J.ConfigureIcon(C.baseSize.toString(),!1,!1,!1,!1),"Global configuration",()=>{ye.show()}),C._contextMenu.addMenuItem(J.SaveIcon(C.baseSize.toString(),!1,!1,!1,!1),"Save now",()=>{C.save(!0)})),C._contextMenu.addMenuItem(J.LogFileIcon(C.baseSize.toString(),!1,!1,!1,!1),"Show logs",()=>{C.showLogsWindow()})}}static RegisterDeviceArrivalCallback(e){oe.RegisterDeviceArrivalCallback(e)}static RegisterDeviceRemovalCallback(e){oe.RegisterDeviceRemovalCallback(e)}static WidgetsSubMenuIsOpening(e,t){C._contextWidgetsSubMenu.clearAllContents();for(let i=0;i<C.widgets.length;i++){let r="",s=new Ar(C.baseSize,C._contextWidgetsSubMenu,(n,o)=>{C.specificWidgetSubMenuIsOpening(s,n,o)},S.generalFontFamily);s.userdata=C.widgets[i],C.widgets[i]instanceof gt&&(r=J.GraphIcon(C.baseSize.toString(),!1,!1,!1,!1)),C.widgets[i]instanceof Gi&&(r=J.DigitalDisplayIcon(C.baseSize.toString(),!1,!1,!1,!1)),C.widgets[i]instanceof Hi&&(r=J.SolidGaugeIcon(C.baseSize.toString(),!1,!1,!1,!1)),C.widgets[i]instanceof vi&&(r=J.AngularGaugeIcon(C.baseSize.toString(),!1,!1,!1,!1)),C._contextWidgetsSubMenu.addSubMenuItem(r,C.widgets[i].Text,s)}}static specificWidgetSubMenuIsOpening(e,t,i){if(e.menuItemsCount>0)return;let r=e.userdata;e.addMenuItem(J.EditIcon(C.baseSize.toString(),!1,!1,!1,!1),"Configure",()=>{r.edit()}),e.addMenuItem(J.TrashIcon(C.baseSize.toString(),!1,!1,!1,!1),"Delete",()=>{C.deleteWidget(r)}),r instanceof gt&&(e.addMenuItem(J.resetViewPort(C.baseSize.toString(),!1,!1,!1,!1),"Reset dataview",()=>{r.resetDataView()}),e.addMenuItem(J.EraseDatalogger(C.baseSize.toString(),!1,!1,!1,!1),"Clear datalogger",()=>{r.clearDataLogger()}))}static showLogsWindow(){Z.show()}static snapShot(){C._snapshotMenuItem.userdata.snapshot()}static menuIsOpening(e,t){C.disableMarkerMenuItem!=null&&(C.disableMarkerMenuItem.visible=!1),C.addMarkerMenuItem!=null&&(C.addMarkerMenuItem.visible=!1),C.clearDataloggerMenuItem!=null&&(C.clearDataloggerMenuItem.visible=!1),C.editMenuItem!=null&&(C.editMenuItem.visible=!1),C.deleteMenuItem!=null&&(C.deleteMenuItem.visible=!1),C.resetDataViewMenuItem.visible=!1,C.snapshotMenuItem.visible=!1;for(let i=0;i<C.widgets.length;i++)C.widgets[i].contextMenuCallBack(e,t);C._widgetsMenuItem.visible=!C.readonly&&C.widgets.length>0&&!C._editMenuItem.visible,C._contextMenu.refresh()}static resetDataView(){C._resetDataViewMenuItem.userdata.resetDataView()}static editWidget(){C._editMenuItem.userdata.edit()}static disableAllMarker(){C._disableMarkerMenuItem.userdata.disableAllMarkers()}static clearDatalogger(){C._clearDataloggerMenuItem.userdata.clearDataLogger()}static deleteWidget(e){let t=typeof e=="undefined"?C._deleteMenuItem.userdata:e;pi.ask(t.confirmDeleteString,()=>{!C.readonly&&t.isBeingEdited&&C._editor!=null&&C._editor.hide(),t.delete(),S.edited=!0;for(let i=C.widgets.length-1;i>=0;i--)C.widgets[i]==t&&C.widgets.splice(i,1);C.widgets.length<=0&&C._mainform!=null&&C._mainform.show()},null,null)}static FindUniqueNewName(e){let t=1;for(let i=0;i<C.widgets.length;i++)C.widgets[i].Text.startsWith(e)&&t++;return t>1&&(e=e+" "+t.toString()),e}static newGraphWidget(){let e=window.innerWidth/2>>0,t=window.innerHeight/2>>0;e<350&&(e=350),t<200&&(e=200);let i=(window.innerWidth-e)/2>>0,r=(window.innerHeight-t)/2>>0,s=C.widgets.length;s>0&&(i=s*25,r=s*25);let n=new gt(null,C._editor,i,r,765,470);n.set_name(C.FindUniqueNewName("New Graph")),C.widgets.push(n),n.resize(e,t),this._mainform!=null&&this._mainform.hide(),C.readonly||C._editor!=null&&C._editor.visible&&n.edit()}static newAngularGaugeWidget(){let e=Math.min(window.innerWidth,window.innerHeight)/2;e<350&&(e=350);let t=(window.innerWidth-e)/2>>0,i=(window.innerHeight-e)/2>>0,r=e>>0,s=e>>0,n=C.widgets.length;n>0&&(t=n*25,i=n*25);let o=new vi(null,C._editor,t,i,375,300);o.set_name(C.FindUniqueNewName("New Angular Gauge")),C.widgets.push(o),o.resize(r,s),this._mainform!=null&&this._mainform.hide(),C.readonly||C._editor!=null&&C._editor.visible&&o.edit()}static newGaugeWidget(){let e=Math.min(window.innerWidth,window.innerHeight)/2;e<350&&(e=350);let t=(window.innerWidth-e)/2>>0,i=(window.innerHeight-e)/2>>0,r=e>>0,s=e>>0,n=C.widgets.length;n>0&&(t=n*25,i=n*25);let o=new Hi(null,C._editor,t,i,355,201);o.set_name(C.FindUniqueNewName("New Solid Gauge")),C.widgets.push(o),o.resize(r,s),this._mainform!=null&&this._mainform.hide(),C.readonly||C._editor!=null&&C._editor.visible&&o.edit()}static newDigitalDisplayWidget(){let e=Math.min(window.innerWidth,window.innerHeight)/8;e<90&&(e=90);let t=(window.innerWidth-4*e)/2>>0,i=(window.innerHeight-e)/2>>0,r=4*e>>0,s=e>>0,n=C.widgets.length;n>0&&(t=n*25,i=n*25);let o=new Gi(null,C._editor,t,i,410,125);o.set_name(C.FindUniqueNewName("New Digital Display"));let a=1;for(let l=0;l<C.widgets.length;l++)C.widgets[l].Text.startsWith(o.Text)&&a++;a>1&&(o.Text=o.Text+" "+a.toString()),C.widgets.push(o),o.resize(r,s),this._mainform!=null&&this._mainform.hide(),C.readonly||C._editor!=null&&C._editor.visible&&o.edit()}static refreshPropertiesForm(){!C.readonly&&C._editor!=null&&C._editor.refresh()}static sensorListHaschanged(){C.refreshPropertiesForm()}static EmptyReadonlyConfig(){yi.show(`Yocto-Visualization Error

Configuration is both empty and read only, check configuration file.`)}static ForceReloadConfig(e){return kt(this,void 0,void 0,function*(){C.readonly||(C._editor!=null&&(C._editor.visible=!1),ye.hide(),Xt.hide(),ui.hide()),Z.log("Reloading the whole configuration."),yield oe.clearHublist();for(let t=C.widgets.length-1;t>=0;t--)C.widgets[t].destroy(),C.widgets.splice(t,1);C.loadFromXML(e),S.edited=!1})}static ConfigChanged(e){C.ConfigChangedConfirmWindows!=null&&C.ConfigChangedConfirmWindows.hide();let t=S.crc32(e);t!=C.xmlDataCRC&&(Z.log("Config file changed behind our back!"),this.readonly?C.ForceReloadConfig(e):C.ConfigChangedConfirmWindows=pi.ask(`Configuration has changed on server
Would you like to reload it?`,()=>{C.ForceReloadConfig(e),C.ConfigChangedConfirmWindows=null},()=>{C.ConfigChangedConfirmWindows=null},null),C.xmlDataCRC=t,S.edited=!1)}static ShowSaveReminder(e){C.saveIntDiv==null&&(C.saveIntDiv=document.createElement("DIV"),C.saveIntDiv.style.position="fixed",C.saveIntDiv.style.left="5px",C.saveIntDiv.style.top="5px",C.saveIntDiv.style.zIndex="200000",C.saveIntDiv.style.cursor="pointer",C.saveIntDiv.innerHTML=J.SaveNeededIcon((48*S.guiDPIFactor).toString(),!1,!1,!1,!1),C.saveIntDiv.addEventListener("click",()=>{C.saveIntDiv.style.display="none",C.save(!0)}),document.body.appendChild(C.saveIntDiv)),C.saveIntDiv.style.display=e?"":"none"}static loadFromXML(e){if(e==""){!C.readonly&&C._mainform!=null?C._mainform.show():C.EmptyReadonlyConfig();return}let i=new DOMParser().parseFromString(e.replace("<!-->","<!-- "),"application/xml"),r=null;if(i.childNodes.forEach(s=>{s.nodeName.toUpperCase()=="ROOT"&&r==null&&(r=s)}),r==null)throw"No ROOT top node in XML data";r.childNodes.forEach(s=>{s.nodeName.toUpperCase()=="SENSORS"&&oe.setKnownSensors(new mi(s))}),r.childNodes.forEach(s=>{let n=null;switch(n=C._editor,s.nodeName.toUpperCase()){case"CONFIG":S.Init(new mi(s));break;case"GRAPHFORM":C.widgets.push(new gt(new mi(s),n));break;case"ANGULARGAUGEFORM":C.widgets.push(new vi(new mi(s),n));break;case"GAUGEFORM":C.widgets.push(new Hi(new mi(s),n));break;case"DIGITALDISPLAYFORM":C.widgets.push(new Gi(new mi(s),n));break}oe.registerChangeCallback(()=>{C.sensorListHaschanged()}),s.nodeName.toUpperCase()=="ROOT"&&r==null&&(r=s)}),C.widgets.length<=0?(S.edited=!1,!C.readonly&&C._mainform!=null?C._mainform.show():C.EmptyReadonlyConfig()):!C.readonly&&C._mainform!=null&&C._mainform.hide()}static AnimateNewVerwsionMessage(e){C.NewVersionmessageDiv.style.left=Math.round(100-e)+"%",e<100&&(e+=2,e>100&&(e=100),setTimeout(()=>{C.AnimateNewVerwsionMessage(e)}))}static StartInstaller(e){let t=document.createElement("DIV");t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%,-50%)",t.style.width="550px",t.style.height="380px",t.style.zIndex=C.getTopZIndex().toString(),t.style.border="1px solid black",t.style.boxShadow="rgba(0, 0, 0, 0.05) 4px 4px 4px 1px",document.body.appendChild(t);let i={};e!=null&&(i={protocol:e.protocol,addr:e.addr,port:parseInt(e.port),path:e.path,cancelable:!0}),window.startYV4W_installer(t,i)}static DownloadAndStartInstaller(e,t,i){clearTimeout(i),console.log("Downloading installer ("+e+")...");let r=document.createElement("P");r.style.textAlign="center",r.style.fontFamily=S.generalFontFamily,r.style.fontSize="16px",r.innerHTML="Downloading Installer<br>Please wait...",C.NewVersionmessageDiv.removeChild(C.NewVersionmessageDiv.firstChild),C.NewVersionmessageDiv.appendChild(r);let s=document.createElement("script");s.async=!1,s.type="module",s.onerror=n=>{console.log("Failed to donwload installer ("+Event.toString()+")"),r.innerHTML="Failed to download installer,<br>Check conole logs"},s.onload=()=>{r.innerHTML="Starting installer...",C.DeleteNewVersionMessage(100),C.StartInstaller(t)},document.body.appendChild(s),s.src=e}static DeleteNewVersionMessage(e){if(e-=5,e>0){C.NewVersionmessageDiv.style.opacity=(e/100).toString(),setTimeout(()=>{C.DeleteNewVersionMessage(e)},100);return}document.body.removeChild(C.NewVersionmessageDiv.parentNode)}static getTopZIndex(){for(var e=document.getElementsByTagName("DIV"),t=0,i=0;i<e.length;i++){var r=Number.parseInt(window.getComputedStyle(e[i],null).getPropertyValue("z-index"));r>t&&(t=r)}return t+1}static CheckForNewVersion(e){return kt(this,void 0,void 0,function*(){if(!S.mustCheckForUpdate&&!e)return;let t=location.protocol+"//www.yoctopuce.com/FR/common/getLastFirmwareLink.php?app=yoctovisualization4web.installer&version="+S.buildVersion+"&platform=_",i;try{i=yield fetch(t)}catch(R){return}if(!i.ok)return;let r;try{r=yield i.json()}catch(R){return}if(!(r instanceof Array)||r.length<=0||!("version"in r[0])||!("link"in r[0]))return;let s=r[0].link,n=parseInt(r[0].version),o=S.trueBuild,a=0;if(o.indexOf("-")<0){let R=o.lastIndexOf(".");R>=0&&(o=o.substr(R+1)),a=parseInt(o)}if(a>=n)return;let l=S.generalFontSize,h=l*24,u=l*5,_=document.createElement("DIV");_.style.position="absolute",_.style.width=h+"px",_.style.height=u+"px",_.style.zIndex=C.getTopZIndex().toString(),_.style.top="5px",_.style.right="0px",_.style.overflow="hidden",document.body.appendChild(_),C.NewVersionmessageDiv=document.createElement("DIV"),C.NewVersionmessageDiv.style.position="absolute",C.NewVersionmessageDiv.style.width=h-7+"px",C.NewVersionmessageDiv.style.height=u-2+"px",C.NewVersionmessageDiv.style.backgroundColor="GhostWhite",C.NewVersionmessageDiv.style.border="1px solid dimgray",C.NewVersionmessageDiv.style.top="0px",C.NewVersionmessageDiv.style.left=h+"px";let d=document.createElement("TABLE");d.style.fontFamily=S.generalFontFamily,d.style.fontSize=l+"px";let g=document.createElement("TR"),y=document.createElement("TD");y.style.paddingLeft="5px",y.style.paddingRight="10px",y.rowSpan=2,y.style.verticalAlign="middle",y.innerHTML=J.infoIcon((l*4).toString(),!1,!1,!1,!1,"information"),g.appendChild(y);let p=document.createElement("TD");p.innerHTML="A new Yocto-Visualization (for web)<br>version is available",g.appendChild(p),d.appendChild(g),g=document.createElement("TR"),p=document.createElement("TD"),p.style.textAlign="right",p.style.verticalAlign="bottom";let x=oe.hubList,w=null;for(let R=0;R<x.length;R++)x[R].removable||(w=x[R]);let f=document.createElement("A"),T=setTimeout(()=>{C.DeleteNewVersionMessage(100)},5e3);f.style.fontSize="12px",f.style.color=" #0000EE",f.style.textDecoration="underline",f.style.cursor="pointer",f.style.fontFamily=S.generalFontFamily,f.style.fontSize=l+"px",w!=null?(f.innerText="Download and start installer..",f.addEventListener("click",()=>{C.DownloadAndStartInstaller(s,w,T)})):(f.innerText="www.yoctopuce.com",f.addEventListener("click",()=>{window.location.assign("http://www.yoctopuce.com/EN/tools.php")})),p.appendChild(f),g.appendChild(p),d.appendChild(g),C.NewVersionmessageDiv.appendChild(d),_.appendChild(C.NewVersionmessageDiv),C.AnimateNewVerwsionMessage(0)})}static run(e,t,i){typeof t!="undefined"&&t!=null&&oe.registerChangeExternalCallback(t),C.xmlDataCRC=S.crc32(e),typeof i!="undefined"&&(C._saveFunction=i),Z.log("Application start, Welcome to Yocto-Visualization (for web)."),Z.log("This application contains code ported from the Pako library (www.github.com/nodeca/pako)."),Z.log("Yocto-Visualization (for web) version is "+S.buildVersion),Z.log("Yoctopuce API version is "+E.imm_GetAPIVersion()),S.RunningOnAndroid&&Z.log("Browser is running on Android");let r=Math.round(2.54*S.deviceScreenWidth/S.screenDPI),s=Math.round(2.54*S.deviceScreenHeight/S.screenDPI);Z.log("Reported screen size is "+S.deviceScreenWidth.toString()+"x"+S.deviceScreenHeight.toString()+" at "+S.screenDPI+" dpi, (~"+r.toString()+"x"+s.toString()+"cm) "),Z.log("Reported pixel ratio is "+window.devicePixelRatio.toString()),Z.log(S.isPhoneOrTablet?"Probably running on a tablet or a phone.":"Probably running on a desktop."),Z.log((S.guiDPIFactorWasOverriden?"DPI based zoom overridden  to ":"DPI based zoom factor set to ")+S.guiDPIFactor.toFixed(1)),Z.log("Reported window inner size ="+window.innerWidth.toString()+"x"+window.innerHeight.toString()+"px"),C.applicationGlobalinit(),oe.run(),C.loadFromXML(e),S.edited=!1,C.CheckForNewVersion(!1)}static pageIsleaving(e){return kt(this,void 0,void 0,function*(){e.persistent||S.edited&&(yield C.save(!1),yield E.FreeAPI())})}static refreshEditor(){C.readonly||C._editor!=null&&C._editor.refresh()}static EditObject(e,t,i,r,s){C.readonly||C._editor!=null&&C._editor.showWindow(e,t,i,r,s)}static get_XmlData(){let e=`<?xml version="1.0" ?>
<!--
   **************************************************
   Yocto-Visualization (for web)  configuration file
   **************************************************
-->
<ROOT version='2.1'>
<!-- in 2.1 version, floating point values are saved in CultureInfo.InvariantCulture form -->
`;e+=S.GetXMLConfiguration();for(let t=0;t<C.widgets.length;t++)C.widgets[t]instanceof gt&&(e+=C.widgets[t].getConfigData()),C.widgets[t]instanceof vi&&(e+=C.widgets[t].getConfigData()),C.widgets[t]instanceof Hi&&(e+=C.widgets[t].getConfigData()),C.widgets[t]instanceof Gi&&(e+=C.widgets[t].getConfigData());return e+=oe.getXMLSensorsConfig(),e+=`</ROOT>
`,e}static get readonly(){let e=!0;return e=C._saveFunction==null,e}static runInternalTest(){return kt(this,void 0,void 0,function*(){})}static save(e){return kt(this,void 0,void 0,function*(){if(C.readonly)return!0;let t=this.get_XmlData(),i=S.crc32(t);if(!e&&i==C.xmlDataCRC)return!0;let r=m((s,n)=>{let o=document.createElement("DIV");o.style.position="Fixed",o.style.left="5px",o.style.top="5px",o.style.padding="2px 5px 2px 5px",o.style.margin="2px 2px 2px 2px",o.style.border="1px solid darkgreen",o.style.fontFamily="Arial",o.style.fontSize=(12*S.guiDPIFactor).toString(),o.style.whiteSpace="nowrap",o.style.zIndex="200000",o.style.textAlign="center",o.style.opacity="1";let a=s?"darkgreen":"darkred",l=s?"#b9eea9":"#eea9a9";o.style.opacity="1",o.style.backgroundColor=l,o.style.border="1px solid "+a,o.style.color=a,o.innerText=n,document.body.appendChild(o),setTimeout(()=>{C.handleSavedNotification(o)},100)},"saveDoneCallback");try{if(C._saveFunction!=null)return yield C._saveFunction(this.get_XmlData(),r)}catch(s){return r(!1,"Save failed"),yi.show(`Configuration save failed, sorry
`+s.message),!1}return C.xmlDataCRC=i,Z.log("Configuration saved."),S.edited=!1,!0})}static handleSavedNotification(e){let t=parseFloat(e.style.opacity)-.05;if(t<0){document.body.removeChild(e);return}e.style.opacity=t.toString(),setTimeout(()=>{C.handleSavedNotification(e)},100)}static Dummysave(e){let t=document.createElement("PRE");return t.innerText=e,document.body.appendChild(t),!0}};m(C,"YWebPage");var O=C;O.baseSize=18*S.generalSizeCoef;O.xmlDataCRC=0;O.widgets=[];O._markersSubMenuItems=[];O._editor=null;O._mainform=null;O._saveFunction=null;O._MarkerCountPerXaxis=0;O.ConfigChangedConfirmWindows=null;O.saveIntDiv=null;var il=class il{constructor(e,t,i){this._data=e,this._status=t,this._statusText=i}get data(){return this._data}get status(){return this._status}get statusText(){return this._statusText}};m(il,"HTTPrequestResult");var Jr=il,rl=class rl{get protocol(){return this._protocol}get addr(){return this._addr}get port(){return this._port}get path(){return this._path}get userPassword(){return this._userPassword}get adminPassword(){return this._adminPassword}get serial(){return this._serial}get srvUsername(){return this._srvusername!=null?this._srvusername:""}get srvPassword(){return this._srvpassword!=null?this._srvpassword:""}constructor(e,t,i,r,s,n){this._userPassword=!1,this._adminPassword=!1,this._cred="",this._serial="",this._srvusername=null,this._srvpassword=null,e.slice(-1)==":"&&(e=e.slice(0,-1)),this._protocol=e,this._addr=t,this._port=i,this._protocol=e,this._path=r,s!==void 0&&(this._srvusername=s),n!==void 0&&(this._srvpassword=n),this._path!=""&&this._path.charAt(0)=="/"&&(this._path=this._path.slice(1)),this._path!=""&&this._path.slice(-1)=="/"&&(this._path=this._path.slice(0,-1))}get_hubUrl(e,t){let i=this.protocol+"://";return typeof e!="undefined"&&e!=""&&e!=""&&(i+=e+":"+t+"@"),i+=this.addr+":"+this.port.toString(),this.path!=""&&(i+="/"+this.path),i}makeRequest(){return kt(this,void 0,void 0,function*(){let e=this._protocol+"://"+this._addr+":"+this._port.toString();this._path!=""&&(e+="/"+this._path),e+="/info.json";let t;try{t=yield fetch(e,{mode:"cors"})}catch(i){return-3}if(t.ok){let i;try{i=yield t.json()}catch(r){return-1}if(i.port&&i.port.length>0){let r=i.port[0].split(":");this._protocol=r[0],this._port=parseInt(r[1])}return this._serial=i.serialNumber,this._path=i.dir,this._adminPassword=i.adminPassword.toUpperCase()=="TRUE",this._userPassword=i.userPassword.toUpperCase()=="TRUE",!0}return t.status==404&&this._path!=""?-2:t.status==0&&t.statusText==null?-3:t.status})}findChild(e,t){let i=null;return e.childNodes.forEach(r=>{if(r.nodeName==t){i=r;return}}),i}findOutCredentialsFromConfigFile(e){if(e==null)return;let i=new DOMParser().parseFromString(e,"application/xml"),r=this.findChild(i,"ROOT");if(r==null)return;let s=this.findChild(r,"Config");if(s==null)return;let n=this.findChild(s,"Hubs");if(n==null)return;let o,a=n.childNodes,l=!1;for(let h=0;h<a.length;h++)if(a[h].nodeName=="Hub"){let _=new mi(a[h]).Attributes,d=_.hasOwnProperty("addr")?_.addr:"",g=_.hasOwnProperty("port")?_.port:"80",y=_.hasOwnProperty("protocol")?_.protocol:"",p=_.hasOwnProperty("path")?_.path:"",x=_.hasOwnProperty("user")?_.user:"",w=_.hasOwnProperty("password")?_.password:"",f=d.toUpperCase();f.substring(0,4)=="WWW."&&(f=f.substring(4));let T=this._addr.toUpperCase();T.substring(0,4)=="WWW."&&(T=T.substring(4)),f==T&&p==this._path&&(this._srvusername=x,this._srvpassword=oi.Decrypt(w,oi.loginCypherPassword))}}};m(rl,"HubInfo");var tl=rl,Lt=class Lt{constructor(e){this.filename="",this.xmldata="",this.htmlSrcCode="",this.FileSystemAccessDenied=!1,this._XMLConfigFileChanged=null,this.fileSystem=null,this.fileSystemReady=!1,this.configFileCRC=-1,this.info=e}init(e){return kt(this,void 0,void 0,function*(){let t=location.href;this.filename=t.substring(t.lastIndexOf("/")+1);let i=this.filename.indexOf("?");i>0&&(this.filename=this.filename.substring(0,i)),this.htmlSrcCode=document.documentElement.outerHTML,typeof e=="undefined"||e==""?this.xmldata=`<?xml version="1.0" ?>
<ROOT version="2.1">
<Config>
<Hubs>
<Hub protocol="`+this.info.protocol+'" addr="'+this.info.addr+'" port="'+this.info.port.toString()+'"'+(this.info.path!=""?' path="'+this.info.path+'"':"")+` removable="FALSE"/>
</Hubs>
</Config>
</ROOT>
`:this.xmldata=e,this.fileSystem=null,this.fileSystemReady=!1,yield this.findSourceFileSystem(e)})}static start(e){return kt(this,void 0,void 0,function*(){let t=location.pathname,i="80",r=t.lastIndexOf("/");r>0?t=t.slice(0,r):t="",location.protocol=="https:"&&(i="443");let s=new tl(location.protocol,location.hostname,parseInt(location.port?location.port:i),t);yield s.makeRequest();let n=new Lt(s);return yield n.init(e),n})}get xmlConfigData(){return this.xmldata}static makeRequest(e,t,i,r){return new Promise(function(s,n){let o=new XMLHttpRequest;i!==void 0&&r!==void 0&&i!=null&&r!==null?(o.open(e,t,!0,i,r),o.withCredentials=!0):o.open(e,t),o.overrideMimeType("text/plain; charset=x-user-defined"),o.onreadystatechange=function(){o.readyState==4&&(this.status>=200&&this.status<300?s(new Jr(E.imm_str2bin(o.response),this.status,o.statusText)):s(new Jr(null,this.status,o.statusText)))},o.onerror=function(){s(new Jr(null,this.status,o.statusText))},o.send()})}findSourceFileSystem(e){return kt(this,void 0,void 0,function*(){this.fileSystem=null;let t=new Dt;this.info.findOutCredentialsFromConfigFile(e);let i=this.info.get_hubUrl(this.info.srvUsername,this.info.srvPassword),r=E.SUCCESS,s="";try{r=yield E.RegisterHub(i,t),s=t.msg}catch(o){r=o.errorType,s=o.message}if(r!=E.SUCCESS){if(this.fileSystemReady=!1,r==E.UNAUTHORIZED){console.log("Access to hub "+i+" is denied, waiting for YV callback to save the situation."),this.FileSystemAccessDenied=!0;return}throw"YV4F ERROR: Unable to register Hub "+this.info.get_hubUrl()+"("+s+"), save will not work."}let n=Ui.FirstFiles();if(n==null)throw this.fileSystemReady=!0,"YV4F ERROR: No file system found on Hub "+this.info.get_hubUrl()+", save will not work.";for(;n!=null;){if((yield n.get_serialNumber())==this.info.serial){yield this.registerSourceFileSystem(n);return}n=n.nextFiles()}for(n=Ui.FirstFiles();n!=null;){let a=yield(yield n.get_module()).get_url();console.log("URL = ("+a+")");let l=a.indexOf("://");if(l>=0&&(a=a.slice(l+3)),l=a.indexOf(":"),l>0&&(a=a.slice(0,l)),a==this.info.addr){yield this.registerSourceFileSystem(n);return}n=n.nextFiles()}throw this.fileSystemReady=!0,"YV4F ERROR: No file system matching Hub "+this.info.get_hubUrl()+" found, save will not work."})}registerSourceFileSystem(e){return kt(this,void 0,void 0,function*(){this.fileSystem=e,this.fileSystemReady=!0,this.FileSystemAccessDenied=!1;let t=yield this.fileSystem.get_list(this.filename);t.length>0&&(this.configFileCRC=yield t[0].get_crc())})}configChangeCallback(e){return kt(this,void 0,void 0,function*(){if(this.fileSystem==null){let a=this.info.addr+":"+this.info.port.toString()+"/"+this.info.path+(this.info.path!=""?"/":""),l=yield e.get_url();if(console.log("urlSignature="+a),console.log("sourceUrl="+l),l.length>a.length&&l.substring(l.length-a.length)==a){let h=Ui.FindFiles((yield e.get_serialNumber())+".files");(yield h.isOnline())&&(yield this.registerSourceFileSystem(h))}}if(this.fileSystem==null||(yield this.fileSystem.get_serialNumber())!=(yield e.get_serialNumber()))return null;let t=yield this.fileSystem.get_list(this.filename);if(t.length<=0||this.configFileCRC==(yield t[0].get_crc()))return null;let i=yield this.fileSystem.download(this.filename),r=new TextDecoder("utf-8").decode(i),s=r.indexOf(Lt.signatureStart);if(s<0)return null;this.configFileCRC=yield t[0].get_crc(),s+=Lt.signatureStart.length;let n=r.indexOf(Lt.signatureEnd);if(n<s)return"";n+=Lt.signatureEnd.length-2;let o=r.substring(s,n);try{return JSON.parse(o)}catch(a){}return null})}get configChangeCallbackFct(){return e=>kt(this,void 0,void 0,function*(){return yield this.configChangeCallback(e)})}get saveFct(){return(e,t)=>kt(this,void 0,void 0,function*(){return yield this.saveFctinternal(e,t)})}retryWithNewCredentials(e,t,i,r){return kt(this,void 0,void 0,function*(){if(this.fileSystem==null){debugger;return}let n=yield(yield this.fileSystem.get_module()).get_url(),o=new Dt,a=n.indexOf("://"),l=n.indexOf("@",a+3),h=n.substring(0,a+3)+t+":"+i+"@";l<0?h+=n.substring(a+3):h+=n.substring(l+1),yield E.UnregisterHub(n),(yield E.RegisterHub(h,o))!=E.SUCCESS&&(yield E.RegisterHub(n,o));try{if(!(yield this.saveFctinternal(e,r)))return}catch(u){r!=null&&r(!1,"Save failed ("+u.message)+"";return}})}saveFctinternal(e,t){return kt(this,void 0,void 0,function*(){if(this.FileSystemAccessDenied)throw"YV4F ERROR: Access to file system on "+this.info.get_hubUrl()+" is denied, it is probably password protected. Check network connections in the global configuration.";if(this.fileSystem==null)throw"YV4F ERROR: No file system, Save aborted";if(!this.fileSystemReady)throw"YV4F ERROR: File system is not ready yet, retry in a few seconds.";if(!this.fileSystem.isOnline())throw"YV4F ERROR: File system is off line, Save aborted";let i="",r=this.htmlSrcCode.indexOf(Lt.signatureStart+")");if(r>0)i=this.htmlSrcCode.substring(0,r+Lt.signatureStart.length)+JSON.stringify(e)+this.htmlSrcCode.substring(r+Lt.signatureStart.length);else{let a=this.htmlSrcCode.indexOf(Lt.signatureStart),l=this.htmlSrcCode.indexOf(Lt.signatureEnd);if(a>0&&l&&l>a)i=this.htmlSrcCode.substring(0,a+Lt.signatureStart.length)+JSON.stringify(e)+");"+this.htmlSrcCode.substring(l+Lt.signatureEnd.length);else throw"Unable to locate YoctoHubFileHandler constructor call in original HTML file."}i=`<!DOCTYPE html>
`+i;let s=Ks.gzip(i,{level:9}),n=!1;try{yield this.fileSystem.upload(this.filename+".gz",s)}catch(a){if(this.fileSystem.get_errorType()==-12)n=!0;else throw a}if(n){let l=yield(yield this.fileSystem.get_module()).get_url(),h=new Dt,u=l.indexOf("://"),_=l.indexOf("@",u+3);return _>=0?l=l.substring(_+1):u>=0&&(l=l.substring(u+3)),yield Si.show(l,()=>kt(this,void 0,void 0,function*(){yield this.retryWithNewCredentials(e,Si.username,Si.password,t)})),t!=null&&t(!1,"Save failed, credentials required"),!1}let o=yield this.fileSystem.get_list(this.filename);return o.length>0&&(this.configFileCRC=yield o[0].get_crc()),t!=null&&t(!0,"Save sucessfull"),!0})}};m(Lt,"YoctoHubFileHandler");var $s=Lt;$s.signatureStart="YoctoHubFileHandler.start(";$s.signatureEnd='</ROOT>\\n");';export{Jt as AlarmSection,ks as AlarmSettings,Vs as AlarmTestTypeDescription,Ns as AngularGaugeFormProperties,Or as AngularZoneDescription,Js as AnnotationPanel,Ei as AnnotationPanelDescription,Os as AnnotationPanelDescriptionGraph,br as ChartSerie,Xs as ColorEditorSroll,Xi as ColorSampler,tt as ContextMenu,Hs as ContextMenuItem,Ja as ContextMenuItemBase,Gr as ContextMenuItemSubMenuEntry,$a as ContextMenuSeparator,Ar as ContextSubMenu,Si as CredentialsPrompt,st as CustomYSensor,Pt as DataPanel,ci as DataSegment,Ri as DataSerie,ur as DataSummarySegment,dr as DataTracker,Hr as DataTrackerDescription,Wr as EditorBaseDef,Et as FontDescription,Ps as GaugeFormProperties,as as GenericAxis,Se as GenericPanel,de as GenericProperties,Fr as GraphFormProperties,Jr as HTTPrequestResult,oi as Hub,ui as HubEdit,tl as HubInfo,wt as InputFieldManager,xn as Legend,Us as LegendDescription,St as LegendPanel,wa as LegendPanelDescription,Di as Marker,bi as MarkerDescription,Yt as Matrix3x3,Ve as MessagePanel,Mt as MinMax,Me as MinMaxHandler,Vi as Navigator,Ra as NavigatorDescription,Ae as NullYSensor,ze as Point,me as PointF,li as PropPathinfo,tr as PropertiesForm2,ya as PropertiesList,ba as PropertyDescriptor,Be as Proportional,os as StartStopStep,kr as Summary,he as TimeConverter,ns as TimeConverterParseResult,ai as TimedSensorValue,pl as TypeDescription,Ie as UIElement,Cr as UIElementBaseParams,So as UIElementBoolean,xo as UIElementColor,Co as UIElementDoubleNan,To as UIElementEnum,Ai as UIElementGeneric,Xr as UIElementList,wo as UIElementMarkerPos,Ao as UIElementNumber,yo as UIElementString,Ut as Vector3,jt as ViewPortSettings,ct as XAxis,Qi as XaxisDescription,E as YAPI,be as YAPIContext,xh as YAPI_BUFFER_TOO_SMALL,_h as YAPI_DEVICE_BUSY,dh as YAPI_DEVICE_NOT_FOUND,wh as YAPI_DNS_ERROR,bh as YAPI_DOUBLE_ACCES,mh as YAPI_EXHAUSTED,Ah as YAPI_FILE_NOT_FOUND,hh as YAPI_INVALID_ARGUMENT,Ge as YAPI_INVALID_DOUBLE,Ih as YAPI_INVALID_INT,Mr as YAPI_INVALID_LONG,fe as YAPI_INVALID_STRING,vh as YAPI_INVALID_UINT,fh as YAPI_IO_ERROR,Nh as YAPI_LEGACY,fs as YAPI_MAX_DOUBLE,gs as YAPI_MIN_DOUBLE,lh as YAPI_NOT_INITIALIZED,uh as YAPI_NOT_SUPPORTED,kh as YAPI_NO_EXPIRATION_CHECK,Ph as YAPI_NO_HOSTNAME_CHECK,ph as YAPI_NO_MORE_DATA,Eh as YAPI_NO_TRUSTED_CA_CHECK,Th as YAPI_RFID_HARD_ERROR,Ch as YAPI_RFID_SOFT_ERROR,yh as YAPI_RTC_NOT_READY,Sh as YAPI_SSL_ERROR,Rh as YAPI_SSL_UNK_CERT,fr as YAPI_SUCCESS,gh as YAPI_TIMEOUT,vs as YAPI_UNAUTHORIZED,Dh as YAPI_UNCONFIGURED,ch as YAPI_VERSION_MISMATCH,ar as YAngularGauge,An as YAngularZone,Nt as YAxis,ts as YBrush,c as YColor,cl as YConsolidatedDataSet,Re as YDataLogger,W as YDataRenderer,zt as YDataSet,Lr as YDataStream,ae as YDate,di as YDigitalDisplay,Le as YEnum,De as YEnumItem,Dt as YErrorMsg,ha as YFileRecord,Ui as YFiles,As as YFirmwareFile,Ss as YFirmwareUpdate,it as YFont,ue as YFunction,Oi as YGenericHub,_l as YGenericSSDPManager,Rt as YGraph,Kt as YGraphics,ei as YGraphicsSVG,gr as YHTTPBody,Ht as YHTTPRequest,Ts as YHttpEngine,Vt as YHub,Cs as YHubEngine,Bt as YLinearGradientBrush,fi as YMeasure,ke as YModule,q as YNetwork,Ce as YPen,le as YRectangle,rt as YSensor,Ki as YSizeF,Ze as YSmoothingMode,at as YSolidBrush,ri as YSolidGauge,qe as YStringFormat,Yr as YSystemEnv,ra as YSystemEnvHtml,Ye as YTextRenderingHint,O as YWebPage,xs as YWebSocketEngine,Tt as YWidget,nt as YWindow,mi as YXmlNode,Cl as Y_DETECT_ALL,On as Y_DETECT_NET,nl as Y_DETECT_NONE,gl as Y_DETECT_USB,Sl as Y_FUNCTIONDESCRIPTOR_INVALID,Ji as YaxisDescription,ps as YoctoError,$s as YoctoHubFileHandler,nr as Zone,zr as ZoneDescription,si as _YY_UrlInfo,yi as alert,vi as angularGaugeWidget,ft as button,sl as captureParametersSet,ni as colorEditor,ye as configForm,pi as confirm,S as constants,Ls as digitalDisplayFormProperties,Gi as digitalDisplayWidget,et as doubleNan,zs as fontNameTypeDescription,Hi as gaugeWidget,gt as graphWidget,ml as info,Z as logForm,Sr as mainForm,Ir as minMaxPoint,ut as newWindowParam,ot as pointXY,hr as pointsSummary,Xt as rawDataForm,J as ressources,Br as sensorDataTypeDescription,er as sensorFreqTypeDescription,Ur as sensorPrecisionTypeDescription,oe as sensorsManager,_t as xAxisPosition,Fs as yAxisDescription};
